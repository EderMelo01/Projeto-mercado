(window.webpackJsonp=window.webpackJsonp||[]).push([[106,139],{2007:function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var r=n(2),o=(n(9),n(7),n(10),n(19),n(11),n(12),n(8),n(4),n(6),n(219)),c=n(42),d=n(1),l=n(59);function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m={data:function(){return{list:[]}},watch:{aiPhotoTrainList:{handler:function(t){this.list=t},immediate:!0,deep:!0},list:{handler:function(t){Object(c.l)()&&((t||[]).filter((function(t){return[1,2,"1","2"].includes(t.state)})).map((function(t){return t.id})).length&&this.mockProcessTask())},immediate:!0,deep:!0},userInfo:{handler:function(t){var e=(t||{}).id;!(void 0===e?"":e)&&this.endPoll()},immediate:!0,deep:!0}},computed:h(h({},Object(d.e)("user",["userInfo"])),Object(d.c)("creation",["aiPhotoTrainList"])),mounted:function(){var t=this;this.pollingMiddleware=new o.a(3e4,(function(){t.fetchTaskData()}))},beforeDestroy:function(){this.pollingMiddleware&&this.pollingMiddleware.stop(),this.pollingMiddleware=null},methods:h(h({},Object(d.b)("creation",["setAiPhotographyTrainList"])),{},{mockProcessTask:function(){var t=this.list.filter((function(t){return[1,2,"1","2"].includes(t.state)})).map((function(t){return t.id}));t.length?this.startPoll(t):this.endPoll()},startPoll:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.pollingMiddleware&&this.pollingMiddleware.checkStart(t)},endPoll:function(){this.pollingMiddleware&&this.pollingMiddleware.stop()},fetchTaskData:function(){var t=this.list.filter((function(t){return[1,2,"1","2"].includes(t.state)})).map((function(t){return t.id}));t.length?this.getTaskInfo(t):this.endPoll()},getTaskInfo:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n={};return n.ids=e,Object(l.o)(n).then((function(e){var n=(e&&e.data?e.data:{}).items;((void 0===n?[]:n)||[]).forEach((function(e){if(t.$EventBus.$emit("updateAiPhotographyDigitalCloneList",e),t.$EventBus.$emit("updateAiPhotographyDigitalCloneItem",e),e&&[3].includes(e.state))return t.$set(t,"showStep","success"),t.visible=!0,void t.endPoll();t.updateData(e,e.id)}))}))},updateData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;this.list.forEach((function(r){if(n===r.id){if([4,"4"].includes(e.state)&&0===e.process)return t.$set(r,"state",e.state),t.$set(r,"state_desc",e.state_desc),t.$set(t,"showStep","failed"),t.visible=!0,t.$EventBus.$emit("updateAiPhotographyDigitalCloneList",r),t.$EventBus.$emit("updateAiPhotographyDigitalCloneItem",r),void t.endPoll();if(![0,100].includes(e.process)&&r.process>=e.process)return t.$set(r,"state",e.state),void t.$set(r,"state_desc",e.state_desc);t.$set(r,"process",e.process>100?100:e.process),t.$set(r,"state",e.state),t.$set(r,"data_set_no",null==e?void 0:e.data_set_no),t.$set(r,"rank",(null==e?void 0:e.rank)||0),t.$set(r,"time_left",(null==e?void 0:e.time_left)||0),t.$set(r,"state_desc",e.state_desc)}})),this.$store.dispatch("creation/setAiPhotographyTrainList",this.list)}})}},219:function(t,e,n){"use strict";var r=n(3),o=n(233),c=n(234),d=(n(20),n(4),n(29),function(){return Object(c.a)((function t(e,n){Object(o.a)(this,t),this.timeInterval=e,this.callback=n,this.timerId=null,this.queue=[],this.running=!1}),[{key:"checkStart",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.queue=t,this.running||this.start()}},{key:"poll",value:(t=Object(r.a)(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.running){t.next=9;break}return t.next=3,this.shouldPoll();case 3:return t.sent||this.stop(),t.next=7,new Promise((function(t){e.timerId=window.setTimeout((function(){"function"==typeof e.callback&&e.callback(),t()}),e.timeInterval)}));case 7:t.next=0;break;case 9:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"shouldPoll",value:function(){return!!this.queue.length}},{key:"start",value:function(){this.running=!0,this.poll()}},{key:"stop",value:function(){this.running=!1,this.timerId&&window.clearTimeout(this.timerId),this.queue=[]}}]);var t}());e.a=d},47:function(t,e,n){"use strict";var r=n(46),o=n(164).findIndex,c=n(568),d="findIndex",l=!0;d in[]&&Array(1)[d]((function(){l=!1})),r({target:"Array",proto:!0,forced:l},{findIndex:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),c(d)},59:function(t,e,n){"use strict";n.d(e,"r",(function(){return o})),n.d(e,"i",(function(){return c})),n.d(e,"a",(function(){return d})),n.d(e,"n",(function(){return l})),n.d(e,"m",(function(){return f})),n.d(e,"l",(function(){return h})),n.d(e,"j",(function(){return m})),n.d(e,"u",(function(){return v})),n.d(e,"v",(function(){return O})),n.d(e,"x",(function(){return P})),n.d(e,"y",(function(){return k})),n.d(e,"o",(function(){return j})),n.d(e,"b",(function(){return T})),n.d(e,"w",(function(){return S})),n.d(e,"s",(function(){return w})),n.d(e,"k",(function(){return y})),n.d(e,"q",(function(){return $})),n.d(e,"t",(function(){return I})),n.d(e,"d",(function(){return D})),n.d(e,"g",(function(){return _})),n.d(e,"e",(function(){return x})),n.d(e,"h",(function(){return C})),n.d(e,"c",(function(){return A})),n.d(e,"p",(function(){return E})),n.d(e,"f",(function(){return M}));var r=n(17);function o(data){return Object(r.a)({url:"/api/v1/task/tool/config",method:"POST",data:data,customConfig:{isSilent:!0}})}function c(data){return Object(r.a)({url:"/api/v1/task/tool/create",method:"POST",data:data})}function d(data){return Object(r.a)({url:"/api/v1/task/tool/batch-progress",method:"POST",data:data,customConfig:{isSilent:!0,needRemovePending:!1}})}function l(data){return Object(r.a)({url:"/api/v1/ai-portrait/template/list",method:"POST",data:data})}function f(data){return Object(r.a)({url:"/api/v1/ai-portrait/template/category",method:"POST",data:data})}function h(data){return Object(r.a)({url:"/api/v1/ai-portrait/model/list",method:"POST",data:data})}function m(data){return Object(r.a)({url:"/api/v1/ai-portrait/task/create",method:"POST",data:data})}function v(data){return Object(r.a)({url:"/api/v1/ai-portrait/task/list",method:"POST",data:data})}function O(data){return Object(r.a)({url:"/api/v1/ai-portrait/model/delete",method:"POST",data:data})}function P(data){return Object(r.a)({url:"/api/v1/ai-portrait/model/train",method:"POST",data:data})}function k(data){return Object(r.a)({url:"/api/v1/ai-portrait/task/upscale",method:"POST",data:data})}function j(data){return Object(r.a)({url:"/api/v1/ai-portrait/model/train-progress",method:"POST",data:data,customConfig:{isSilent:!0,needRemovePending:!1}})}function T(data){return Object(r.a)({url:"/api/v1/task/tool/magic-eraser",method:"POST",data:data,customConfig:{needRemovePending:!1}})}function S(data){return Object(r.a)({url:"/api/v1/task/tool/ultra-hd/create",method:"POST",data:data})}function w(data){return Object(r.a)({url:"/api/v1/task/tool/ultra-hd/task/list",method:"POST",data:data})}function y(data){return Object(r.a)({url:"/api/v1/task/delete",method:"POST",data:data})}function $(data){return Object(r.a)({url:"/api/v1/task/estimate",method:"POST",data:data})}function I(data){return Object(r.a)({url:"/api/v1/task/detail",method:"POST",data:data})}function D(data){return Object(r.a)({url:"/api/v1/task/tool/st/config",method:"POST",data:data})}function _(data){return Object(r.a)({url:"/api/v1/task/tool/st/storyboard-prompt",method:"POST",data:data})}function x(data){return Object(r.a)({url:"/api/v1/task/tool/st/comic/create",method:"POST",data:data,customConfig:{isSilent:!0}})}function C(data){return Object(r.a)({url:"/api/v1/task/tool/st/task/list",method:"POST",data:data})}function A(data){return Object(r.a)({url:"/api/v1/task/tool/st/character-prompt",method:"POST",data:data})}function E(data){return Object(r.a)({url:"/api/v1/fast_ai/detail",method:"POST",data:data})}function M(data){return Object(r.a)({url:"/api/v1/task/stash/run-task/get",method:"POST",data:data})}}}]);