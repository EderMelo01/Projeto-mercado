(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{1001:function(t,e,n){t.exports={}},1002:function(t,e,n){t.exports={}},1003:function(t,e,n){t.exports={}},1009:function(t,e,n){t.exports={}},1010:function(t,e,n){t.exports={}},1012:function(t,e,n){t.exports={}},1013:function(t,e,n){t.exports={}},1014:function(t,e,n){t.exports={}},1015:function(t,e,n){t.exports={}},1016:function(t,e,n){t.exports={}},1018:function(t,e,n){t.exports={}},1019:function(t,e,n){t.exports={}},1023:function(t,e,n){t.exports={}},1024:function(t,e,n){t.exports={}},1027:function(t,e,n){t.exports={}},1028:function(t,e,n){t.exports={}},1029:function(t,e,n){t.exports={}},1030:function(t,e,n){t.exports={}},1031:function(t,e,n){t.exports={}},1032:function(t,e,n){t.exports={}},1033:function(t,e,n){t.exports={}},1034:function(t,e,n){t.exports={}},1035:function(t,e,n){t.exports={}},1036:function(t,e,n){t.exports={}},1037:function(t,e,n){t.exports={}},1038:function(t,e,n){t.exports={}},1039:function(t,e,n){t.exports={}},1040:function(t,e,n){t.exports={}},1041:function(t,e,n){t.exports={}},1055:function(t,e,n){t.exports={}},1056:function(t,e,n){t.exports={}},1057:function(t,e,n){t.exports={}},1058:function(t,e,n){t.exports={}},1059:function(t,e,n){t.exports={}},1060:function(t,e,n){t.exports={}},1061:function(t,e,n){t.exports={}},1086:function(t,e,n){t.exports={}},1089:function(t,e,n){t.exports={}},1090:function(t,e,n){t.exports={}},1092:function(t,e,n){t.exports={}},1093:function(t,e,n){t.exports={}},1096:function(t,e,n){t.exports={}},1097:function(t,e,n){t.exports={}},1098:function(t,e,n){t.exports={}},1099:function(t,e,n){t.exports={}},1100:function(t,e,n){t.exports={}},1101:function(t,e,n){t.exports={}},1102:function(t,e,n){t.exports={}},1117:function(t,e,n){t.exports={}},1118:function(t,e,n){t.exports={}},1119:function(t,e,n){t.exports={}},1120:function(t,e,n){t.exports={}},1122:function(t,e,n){t.exports={}},1123:function(t,e,n){t.exports={}},1124:function(t,e,n){t.exports={}},1125:function(t,e,n){t.exports={}},1126:function(t,e,n){t.exports={}},1127:function(t,e,n){t.exports={}},1128:function(t,e,n){t.exports={}},1129:function(t,e,n){t.exports={}},1130:function(t,e,n){t.exports={}},1131:function(t,e,n){t.exports={}},1132:function(t,e,n){t.exports={}},1133:function(t,e,n){t.exports={}},1134:function(t,e,n){t.exports={}},1135:function(t,e,n){t.exports={}},1136:function(t,e,n){t.exports={}},1137:function(t,e,n){t.exports={}},1138:function(t,e,n){t.exports={}},1139:function(t,e,n){t.exports={}},1140:function(t,e,n){t.exports={}},1141:function(t,e,n){t.exports={}},1142:function(t,e,n){t.exports={}},1143:function(t,e,n){t.exports={}},1144:function(t,e,n){t.exports={}},1145:function(t,e,n){t.exports={}},1172:function(t,e,n){t.exports={}},1173:function(t,e,n){t.exports={}},1174:function(t,e,n){t.exports={}},1177:function(t,e,n){t.exports={}},1178:function(t,e,n){t.exports={}},1179:function(t,e,n){t.exports={}},1184:function(t,e,n){t.exports={}},1185:function(t,e,n){t.exports={}},1186:function(t,e,n){t.exports={}},1188:function(t,e,n){t.exports={}},1189:function(t,e,n){t.exports={}},1190:function(t,e,n){t.exports={}},1191:function(t,e,n){t.exports={}},1213:function(t,e,n){t.exports={}},1214:function(t,e,n){t.exports={}},1215:function(t,e,n){t.exports={}},1216:function(t,e,n){t.exports={}},1319:function(t,e,n){t.exports={}},1320:function(t,e,n){t.exports={}},1321:function(t,e,n){t.exports={}},1325:function(t,e,n){t.exports={}},1326:function(t,e,n){t.exports={}},1327:function(t,e,n){t.exports={}},1328:function(t,e,n){t.exports={}},1329:function(t,e,n){t.exports={}},1332:function(t,e,n){t.exports={}},1333:function(t,e,n){t.exports={}},1334:function(t,e,n){t.exports={}},137:function(t,e,n){"use strict";n(14),n(9),n(7),n(11),n(12),n(8),n(4),n(6);var o=n(2),r=(n(23),n(37),n(71),n(719)),l=n(1),c=n(199),d=n.n(c);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={name:"RightPart",props:{activation:{type:Boolean,default:!1},showBg:{type:Boolean,default:!1},showText:{type:Boolean,default:!1},showAvatar:{type:Boolean,default:!0},showStep:{type:Boolean,default:!0},currency:{type:String,default:"US$"}},components:{},computed:m(m({},Object(l.e)("user",["cdnHost"])),{},{randomPersonData:function(){var t=r.a[Math.floor(Math.random()*r.a.length)],e=(this.$i18n.locale?this.$i18n.locale:"en").toLowerCase().startsWith("zh");return m(m({},t),{},{title:e?t.titleZh:t.titleEn,content:e?t.contentZh:t.contentEn,avatar:t.avatar.replace("image2.cdn.seaart.me",this.cdnHost)})}}),data:function(){return{}},mounted:function(){},methods:{formatDate:function(){return d()().add(3,"day").format("YYYY-MM-DD")},toMall:function(){window.open(this.localePath("/mall"),"_blank")}}},f=(n(2550),n(0)),component=Object(f.a)(v,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"right-part",class:{bgImg:t.showBg}},[t.showText?e("div",{staticClass:"renew-content"},[e("div",{staticClass:"renew-sign"},[t._v("“")]),t._v(" "),e("div",{staticClass:"renew-txt"},[t._v(t._s(t.randomPersonData.content))])]):t._e(),t._v(" "),t.showStep?e("div",{staticClass:"steps"},[e("div",{staticClass:"step up"},[e("div",{staticClass:"left-step"},[e("div",{staticClass:"left-icon"},[e("svg-icon",{staticClass:"icon",attrs:{"icon-class":"blueHeart"}})],1),t._v(" "),e("div",{staticClass:"left-line"})]),t._v(" "),e("div",{staticClass:"box"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t("vipDialogNewTitle")))]),t._v(" "),e("div",{staticClass:"desc"},[t._v(t._s(t.$t("vipDialogNewDesc1",{unit:t.currency})))])])]),t._v(" "),e("div",{staticClass:"step"},[t._m(0),t._v(" "),e("div",{staticClass:"box"},[e("div",{staticClass:"title"},[t._v(t._s(t.formatDate()))]),t._v(" "),e("div",{staticClass:"desc"},[t._v(t._s(t.$t("vipDialogNewDesc2")))])])])]):t._e(),t._v(" "),t.showAvatar?e("div",{staticClass:"avatar-content"},[t.randomPersonData.avatar?e("div",{staticClass:"avatar"},[e("img",{attrs:{src:t.randomPersonData.avatar,alt:"avatar"},on:{mousedown:function(t){t.preventDefault()},contextmenu:function(t){t.preventDefault()}}})]):t._e(),t._v(" "),e("div",{staticClass:"person-info"},[e("div",{staticClass:"name"},[t._v(t._s(t.randomPersonData.name))]),t._v(" "),e("div",{staticClass:"title"},[t._v(t._s(t.randomPersonData.title))])])]):t._e(),t._v(" "),!t.activation&&t.showStep?e("div",{staticClass:"renew-txt"},[t._v(t._s(t.randomPersonData.content))]):t._e(),t._v(" "),t.activation?e("div",{staticClass:"to-mall",on:{click:t.toMall}},[t._v(t._s(t.$t("ActivationTip")))]):t._e()])}),[function(){var t=this._self._c;return t("div",{staticClass:"left-step"},[t("div",{staticClass:"left-icon"},[t("i",{staticClass:"icon iconfont icon-ring"})]),this._v(" "),t("div",{staticClass:"left-line"})])}],!1,null,"35792eef",null);e.a=component.exports},138:function(t,e,n){"use strict";n(14),n(9),n(11),n(12),n(6);var o=n(3),r=n(2),l=(n(20),n(16),n(7),n(32),n(10),n(28),n(8),n(4),n(18),n(50),n(48),n(29),n(66)),c=n(1),d=n(559),h=n(5);function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f=n(291),_={name:"PaymentForm",inject:["top"],props:{initMount:{type:Boolean,default:!1},defaultThirdType:{type:Number,default:9},disabledMethods:{type:Array,default:function(){return[]}},goodsId:{type:[Number,String],default:""},isFreeTry:{type:Boolean,default:!1},showFreeTry:{type:Boolean,default:!0},purchParams:{type:Object,default:function(){return{}}},upgrade:{type:[Number,Boolean],default:0},isSubscription:{type:Boolean,default:!0},btnLabel:{type:String,default:""},backToCheck:{type:Boolean,default:!1},from:{type:String,default:""}},components:{PaymentCheck:d.a},watch:{inPaymentForm:function(t){t&&this.$emit(t)}},computed:v(v(v({},Object(c.e)("payment",["paymentInfo","adyenFailed","adyenPaymenMethods"])),Object(c.e)("user",["userInfo"])),{},{$isChinaSite:function(){return!1},showBack:function(){return!0},allMethods:function(){var t=this,e=[{name:"Credit Card",i18n:"Credit Card",newWindow:!1,icon:"adyen-icon.png",type:9},{name:"AliPay",i18n:"alipay",newWindow:!1,icon:"alipay-icon.png",type:9},{name:"Google Pay",i18n:"Google Pay",newWindow:!1,icon:"googlepay-icon.png",type:9},{name:"PIX",i18n:"PIX",newWindow:!0,icon:"pix-icon.png",type:1},{name:"Paypal",i18n:"Paypal",newWindow:!0,icon:"paypal-icon.png",type:10}];return this.disabledMethods.length&&(e=e.filter((function(e){return!t.disabledMethods.includes(e.type)}))),this.isShowPayermax||(e=e.filter((function(t){return 1!==t.type}))),this.useTry&&(e=e.filter((function(t){return![1,10].includes(t.type)}))),this.isShowAlipay||(e=e.filter((function(t){return"AliPay"!==t.name}))),this.upgrade&&this.defaultThirdType&&(e=e.filter((function(e){return e.type===t.defaultThirdType})),8===this.defaultThirdType&&this.$message.warning(this.$t("bandStripe"))),e},creditCard:function(){return this.allMethods.find((function(t){return"Credit Card"===t.name}))},trueUpgrade:function(){var t;return 2===(null===(t=this.paymentInfo)||void 0===t?void 0:t.purchaseType)&&this.upgrade},btnTxt:function(){return this.isSubscription?"SubscribeNow":"businesSwiperBtn1"},isYahoo:function(){var t;return null===(t=this.userInfo)||void 0===t||null===(t=t.adv_platform)||void 0===t?void 0:t.includes("yahoo")},isShowBillingAddress:function(){var t,e=null===(t=this.userInfo)||void 0===t?void 0:t.current_country_code;return["US","UK","GB","CA"].includes(e)},isShowAlipay:function(){var t;return"CN"===(null===(t=this.userInfo)||void 0===t?void 0:t.current_country_code)},isShowPayermax:function(){var t;return"BR"===(null===(t=this.userInfo)||void 0===t?void 0:t.current_country_code)},isBindAdyen:function(){var t;return null===(t=this.userInfo)||void 0===t?void 0:t.bind_adyen}}),data:function(){return{AdyenCheckout:null,activeMethod:null,selectAdyenMethod:{brands:["visa","mc","cup","jcb"],name:"Credit Card",type:"scheme"},thirdOrderId:"",adyenComponent:null,adyenTempAction:null,adyenTempPayment:null,inPaymentForm:"in-form",qrCode:null,wechatBtnLoading:!1,wechatBtnDisabled:!1,useTry:!1,backToClose:!1,inCreating:!1}},mounted:function(){var t=this;if(this.loadAdyenCheckout(),Object(h.w)("https://cdn.jsdelivr.net/npm/@adyen/adyen-web@latest/dist/adyen.css"),this.isBindAdyen&&!this.adyenFailed&&(this.inPaymentForm="in-reuse",this.$confirm(this.$t("adyenConfirmTitle"),this.$t("Tip"),{distinguishCancelAndClose:!0,confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("switch"),customClass:"ai-face-swap-confirm"}).then((function(){t.purchaseGoodsFun(9),t.backToClose=!0,t.$logEvent("log_actions",{operation:"click_confirm",behavior_info:"on_repay_popup"})})).catch((function(e){"cancel"===e?(t.inPaymentForm="in-form",t.$logEvent("log_actions",{operation:"click_switch",behavior_info:"on_repay_popup"})):t.$emit("in-pay-back")})).finally((function(){t.$logEvent("log_order",{source:"credit_repurchase_popup"})}))),this.useTry=this.isFreeTry&&"mall"!==this.from,this.adyenPaymenMethods||this.getAdyenPaymentMethod(),this.initMount){var e=this.allMethods.find((function(e){return e.type===t.defaultThirdType}));e||(e=this.creditCard),e&&this.selectMethod(e)}},methods:v(v(v({},Object(c.b)("payment",["getPaymentInfo","setAdyenFailed","setSubThirdType","getAdyenPaymentMethod"])),Object(c.b)("user",["getAccountInfo"])),{},{loadAdyenCheckout:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.e(22).then(n.t.bind(null,4282,7));case 3:o=e.sent,t.AdyenCheckout=o.default,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to load Adyen Checkout:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},initPayments:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.adyenPaymenMethods){e.next=3;break}return e.next=3,t.getAdyenPaymentMethod();case 3:case"end":return e.stop()}}),e)})))()},handleBack:function(){"in-waiting"===this.inPaymentForm&&(this.$refs.paymentCheck.getPaymentOnce(),this.$refs.paymentCheck.stopPoll()),this.backToCheck?this.$emit("in-pay-back"):"in-waiting"!==this.inPaymentForm||this.backToClose?(this.qrCode=null,this.$emit("in-pay-back"),this.$refs.paymentCheck.stopPoll()):this.inPaymentForm="in-form"},selectMethod:function(t){console.log("selectMethod",t,this.adyenPaymenMethods),this.activeMethod=t,9===t.type&&this.startCheckout()},switchTry:function(t){var e;t&&[1,10].includes(null===(e=this.activeMethod)||void 0===e?void 0:e.type)&&this.selectMethod(this.creditCard)},startCheckout:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.initPayments();case 2:return(o=null===(n=t.adyenPaymenMethods)||void 0===n?void 0:n.paymentMethods)&&(t.selectAdyenMethod=o.find((function(e){return e.name===t.activeMethod.name}))),console.log("this.selectAdyenMethod",t.selectAdyenMethod,t.AdyenCheckout),e.next=7,t.loadAdyenCheckout();case 7:if(t.AdyenCheckout&&t.selectAdyenMethod){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,t.createAdyenCheckout();case 11:r=e.sent,t.adyenComponent=r.create(t.selectAdyenMethod.type,{hasHolderName:!0,holderNameRequired:!0,billingAddressRequired:t.isShowBillingAddress,buttonType:"pay",buttonLocale:t.$i18n.locale||"en"}),t.adyenComponent.mount(t.$refs["adyen".concat(t.selectAdyenMethod.type)]);case 14:case"end":return e.stop()}}),e)})))()},createAdyenCheckout:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={locale:t.$i18n.locale,clientKey:"production".includes("production")?"live_Q2TOAFSMXNDDZIHVMRZZ3DRK2MGQQ6OX":"test_W6R5OPPNSJG2HNO2ZJ5DNOUORIJJY53E",environment:"production".includes("production")?"production":"test",showPayButton:!0,paymentMethodsResponse:t.adyenPaymenMethods,onPaymentCompleted:function(t,component){console.log("onPaymentCompleted result: "+t)},onSubmit:function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(n,component){var o,r,l,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("onSubmit:",n,component),t.adyenTempPayment=null==n||null===(o=n.data)||void 0===o?void 0:o.paymentMethod,p={adyen_payment_method:t.adyenTempPayment,browser_info:null==n||null===(r=n.data)||void 0===r?void 0:r.browserInfo,origin:null==n||null===(l=n.data)||void 0===l?void 0:l.origin},e.next=5,t.purchaseGoodsFun(9,v({},p));case 5:console.log("onSubmit: 创建完订单 adyenTempAction","p",p,t.adyenTempAction,"thirdOrderId",t.thirdOrderId),t.adyenTempAction&&component.handleAction(t.adyenTempAction);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),onAdditionalDetails:function(e,component){var n;console.log("onAdditionalDetails:",e,component);var o=(null==e||null===(n=e.data)||void 0===n||null===(n=n.details)||void 0===n?void 0:n.threeDSResult)||"";o&&t.checkThreeDResult(o)},onError:function(e,component){console.error("onError:",e.name,e.message,e.stack,component),t.reRenderAdyen()}},console.log("configuration",n),e.abrupt("return",new t.AdyenCheckout(n));case 3:case"end":return e.stop()}}),e)})))()},reRenderAdyen:function(){this.adyenComponent.unmount(),this.adyenComponent.mount(this.$refs["adyen".concat(this.selectAdyenMethod.type)])},purchaseGoodsFun:function(){var t=arguments,e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,c,d,h,m,f,_;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.length>0&&void 0!==t[0]?t[0]:9,c=t.length>1&&void 0!==t[1]?t[1]:{},!e.inCreating){n.next=4;break}return n.abrupt("return");case 4:if(e.$refs.paymentCheck.stopPoll(),!e.upgrade){n.next=10;break}if(!e.trueUpgrade){n.next=10;break}return n.next=9,e.setUpgrade(r,c);case 9:return n.abrupt("return");case 10:if([6,8,9].includes(r)&&e.isSubscription){if(h=l.n,d=v(v({cp_product_id:e.goodsId,with_trial:e.useTry,change_type:1,third_plat_type:r},e.purchParams),c),8===(null===(m=e.activeMethod)||void 0===m?void 0:m.type)){d.client_reference_id="";try{(_=Rewardful&&(null===(f=Rewardful)||void 0===f?void 0:f.referral)||"")&&(d.client_reference_id=_)}catch(t){console.log("Rewardful, error",t)}}}else h=l.m,d=v({cp_product_id:e.goodsId,os:"1",quantity:1,third_plat_type:r},c);return(null==e||null===(o=e.top)||void 0===o?void 0:o.dotFrom)&&(d.from=e.top.dotFrom),5===r&&(e.wechatBtnLoading=!0),e.$emit("in-loading",!0),e.inCreating=!0,n.next=17,h(d).then((function(t){var n,o=t.data,l=o.PaymentUrl,c=o.ThirdOrderId,d=o.AdyenAction;if(9===(null===(n=e.activeMethod)||void 0===n?void 0:n.type)&&d)e.handleAction(d);else if(l&&5!==r){e.thirdOrderId=c;var h=window.screen.height/2-300,m=window.screen.width/2-400;e.showWaitPayment(),window.open(l,"newWindow","height=600,width=800,top=".concat(h,",left=").concat(m))}else 5===r?(e.thirdOrderId=c,e.wechatBtnLoading=!1,e.wechatBtnDisabled=!0,setTimeout((function(){e.wechatBtnDisabled=!1}),3e5),e.appendQrCode(l)):console.log("create error, no PaymentUrl or AdyenAction")})).catch((function(t){var n;console.error("purchaseGoodsFun:",t),9===(null===(n=e.activeMethod)||void 0===n?void 0:n.type)&&(e.setAdyenFailed(),e.reRenderAdyen(),e.backToClose&&(e.inPaymentForm="in-form"))})).finally((function(){e.inCreating=!1,e.$emit("in-loading",!1)}));case 17:case"end":return n.stop()}}),n)})))()},checkThreeDResult:function(t){var e=this,n={three_ds_result:t,adyen_payment_method:this.adyenTempPayment};Object(l.a)(n).then((function(t){var n;if(1e4===(null==t||null===(n=t.status)||void 0===n?void 0:n.code)){var o=t.data.order_id;e.thirdOrderId=o,e.$emit("check-payment-status",{type:9,order_id:o}),e.showWaitPayment()}})).catch((function(t){console.log("checkThreeDs error",t),e.reRenderAdyen()}))},setUpgrade:function(t,e){var n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var r,c;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(console.log("setUpgrade",t,e),8!=t){o.next=4;break}return n.$message.warning(n.$t("bandStripe")),o.abrupt("return");case 4:return c=v({change_type:1,cp_product_id:null==n?void 0:n.goodsId,third_plat_type:t},e),(null==n||null===(r=n.top)||void 0===r?void 0:r.dotFrom)&&(c.from=n.top.dotFrom),o.next=8,Object(l.o)(c).then((function(t){var e,o=t.data,r=o.PaymentUrl,l=(o.ThirdOrderId,o.AdyenAction);9===(null===(e=n.activeMethod)||void 0===e?void 0:e.type)&&l?n.handleAction(l):r?window.open(r):(n.$message.success(n.$t("OperateSuccess")),n.$refs.paymentCheck.paySuccess())}));case 8:case"end":return o.stop()}}),o)})))()},paymentSuccess:function(){this.saveSubType(this.activeMethod.type),this.$emit("pay-success"),this.inPaymentForm="in-form",this.isYahoo},paymentError:function(t){var e=t.type;this.inPaymentForm="in-form",9===e&&this.reRenderAdyen()},saveSubType:function(t){var e,n;1!==(null===(e=this.paymentInfo)||void 0===e?void 0:e.purchaseType)&&this.isSubscription&&this.setSubThirdType(t),"Credit Card"===(null===(n=this.activeMethod)||void 0===n?void 0:n.name)&&this.getAccountInfo()},showWaitPayment:function(){this.inPaymentForm="in-waiting"},appendQrCode:function(t){var e=this;this.$refs.QRCodeContainer[0].innerHTML="",this.$nextTick((function(){var n=e.$refs.QRCodeContainer[0];e.qrCode=new f(n,{text:t,width:85,height:85}),e.$refs.paymentCheck.pollGetPaymentStatus(5)}))},handleAction:function(t){var e=JSON.parse(t),n=e.action,o=e.merchantReference;n?this.adyenTempAction=n:o?(this.thirdOrderId=o,this.$emit("check-payment-status",{type:9,order_id:o}),this.showWaitPayment()):console.log("create error, no action or merchantReference")}})},y=_,w=(n(2552),n(2553),n(0)),component=Object(w.a)(y,(function(){var t,e,o,r,l=this,c=l._self._c;return c("div",{staticClass:"payment-content"},[l.$slots.default?c("div",{staticClass:"close-icon flex-center",on:{click:l.handleBack}},[c("i",{staticClass:"el-icon-close"})]):l._e(),l._v(" "),c("div",{directives:[{name:"show",rawName:"v-show",value:"in-form"===l.inPaymentForm,expression:"inPaymentForm === 'in-form'"}],staticClass:"in-payment-content w-full flex"},[c("div",{staticClass:"left"},[c("div",{directives:[{name:"show",rawName:"v-show",value:l.showBack,expression:"showBack"}],staticClass:"back-to",on:{click:l.handleBack}},[c("i",{staticClass:"el-icon-arrow-left"}),l._v(l._s(l.$slots.default?l.$t("changePlan"):l.$t("Back"))+"\n      ")]),l._v(" "),c("div",{staticClass:"select-methods"},[c("div",{staticClass:"select-txt flex justify-between items-center"},[l._v("\n          "+l._s(l.$t("PaymentMethod"))+"\n          "),c("div",{staticClass:"switch"},[l.isFreeTry?c("el-switch",{directives:[{name:"show",rawName:"v-show",value:l.showFreeTry,expression:"showFreeTry"}],attrs:{"active-color":"#13ce66","inactive-color":"#636466","inactive-text":l.$t("try3Days")},on:{change:l.switchTry},model:{value:l.useTry,callback:function(t){l.useTry=t},expression:"useTry"}}):l._e()],1)]),l._v(" "),l.$isChinaSite?c("div",{staticClass:"haiyi-methods"},l._l(l.allMethods,(function(t,e){return c("div",{key:t.name+e,class:t.name},[c("div",{staticClass:"box"},[5===t.type?c("div",{directives:[{name:"show",rawName:"v-show",value:l.qrCode,expression:"qrCode"}],ref:"QRCodeContainer",refInFor:!0,staticClass:"QR-code div"}):l._e(),l._v(" "),c("img",{directives:[{name:"show",rawName:"v-show",value:!l.qrCode||4===t.type,expression:"!qrCode || item.type === 4"}],staticClass:"icon",attrs:{src:n(258)("./".concat(t.icon)),alt:"alipay-icon"}})]),l._v(" "),c("el-button",{staticClass:"btn",attrs:{loading:5===t.type&&l.wechatBtnLoading},on:{click:function(e){return l.purchaseGoodsFun(t.type)}}},[l._v("\n              "+l._s(l.$t(t.i18n))+" "),c("i",{staticClass:"el-icon-arrow-right"})])],1)})),0):c("div",{staticClass:"methods"},l._l(l.allMethods,(function(t,e){var o;return c("div",{key:t.name+e,staticClass:"method-item",class:{active:(null===(o=l.activeMethod)||void 0===o?void 0:o.name)===t.name},on:{click:function(e){return l.selectMethod(t)}}},["Google Pay"===t.name?[c("img",{staticClass:"google-pay-icon",attrs:{src:n(621),alt:""}})]:c("div",{staticClass:"method-name w-full flex-center"},[l._v(l._s(l.$t(t.i18n)))])],2)})),0)]),l._v(" "),l.activeMethod&&!l.$isChinaSite?c("div",{staticClass:"payment-form flex items-center"},[c("div",{directives:[{name:"show",rawName:"v-show",value:"Credit Card"===(null===(t=l.activeMethod)||void 0===t?void 0:t.name),expression:"activeMethod?.name === 'Credit Card'"}],ref:"adyenscheme",staticClass:"adyen-payment w-full"}),l._v(" "),c("div",{directives:[{name:"show",rawName:"v-show",value:"AliPay"===(null===(e=l.activeMethod)||void 0===e?void 0:e.name),expression:"activeMethod?.name === 'AliPay'"}],ref:"adyenalipay",staticClass:"alipay-payment w-full"}),l._v(" "),c("div",{directives:[{name:"show",rawName:"v-show",value:"Google Pay"===(null===(o=l.activeMethod)||void 0===o?void 0:o.name),expression:"activeMethod?.name === 'Google Pay'"}],ref:"adyengooglepay",staticClass:"googlepay-payment w-full"}),l._v(" "),c("div",{directives:[{name:"show",rawName:"v-show",value:9!==(null===(r=l.activeMethod)||void 0===r?void 0:r.type),expression:"activeMethod?.type !== 9"}],staticClass:"other-payment flex items-center w-full"},[c("div",{staticClass:"other-payment-btn w-full",on:{click:function(t){var e;return l.purchaseGoodsFun(null===(e=l.activeMethod)||void 0===e?void 0:e.type)}}},[l._v("\n            "+l._s(l.btnLabel?l.$t(l.btnLabel):l.$t(l.btnTxt))+"\n          ")])])]):l._e()]),l._v(" "),l.$slots.default?c("div",{staticClass:"right"},[l._t("default")],2):l._e()]),l._v(" "),c("payment-check",{directives:[{name:"show",rawName:"v-show",value:"in-waiting"===l.inPaymentForm,expression:"inPaymentForm === 'in-waiting'"}],ref:"paymentCheck",attrs:{activeMethod:l.activeMethod,thirdOrderId:l.thirdOrderId},on:{success:l.paymentSuccess,paymentError:l.paymentError,back:l.handleBack}})],1)}),[],!1,null,"13ad23fc",null);e.a=component.exports},1381:function(t,e,n){t.exports={}},1382:function(t,e,n){t.exports={}},1383:function(t,e,n){t.exports={}},1384:function(t,e,n){t.exports={}},1385:function(t,e,n){t.exports={}},1411:function(t,e,n){t.exports={}},1412:function(t,e,n){t.exports={}},1413:function(t,e,n){t.exports={}},1415:function(t,e,n){t.exports={}},1416:function(t,e,n){t.exports={}},1417:function(t,e,n){t.exports={}},1418:function(t,e,n){t.exports={}},1419:function(t,e,n){t.exports={}},1420:function(t,e,n){t.exports={}},1421:function(t,e,n){t.exports={}},1422:function(t,e,n){t.exports={}},1423:function(t,e,n){t.exports={}},1424:function(t,e,n){t.exports={}},1425:function(t,e,n){t.exports={}},1426:function(t,e,n){t.exports={}},1427:function(t,e,n){t.exports={}},1428:function(t,e,n){t.exports={}},1429:function(t,e,n){t.exports={}},1430:function(t,e,n){t.exports={}},1431:function(t,e,n){t.exports={}},1432:function(t,e,n){t.exports={}},1433:function(t,e,n){t.exports={}},1434:function(t,e,n){t.exports={}},1435:function(t,e,n){t.exports={}},1436:function(t,e,n){t.exports={}},1437:function(t,e,n){t.exports={}},1520:function(t,e,n){t.exports={}},1521:function(t,e,n){t.exports={}},1522:function(t,e,n){t.exports={}},1523:function(t,e,n){t.exports={}},1524:function(t,e,n){t.exports={}},1525:function(t,e,n){t.exports={}},1526:function(t,e,n){t.exports={}},1527:function(t,e,n){t.exports={}},1528:function(t,e,n){t.exports={}},1529:function(t,e,n){t.exports={}},1530:function(t,e,n){t.exports={}},1535:function(t,e,n){t.exports={}},1536:function(t,e,n){t.exports={}},1537:function(t,e,n){t.exports={}},1538:function(t,e,n){t.exports={}},1540:function(t,e,n){t.exports={}},1541:function(t,e,n){t.exports={}},1542:function(t,e,n){t.exports={}},1543:function(t,e,n){t.exports={}},1544:function(t,e,n){t.exports={}},1545:function(t,e,n){t.exports={}},1546:function(t,e,n){t.exports={}},1547:function(t,e,n){t.exports={}},1550:function(t,e,n){t.exports={}},1551:function(t,e,n){t.exports={}},1552:function(t,e,n){t.exports={}},1553:function(t,e,n){t.exports={}},1554:function(t,e,n){t.exports={}},1555:function(t,e,n){t.exports={}},1556:function(t,e,n){t.exports={}},1564:function(t,e,n){t.exports={}},1565:function(t,e,n){t.exports={}},1566:function(t,e,n){t.exports={}},1567:function(t,e,n){t.exports={}},1568:function(t,e,n){t.exports={}},179:function(t,e,n){"use strict";var o={props:{title:{type:String,default:""}},data:function(){return{isOpen:!0,scrollHeight:0}},mounted:function(){this.updateScrollHeight()},computed:{getStyle:function(){return{maxHeight:this.isOpen?"".concat(this.scrollHeight+20,"px"):"0px",padding:this.isOpen?"10px 0":"0px",borderTop:this.isOpen?"1px solid rgba(255, 255, 255, 0.06)":"0"}}},methods:{handleClick:function(){this.isOpen=!this.isOpen,this.updateScrollHeight()},updateScrollHeight:function(){var t=this;this.$nextTick((function(){var e;t.scrollHeight=(null===(e=t.$refs.content)||void 0===e?void 0:e.scrollHeight)||0}))}}},r=(n(2351),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"collapse-components"},[e("div",{staticClass:"collapse-components-top",on:{click:t.handleClick}},[e("span",{staticClass:"collapse-components-top-title overflow-ellipsis"},[t._v(t._s(t.title))]),t._v(" "),e("i",{staticClass:"el-icon-arrow-down collapse-components-top-icon",class:{"is-open":t.isOpen}})]),t._v(" "),e("div",{ref:"content",staticClass:"collapse-components-content",style:t.getStyle},[t._t("default")],2)])}),[],!1,null,"052dcf82",null);e.a=component.exports},1816:function(t,e,n){t.exports={}},1817:function(t,e,n){t.exports={}},1818:function(t,e,n){t.exports={}},1819:function(t,e,n){t.exports={}},1820:function(t,e,n){t.exports={}},1821:function(t,e,n){t.exports={}},1822:function(t,e,n){t.exports={}},1823:function(t,e,n){t.exports={}},1824:function(t,e,n){t.exports={}},1825:function(t,e,n){t.exports={}},1826:function(t,e,n){t.exports={}},1827:function(t,e,n){t.exports={}},1828:function(t,e,n){t.exports={}},1831:function(t,e,n){t.exports={}},1832:function(t,e,n){t.exports={}},1833:function(t,e,n){t.exports={}},1834:function(t,e,n){t.exports={}},1835:function(t,e,n){t.exports={}},1836:function(t,e,n){t.exports={}},1889:function(t,e,n){"use strict";n.r(e);n(16),n(10),n(14);var o=n(15),r=n(2),l=n(3),c=(n(7),n(32),n(47),n(9),n(19),n(43),n(8),n(11),n(12),n(4),n(23),n(18),n(50),n(37),n(6),n(48),n(142),n(143),n(112),n(20),n(70),n(5)),d=n(1);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={name:"publishTopBar",data:function(){return{formatNumberForeign:c.i,logoUrl:n(124),vipIconUrl:n(319),coins:[{name:"credit",icon:n(279),type:"calculateCoins",desc:"new_credit_desc"},{name:"stamina",icon:n(280),type:"tempCoins",desc:"new_stamina_desc"}]}},computed:m(m(m(m({},Object(d.e)("payment",["paymentInfo","activeState","liteActiveState"])),Object(d.e)("user",["userInfo"])),Object(d.c)("user",["isLoggedIn"])),{},{isVip:function(){return this.activeState||this.liteActiveState},getCoinTitle:function(){var t=this;return function(e){return t.$t(e.type)+"："+t.$t("balance")+" "+(t.paymentInfo[e.type]||0)+", "+t.$t(e.desc)}}}),mounted:function(){},methods:{backPreview:function(){this.$emit("changePageType","workflow")},openLogin:function(){this.$EventBus.$emit("openLoginDialog")},toMall:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$logEvent("log_actions",{operation:"subscription_page_show",behavior_info:null!=t&&t.name?t.name:location.href}),window.open("".concat(location.origin,"/mall"),"_blank")},initials:function(t){return(t||"").split(" ").map((function(t){return t[0]})).join("")}}},f=v,_=(n(2347),n(0)),component=Object(_.a)(f,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-publish-top-bar"},[e("div",{staticClass:"publish-top-bar-title"},[e("div",{staticClass:"back-preview-btn",on:{click:function(e){return e.stopPropagation(),t.backPreview.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-back"})]),t._v(" "),e("div",{staticClass:"publish-top-bar-title-text"},[t._v(t._s(t.$t("workFlow21"))+"/"+t._s(t.$t("workFlow22")))])]),t._v(" "),t.isLoggedIn?e("div",{staticClass:"tavern-top-bar-info"},[e("div",{staticClass:"vip-info"},[t._l(t.coins,(function(n){return[e("div",{key:n.name,staticClass:"item-coin",class:n.name,attrs:{title:t.getCoinTitle(n)},on:{click:function(e){return t.toMall(n)}}},[e("img",{staticClass:"icon",attrs:{src:n.icon,alt:n.name}}),t._v(" "),e("div",{staticClass:"number"},[t._v("\n            "+t._s(t.formatNumberForeign(t.paymentInfo[n.type])||0)+"\n          ")])])]})),t._v(" "),e("img",{directives:[{name:"show",rawName:"v-show",value:t.isVip,expression:"isVip"}],staticClass:"vip-icon",attrs:{src:t.vipIconUrl,alt:"vip-icon"},on:{click:function(e){return e.stopPropagation(),t.toMall.apply(null,arguments)}}})],2),t._v(" "),e("div",{staticClass:"user-info"},[e("client-only",[e("div",{staticClass:"avatar",class:[t.userInfo.head?"":"avatar-color"]},[t.userInfo.head?e("img",{attrs:{src:t.userInfo.head,alt:"avatar"}}):e("div",[t._v("\n            "+t._s(t.initials(t.userInfo.name?t.userInfo.name:t.userInfo.id))+"\n          ")])])])],1)]):t._e(),t._v(" "),e("client-only",[t.isLoggedIn?t._e():e("div",{staticClass:"log-btn",on:{click:function(e){return e.stopPropagation(),t.openLogin()}}},[t._v(t._s(t.$t("Login")))])])],1)}),[],!1,null,"e0c9b618",null),y=component.exports,w=n(51),C={name:"effectExampleItem",props:{source:{type:Object,default:function(){return{}}}},computed:{getImageUrl:function(){var t,e,n,o=(null===(t=this.source)||void 0===t?void 0:t.url)||"";if([2,"2"].includes(null===(e=this.source)||void 0===e?void 0:e.type)&&null!==(n=this.source)&&void 0!==n&&n.url){o=this.source.url.replace(/\.(mp4)/g,"_low.webp")}return o}},data:function(){return{imageLoading:!1}},methods:{removeImage:function(){this.$emit("removeImage",this.source)},handleImageLoad:function(t){var e=0,n=0;try{e=t.target.naturalWidth,n=t.target.naturalHeight}catch(t){}this.$emit("updateInfo",{width:e,height:n})},handleImageLoadError:function(){this.imageLoading=!1}}},k=(n(2348),Object(_.a)(C,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"c-work-flow-effect-example-item"},[[null!==(t=e.source)&&void 0!==t&&t.url?n("img",{attrs:{src:e.getImageUrl,alt:""},on:{load:e.handleImageLoad,error:e.handleImageLoadError}}):e._e()],e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:!e.imageLoading,expression:"!imageLoading"}],staticClass:"el-image-viewer__close",on:{click:function(t){return t.stopPropagation(),e.removeImage.apply(null,arguments)}}},[n("i",{staticClass:"el-icon-close"})])],2)}),[],!1,null,"25f7b6fb",null)),x=k.exports,O=n(38),$=(n(28),n(126)),D={name:"exampleImgList",props:{iconBntWidth:{type:Number,default:36},moveLeng:{type:Number,default:140},sourceList:{type:Array,default:function(){return[]}}},data:function(){return{list:[],selectList:[],isShowLeft:!0,isShowRight:!0,savedScrollLeft:0,activeIndex:0}},mounted:function(){var t=this;this.selectList=[],window.addEventListener("resize",this.setMoveBtnShow),this.$refs.scrollArea.addEventListener("scroll",this.setMoveBtnShow),this.$once("hook:beforeDestroy",(function(){t.$refs.scrollArea.removeEventListener("scroll",t.setMoveBtnShow),window.removeEventListener("resize",t.setMoveBtnShow)}))},beforeDestroy:function(){this.loading=!1},updated:function(){var t=this;this.$nextTick((function(){t.setMoveBtnShow()}))},methods:{getList:function(){var t=this;this.loading=!0,Object($.k)({}).then((function(e){var n=((null==e?void 0:e.data)||{}).items,o=void 0===n?[]:n;t.list=o&&Array.isArray(o)?o:[]})).finally((function(){t.loading=!1}))},handleSelect:function(){this.activeIndex++;var t=this.activeIndex>this.sourceList.length?0:this.activeIndex;this.$emit("changeSelect",t)},clearSelect:function(){this.selectList=[],this.$emit("selectList",this.selectList)},setMoveBtnShow:function(){var t,e,n=this.$refs.scrollArea||{};n<=(null===(t=this.$refs.tags)||void 0===t?void 0:t.offsetWidth)&&(this.isShowRight=!1),0===n.scrollLeft?this.isShowLeft=!1:this.isShowLeft=!0,Math.ceil(n.scrollLeft)+n.clientWidth>=n.scrollWidth?this.isShowRight=!1:this.isShowRight=!0,this.savedScrollLeft=null===(e=this.$refs.scrollArea)||void 0===e?void 0:e.scrollLeft},tagsMove:function(t){this.$refs.scrollArea.scrollBy({left:t,behavior:"smooth"}),this.setMoveBtnShow()}}},S=(n(2349),Object(_.a)(D,(function(){var t=this,e=t._self._c;return e("div",{ref:"tags",staticClass:"c-example-img-list"},[e("div",{staticClass:"swipeab-icon-box swipeab-icon-box-left",style:{width:t.iconBntWidth+"px"}},[e("div",{staticClass:"icon-bnt",style:{width:t.iconBntWidth+"px",height:t.iconBntWidth+"px",marginTop:"-"+t.iconBntWidth/2+"px"},on:{click:function(e){return t.tagsMove("-"+t.moveLeng)}}},[e("i",{staticClass:"el-icon-arrow-left"})])]),t._v(" "),e("div",{ref:"scrollArea",staticClass:"scroll-area"},[e("div",{staticClass:"scroll-area-list"},t._l(t.sourceList,(function(n,o){return e("div",{key:o,staticClass:"tavern-tag-item",class:[t.activeIndex===o?"tavern-tag-item-active":""],on:{click:function(e){return e.stopPropagation(),t.handleSelect(n,o)}}},[e("img",{attrs:{src:n.url,alt:""}})])})),0)]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowRight,expression:"isShowRight"}],staticClass:"swipeab-icon-box swipeab-icon-box-right",style:{width:t.iconBntWidth+"px"}},[e("div",{staticClass:"icon-bnt",style:{width:t.iconBntWidth+"px",height:t.iconBntWidth+"px",marginTop:"-"+t.iconBntWidth/2+"px"},on:{click:function(e){return t.tagsMove(t.moveLeng)}}},[e("i",{staticClass:"el-icon-arrow-right"})])])])}),[],!1,null,"ecedd430",null).exports),I=n(64),T=n(114),j=n(96),L=n(208),P=n(501),M=n(281),E=n(282),A=n(45),N=n(13),R=n(81);function B(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function F(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?B(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var U={name:"workflowPublish",components:{publishTopBar:y,effectExampleItem:x,exampleImgList:S,SwipeableList:I.a,LoadingStatus:L.a,CodeViewer:P.a},mixins:[E.a],provide:function(){return{top:this}},data:function(){return{agree:!0,allowPublish:!0,allowPromotion:!0,activeImg:"",activeIndex:-1,tabList:[{name:"ComfyUi发布",i18nKey:"workFlow28",code:"publish"},{name:"封装为应用（可选）",i18nKey:"workFlow29",code:"package"}],currentPageType:"publish",exampleItemLimit:10,titleMaxlength:80,descMaxLength:3e3,formData:{name:"",desc:"",samples:[],categories:[]},rules:{name:[{required:!0,message:this.$t("comfyUpLoad4"),trigger:["change","blur"]}],samples:[{required:!0,message:this.$t("workFlow30"),trigger:["change","blur"]}],categories:[{required:!0,message:this.$t("comfyUpLoad7"),trigger:["change","blur"]}]},selectList:[],intRmdTag:[],loading:!1,langOptions:["zh_cn","zh_tw","ja","ar","ko","de","fr","ru","es","th","en","pt"],imageLoading:!1,UPLOAD:new O.a({type:2}),isPosting:!1,itemScroll:null,itemScrollLeft:null,loadingFormData:!1,isSubmitSuccess:!1,workflowConfig:{},workflowFormInfo:null,workflowInfo:null,isReady:!1,inputData:[],outputData:[],inputDataTemplate:{},selectInputData:[],selectOutputData:[],dragIndex:-1,work_flow_id:"",template_id:"",fromPage:"",showCustomTitle:!1,uploadingVideo:!1,isApp:0}},mounted:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.work_flow_id=t.$route.params.id,t.template_id=(null===(n=t.$route.query)||void 0===n?void 0:n.template_id)||"",t.resetFormData(),e.next=5,t.getWorkflowConfig();case 5:if(null===(o=t.$route)||void 0===o||null===(o=o.query)||void 0===o||!o.template_id){e.next=10;break}return e.next=8,t.getFullInfo(t.work_flow_id);case 8:e.next=12;break;case 10:return e.next=12,t.getWorkflowInfo();case 12:t.getTagList(),t.isReady=!0;case 14:case"end":return e.stop()}}),e)})))()},beforeDestroy:function(){this.fromPage="",this.isApp=0},computed:{acceptImage:function(){return this.enableUploadVideo?".jpg,.jpeg,.png,.webp,.gif":".jpg,.jpeg,.png,.webp"},enableUploadVideo:function(){var t;return null==this||null===(t=this.workflowConfig)||void 0===t?void 0:t.enable_video_cover},getDynamicHref:function(){return function(t){var e="Terms"===t,n=this.$i18n.locale?this.$i18n.locale:"en";return Object(T.a)(n,e,this.$isChinaSite)}},getInputDataConfig:function(){var t,e=this;return((null===(t=this.workflowInfo)||void 0===t?void 0:t.apply_input_param)||[]).reduce((function(pre,t){var n=t.options.map((function(n){var o=F({},n);return e.showCustomTitle&&!["",null,void 0].includes(null==t?void 0:t.title)?o.label="".concat(o.node_id,"-").concat(t.node_type," (").concat(t.title,") -").concat(n.field):o.label="".concat(o.node_id,"-").concat(t.node_type,"-").concat(n.field),o.nodeKey="".concat(t.node_type,"-").concat(n.field),o.node_type=t.node_type,o}));return pre.push.apply(pre,Object(o.a)(n)),pre}),[])},getCustomNodeTitle:function(){var t,e={};return((null===(t=this.workflowInfo)||void 0===t?void 0:t.apply_input_param)||[]).forEach((function(t){null!=t&&t.title&&(e[t.node_type]=t.title)})),e},getOutputDataConfig:function(){var t;return((null===(t=this.workflowInfo)||void 0===t?void 0:t.apply_output_param)||[]).map((function(t){var e=F({},t);return e.label="".concat(e.node_id,"-").concat(t.node_type),e}))},getInputDataList:function(){return(this.inputData||[]).map((function(t){var e=F({},t);return e.val="",e.option=F({values:[]},(null==t?void 0:t.option)||{}),e}))},isPackagePage:function(){return"package"===this.currentPageType},getImageUrl:function(){return function(t){var e=(null==t?void 0:t.url)||"";if([2,"2"].includes(null==t?void 0:t.type)&&null!=t&&t.url){e=t.url.replace(/\.(mp4)/g,"_low.webp")}return e}}},methods:{dragstart:function(t){this.dragIndex=t},dragenter:function(t,e){if(t.preventDefault(),this.dragIndex!==e){var n=this.inputData[this.dragIndex];this.inputData.splice(this.dragIndex,1),this.inputData.splice(e,0,n),this.dragIndex=e}},dragover:function(t,e){t.preventDefault()},getFullInfo:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n={};n.id=e,this.loadingFormData=!0,Object(j.i)(n).then((function(e){var n=(null==e?void 0:e.data)||{},o=n.desc,desc=void 0===o?"":o,r=n.name,l=void 0===r?"":r,c=n.samples,d=void 0===c?[]:c,h=n.categories,m=void 0===h?[]:h,v=n.ad,f=void 0===v?2:v,_=n.inputs,y=void 0===_?[]:_,w=n.outputs,C=void 0===w?[]:w,k=n.permission,x=void 0===k?{}:k,O=n.type;t.workflowInfo=Object.assign({},(null==e?void 0:e.data)||{}),t.formData.samples=d,t.formData.desc=(desc||"").replace(/<br\s*\/?>/gi,"\r\n"),t.formData.name=l,t.allowPromotion=1===f,t.formData.categories=(m||[]).map((function(t){return null==t?void 0:t.value})).filter((function(t){return!!t})),t.inputData=Array.isArray(y)?y:[],t.outputData=Array.isArray(C)?C:[],t.allowPublish=2===(null==x?void 0:x.primary),t.allowPromotion=1===(null==x?void 0:x.ad),t.isApp=[3,4,"3","4"].includes(O)})).finally((function(){t.loadingFormData=!1}))},changeVal:function(){},handleSelectInputFiled:function(source){if((this.selectInputData=[],source)&&(this.doLogEvent("click_input_node","","on_comfyui_encapsulation_page"),!(this.inputData||[]).find((function(t){return t.node_id===(null==source?void 0:source.node_id)&&t.node_type===(null==source?void 0:source.node_type)&&t.field===source.field})))){var t=[1,"1"].includes(source.type)?this.$t("pleaseEnte"):this.$t("Pls_select"),e={desc:"",field:source.field,node_id:null==source?void 0:source.node_id,node_type:source.node_type,title:"".concat(t).concat(source.field),type:source.type,value_type:source.value_type};this.inputData.push(e)}},handleSelectOutputFiled:function(t){if((this.selectOutputData=[],t)&&(this.doLogEvent("click_output_node","","on_comfyui_encapsulation_page"),!(this.outputData||[]).find((function(e){return e.node_id===(null==t?void 0:t.node_id)&&e.node_type===t.node_type})))){var e={node_id:t.node_id,node_type:t.node_type};this.outputData.push(e)}},getWorkflowInfo:function(){var t=this,e={};e.id=this.$route.params.id,this.loading=!0,Object(j.f)(e).then((function(e){var n,o,r=(null==e?void 0:e.data)||{},l=null==e||null===(n=e.data)||void 0===n?void 0:n.data;try{l=JSON.parse(l)}catch(t){}if(t.workflowInfo=F(F({},r),{},{data:l}),3===(null===(o=t.workflowInfo)||void 0===o?void 0:o.source))return t.getComfyUiInfo()})).finally((function(){t.loading=!1}))},doLogEvent:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={operation:t,behavior_info:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"on_comfyui_project_publish_page"};e&&(n.behavior_info_sub=e),this.$logEvent("log_actions",n)},handleChange:function(){this.doLogEvent("click_publish_to_community")},handlePromotionChange:function(){this.doLogEvent("click_allow_promotion","","on_comfyui_encapsulation_page")},getComfyUiInfo:function(){var t,e=this,n={};n.id=null===(t=this.workflowInfo)||void 0===t?void 0:t.source_id,this.loadingFormData=!0,Object(j.i)(n).then((function(t){var n=(null==t?void 0:t.data)||{},o=n.desc,desc=void 0===o?"":o,r=n.name,l=void 0===r?"":r,c=n.samples,d=void 0===c?[]:c,h=n.categories,m=void 0===h?[]:h,v=n.ad,f=void 0===v?2:v,_=n.inputs,y=void 0===_?[]:_,w=n.outputs,C=void 0===w?[]:w,k=n.permission,x=void 0===k?{}:k,O=n.type;e.formData.samples=d,e.formData.desc=(desc||"").replace(/<br\s*\/?>/gi,"\r\n"),e.formData.name=l,e.allowPublish=2===(null==x?void 0:x.primary),e.allowPromotion=1===f,e.inputData=Array.isArray(y)?y:[],e.outputData=Array.isArray(C)?C:[],e.formData.categories=(m||[]).map((function(t){return null==t?void 0:t.value})).filter((function(t){return!!t})),e.isApp=[3,4,"3","4"].includes(O)})).finally((function(){e.loadingFormData=!1}))},handleChangePageType:function(t){var e;if(this.fromPage&&[this.fromPage].includes("workflow")){var n="";[this.fromPage].includes("workflow")&&(n="click_back_to_work_page"),[this.fromPage].includes("workFlowDetail")&&(n="click_back_to_publish_template_page"),n&&this.doLogEvent(n,"","on_comfyui_encapsulation_page")}(null===(e=window)||void 0===e?void 0:e.history.length)>2?this.$router.back():this.$router.push(this.localePath("/"))},handleRemoveImage:function(t){var e=this.formData.samples.findIndex((function(e){return t.url&&e.url===(null==t?void 0:t.url)}));this.formData.samples.length&&this.formData.samples.splice(e,1)},carouselChange:function(t){this.activeIndex=t,this.changeScroll()},imgItemChange:function(t){this.$refs.imgCnt.setActiveItem(t),this.changeScroll()},getItemScrollLeft:function(){var t=this;this.$nextTick((function(){t.$refs.listItem&&t.$refs.listItem.forEach((function(e){var n;null!==(n=e.classList)&&void 0!==n&&n.contains("imgActivate")&&(t.itemScrollLeft=e.getBoundingClientRect().left)}))}))},changeScroll:function(){var t=this;this.$nextTick((function(){t.$refs.listItem.forEach((function(e,n){e.classList.contains("imgActivate")&&(t.itemScroll={value:e.getBoundingClientRect().left,index:n})}))}))},resetFormData:function(){this.isSubmitSuccess=!1,this.isApp=0},handleSelect:function(i){var t;this.activeImg=(null==this||null===(t=this.formData)||void 0===t?void 0:t.samples[i])||""},changeTag:function(){},filterMethod:function(){var t=this;this.$nextTick((function(){try{t.$refs.tagSelect.$el.querySelector(".el-select__input").setAttribute("maxlength",30)}catch(t){}}))},remoteMethod:function(t){var e=this;t&&Object(w.f)({prefix:t,except_num:20,source_type:3}).then((function(t){var n;1e4==t.status.code&&(e.selectList=[],null==t||null===(n=t.data)||void 0===n||n.items.forEach((function(t){e.selectList.push({title:t.title,id:t.title})})))}))},setIntRmdTag:function(t){var e,n=this;t&&(this.selectList=[].concat(Object(o.a)(this.intRmdTag),Object(o.a)(null===(e=this.formData)||void 0===e?void 0:e.categories.filter((function(t){return!n.intRmdTag.find((function(e){return e.title===t.title}))})))))},handleChangeTab:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=!0;"package"===t&&(this.doLogEvent("click_publish","","on_comfyui_encapsulation_tab"),this.$refs.infoForm.validate((function(t){e=t}))),e&&(this.agree?this.currentPageType=t:this.$message.warning(this.$t("PleaseTTOSAPP")))},getTagList:function(){var t=this;Object(R.a)({show_area:"workflow"}).then((function(e){var n=(null==e?void 0:e.data)||[];n.length&&n.forEach((function(e){return e.title=e[N.l[t.$i18n.locale]],e})),t.$set(t,"selectList",n)})).catch((function(t){console.log("err",t)}))},getWorkflowConfig:function(){var t=this;return Object(j.g)().then((function(e){t.workflowConfig=Object.assign(t.workflowConfig,e.data||{}),window.workflowConfig=t.workflowConfig})).catch((function(t){}))},handleImageUpload:function(t){var e=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.UPLOAD,r=["image/jpeg","image/png","image/jpg","image/webp"],l=["image/gif"].includes(t.type),!e.isPosting){n.next=5;break}return n.abrupt("return");case 5:if(e.enableUploadVideo&&r.push("image/gif"),r.includes(t.type)){n.next=9;break}return e.$message.error(e.$t("AllowImageFiles")),n.abrupt("return",!1);case 9:if(!(c=t)||c.size){n.next=12;break}return n.abrupt("return",!1);case 12:if(!(l&&c.size/1024/1024>5)){n.next=15;break}return e.$message.warning(e.$t("UploadImageExceedCustomMB",{number:5})),n.abrupt("return",!1);case 15:if(l||!(c.size/1024/1024>10)){n.next=26;break}return n.prev=16,n.next=19,Object(A.a)(c,10485760);case 19:c=n.sent,n.next=26;break;case 22:return n.prev=22,n.t0=n.catch(16),console.error("Compression failed:",n.t0),n.abrupt("return",!1);case 26:return n.next=28,e.checkImageSize(t);case 28:if(d=n.sent,e.base64RoleUrl=d.url||"",!e.imageLoading){n.next=32;break}return n.abrupt("return");case 32:return e.imageLoading=!0,o.startUpload(c,{category:20}).then((function(t){var n={width:d.width,height:d.height,type:3,url:t};e.formData.samples.length<e.exampleItemLimit&&e.formData.samples.push(n),e.imageLoading=!1})).catch((function(t){e.$message.error(e.$t("uploadError")),e.imageLoading=!1})),n.abrupt("return",!1);case 35:case"end":return n.stop()}}),n,null,[[16,22]])})))()},handleVideoUpload:function(t){var e=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,r,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.isPosting){n.next=2;break}return n.abrupt("return");case 2:if(e.uploadingVideo=!0,["video/mp4"].includes(t.type)){n.next=7;break}return e.uploadingVideo=!1,n.abrupt("return",e.$message.warning(e.$t("OnlySupportVideo")));case 7:if(o=t.size,!(o>5242880)){n.next=14;break}return e.$message.warning(e.$t("ExceedingNumberMB",{number:5})),e.uploadingVideo=!1,n.abrupt("return");case 14:return r=URL.createObjectURL(t),n.next=17,e.getVideoBasicInfo(r);case 17:return l=n.sent,URL.revokeObjectURL(r),e.handleUploadVideo(t,l),n.abrupt("return",!1);case 21:case"end":return n.stop()}}),n)})))()},handleUploadVideo:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};new M.a({file:t,category:20}).beforeUpload().then(function(){var t=Object(l.a)(regeneratorRuntime.mark((function t(o){var r,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=o.url,l={width:null==n?void 0:n.width,height:null==n?void 0:n.height,duration:Math.ceil((null==n?void 0:n.duration)||0),type:2,url:r},e.formData.samples.length<e.exampleItemLimit&&e.formData.samples.push(l),e.uploadingVideo=!1;case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.uploadingVideo=!1}))},checkImageSize:function(t){return new Promise((function(e,n){var o=new FileReader;o.onload=function(t){var img=new Image;img.onload=function(){var t={width:img.width,height:img.height,realWidth:img.naturalWidth,realHeight:img.naturalHeight};t.url=img.src,e(t)},img.onerror=function(){n(!1)},img.src=t.target.result},o.readAsDataURL(t)}))},handleConfirm:function(){var t,e,n=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.isApp&&"package"!==o)this.handleChangeTab("package");else if(!this.isPosting&&!this.isSubmitSuccess){"publish"===this.currentPageType&&this.doLogEvent("click_confirm_publish"),"package"===this.currentPageType&&this.doLogEvent("click_publish","","on_comfyui_encapsulation_page");var param={},r=!0;if(this.$refs.infoForm.validate((function(t){r=t})),r)if("package"!==this.currentPageType||this.outputData.length)if(this.agree){this.isPosting=!0,"package"===this.currentPageType&&(param.type="package"===this.currentPageType?2:1,param.inputs=this.inputData,param.outputs=this.outputData,param.ad=this.allowPromotion?1:2),param.id=this.workflowInfo.id,["",null,void 0].includes(this.template_id)&&(param.work_flow_id=this.work_flow_id),param.desc=(this.formData.desc||"").replace(/\n/g,"<br>"),param.name=this.formData.name,param.samples=this.formData.samples,param.publish=this.allowPublish?1:2,param.categories=this.formData.categories||[];var l,c=3!==(null===(t=this.workflowInfo)||void 0===t?void 0:t.source)&&["",null,void 0].includes(this.template_id)?j.k:j.l;if(3===(null===(e=this.workflowInfo)||void 0===e?void 0:e.source))param.id=null===(l=this.workflowInfo)||void 0===l?void 0:l.source_id;c(param).then((function(t){var e;1e4===(null==t||null===(e=t.status)||void 0===e?void 0:e.code)&&(n.isSubmitSuccess=!0,n.$message.success(n.$t("CreativeCenterPopup30")),n.$router.push(n.localePath({path:"/personal",query:{tab:"package"===n.currentPageType?"swtft_app":"workflow"}})))})).finally((function(){n.isPosting=!1}))}else this.$message.warning(this.$t("PleaseTTOSAPP"));else this.$message.warning(this.$t("workFlow42"))}},handlePackagePublish:function(){this.handleConfirm("package")},handleDeleteInputData:function(t,e){var n=this;this.$confirm(this.$t("workFlow41"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){-1!==e&&n.inputData.splice(e,1)}))},handleDeleteOutputData:function(t,e){var n=this;this.$confirm(this.$t("workFlow41"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){-1!==e&&n.outputData.splice(e,1)}))}},beforeRouteEnter:function(t,e,n){n((function(t){t.fromPage=(null==e?void 0:e.name)||""}))}},V=U,W=(n(2369),n(2370),Object(_.a)(V,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"p-workflow-publish"},[e.isReady?[n("publish-top-bar",{on:{changePageType:e.handleChangePageType}}),e._v(" "),n("div",{staticClass:"workflow-publish-container",class:[e.isPackagePage&&"workflow-publish-container-package"]},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingFormData,expression:"loadingFormData"}],staticClass:"workflow-publish-container-left",class:[e.isPackagePage&&"flex-771"]},[n("div",{staticClass:"publish-container-left-container",class:[e.isPackagePage&&"publish-container-left-container-package"]},[n("div",{staticClass:"page-type-tabs",class:[e.isPackagePage?"page-type-tabs-margin20":""]},[e._l(e.tabList,(function(t){return[n("div",{key:t.code,staticClass:"page-type-tabs-item",class:[e.currentPageType===t.code?"page-type-tabs-item-active":""],on:{click:function(n){return n.stopPropagation(),e.handleChangeTab(t.code)}}},[e._v("\n                "+e._s(e.$t(t.i18nKey)||t.name)+"\n              ")])]}))],2),e._v(" "),n("el-form",{directives:[{name:"show",rawName:"v-show",value:"publish"===e.currentPageType,expression:"currentPageType === 'publish'"}],ref:"infoForm",staticClass:"custom-form",attrs:{"label-position":"top",model:e.formData,rules:e.rules}},[n("el-form-item",{attrs:{label:e.$t("workFlow23"),prop:"name"}},[n("el-input",{staticClass:"title-input",attrs:{placeholder:e.$t("pleaseEnte"),"show-word-limit":"",maxlength:e.titleMaxlength},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("workFlow24"),prop:"desc"}},[n("el-input",{staticClass:"text-area-min-height",attrs:{placeholder:e.$t("pleaseEnte"),type:"textarea","show-word-limit":"",maxlength:e.descMaxLength},model:{value:e.formData.desc,callback:function(t){e.$set(e.formData,"desc",t)},expression:"formData.desc"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("workFlow25"),prop:"samples"}},[n("div",{staticClass:"effect-example-upload-box"},[null!==(t=e.formData)&&void 0!==t&&null!==(t=t.samples)&&void 0!==t&&t.length?e._l(e.formData.samples,(function(t,o){return n("effect-example-item",{key:o,attrs:{source:t},on:{removeImage:function(t){return e.handleRemoveImage(t,o)}}})})):e._e(),e._v(" "),e.formData.samples.length<10?n("div",{staticClass:"upload-item"},[n("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.imageLoading,expression:"imageLoading"}],key:"backgroundUpload",ref:"backgroundUpload",staticClass:"image-upload",attrs:{action:"#","before-upload":e.handleImageUpload,disabled:e.imageLoading,accept:e.acceptImage,"http-request":function(){},"show-file-list":!1}},[n("div",{staticClass:"image-upload-trigger",attrs:{slot:"trigger"},slot:"trigger"},[n("i",{staticClass:"iconfont icon-add-icon"}),e._v(" "),n("div",{staticClass:"upload-item-text"},[e._v(e._s(e.$t("UploadImg")))])])])],1):e._e(),e._v(" "),e.enableUploadVideo?[e.formData.samples.length<10?n("div",{staticClass:"upload-item"},[n("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.uploadingVideo,expression:"uploadingVideo"}],key:"videoUpload",ref:"videoUpload",staticClass:"image-upload",attrs:{action:"#","before-upload":e.handleVideoUpload,disabled:e.uploadingVideo,accept:"video/mp4","http-request":function(){},"show-file-list":!1}},[n("div",{staticClass:"image-upload-trigger",attrs:{slot:"trigger"},slot:"trigger"},[n("i",{staticClass:"iconfont icon-add-icon"}),e._v(" "),n("div",{staticClass:"upload-item-text"},[e._v(e._s(e.$t("selectingMaterialsType3")))])])])],1):e._e()]:e._e()],2)]),e._v(" "),n("el-form-item",{attrs:{label:e.$t("categoryTags"),prop:"categories"}},[n("el-select",{ref:"tagSelect",staticClass:"show-tag",staticStyle:{width:"100%"},attrs:{"value-key":"title",placeholder:e.$t("TagsAssociationTips"),multiple:"","multiple-limit":5,"popper-class":"show-tag-select",clearable:"",filterable:"","default-first-option":""},on:{change:e.changeTag},model:{value:e.formData.categories,callback:function(t){e.$set(e.formData,"categories",t)},expression:"formData.categories"}},e._l(e.selectList,(function(t,i){return n("el-option",{key:"tag_".concat(t.id+i),attrs:{label:t.title,value:t.id}})})),1)],1)],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isPackagePage,expression:"isPackagePage"}],staticClass:"package-config-form-desc"},[n("span",[e._v(e._s(e.$t("workFlow37")))]),e._v(" "),n("span",[n("el-checkbox",{model:{value:e.showCustomTitle,callback:function(t){e.showCustomTitle=t},expression:"showCustomTitle"}},[e._v(e._s(e.$t("workFlow50")))])],1)]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isPackagePage,expression:"isPackagePage"}],staticClass:"package-config-form"},[n("div",{staticClass:"package-config-form-input custom-form"},[n("el-select",{staticClass:"custom-select",attrs:{placeholder:e.$t("workFlow38"),"popper-class":"custom-select",filterable:"",clearable:""},on:{change:e.handleSelectInputFiled}},e._l(e.getInputDataConfig,(function(t,e){return n("el-option",{key:"".concat(t.nodeKey,"_").concat(e),attrs:{label:t.label,value:t}})})),1),e._v(" "),n("transition-group",{staticClass:"list",attrs:{name:"drag"}},[e._l(e.inputData,(function(t,o){return[n("div",{key:"input_filed_".concat(o),staticClass:"package-config-form-input-item",attrs:{draggable:!0},on:{dragenter:function(t){return e.dragenter(t,o)},dragover:function(t){return e.dragover(t,o)},dragstart:function(t){return e.dragstart(o)}}},[n("div",{staticClass:"package-config-form-input-item-label"},[n("span",{staticClass:"input-item-operate-btn iconfont icon-a-copylink"}),e._v(" "),e.showCustomTitle&&!["",null,void 0].includes(e.getCustomNodeTitle[null==t?void 0:t.node_type])?[n("div",{staticClass:"input-item-label-text"},[e._v("\n                          "+e._s("".concat(t.node_id,"-").concat(t.node_type," (").concat(e.getCustomNodeTitle[null==t?void 0:t.node_type],") -").concat(t.field))+"\n                        ")])]:n("div",{staticClass:"input-item-label-text"},[e._v("\n                        "+e._s("".concat(t.node_id,"-").concat(t.node_type,"-").concat(t.field))+"\n                      ")]),e._v(" "),n("span",{staticClass:"input-item-operate-btn el-icon-delete",on:{click:function(n){return n.stopPropagation(),e.handleDeleteInputData(t,o)}}})],2),e._v(" "),n("div",{staticClass:"package-config-form-input-item-title"},[n("el-input",{attrs:{placeholder:e.$t("pleaseEnte"),clearable:""},model:{value:t.title,callback:function(n){e.$set(t,"title",n)},expression:"item.title"}})],1)])]}))],2)],1),e._v(" "),n("div",{staticClass:"package-config-form-output custom-form"},[n("el-select",{staticClass:"custom-select",attrs:{placeholder:e.$t("workFlow39"),"popper-class":"custom-select"},on:{change:e.handleSelectOutputFiled}},e._l(e.getOutputDataConfig,(function(t,i){return n("el-option",{key:"".concat(t.node_type,"_").concat(i),attrs:{label:t.label,value:t}})})),1),e._v(" "),e._l(e.outputData,(function(t,o){return[n("div",{key:"output_filed_".concat(o),staticClass:"package-config-form-input-item"},[n("div",{staticClass:"package-config-form-input-item-label"},[n("span",{staticClass:"input-item-operate-btn iconfont icon-a-copylink"}),e._v(" "),n("div",{staticClass:"input-item-label-text"},[e._v("\n                      "+e._s("".concat(t.node_id,"-").concat(t.node_type))+"\n                    ")]),e._v(" "),n("span",{staticClass:"input-item-operate-btn el-icon-delete",on:{click:function(n){return n.stopPropagation(),e.handleDeleteOutputData(t,o)}}})])])]}))],2)])],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"publish"===e.currentPageType,expression:"currentPageType === 'publish'"}],staticClass:"bottom-btn-box"},[n("div",{staticClass:"bottom-checkbox-wrap"},[n("el-checkbox",{model:{value:e.agree,callback:function(t){e.agree=t},expression:"agree"}},[e._v(e._s(e.$t("workFlow26"))),n("a",{staticClass:"bottom-checkbox-title",attrs:{target:"“_blank”",href:e.getDynamicHref("Terms")}},[e._v(e._s(e.$t("comfyUpLoad3")))])]),e._v(" "),n("el-checkbox",{on:{change:e.handleChange},model:{value:e.allowPublish,callback:function(t){e.allowPublish=t},expression:"allowPublish"}},[e._v(e._s(e.$t("workFlow27")))])],1),e._v(" "),n("el-button",{staticClass:"publish-btn",attrs:{type:"primary",loading:e.isPosting,disabled:e.isPosting},on:{click:function(t){return e.handleConfirm()}}},[e._v(e._s(e.isApp?e.$t("NextStep"):e.$t("Publish"))+"\n          ")])],1)]),e._v(" "),n("div",{staticClass:"workflow-publish-container-right",class:[e.isPackagePage&&"flex-590"]},[n("div",{directives:[{name:"show",rawName:"v-show",value:"publish"===e.currentPageType,expression:"currentPageType === 'publish'"}],staticClass:"image-view-area",style:{width:"100%"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.formData.samples.length>1,expression:"formData.samples.length > 1"}],staticClass:"changeBtn leftBtn",on:{click:function(t){return e.$refs.imgCnt.prev()}}},[n("i",{staticClass:"el-icon-arrow-left"})]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.formData.samples.length>1,expression:"formData.samples.length > 1"}],staticClass:"changeBtn rightBtn",on:{click:function(t){return e.$refs.imgCnt.next()}}},[n("i",{staticClass:"el-icon-arrow-right"})]),e._v(" "),n("div",{staticClass:"imgInfo"},[n("el-carousel",{ref:"imgCnt",attrs:{autoplay:!1,arrow:"never","initial-index":e.activeIndex,"indicator-position":"none"},on:{change:function(t,n){return e.carouselChange(t)}}},e._l(e.formData.samples,(function(t,e){return n("el-carousel-item",{key:e},[[2,"2"].includes(null==t?void 0:t.type)?n("video",{staticClass:"img-info-video",style:{maxWidth:"100%",maxHeight:"100%"},attrs:{src:null==t?void 0:t.url,autoplay:"",loop:"",muted:"",controls:!1},domProps:{muted:!0}}):n("img",{attrs:{src:t.url||t.cover,alt:""}})])})),1)],1),e._v(" "),n("div",{staticClass:"imgList"},[n("swipeable-list",{attrs:{scrollLeftnum:e.itemScrollLeft,scrollChange:e.itemScroll,top:"0px",height:"100%",isShowIconBtn:!1}},e._l(e.formData.samples,(function(t,o){return n("div",{key:o,ref:"listItem",refInFor:!0,staticClass:"imgItem",class:{imgActivate:o===e.activeIndex},on:{click:function(t){return e.imgItemChange(o)}}},[n("img",{attrs:{src:e.getImageUrl(t),alt:""}})])})),0)],1)]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isPackagePage,expression:"isPackagePage"}],staticClass:"package-config-area"},[n("div",{staticClass:"package-config-area-header"},[e._v(e._s(e.$t("workFlow40")))]),e._v(" "),n("code-viewer",{attrs:{"code-view-data":e.getInputDataList}})],1)])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isPackagePage,expression:"isPackagePage"}],staticClass:"package-operate-bar"},[n("div",{staticClass:"package-operate-bar-left"},[n("div",{staticClass:"bottom-checkbox-wrap"},[n("p",{staticClass:"bottom-checkbox-wrap-text"},[e._v(e._s(e.$t("workFlow43")))]),e._v(" "),n("el-checkbox",{on:{change:e.handlePromotionChange},model:{value:e.allowPromotion,callback:function(t){e.allowPromotion=t},expression:"allowPromotion"}},[e._v(e._s(e.$t("workFlow44")))])],1)]),e._v(" "),n("div",{staticClass:"package-operate-bar-right"},[n("el-button",{staticClass:"publish-btn",attrs:{type:"primary",loading:e.isPosting,disabled:e.isPosting},on:{click:e.handlePackagePublish}},[e._v(e._s(e.$t("workFlow36"))+"\n        ")])],1)])]:n("LoadingStatus",{attrs:{bgColor:"#02050e"}})],2)}),[],!1,null,"64c8a01e",null));e.default=W.exports},209:function(t,e,n){"use strict";n(7),n(4),n(9),n(11),n(12),n(8);var o=n(2),r=(n(16),n(28),n(6),n(24)),l=n(40),c=n(1);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var h={name:"pickWorkModal",components:{WaterFallVue:n(554).a},props:{maxNum:{type:Number,default:1},type:{type:String,default:"default"}},data:function(){return{visible:!1,loading:!1,list:[],noMore:!1,queryParam:{keyword:"",page:1,page_size:60,time_to:0,after:0},debounceHandleScroll:null,scrollTop:0,selectList:[],debounceHandleSearch:null,checkType:""}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(c.e)("user",["userInfo"])),mounted:function(){this.debounceHandleScroll=Object(r.debounce)(this.handleScroll,200),this.debounceHandleSearch=Object(r.debounce)(this.handleSearch,600)},beforeDestroy:function(){this.debounceHandleScroll=null,this.debounceHandleSearch=null},methods:{openModal:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.resetData(),this.getList(),this.selectList=t||[],this.checkType=e||"",this.visible=!0},handleClose:function(){this.visible=!1},resetData:function(){this.list=[],this.loading=!1,this.queryParam={keyword:"",page:1,page_size:60,time_to:0,after:0},this.scrollTop=0,this.noMore=!1,this.selectList=[],this.checkType=""},handleCancel:function(){this.visible=!1},handleSearch:function(){this.loading=!1,this.queryParam.page=1,this.noMore=!1,this.queryParam.time_to=0,this.queryParam.after=0,this.scrollTop=0,this.list=[],this.getList()},handleScroll:function(){var t=this.$refs.handleWorkScroll;this.scrollTop=t.scrollTop||0;try{t&&t.scrollTop+t.clientHeight>=t.scrollHeight-50&&this.getList(!0)}catch(t){}},getList:function(t){var e=this;if(!this.loading&&!this.noMore){this.loading=!0;var n=l.artworkList;this.queryParam.order_by="new",this.queryParam.artwork_types=[1,3],"animGen"===this.type&&(this.queryParam.artwork_types=[1]),"workFlowAppDetail"===this.type&&(this.queryParam.artwork_types=[1,3,4]),this.queryParam.type="bookmarks",this.queryParam.category=2;var o=this.queryParam;return new Promise((function(r,l){n(o).then((function(n){if(1e4===n.status.code){e.noMore=!n.data.has_more,e.list=t?e.list.concat(n.data.items||[]):n.data.items||[],1===o.page&&n.data.time_ms&&(o.time_to=n.data.time_ms);try{var l;if(n.data.items.length>0)e.queryParam.after=null===(l=n.data.items[n.data.items.length-1])||void 0===l||null===(l=l.folder_no)||void 0===l?void 0:l.collect_at}catch(t){}o.page++,r()}})).catch((function(t){l(t)})).finally((function(){e.loading=!1}))}))}},getCheckList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.selectList=[],(e.url||[]).forEach((function(n,o){t.selectList.push({url:n,id:(null==e?void 0:e.ids[o])||"",type:"check",info:null==e?void 0:e.info[o]})}))},handleConfirm:function(){if(this.selectList.length){var t=0,e=0;try{t=this.selectList[0].info.banner.width,e=this.selectList[0].info.banner.height}catch(t){}var n={background:1024,character:768}[this.checkType]||0;if(n&&[t,e].some((function(t){return t<n})))return this.$message.warning(this.$t("tavern38",{number:n})),!1;this.$emit("confirm",{url:this.selectList[0].url,type:this.checkType,width:t,height:e,urls:this.selectList}),this.handleClose()}else this.$message.warning(this.$t("selectOneWork"))}}},m=h,v=(n(2356),n(0)),component=Object(v.a)(m,(function(){var t=this,e=t._self._c;return t.visible?e("el-dialog",{attrs:{visible:t.visible,"custom-class":"c-pick-work-modal","modal-append-to-body":!0,"append-to-body":!0,"close-on-click-modal":!1,"destroy-on-close":"",center:""},on:{"update:visible":function(e){t.visible=e}}},[e("div",{staticClass:"pick-work-modal-header"},[e("div",{staticClass:"pick-work-modal-header-item"},[e("span",{staticClass:"header-item-text"},[t._v(t._s(t.$t("personalFeed")))]),t._v(" "),e("span",{staticClass:"el-icon-info header-item-text-tip"}),t._v(" "),e("span",{staticClass:"header-item-desc-text"},[t._v(t._s(t.$t("modelWorkDesc")))]),t._v(" "),e("span",{staticClass:"header-item-desc-text",staticStyle:{"margin-left":"8px"}},[t._v("("+t._s(t.selectList.length)+"/"+t._s(t.maxNum)+")")])]),t._v(" "),e("div",{staticClass:"pick-work-modal-header-item"},[e("div",{staticClass:"header-item-btn",on:{click:function(e){return e.stopPropagation(),t.handleCancel.apply(null,arguments)}}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("div",{staticClass:"header-item-btn header-item-btn-gradient",on:{click:function(e){return e.stopPropagation(),t.handleConfirm.apply(null,arguments)}}},[t._v("\n        "+t._s(t.$t("Done"))+"\n      ")])])]),t._v(" "),e("div",{staticClass:"pick-work-modal-body"},[e("div",{staticClass:"search-box"},[e("el-input",{staticClass:"search-box__search-input",attrs:{placeholder:t.$t("Search"),clearable:""},on:{change:t.debounceHandleSearch},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.debounceHandleSearch.apply(null,arguments)}},model:{value:t.queryParam.keyword,callback:function(e){t.$set(t.queryParam,"keyword",e)},expression:"queryParam.keyword"}},[e("template",{slot:"suffix"},[e("i",{staticClass:"iconfont icon-search search-icon",on:{click:t.handleSearch}})])],2)],1),t._v(" "),e("div",{ref:"handleWorkScroll",staticClass:"handle-work-scroll-list",on:{scroll:t.debounceHandleScroll}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"wraper",staticClass:"wraper"},[e("WaterFallVue",{ref:"WaterFallVue",attrs:{type:"artwork",cols:5,container:"wraper",list:"animGen"==t.type?t.list.filter((function(t){return"sdxl"!=t.channel&&"studio"!=t.channel&&6!=t.type})):t.list,lazy:!0,dislikeShow:!0,isCheck:!0,checkMax:t.maxNum,alreadyNoMoreData:t.noMore,scrollContainerClassName:"handle-work-scroll-list",scrollContentTop:t.scrollTop,selectList:t.selectList},on:{load:function(e){return t.getList(!0)},getChecList:t.getCheckList}})],1)])])]):t._e()}),[],!1,null,null,null);e.a=component.exports},210:function(t,e,n){"use strict";n(16),n(10),n(36),n(14),n(18),n(9),n(11),n(12);var o=n(15),r=n(2),l=(n(7),n(32),n(19),n(43),n(8),n(4),n(274),n(6),n(41)),c=n(21),d=n(1),h=n(5),m=n(24),v=n(22),f=n(56),_=n(33),y=n(82),w=n(135),C=n(64),k=n(13),x=n(81),O=n(269),$=void 0;function D(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function S(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?D(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var I={name:"workflowStyleModal",mixins:[_.a],components:{CollectPopover:f.a,modelPayNum:y.a,changeVer:w.a,SwipeableList:C.a,LenovoInput:O.a},props:{selectList:{type:Array,default:function(){return[]}},placeholder:{type:String,default:function(){return null==$?void 0:$.$t("TaskStylePlaceHolder")}},isPaintingBoard:{type:Boolean,default:!1},isSDXL:{type:Boolean,default:!1},SDXLmodel:{type:Array,default:function(){return null}},SDmodel:{type:Array,default:function(){return null}},inTask:{type:Boolean,default:!0}},data:function(){return{visible:!1,activeTab:"mine",timeName:"All",timeTypeOption:[{name:"All",startTime:null,endTime:null},{name:"days",startTime:this.getTimestamps().startTimestamp,endTime:this.getTimestamps().endTimestamp},{name:"week",startTime:this.getWeekTimeRange().startTimestamp,endTime:this.getWeekTimeRange().endTimestamp},{name:"months",startTime:this.getMonthTimestampRange().startTimestamp,endTime:this.getMonthTimestampRange().endTimestamp}],tagIndex:"hot",typeOption:[{name:"Hot",id:"hot",icon:"hot"},{name:"New",id:"new",icon:"new1"}],tabList:[{label:"我的",type:"mine",id:"mine",order:1,i18nKey:"Mine"}],queryOptionsList:[{label:"综合推荐",value:"comprehensive",order:1,i18nKey:"styleModal1"},{label:"最近使用",value:"recent",order:2,i18nKey:"recentlyUsed"},{label:"我的收藏",value:"collect",order:3,i18nKey:"MyCollection"},{label:"我的模型",value:"bookmarks_choose",order:4,i18nKey:"MyModel"},{label:"更多推荐",value:"recommend",order:5,i18nKey:"FindGoodPictures"}],queryParam:{order_by:"hot",keyword:"",created:"",model_type:"LORA"},list:[],hotRecentUsedList:[],loading:!1,noMore:!1,pageInfo:{page:1,limit:60,total:0},debounceHandleScroll:null,gridNum:5,modalWidth:"1340px",debounceResize:null,showType:"",modelOption:[],itemScroll:null,modelType:"LORA",comfyUiNode:null,queryType:"comprehensive",baseModelSelect:[],modelTypes:["Checkpoint","LoRA"],tabShowTagEmpty:!1,showTagEmpty:!1,keyWordCopy:""}},computed:S(S(S({},Object(d.e)("user",["collectData","cdnHost","token"])),{},{showEmptyResult:function(){var t=!this.loading,e=!this.renderList.length&&!this.hotRecentUsedList.length,n="mine"===this.activeTab&&!["comprehensive"].includes(this.queryType);return t&&e&&n},lang:function(){return this.$i18n.locale},renderBaseModels:function(){},getTitle:function(){var t={Checkpoint:"Checkpoint",LORA:"LoRA",TextualInversion:this.$t("embedding1")}[this.modelType]||this.modelType;return"".concat(this.$t("selectModels"),"(").concat(t,")")},getModels:function(){var t=k.B.sd,e=k.B.sd3,n=k.B.sd35,r=k.B.sdxl,l=k.B.flux,c=[].concat(Object(o.a)(t),Object(o.a)(e),Object(o.a)(n),Object(o.a)(r),Object(o.a)(l));return{sd:this.SDmodel||t,sd35:n,sd3:e,sdxl:this.SDXLmodel||r,allBaseModels:c}},getBaseModel:function(){var t=this.getModels.allBaseModels;return[].concat(Object(o.a)(t),Object(o.a)(k.B.other))},showRecommendText:function(){return!this.loading&&this.hotUsedList.length&&"mine"===this.activeTab&&"comprehensive"===this.queryType},isNoRecentUsed:function(){return!this.loading&&!this.renderList.length&&"recent"===this.queryType&&this.showRecommendText},nsfwUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20230401/62f66fbd-bc27-44f6-b744-5c5d7e5b18ee.webp")},activeTabClass:function(){return function(t){return t&&t===this.activeTab?"tab-active":""}}},Object(d.c)(["isSupportWebp"])),{},{getImageUrl:function(){return function(t){var e="";return t.banner&&!["",null,void 0].includes(t.banner.url)?e=Object(h.x)(t.banner.url,this.$imgL):e}},activeSelectModel:function(){return function(t){return this.selectList.find((function(e){return(t.id||t.model_id)===(e.id||e.model_id)}))?"select-model-active":""}},renderList:function(){return this.list},hotUsedList:function(){return this.hotRecentUsedList},convertTabText:function(){return function(t){var e="LORA"===this.modelType?"MyStyle":"MyModel";return t.title?t.title:"bookmarks_choose"===t.type?this.$t(e):this.$t(t.i18nKey)}}}),beforeDestroy:function(){this.debounceHandleScroll=null},watch:{hotRecentUsedList:{handler:function(t){for(var i=0;i<this.hotRecentUsedList.length;i++)for(var e=0;e<this.selectList.length;e++)if(this.selectList[e].id===this.hotRecentUsedList[i].id&&this.selectList[e].art_model_ver_no_name&&this.hotRecentUsedList[i].version_name){this.hotRecentUsedList[i].version_name=this.selectList[e].art_model_ver_no_name,this.hotRecentUsedList[i].banner.url=this.selectList[e].model_cover;break}}},list:{handler:function(t){for(var i=0;i<this.list.length;i++)for(var e=0;e<this.selectList.length;e++)if(this.selectList[e].id===this.list[i].id&&this.selectList[e].art_model_ver_no_name&&this.list[i].version_name){this.list[i].version_name=this.selectList[e].art_model_ver_no_name,this.list[i].banner.url=this.selectList[e].model_cover;break}}}},mounted:function(){var t=this;this.debounceHandleScroll=Object(m.debounce)(this.handleScroll,600),this.debounceResize=Object(m.debounce)(this.handleResize,500),window.addEventListener("resize",this.debounceResize),this.$nextTick((function(){t.handleResize()}))},methods:{onFilter:function(t,e){var n=this;this.loading||(this.baseModelSelect.includes(t)?this.baseModelSelect.forEach((function(e,o){e==t&&n.baseModelSelect.splice(o,1)})):this.baseModelSelect.push(t),"recommend"===this.queryType&&(this.tagIndex="hot"),this.checkGetList())},onFilterReset:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loading||(this.$logEvent("log_actions",{operation:"click_choose_model_type",behavior_info:"on_choose_model_popup",behavior_info_sub:"comfy-ui"}),this.baseModelSelect=[],t||this.checkGetList())},changeQueryType:function(){this.list=[],this.hotRecentUsedList=[],this.pageInfo={page:1,limit:60,total:0},this.tagIndex="hot",this.timeName="All",this.queryParam={order_by:"hot",keyword:"",created:"",model_type:this.modelType||"LORA"},this.checkGetList(),this.$logEvent("log_actions",{operation:"click_comprehensive_recommendation_tab",behavior_info:"on_choose_model_popup",behavior_info_sub:"comfy-ui"})},checkGetList:function(){"comprehensive"!==this.queryType?"recent"===this.queryType?this.handleGetRecentUsed():this.handleSearch():this.handleGetComList()},handleGetComList:function(){var t=this;this.pageInfo.page=1,this.loading=!0,this.noMore=!1,Reflect.deleteProperty(this.queryParam,"time_to");var e={};return e.base_models=this.baseModelSelect.length?this.baseModelSelect:this.getBaseModel,e.model_type=this.modelType||"LORA",this.loading=!0,Object(v.i)(e).then((function(e){var n=e||{},o=n.status.code,code=void 0===o?"":o,r=n.data,data=void 0===r?{}:r;if([1e4,"10000"].includes(code)){var l=Array.isArray(null==data?void 0:data.hot_used_items)?data.hot_used_items:[],c=Array.isArray(null==data?void 0:data.items)?data.items:[];t.noMore=!0;var d={},h=(c||[]).map((function(t){return t.art_model||{}})).reduce((function(t,e){return d[e.id]||(d[e.id]=!0,t.push(e)),t}),[]).filter((function(e){return e.type===t.modelType})).map((function(e){var n=(e.banner||{}).nsfw;[1,"1"].includes(void 0===n?0:n)&&(e.banner=Object.assign(e.banner||{},{url:t.nsfwUrl}));var o=t.findSelectItem(e);return o&&(e=Object.assign(e,o)),e}));t.list=h.length<=10?h:h.slice(0,10),t.hotRecentUsedList=(l||[]).map((function(t){return t.art_model||{}})).reduce((function(t,e){return d[e.id]||(d[e.id]=!0,t.push(e)),t}),[]).filter((function(e){return e.type===t.modelType})).map((function(e){var n,o=(e.banner||{}).nsfw;[1,"1"].includes(void 0===o?0:o)&&(e.banner=Object.assign((null===(n=e)||void 0===n?void 0:n.banner)||{},{url:t.nsfwUrl}));var r=t.findSelectItem(e);return r&&(e=Object.assign(e,r)),e}))}return t.noDataView(),t.list})).finally((function(){t.loading=!1}))},setIcon:function(){var t=this,e="homeIcon1";return this.typeOption.forEach((function(n){t.tagIndex==n.id&&(e=n.icon)})),e},handleCommand:function(t){this.tagIndex=t,this.queryParam.order_by=this.tagIndex,this.handleSearch()},handleTimeCommand:function(t){this.timeName=t.name,this.queryParam.start_at=t.startTime,this.queryParam.end_at=t.endTime,this.handleSearch()},getTimestamps:function(){var t=new Date;return{startTimestamp:t-864e5,endTimestamp:t.getTime()}},getWeekTimeRange:function(){var t=new Date;return{startTimestamp:t-6048e5,endTimestamp:t.getTime()}},getMonthTimestampRange:function(){var t=new Date;t.getFullYear(),t.getMonth();return{startTimestamp:t-2592e6,endTimestamp:t.getTime()}},changeScroll:function(){var t=this;this.$refs.listItem.forEach((function(e,n){e.classList.contains("tab-active")&&(t.itemScroll={value:e.getBoundingClientRect().left,index:n})}))},getTag:function(){var t=this;Object(x.a)({show_area:"model"}).then((function(e){if(1e4===e.status.code){var n=e.data||[];n.length&&n.forEach((function(e){e.title=e[k.l[t.$i18n.locale]]})),t.tabList=[].concat(Object(o.a)(t.tabList),Object(o.a)(n))}}))},collectionBar:function(){var t=this;Object(c.B)({type:2}).then((function(e){1e4===e.status.code&&(t.modelOption=[{label:t.$t("All"),value:""}],e.data.items.forEach((function(e){t.modelOption.push({label:e.name,value:e.id})})))}))},changeType:function(t){this.list=[],this.pageInfo={page:1,limit:60,total:0},this.handleSearch()},handleResize:function(){try{window.innerWidth>1400?(this.modalWidth="1340px",this.gridNum=5):(this.modalWidth="1071px",this.gridNum=4)}catch(t){}},selectItem:function(t,e,n){var o,r;(e.model_ver_no=t.model_ver_id,e.version_name=t.version_no,e.base_model=t.base_model_name,e.modelTags=Array.isArray(null==t?void 0:t.tags)?null==t?void 0:t.tags:[],null!==(o=t.sample)&&void 0!==o&&null!==(o=o.banner)&&void 0!==o&&o.url)?e.banner.url=null===(r=t.sample)||void 0===r||null===(r=r.banner)||void 0===r?void 0:r.url:e.banner.url="";n&&this.$emit("selectModel",e)},openModal:function(t){var e=this,n=t.modelType,o=void 0===n?"LORA":n,r=t.node,l=void 0===r?null:r,c=t.pickWidget,d=void 0===c?null:c;if(this.resetData(),this.comfyUiNode=l,this.modelType=o,this.pickWidget=d,this.token&&this.collectionBar(),this.queryParam.model_type=this.modelType||"",this.tabList=[{label:"我的",type:"mine",id:"mine",order:1,i18nKey:"Mine"}],this.activeTab="mine",this.queryType="comprehensive",this.getTag(),!this.token)return this.getList(),void(this.visible=!0);this.$nextTick((function(){e.getRecentUsedModel().finally((function(){e.loading=!1,e.list.length&&e.list.length>=10?(e.activeTab="mine",e.queryType="recent"):(e.activeTab="mine",e.queryType="comprehensive",e.hotRecentUsedList=[],e.checkGetList())})),e.visible=!0}))},handleClose:function(){this.visible=!1,this.resetData()},resetData:function(){this.pageInfo={page:1,limit:60,total:0},this.tagIndex="hot",this.timeName="All",this.queryParam={order_by:"hot",keyword:"",created:"",model_type:this.modelType||"LORA"},this.list=[],this.activeTab="mine",this.queryType="comprehensive",this.loading=!1,this.noMore=!1,this.modelType="LORA"},handleViewMore:function(){this.activeTab="",this.handleTabClick("mine","recommend")},handleTabClick:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t===this.activeTab||this.loading||(this.activeTab=t,this.queryType="mine"===t?n||"comprehensive":"recommend",this.$nextTick((function(){e.changeScroll()})),this.list=[],this.hotRecentUsedList=[],this.pageInfo={page:1,limit:60,total:0},this.tagIndex="hot",this.timeName="All",this.queryParam={order_by:"hot",keyword:"",created:"",model_type:this.modelType||"LORA"},this.checkGetList(),this.$logEvent("log_actions",{operation:"click_choose_model_tab",behavior_info:"on_choose_model_popup",behavior_info_sub:"comfy-ui"}))},screenAll:function(){this.activeTab="mine",this.baseModelSelect=[],this.modelTypeSelect=[],this.queryParam.order_by="hot",this.queryParam.created="",this.queryParam.start_at=void 0,this.queryParam.end_at=void 0,this.$logEvent("log_actions",{operation:"click_search",behavior_info:"on_choose_model_popup",behavior_info_sub:"comfy-ui"}),this.handleSearch()},handleSearch:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.pageInfo.page=1,this.loading=!1,this.noMore=!1,this.list=[],this.hotRecentUsedList=[],Reflect.deleteProperty(this.queryParam,"time_to"),"recent"===this.queryType&&(this.queryType="recommend"),"comprehensive"===this.queryType&&(this.queryType="recommend"),this.getList(),"dot"===t&&this.$logEvent("log_actions",{operation:"click_choose_model_tab",behavior_info:"on_choose_model_popup",behavior_info_sub:"comfy-ui"})},handleScroll:function(){var t=this.$refs.scrollWrapper;try{t&&t.scrollTop+t.clientHeight>=t.scrollHeight-30&&"recent"!==this.queryType&&this.getList(!0)}catch(t){}},getList:function(t){var e=this;if(!this.loading&&!this.noMore){this.loading=!0;var n={collect:"bookmarks",recommend:"community",bookmarks_choose:"bookmarks_choose"}[JSON.parse(JSON.stringify(this.queryType))]||"",o={page:this.pageInfo.page,page_size:this.pageInfo.limit,type:n};if(this.inTask&&(o.refer="task"),"bookmarks"===o.type){var r=0;o.folder_no=this.showType;try{var c,d=this.list.length?this.list[this.list.length-1]:null;r=(null==d||null===(c=d.collect)||void 0===c?void 0:c.collect_at)||0,o.after=1===o.page?0:r}catch(t){}}["recent","collect","bookmarks","bookmarks_choose","recommend","comprehensive","mine"].includes(this.activeTab)||(o.tags=[this.activeTab],o.type="community"),o.base_models=this.baseModelSelect.length?this.baseModelSelect:this.getBaseModel,Object.assign(o,this.queryParam),(""!==this.queryParam.keyword&&"recommend"===this.queryType?l.o:l.r)(o).then((function(n){var o=n||{},r=o.status,l=void 0===r?{}:r,c=o.data,data=void 0===c?{}:c,d=l.code;if([1e4,"10000"].includes(void 0===d?"":d)){if(e.noMore=!data.has_more,t){var h=e.list.map((function(t){return t.id})),m=(n.data.items||[]).filter((function(t){return!h.includes(t.id)})).map((function(t){var n=(t.banner||{}).nsfw;[1,"1"].includes(void 0===n?0:n)&&(t.banner=Object.assign(t.banner||{},{url:e.nsfwUrl}));var o=e.findSelectItem(t);return o&&(t=Object.assign(t,o)),t}));e.list=e.list.concat(m)}else e.list=(n.data.items||[]).map((function(t){var n=(t.banner||{}).nsfw;[1,"1"].includes(void 0===n?0:n)&&(t.banner=Object.assign(t.banner||{},{url:e.nsfwUrl}));var o=e.findSelectItem(t);return o&&(t=Object.assign(t,o)),t}));1===e.pageInfo.page&&(e.queryParam.time_to=n.data.time_ms),e.pageInfo.page++,e.loading=!1,e.keyWordCopy=e.queryParam.keyword,e.noDataView()}})).catch((function(t){console.log(t)})).finally((function(){e.loading=!1}))}},noDataView:function(){var t=!this.loading,e=!this.list.length,n="mine"!==this.activeTab,o=""===this.queryParam.keyword,r=t&&e&&n&&o,l=t&&e&&n&&!o;this.tabShowTagEmpty=r,this.showTagEmpty=l},findSelectItem:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.activeSelectModel(t)){var e=this.selectList.find((function(e){return(t.id||t.model_id)===(e.id||e.model_id)}));return t=e||t}return null},handleSelect:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(["cltpop","use"].includes(null===(t=(arguments.length>2?arguments[2]:void 0).target)||void 0===t?void 0:t.className)){if(n)return void this.$message.warning(this.$t("CannotSelectedRepeatedly"));this.$emit("selectModel",{info:e,node:this.comfyUiNode,modelType:this.modelType,pickWidget:this.pickWidget}),this.handleClose()}},handleGetRecentUsed:function(){this.pageInfo.page=1,this.loading=!0,this.noMore=!1,Reflect.deleteProperty(this.queryParam,"time_to"),this.getRecentUsedModel()},getRecentUsedModel:function(){var t=this,e={};return e.base_models=this.baseModelSelect.length?this.baseModelSelect:this.getBaseModel,this.loading=!0,Object(v.l)(e).then((function(e){console.log(e);var n=e||{},o=n.status.code,code=void 0===o?"":o,r=n.data,data=void 0===r?{}:r;if([1e4,"10000"].includes(code)){var l=Array.isArray(data.items)?data.items:[],c={};t.list=(l||[]).map((function(t){return t.art_model||{}})).reduce((function(t,e){return c[e.id]||(c[e.id]=!0,t.push(e)),t}),[]).filter((function(e){return e.type===t.modelType&&"f8172af6747ec762bcf847bd60fdf7cd"!==(null==e?void 0:e.id)})).map((function(e){var n=(e.banner||{}).nsfw;[1,"1"].includes(void 0===n?0:n)&&(e.banner=Object.assign(e.banner||{},{url:t.nsfwUrl}));var o=t.findSelectItem(e);return o&&(e=Object.assign(e,o)),e}))}return t.noDataView(),t.list})).finally((function(){t.loading=!1}))},handleDetail:function(t){(null==t?void 0:t.id)&&window.open("/models/detail/".concat(t.id))},convertModelFlag:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.getModels.sdxl,n=(this.getModels.sd,this.getModels.sd3),o=(null===k.B||void 0===k.B?void 0:k.B.flux)||[],r=(t.type,t.base_model),l=void 0===r?"":r,c=e.includes(l)||(l||"").includes("SDXL"),d=n.includes(l);return o.includes(l)?"Flux":d?"SD3":c?"SDXL":""}}},T=I,j=(n(2360),n(2361),n(0)),component=Object(j.a)(T,(function(){var t,e,n=this,o=n._self._c;return o("el-dialog",{ref:"styleModal",attrs:{title:n.getTitle,visible:n.visible,width:n.modalWidth,height:"auto","custom-class":"c-workflow-style-modal","modal-append-to-body":!0,"append-to-body":!0,"close-on-click-modal":!1,"destroy-on-close":!0,center:""},on:{"update:visible":function(t){n.visible=t},close:function(t){return n.onFilterReset(!0)}}},[o("div",{staticClass:"style-content-wrapper"},[o("div",{staticClass:"style-content__header"},[o("swipeable-list",{attrs:{scrollChange:n.itemScroll,top:"15px"}},[o("div",{staticClass:"style-content__header-tabs"},n._l(n.tabList,(function(t,e){return o("div",{key:"tab_".concat(null==t?void 0:t.id,"_").concat(e)},[o("div",{ref:"listItem",refInFor:!0,staticClass:"style-content__header-tabs-item",class:[n.activeTabClass(t.id)],on:{click:function(e){return e.stopPropagation(),n.handleTabClick(t.id)}}},[n._v("\n                  "+n._s(n.convertTabText(t))+"\n                ")])])})),0)])],1),n._v(" "),o("div",{staticClass:"style-content__search-box"},[o("div",[n._e(),n._v(" "),o("LenovoInput",{attrs:{width:404,screen:{activeTab:n.activeTab,baseModelSelect:n.baseModelSelect.length?n.baseModelSelect:n.getBaseModel,modelType:n.modelType},isLoca:"creative",clearable:"",placeholder:"LORA"===n.modelType?n.$t("TaskStylePlaceHolder"):n.$t("TaskModelPlaceHolder")},on:{onScreen:function(t){return n.handleSearch("dot")},clear:function(t){return n.handleSearch("dot")}},model:{value:n.queryParam.keyword,callback:function(t){n.$set(n.queryParam,"keyword",t)},expression:"queryParam.keyword"}}),n._v(" "),o("span",{staticClass:"style-content__search-btn style-content__search-btn-gra-border",on:{click:function(){return""!=n.queryParam.keyword&&n.handleSearch("dot")}}},[o("span",[n._v(n._s(n.$t("Search")))])])],1),n._v(" "),o("div",{staticClass:"search-right"},[o("el-popover",{attrs:{placement:"bottom","popper-class":"homeFilter",trigger:"hover"}},[o("div",{staticClass:"filterCnt"},[o("div",{staticClass:"filterTit",staticStyle:{"margin-top":"16px"}},[n._v(n._s(n.$t("BaseModel")))]),n._v(" "),o("div",{staticClass:"filterList"},n._l(n.getBaseModel,(function(t,e){return o("div",{key:e,staticClass:"filterItem",class:{AfilterItem:n.baseModelSelect.includes(t)},on:{click:function(e){return n.onFilter(t,2)}}},[n.baseModelSelect.includes(t)?o("i",{staticClass:"el-icon-check"}):n._e(),n._v(" "),o("span",[n._v(n._s("TextualInversion"===t?n.$t("embedding1"):t))])])})),0),n._v(" "),o("div",{staticClass:"filterReset graBorder",on:{click:function(t){return n.onFilterReset(!1)}}},[n._v("\n                "+n._s(n.$t("resetSelection"))+"\n              ")])]),n._v(" "),o("el-badge",{staticClass:"item",attrs:{slot:"reference",value:null===(t=n.baseModelSelect)||void 0===t?void 0:t.length,hidden:0==(null===(e=n.baseModelSelect)||void 0===e?void 0:e.length)},slot:"reference"},[o("div",{staticClass:"filterBox"},[o("div",[o("i",{staticClass:"iconfont icon-a-filterIcon"}),n._v(" "),o("span",[n._v(n._s(n.$t("Filter")))])]),n._v(" "),o("i",{staticClass:"el-icon-arrow-down"})])])],1),n._v(" "),"mine"===n.activeTab&&"collect"===n.queryType&&n.modelOption.length>0?o("el-select",{staticClass:"showType custom-select",class:n.$i18n.locale,attrs:{"popper-class":"custom-select"},on:{change:n.changeType},model:{value:n.showType,callback:function(t){n.showType=t},expression:"showType"}},n._l(n.modelOption,(function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1):n._e(),n._v(" "),"mine"===n.activeTab?o("el-select",{staticClass:"showType custom-select",class:n.$i18n.locale,attrs:{"popper-class":"custom-select"},on:{change:n.changeQueryType},model:{value:n.queryType,callback:function(t){n.queryType=t},expression:"queryType"}},n._l(n.queryOptionsList,(function(t){return o("el-option",{key:t.value,attrs:{label:n.$t(t.i18nKey),value:t.value}})})),1):n._e(),n._v(" "),["recent","collect","bookmarks","bookmarks_choose","recommend","mine"].includes(n.activeTab)?n._e():o("div",{staticClass:"Screening"},[o("el-dropdown",{attrs:{trigger:"hover"},on:{command:n.handleTimeCommand}},[o("div",{staticClass:"el-dropdown-link selectTime"},[o("div",[o("i",{staticClass:"el-icon-time"}),n._v(" "),o("span",[n._v(n._s(n.$t(n.timeName)))])]),n._v(" "),o("i",{staticClass:"el-icon-arrow-down"})]),n._v(" "),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},n._l(n.timeTypeOption,(function(t,e){return o("el-dropdown-item",{key:e,attrs:{command:t}},[o("div",{staticClass:"el-dropdown-item el-dropdown-item-time"},[o("span",[n._v(n._s(n.$t(t.name)))])])])})),1)],1),n._v(" "),o("el-dropdown",{attrs:{trigger:"hover"},on:{command:n.handleCommand}},[o("div",{staticClass:"el-dropdown-link"},[o("div",[o("i",{staticClass:"iconfont custom-iconfont",class:"icon-".concat(n.setIcon())}),n._v(" "),o("span",[n._v(n._s(n.$t(n.tagIndex.charAt(0).toUpperCase()+n.tagIndex.slice(1))))])]),n._v(" "),o("i",{staticClass:"el-icon-arrow-down"})]),n._v(" "),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},n._l(n.typeOption,(function(t,e){return o("el-dropdown-item",{key:e,attrs:{command:t.id}},[o("div",{staticClass:"el-dropdown-item"},[o("i",{staticClass:"iconfont custom-iconfont",class:"icon-".concat(t.icon)}),n._v(" "),o("span",[n._v(n._s(n.$t(t.name)))])])])})),1)],1)],1)],1)]),n._v(" "),o("div",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],ref:"scrollWrapper",staticClass:"style-content__list-wrapper",class:[n.isNoRecentUsed?"style-content__list-wrapper-no-margin":""],style:{gridTemplateColumns:"repeat(".concat(n.gridNum,", 1fr)")},on:{scroll:n.handleScroll}},[n.renderList.length?n._l(n.renderList,(function(t){var e;return o("div",{key:t.id,staticClass:"style-content__list-item",class:[n.activeSelectModel(t)],on:{click:function(e){return e.stopPropagation(),function(e){return n.handleSelect(t,n.activeSelectModel(t),e)}.apply(null,arguments)}}},[o("div",{staticClass:"top-box"},[t.is_agency_fee?o("div",{staticClass:"payNum"},[o("modelPayNum",{attrs:{number:t.agency_fee}})],1):n._e()]),n._v(" "),o("div",{staticClass:"cltpop"},[o("div",{staticClass:"collect-popover-container"},[o("CollectPopover",{attrs:{type:"model",folder:t,from:"waterfall"}})],1),n._v(" "),o("div",{staticClass:"detail-button",on:{click:function(e){return e.stopPropagation(),n.handleDetail(t)}}},[n._v("\n                "+n._s(n.$t("Details"))+"\n              ")])]),n._v(" "),o("div",{staticClass:"list-item-image-wrapper"},[["",null,void 0].includes(null==t||null===(e=t.banner)||void 0===e?void 0:e.url)?o("div",{staticClass:"list-item-image-card-image"},[o("div",{staticClass:"image-empty"},[n._v(n._s(n.$t("EmptyBannerText")))])]):o("el-image",{staticClass:"list-item-image-card-image",attrs:{src:n.getImageUrl(t)}},[o("template",{slot:"error"},[o("img",{directives:[{name:"webp",rawName:"v-webp",value:n.$imgL,expression:"$imgL"}],staticClass:"list-item-image-card-image",attrs:{src:t&&t.banner?t.banner.url:"",alt:""}})])],2)],1),n._v(" "),o("div",{staticClass:"list-item-image-mask"},[o("div",{staticClass:"list-item-image-mask-row"},[o("span",{staticClass:"list-item-image-mask-item__content",attrs:{title:t.name}},[n._v(n._s(t.name))])]),n._v(" "),o("div",{staticClass:"list-item-image-mask-row"},[o("changeVer",{attrs:{from:"styleModal",item:t,base_models:n.getBaseModel},on:{selectItem:function(e){return n.selectItem(e,t,n.activeSelectModel(t))}}}),n._v(" "),o("div",{staticClass:"use",on:{click:function(e){return e.stopPropagation(),function(e){return n.handleSelect(t,n.activeSelectModel(t),e)}.apply(null,arguments)}}},[n._v(n._s(n.$t("workFlow46")))])],1)]),n._v(" "),"Pony"===(null==t?void 0:t.base_model)?[o("span",{staticClass:"model-type-flag"},[n._v("\n                "+n._s(n.modelType)),o("span",{staticClass:"model-type-flag-line"},[n._v("|")]),n._v(" "),o("i",{staticClass:"iconfont icon-icon-horse model-type-flag-icon"})])]:[o("span",{directives:[{name:"show",rawName:"v-show",value:""!==n.convertModelFlag(t),expression:"convertModelFlag(item) !==''"}],staticClass:"model-type-flag"},[n._v(n._s(n.convertModelFlag(t)))])]],2)})):n._e(),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.showRecommendText,expression:"showRecommendText"}],staticClass:"recommend-text",style:{gridColumn:"span ".concat(n.gridNum)}},[o("div",{staticClass:"recommend-text-line"}),n._v(" "),o("div",{staticClass:"recommend-text-main"},[n._v(n._s(n.$t("styleModalLineText")))]),n._v(" "),o("div",{staticClass:"recommend-text-line"})]),n._v(" "),!n.loading&&n.hotUsedList.length&&"mine"===n.activeTab&&["comprehensive"].includes(n.queryType)?[n._l(n.hotUsedList,(function(t){var e;return o("div",{key:"hot_".concat(t.id),staticClass:"style-content__list-item",class:[n.activeSelectModel(t)],on:{click:function(e){return e.stopPropagation(),function(e){return n.handleSelect(t,n.activeSelectModel(t),e)}.apply(null,arguments)}}},[o("div",{staticClass:"top-box"},[t.is_agency_fee?o("div",{staticClass:"payNum",attrs:{num:""}},[o("modelPayNum",{attrs:{number:t.agency_fee}})],1):n._e()]),n._v(" "),o("div",{staticClass:"cltpop"},[o("div",{staticClass:"collect-popover-container"},[o("CollectPopover",{attrs:{type:"model",folder:t,from:"waterfall"}})],1),n._v(" "),o("div",{staticClass:"detail-button",on:{click:function(e){return e.stopPropagation(),n.handleDetail(t)}}},[n._v("\n                "+n._s(n.$t("Details"))+"\n              ")])]),n._v(" "),o("div",{staticClass:"list-item-image-wrapper"},[["",null,void 0].includes(null==t||null===(e=t.banner)||void 0===e?void 0:e.url)?o("div",{staticClass:"list-item-image-card-image"},[o("div",{staticClass:"image-empty"},[n._v(n._s(n.$t("EmptyBannerText")))])]):o("el-image",{staticClass:"list-item-image-card-image",attrs:{src:n.getImageUrl(t)}},[o("template",{slot:"error"},[o("img",{directives:[{name:"webp",rawName:"v-webp",value:n.$imgL,expression:"$imgL"}],staticClass:"list-item-image-card-image",attrs:{src:t&&t.banner?t.banner.url:"",alt:""}})])],2),n._v(" "),o("div",{staticClass:"list-item-image-mask"},[o("div",{staticClass:"list-item-image-mask-row"},[o("span",{staticClass:"list-item-image-mask-item__content",attrs:{title:t.name}},[n._v(n._s(t.name))])]),n._v(" "),o("div",{staticClass:"list-item-image-mask-row"},[o("changeVer",{attrs:{item:t,base_models:n.getBaseModel},on:{selectItem:function(e){return n.selectItem(e,t,n.activeSelectModel(t))}}}),n._v(" "),o("div",{staticClass:"use",on:{click:function(e){return e.stopPropagation(),function(e){return n.handleSelect(t,n.activeSelectModel(t),e)}.apply(null,arguments)}}},[n._v(n._s(n.$t("workFlow46")))])],1)])],1),n._v(" "),"Pony"===(null==t?void 0:t.base_model)?[o("span",{staticClass:"model-type-flag"},[n._v("\n                "+n._s(n.modelType)),o("span",{staticClass:"model-type-flag-line"},[n._v("|")]),n._v(" "),o("i",{staticClass:"iconfont icon-icon-horse model-type-flag-icon"})])]:[o("span",{directives:[{name:"show",rawName:"v-show",value:""!==n.convertModelFlag(t),expression:"convertModelFlag(item) !==''"}],staticClass:"model-type-flag"},[n._v(n._s(n.convertModelFlag(t)))])]],2)})),n._v(" "),o("div",{staticClass:"show-more-item",style:{gridColumn:"span ".concat(n.gridNum)}},[o("span",{staticClass:"show-more-item-btn",on:{click:function(t){return t.stopPropagation(),n.handleViewMore()}}},[o("span",{staticClass:"show-more-item-btn-text"},[n._v(n._s(n.$t("viewMore")))]),n._v(" "),o("i",{staticClass:"iconfont icon-icon-direction-down show-more-item-btn-icon"})])])]:n._e(),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.showEmptyResult,expression:"showEmptyResult"}],staticClass:"style-content__list-empty"},[o("svg-icon",{staticClass:"style-content__list-empty-icon",attrs:{"icon-class":"style-empty-icon"}}),n._v(" "),"LORA"===n.modelType&&"mine"===n.activeTab&&["recent"].includes(n.queryType)&&["",null,void 0].includes(n.queryParam.keyword)?[n._v("\n            "+n._s(n.$t("styleRecent"))+"\n          ")]:"LORA"===n.modelType&&["collect"].includes(n.queryType)&&"mine"===n.activeTab&&["",null,void 0].includes(n.queryParam.keyword)?[n._v("\n            "+n._s(n.$t("styleCollect"))+"\n          ")]:[n._v(n._s(n.$t("NoResultsFound")))]],2),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.showTagEmpty,expression:"showTagEmpty"}],staticClass:"tag-empty-box flex_c_m"},[o("div",{staticClass:"item flex_c"},[o("p",[n._v(n._s(n.$t("screenTagNodata",{keyword:n.keyWordCopy?' "'.concat(n.keyWordCopy,'" '):""})))]),n._v(" "),o("div",{staticClass:"btn",on:{click:n.screenAll}},[n._v(n._s(n.$t("screenAll")))])])]),n._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:n.tabShowTagEmpty,expression:"tabShowTagEmpty"}],staticClass:"style-content__list-empty"},[o("svg-icon",{staticClass:"style-content__list-empty-icon",attrs:{"icon-class":"style-empty-icon"}}),n._v(" "),o("p",[n._v(n._s(n.$t("NoResultsFound")))])],1)],2)])])}),[],!1,null,"595c985f",null);e.a=component.exports},2106:function(t,e,n){t.exports={}},2107:function(t,e,n){t.exports={}},2334:function(t,e,n){"use strict";n(1001)},2335:function(t,e,n){"use strict";n(1002)},2336:function(t,e,n){"use strict";n(1003)},2342:function(t,e,n){"use strict";n(1009)},2343:function(t,e,n){"use strict";n(1010)},2345:function(t,e,n){"use strict";n(1012)},2346:function(t,e,n){"use strict";n(1013)},2347:function(t,e,n){"use strict";n(1014)},2348:function(t,e,n){"use strict";n(1015)},2349:function(t,e,n){"use strict";n(1016)},2351:function(t,e,n){"use strict";n(1018)},2352:function(t,e,n){"use strict";n(1019)},2356:function(t,e,n){"use strict";n(1023)},2357:function(t,e,n){"use strict";n(1024)},2360:function(t,e,n){"use strict";n(1027)},2361:function(t,e,n){"use strict";n(1028)},2362:function(t,e,n){"use strict";n(1029)},2363:function(t,e,n){"use strict";n(1030)},2364:function(t,e,n){"use strict";n(1031)},2365:function(t,e,n){"use strict";n(1032)},2366:function(t,e,n){"use strict";n(1033)},2367:function(t,e,n){"use strict";n(1034)},2368:function(t,e,n){"use strict";n(1035)},2369:function(t,e,n){"use strict";n(1036)},2370:function(t,e,n){"use strict";n(1037)},2371:function(t,e,n){"use strict";n(1038)},2373:function(t,e,n){"use strict";n(1039)},2374:function(t,e,n){"use strict";n(1040)},2375:function(t,e,n){"use strict";n(1041)},2389:function(t,e,n){"use strict";n(1055)},2390:function(t,e,n){"use strict";n(1056)},2391:function(t,e,n){"use strict";n(1057)},2392:function(t,e,n){"use strict";n(1058)},2393:function(t,e,n){"use strict";n(1059)},2394:function(t,e,n){"use strict";n(1060)},2395:function(t,e,n){"use strict";n(1061)},2419:function(t,e,n){"use strict";n(1086)},2422:function(t,e,n){"use strict";n(1089)},2423:function(t,e,n){"use strict";n(1090)},2424:function(t,e,n){"use strict";n(1092)},2425:function(t,e,n){"use strict";n(1093)},2428:function(t,e,n){"use strict";n(1096)},2429:function(t,e,n){"use strict";n(1097)},2430:function(t,e,n){"use strict";n(1098)},2431:function(t,e,n){"use strict";n(1099)},2432:function(t,e,n){"use strict";n(1100)},2433:function(t,e,n){"use strict";n(1101)},2434:function(t,e,n){"use strict";n(1102)},2449:function(t,e,n){"use strict";n(1117)},2450:function(t,e,n){"use strict";n(1118)},2451:function(t,e,n){"use strict";n(1119)},2452:function(t,e,n){"use strict";n(1120)},2454:function(t,e,n){"use strict";n(1122)},2455:function(t,e,n){"use strict";n(1123)},2456:function(t,e,n){"use strict";n(1124)},2457:function(t,e,n){"use strict";n(1125)},2458:function(t,e,n){"use strict";n(1126)},2459:function(t,e,n){"use strict";n(1127)},2460:function(t,e,n){"use strict";n(1128)},2461:function(t,e,n){"use strict";n(1129)},2462:function(t,e,n){"use strict";n(1130)},2463:function(t,e,n){"use strict";n(1131)},2464:function(t,e,n){"use strict";n(1132)},2465:function(t,e,n){"use strict";n(1133)},2467:function(t,e,n){"use strict";n(1134)},2468:function(t,e,n){"use strict";n(1135)},2469:function(t,e,n){"use strict";n(1136)},2470:function(t,e,n){"use strict";n(1137)},2471:function(t,e,n){"use strict";n(1138)},2472:function(t,e,n){"use strict";n(1139)},2473:function(t,e,n){"use strict";n(1140)},2474:function(t,e,n){"use strict";n(1141)},2475:function(t,e,n){"use strict";n(1142)},2476:function(t,e,n){"use strict";n(1143)},2478:function(t,e,n){"use strict";n(1144)},2479:function(t,e,n){"use strict";n(1145)},2507:function(t,e,n){"use strict";n(1172)},2508:function(t,e,n){"use strict";n(1173)},2509:function(t,e,n){"use strict";n(1174)},2511:function(t,e,n){"use strict";n(1177)},2512:function(t,e,n){"use strict";n(1178)},2513:function(t,e,n){"use strict";n(1179)},2519:function(t,e,n){"use strict";n(1184)},2520:function(t,e,n){"use strict";n(1185)},2521:function(t,e,n){"use strict";n(1186)},2523:function(t,e,n){"use strict";n(1188)},2524:function(t,e,n){"use strict";n(1189)},2525:function(t,e,n){"use strict";n(1190)},2526:function(t,e,n){"use strict";n(1191)},2550:function(t,e,n){"use strict";n(1213)},2551:function(t,e,n){"use strict";n(1214)},2552:function(t,e,n){"use strict";n(1215)},2553:function(t,e,n){"use strict";n(1216)},266:function(t,e,n){"use strict";n(14),n(71);var o=n(390),r=n(5),l={props:{existObj:{type:Object,default:function(){return{name:"",url:"",open:!1}}}},data:function(){return{handleInitHelp:o.a,modelExistDialog:!1}},methods:{copyLink:function(){var text=this.existObj.url;text&&Object(r.d)(text),this.$message.success(this.$t("CopySuccess"))},claimModel:function(){var t="https://aihelp.net/questionnaire/#/?formId=78dea50f5cbb426cb136748154c029aa";this.$i18n.locale.startsWith("zh")&&(t="https://aihelp.net/questionnaire/#/?formId=bffe7a2307454e859f559913e28d4f19"),window.open(t,"_blank")}}},c=n(0),component=Object(c.a)(l,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticStyle:{"margin-top":"25vh !important"},attrs:{title:t.$t("Tip"),visible:t.modelExistDialog,width:"500px","modal-append-to-body":!1,"close-on-click-modal":!1,"append-to-body":!0,"custom-class":"SaDialog"},on:{"update:visible":function(e){t.modelExistDialog=e}}},[e("div",{staticClass:"flex justify-between flex-wrap",staticStyle:{margin:"20px 0"}},[e("div",{staticClass:"left",staticStyle:{"margin-top":"15px","word-break":"break-word"}},[e("i",{staticClass:"el-icon-warning",staticStyle:{color:"#f19c5c","margin-right":"15px",transform:"scale(1.5)"}}),t._v("\n        "+t._s(t.$t("newUpload_Model_1"))+"，"),t.existObj.url&&t.existObj.open?e("span",[t._v(t._s(t.$t("Upload_Model_2"))),e("a",{staticStyle:{color:"#e5af5d",cursor:"pointer"},attrs:{href:t.existObj.url,target:"_blank"}},[t._v(t._s(t.existObj.name)+"，")])]):t._e(),t._v("\n        "+t._s(t.$t("Upload_Model_3"))+" "),e("span",{staticStyle:{color:"#e5af5d",cursor:"pointer"},on:{click:function(e){return e.preventDefault(),t.handleInitHelp()}}},[t._v(t._s(t.$t("Contact_customer")))])]),t._v(" "),t.existObj.url&&t.existObj.open?e("div",{staticStyle:{color:"#4784FF",cursor:"pointer","margin-top":"15px"},on:{click:t.copyLink}},[e("i",{staticClass:"iconfont icon-link",staticStyle:{"margin-right":"5px"}}),t._v("\n        "+t._s(t.$t("CopyLink"))+"\n      ")]):t._e()]),t._v(" "),e("div",{staticClass:"bntitem",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.modelExistDialog=!1}}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("el-button",{on:{click:t.claimModel}},[t._v(t._s(t.$t("ClaimModel")))])],1)])}),[],!1,null,"6092af0e",null);e.a=component.exports},2661:function(t,e,n){"use strict";n(1319)},2662:function(t,e,n){"use strict";n(1320)},2663:function(t,e,n){"use strict";n(1321)},2667:function(t,e,n){"use strict";n(1325)},2668:function(t,e,n){"use strict";n(1326)},2669:function(t,e,n){"use strict";n(1327)},2670:function(t,e,n){"use strict";n(1328)},2671:function(t,e,n){"use strict";n(1329)},2674:function(t,e,n){"use strict";n(1332)},2675:function(t,e,n){"use strict";n(1333)},2676:function(t,e,n){"use strict";n(1334)},2725:function(t,e,n){"use strict";n(1381)},2726:function(t,e,n){"use strict";n(1382)},2727:function(t,e,n){"use strict";n(1383)},2728:function(t,e,n){"use strict";n(1384)},2729:function(t,e,n){"use strict";n(1385)},2755:function(t,e,n){"use strict";n(1411)},2756:function(t,e,n){"use strict";n(1412)},2757:function(t,e,n){"use strict";n(1413)},2759:function(t,e,n){"use strict";n(1415)},2761:function(t,e,n){"use strict";n(1416)},2762:function(t,e,n){"use strict";n(1417)},2763:function(t,e,n){"use strict";n(1418)},2764:function(t,e,n){"use strict";n(1419)},2765:function(t,e,n){"use strict";n(1420)},2766:function(t,e,n){"use strict";n(1421)},2767:function(t,e,n){"use strict";n(1422)},2768:function(t,e,n){"use strict";n(1423)},2769:function(t,e,n){"use strict";n(1424)},2770:function(t,e,n){"use strict";n(1425)},2773:function(t,e,n){"use strict";n(1426)},2774:function(t,e,n){"use strict";n(1427)},2775:function(t,e,n){"use strict";n(1428)},2776:function(t,e,n){"use strict";n(1429)},2777:function(t,e,n){"use strict";n(1430)},2778:function(t,e,n){"use strict";n(1431)},2779:function(t,e,n){"use strict";n(1432)},2780:function(t,e,n){"use strict";n(1433)},2781:function(t,e,n){"use strict";n(1434)},2782:function(t,e,n){"use strict";n(1435)},2783:function(t,e,n){"use strict";n(1436)},2784:function(t,e,n){"use strict";n(1437)},2870:function(t,e,n){"use strict";n(1520)},2871:function(t,e,n){"use strict";n(1521)},2872:function(t,e,n){"use strict";n(1522)},2873:function(t,e,n){"use strict";n(1523)},2874:function(t,e,n){"use strict";n(1524)},2875:function(t,e,n){"use strict";n(1525)},2876:function(t,e,n){"use strict";n(1526)},2877:function(t,e,n){"use strict";n(1527)},2878:function(t,e,n){"use strict";n(1528)},2879:function(t,e,n){"use strict";n(1529)},2880:function(t,e,n){"use strict";n(1530)},2885:function(t,e,n){"use strict";n(1535)},2886:function(t,e,n){"use strict";n(1536)},2887:function(t,e,n){"use strict";n(1537)},2888:function(t,e,n){"use strict";n(1538)},2890:function(t,e,n){"use strict";n(1540)},2891:function(t,e,n){"use strict";n(1541)},2892:function(t,e,n){"use strict";n(1542)},2893:function(t,e,n){"use strict";n(1543)},2894:function(t,e,n){"use strict";n(1544)},2895:function(t,e,n){"use strict";n(1545)},2896:function(t,e,n){"use strict";n(1546)},2897:function(t,e,n){"use strict";n(1547)},2900:function(t,e,n){"use strict";n(1550)},2901:function(t,e,n){"use strict";n(1551)},2902:function(t,e,n){"use strict";n(1552)},2903:function(t,e,n){"use strict";n(1553)},2904:function(t,e,n){"use strict";n(1554)},2905:function(t,e,n){"use strict";n(1555)},2906:function(t,e,n){"use strict";n(1556)},2912:function(t,e,n){"use strict";n(1564)},2913:function(t,e,n){"use strict";n(1565)},2914:function(t,e,n){"use strict";n(1566)},2915:function(t,e,n){"use strict";n(1567)},2916:function(t,e,n){"use strict";n(1568)},3179:function(t,e,n){"use strict";n(1816)},3180:function(t,e,n){"use strict";n(1817)},3181:function(t,e,n){"use strict";n(1818)},3182:function(t,e,n){"use strict";n(1819)},3183:function(t,e,n){"use strict";n(1820)},3184:function(t,e,n){"use strict";n(1821)},3185:function(t,e,n){"use strict";n(1822)},3186:function(t,e,n){"use strict";n(1823)},3187:function(t,e,n){"use strict";n(1824)},3188:function(t,e,n){"use strict";n(1825)},3189:function(t,e,n){"use strict";n(1826)},3190:function(t,e,n){"use strict";n(1827)},3191:function(t,e,n){"use strict";n(1828)},3194:function(t,e,n){"use strict";n(1831)},3195:function(t,e,n){"use strict";n(1832)},3196:function(t,e,n){"use strict";n(1833)},3197:function(t,e,n){"use strict";n(1834)},3198:function(t,e,n){"use strict";n(1835)},3199:function(t,e,n){"use strict";n(1836)},3244:function(t,e,n){"use strict";n.r(e);n(9),n(11),n(12);var o=n(31),r=n(2),l=(n(16),n(7),n(10),n(19),n(8),n(4),n(18),n(6),n(48),n(29),n(1)),c={data:function(){return{modeType:"poster",modeList:[{label:this.$t("generateCanvas"),value:"generate"},{label:this.$t("realtimeCanvas"),value:"live"},{label:this.$t("designCanvas"),value:"poster"}]}},methods:{changeModeType:function(t){this.modeType=t;["generate","live"].includes(t)&&this.$router.push(this.localePath({path:"/editBoard"}))},backPage:function(){this.$router.back()}}},d=(n(2755),n(0)),h=Object(d.a)(c,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"left-action-box flex_m"},[e("div",{staticClass:"back-btn flex_c_m",on:{click:t.backPage}},[e("i",{staticClass:"iconfont icon-back"})]),t._v(" "),e("el-select",{staticClass:"custom-select-transparent my-el-select",attrs:{value:t.modeType,"popper-class":"painting-board-select select-canvas my-el-option"},on:{change:t.changeModeType}},t._l(t.modeList,(function(t){return e("el-option",{key:t.value,attrs:{value:t.value,label:t.label}})})),1)],1)}),[],!1,null,"23f7a602",null).exports,m={inject:["top"],data:function(){return{imgUrl:""}},methods:{showFontList:function(){this.top.baseData.leftMenu.showDrawer||(this.top.baseData.leftMenu.showDrawer=!0),this.top.baseData.leftMenu.actMenu="fontSizeList"},setTypefaceUrl:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(1===t.length){var e=Object(o.a)(t,1)[0];this.imgUrl=e.fontStyle.familyImg}t.length>1&&(this.imgUrl="")}}},v=m,f=(n(2756),Object(d.a)(v,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"font-select-box flex_m",on:{click:t.showFontList}},[e("div",{staticClass:"img-item flex_m"},[e("img",{directives:[{name:"show",rawName:"v-show",value:t.imgUrl,expression:"imgUrl"}],attrs:{src:t.imgUrl}}),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:!t.imgUrl,expression:"!imgUrl"}]},[t._v(t._s(t.$t("typeface")))])]),t._v(" "),t._m(0)])}),[function(){var t=this._self._c;return t("div",{staticClass:"icon-item flex_c_m"},[t("i",{staticClass:"el-icon-arrow-down"})])}],!1,null,"0a30013b",null).exports),_=n(15),y=n(52),w={inject:["top"],data:function(){return{num:12}},methods:{getIds:function(t){var e=this.top.getActiveLayer().map((function(t){return t.layerId}));e.length&&t&&t(e)},changeSize:function(t){var e=this;this.num=t,this.getIds((function(n){var o={fontStyle:{size:t}};e.top.setIdItem(n,o),e.$nextTick((function(){var t=n.map((function(t){return document.querySelector("#layer-".concat(t))}));y.a.emit("$E_updateLayerRect",t),e.top.setPosterInfoFn()}))}))},setLayerFontSize:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((function(t){return t.fontStyle.size})),e=Math.max.apply(Math,Object(_.a)(t));this.num=e||12}}},C=w,k=(n(2757),Object(d.a)(C,(function(){var t=this,e=t._self._c;return e("div",[e("el-input-number",{staticClass:"my-input-number",attrs:{value:t.num,size:"mini",min:12,max:1e3,step:2,precision:0},on:{change:t.changeSize}})],1)}),[],!1,null,"557c35d8",null).exports),x=(n(14),n(1414),n(44),n(676)),O=n.n(x),$=n(2758),D=(n(28),{props:{list:{type:Array,default:function(){return[]}},inx:{type:Number,default:0}},data:function(){return{}},computed:{item:function(){return this.list[this.inx]}},methods:{handleToo:function(){var t=this.list,e=this.inx;++e>t.length-1&&(e=0),this.$emit("onToggle",e)}}}),S=(n(2759),Object(d.a)(D,(function(){var t=this,e=t._self._c;return e("div",{on:{click:t.handleToo}},[e("i",{class:["iconfont","icon-item",t.item.icon],style:{fontSize:t.item.size+"px"}})])}),[],!1,null,"5b8ee168",null).exports),I={inject:["top"],directives:{Clickoutside:n(2760).a},components:{ToggleToo:S,ElColorPicker:O.a},data:function(){return{actTool:"fontColor",tools:$.a,color:"none"}},mounted:function(){document.addEventListener("click",this.handleClose)},beforeDestroy:function(){document.removeEventListener("click",this.handleClose)},methods:{updateStatus:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=this.tools,r=e.length;if(1===r){var l=Object(o.a)(e,1)[0],c={fontBold:"bold",fontItalic:"italic",underline:"underline",strikethrough:"strikeout",fontCase:"case"};n.forEach((function(e){var n=l.fontStyle[c[e.name]];if("fontColor"===e.name&&(t.color=l.fontStyle.color),"justifying"===e.name){e.actInx={left:0,center:1,right:2}[l.fontStyle.textAlign]}c[e.name]&&(e.active=n)}))}(r>1||0===r)&&(n.forEach((function(t){t.active=!1,"justifying"===t.name&&(t.actInx=0)})),this.color="none")},handleTool:function(t){var e=t.name;t.active=!t.active,this[e]&&this[e](t)},getIds:function(t){var e=this.top.getActiveLayer().map((function(t){return t.layerId}));e.length&&t&&t(e)},fontColor:function(t){t.active=!1},selectColor:function(t){this.top.getActiveLayer().filter((function(t){return"wordLayer"===t.type})).map((function(t){return document.querySelector("#layer-".concat(t.layerId))})).forEach((function(e){e.querySelector(".words-content-box").style.color=t}))},fontColorOk:function(t){var e=this;this.getIds((function(n){var o={fontStyle:{color:t}};e.top.setIdItem(n,o),e.top.setPosterInfoFn()}))},handleClose:function(){this.top.getActiveLayer().forEach((function(t){if("wordLayer"===t.type){var sub=document.querySelector("#layer-".concat(t.layerId)).querySelector(".words-content-box"),e=t.fontStyle.color;sub.style.color="none"===e?"#000":e}}))},fontBold:function(t){var e=this,n=t.active;this.getIds((function(t){var o={fontStyle:{bold:n}};e.top.setIdItem(t,o),e.top.setPosterInfoFn()}))},fontItalic:function(t){var e=this,n=t.active;this.getIds((function(t){var o={fontStyle:{italic:n}};e.top.setIdItem(t,o),e.top.setPosterInfoFn()}))},underline:function(t){var e=this,n=t.active;this.getIds((function(t){var o={fontStyle:{underline:n}};e.top.setIdItem(t,o),e.top.setPosterInfoFn()}))},strikethrough:function(t){var e=this,n=t.active;this.getIds((function(t){var o={fontStyle:{strikeout:n}};e.top.setIdItem(t,o),e.top.setPosterInfoFn()}))},fontCase:function(){},lock:function(){},toggleJustifying:function(t,e){var n=this,o=t.list[e];t.actInx=e,t.text=o.text,this.getIds((function(t){var e={fontStyle:{textAlign:o.name}};n.top.setIdItem(t,e),n.top.setPosterInfoFn()}))}}},T=I,j=(n(2761),{inject:["top"],components:{FontSelect:f,FontSizeNum:k,UseTools:Object(d.a)(T,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"tools-list-box flex"},t._l(t.tools,(function(n){return e("div",{key:n.name,staticClass:"tool-item flex_c_m",class:n.active&&"active"},[e("el-tooltip",{attrs:{effect:"dark",content:"".concat(t.$t(n.text))}},["fontColor"===n.name?[e("div",{staticClass:"color-item",on:{click:function(e){return t.handleTool(n)}}},[e("p",[t._v("A")]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"none"===t.color,expression:"color === 'none'"}],staticClass:"line linein"}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"none"!==t.color,expression:"color !== 'none'"}],staticClass:"line",style:{background:t.color}}),t._v(" "),e("el-color-picker",{staticClass:"color-picker",attrs:{size:"mini"},on:{"active-change":t.selectColor,change:t.fontColorOk},model:{value:t.color,callback:function(e){t.color=e},expression:"color"}})],1)]:t._e(),t._v(" "),"justifying"===n.name?[e("toggle-too",{attrs:{inx:n.actInx,list:n.list},on:{onToggle:function(e){t.toggleJustifying(n,e)}}})]:[e("i",{class:["iconfont","icon-item",n.icon],style:{fontSize:n.size+"px"},on:{click:function(e){return t.handleTool(n)}}})]],2)],1)})),0)}),[],!1,null,"1a926257",null).exports},data:function(){return{showFontTool:!1}},mounted:function(){y.a.on("$E_setToolsStatus",this.setToolsStatus),y.a.on("$E_toggleFontTool",this.toggleFontTool)},methods:{setToolsStatus:function(){var t=this.top.getActiveLayer();if(t.length){var e=this.$refs.FontSizeNumRef,n=this.$refs.UseToolsRef,o=this.$refs.FontSelectRef;e&&e.setLayerFontSize(t),n&&n.updateStatus(t),o&&o.setTypefaceUrl(t)}},toggleFontTool:function(){var t=this.top.baseData.eleList.filter((function(t){return"wordLayer"===t.type&&t.active}));this.showFontTool=!!t.length}}}),L=(n(2762),Object(d.a)(j,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"middle-tool-box flex_c_m"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.showFontTool,expression:"showFontTool"}],staticClass:"flex_c_m"},[e("font-select",{ref:"FontSelectRef"}),t._v(" "),e("font-size-num",{ref:"FontSizeNumRef"}),t._v(" "),e("use-tools",{ref:"UseToolsRef"})],1)])}),[],!1,null,"ce269a4c",null).exports),P=(n(70),n(185)),M=n(3204),E={inject:["top"],components:{UserPopover:P.a},data:function(){return{}},methods:{toFeedback:function(){window.open("https://aihelp.net/questionnaire/#/?formId=6c101e48f801480eb2e97fd9d4fe5f0f","_blank")},fontCssStr:function(){var t=this.top.baseData.eleList.filter((function(t){return"wordLayer"===t.type&&"none"!==t.family})).map((function(t){var e=t.fontStyle;return'@font-face {\n          font-family: "'.concat(e.family,'";\n          src: url("').concat(e.familyPath,'")\n            format("truetype");\n          }')})),style=document.createElement("style");style.type="text/css",style.id="fontStyleTagId",style.innerHTML=t.join(""),document.body.appendChild(style)},leadingOut:function(){var t=this,e=this.top.baseData.whiteBoard.zoom,o=document.querySelector("#workScaleBoxid"),r=(new Date).getTime(),l=navigator.userAgent,c=l.indexOf("Safari")>-1&&-1===l.indexOf("Chrome");this.top.baseData.whiteBoard.zoom=100,this.top.exportLoading=!0,this.top.initLayerStatus(),y.a.emit("$E_setActiveLayerList"),y.a.emit("$E_LayerTopHideArea"),this.$logEvent("log_actions",{operation:"click_export",behavior_info:"on_canvas_fuction_page"});var d=function(n){var link=document.createElement("a"),o=document.querySelector("#fontStyleTagId");t.top.baseData.whiteBoard.zoom=e,t.top.exportLoading=!1,o&&o.parentNode.removeChild(o),link.href=n,link.download=r+".png",link.click()};this.$nextTick((function(){c?n(569)(o,{dpi:300,useCORS:!0,allowTaint:!1,scale:1}).then((function(canvas){if(canvas){var t=canvas.toDataURL();d(t)}})).catch((function(){t.top.baseData.whiteBoard.zoom=e,t.top.exportLoading=!1})):(t.fontCssStr(),Object(M.a)(o).then((function(t){t&&d(t)})).catch((function(){t.top.baseData.whiteBoard.zoom=e,t.top.exportLoading=!1})))}))}}},A=(n(2763),{components:{LeftAction:h,MiddleTool:L,RightAction:Object(d.a)(E,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"right-action-box flex_m"},[e("div",{staticClass:"feed-back flex_c_m",on:{click:t.toFeedback}},[e("i",{staticClass:"iconfont icon-icon_wenjuan"}),t._v(" "),e("span",[t._v(t._s(t.$t("Feedback")))])]),t._v(" "),e("div",{staticClass:"publish-btn flex_c_m",on:{click:t.leadingOut}},[e("i",{staticClass:"iconfont icon-icon-daochu"}),t._v(" "),e("span",[t._v(t._s(t.$t("leadingOut")))])]),t._v(" "),t.top.token?e("UserPopover"):e("el-button",{staticClass:"login-btn"},[t._v("\n    "+t._s(t.$t("Login"))+"\n  ")])],1)}),[],!1,null,"66a27102",null).exports},data:function(){return{}}}),N=(n(2764),Object(d.a)(A,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"top-nav-box flex"},[e("left-action"),t._v(" "),e("middle-tool"),t._v(" "),e("right-action")],1)}),[],!1,null,"2840a8e3",null).exports),R=(n(23),n(120),n(32),n(130)),B={props:{category:{type:Array,default:function(){return[]}},currentCategory:{type:String,default:"all"}},data:function(){return{categoryMoreName:"more"}},methods:{changeTag:function(t){var e,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.$emit("changeTag",t),this.categoryMoreName=n?null===(e=this.category.find((function(e){return e.value===t})))||void 0===e?void 0:e.label:"more"}}},F=B,U=(n(2765),Object(d.a)(F,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"category"},[t._l(t.category.filter((function(t){return null==t?void 0:t.isMore})),(function(n){return e("div",{key:n.value,staticClass:"item-category flex-center",class:{active:t.currentCategory===n.value},on:{click:function(e){return t.changeTag(n.value,!1)}}},[t._v("\n    "+t._s(t.$t(n.label))+"\n  ")])})),t._v(" "),e("el-dropdown",{attrs:{trigger:"click"},on:{command:t.changeTag}},[e("div",{staticClass:"item-category flex-center",class:{active:"more"!=t.categoryMoreName}},[t._v("\n      "+t._s(t.$t("".concat(t.categoryMoreName)))+"\n    ")]),t._v(" "),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.category.filter((function(t){return!(null!=t&&t.isMore)})),(function(n){return e("el-dropdown-item",{key:n.value,attrs:{command:n.value}},[t._v("\n        "+t._s(t.$t(null==n?void 0:n.label))+"\n      ")])})),1)],1)],2)}),[],!1,null,"6b8ab6ad",null).exports),V=n(95);function W(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function H(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?W(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var z={components:{CategoryTags:U},inject:["top"],data:function(){return{list:[],currentCategory:"all",category:[],categoryMoreName:"more",type:"normal",keywords:"",searchList:[],isHaveMore:!1,moreList:[],moreLoading:!1,paramsData:{page:1,page_size:50,category:"",type:1}}},mounted:function(){this.getList()},computed:H(H({},Object(l.c)("user",["cdnHostFun"])),{},{isShowClassify:function(){var t=this;return function(e){return(null==e?void 0:e.items.length)&&(t.currentCategory===e.category||"all"===t.currentCategory)}}}),methods:{getList:function(){var t=this;this.top.token&&(this.moreLoading=!0,Object(R.c)({type:1}).then((function(e){var n=e.data.items,o=void 0===n?[]:n;t.list=o.map((function(e){return e.label=t.initCategoryName(e.category),e})),t.initCategory(o),t.moreLoading=!1})))},initCategory:function(t){this.category=t.map((function(t,e){return{value:t.category,label:null==t?void 0:t.label,isMore:e<4}})),this.category.unshift({value:"all",label:"All",isMore:!0})},changeTag:function(t){this.currentCategory=t,this.$logEvent("log_actions",{operation:"click_".concat(t,"_material"),behavior_info:"on_canvas_detail_page"})},getMore:function(t){var e=this;this.moreLoading=!0,this.type="more",t&&(this.paramsData.category=t.category),Object(R.c)(this.paramsData).then((function(n){var data=n.data;e.isHaveMore?e.moreList=[{items:e.paramsData.page>1?e.moreList[0].items.concat(data):data,label:t?null==t?void 0:t.label:e.moreList[0].label}]:e.moreList=[{items:data,label:t.label}],e.isHaveMore=!(data.length<50),e.moreLoading=!1}))},closeSeeMore:function(){this.type="normal",this.moreList=[],this.paramsData.page=1,this.isHaveMore=!1},isScrollBottom:function(){if(this.isHaveMore){var t=this.$refs.material,e=t.clientHeight;t.scrollTop+e>=t.scrollHeight&&(this.paramsData.page+=1,this.getMore())}},initCategoryName:function(t){return"use"===t?"recentlyUsed":t.includes("/")?"canvas_".concat(t.split("/")[0]):"canvas_".concat(t)},keywordsChange:function(t){!t.target.value&&(this.type="normal")},search:function(){var t=this;this.keywords&&Object(R.c)({type:1,name:this.keywords}).then((function(e){t.type="search",t.searchList=(null==e?void 0:e.data)||[]}))},clear:function(){this.keywords="",this.searchList=[],this.type="normal"},handleUse:function(t){var e=this;if(!t)return this.$message.error();var n=t.id,o=void 0===n?"":n;Object(V.d)({url:t.image}).then((function(n){var r,l=n.realWidth,c=n.realHeight,d=n.renderWidth,h=n.renderHeight,m=e.top.baseData.eleList,v=Object(V.g)(m),param={type:"imgLayer",width:d,height:h,z:v,name:"".concat(e.$t("Layer")).concat(v),imgStyle:{imgSrc:t.image||"",realWidth:l,realHeight:c}},f=null===(r=e.list.find((function(t){return"use"==t.category})))||void 0===r?void 0:r.items;f.find((function(t){return(null==t?void 0:t.id)==o}))?Object(R.f)({id:o}).then((function(){e.top.initLayerStatus(),e.top.addLayerItem(param);var n=f.filter((function(t){return(null==t?void 0:t.id)!=o}));n.unshift(t),e.$set(e.list[0],"items",n)})):Object(R.f)({id:o}).then((function(){e.top.initLayerStatus(),e.top.addLayerItem(param),f.unshift(t)}))}))}}},G=(n(2766),Object(d.a)(z,(function(){var t=this,e=t._self._c;return e("div",{ref:"material",staticClass:"material-panel",on:{scroll:t.isScrollBottom}},[e("div",{directives:[{name:"show",rawName:"v-show",value:"more"!=t.type,expression:"type != 'more'"}],staticClass:"input-search"},[e("i",{staticClass:"iconfont icon-min-search",on:{click:t.search}}),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.keywords,expression:"keywords"}],attrs:{type:"text",placeholder:t.$t("minSearch")},domProps:{value:t.keywords},on:{change:t.keywordsChange,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search.apply(null,arguments)},input:function(e){e.target.composing||(t.keywords=e.target.value)}}}),t._v(" "),t.keywords.length>0?e("i",{staticClass:"el-icon-close",on:{click:t.clear}}):t._e()]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"search"==t.type,expression:"type == 'search'"}],staticClass:"search-box"},[t.searchList.length?e("div",{staticClass:"search-content"},[e("div",{staticClass:"label"},[t._v(t._s(t.$t("SearchResults")))]),t._v(" "),e("div",{staticClass:"content-box"},t._l(t.searchList,(function(n){return e("div",{key:null==n?void 0:n.id,staticClass:"item-content",on:{click:function(e){return t.handleUse(n)}}},[e("img",{staticClass:"image",attrs:{src:(null==n?void 0:n.image)||"",alt:"image"}})])})),0)]):e("div",{staticClass:"empty-box"},[e("img",{staticClass:"empty-img",attrs:{src:"https://".concat(t.cdnHostFun(),"static/upload/20240125/8b9a3975-7433-44ce-8244-5cb21cfe920c.webp"),alt:"empty image"}}),t._v(" "),e("div",{staticClass:"empty-tip"},[t._v(t._s(t.$t("NoSearchResultsTip")))])])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"more"==t.type,expression:"type == 'more'"},{name:"loading",rawName:"v-loading",value:t.moreLoading,expression:"moreLoading"}],staticClass:"normal-box"},[e("div",{staticClass:"classify-container"},t._l(t.moreList,(function(n){return e("div",{key:n.category,staticClass:"item-classify"},[e("div",{staticClass:"label"},[e("span",{on:{click:t.closeSeeMore}},[e("i",{staticClass:"iconfont icon-back"}),t._v(t._s(t.$t(null==n?void 0:n.label)))])]),t._v(" "),e("div",{staticClass:"content-box"},t._l(n.items,(function(content){return e("div",{key:null==content?void 0:content.id,staticClass:"item-content",on:{click:function(e){return t.handleUse(content)}}},[e("img",{staticClass:"image",attrs:{src:(null==content?void 0:content.image)||"",alt:"image"}})])})),0)])})),0)]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"normal"==t.type,expression:"type == 'normal'"},{name:"loading",rawName:"v-loading",value:t.moreLoading,expression:"moreLoading"}],staticClass:"normal-box"},[e("CategoryTags",{attrs:{currentCategory:t.currentCategory,category:t.category},on:{changeTag:t.changeTag}}),t._v(" "),e("div",{staticClass:"classify-container"},t._l(t.list,(function(n,o){return e("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowClassify(n),expression:"isShowClassify(classify)"}],key:n.category,staticClass:"item-classify"},[e("div",{staticClass:"label"},[e("span",[t._v(t._s(t.$t(null==n?void 0:n.label)))]),t._v(" "),"use"!=n.category?e("span",{staticClass:"text",on:{click:function(e){return t.getMore(n,o)}}},[t._v(t._s(t.$t("viewMore")))]):t._e()]),t._v(" "),n.isHaveMore?t._e():e("div",{staticClass:"content-box"},t._l(n.items.filter((function(t){return null==t?void 0:t.id})),(function(content){return e("div",{key:null==content?void 0:content.id,staticClass:"item-content",on:{click:function(e){return t.handleUse(content)}}},[e("img",{staticClass:"image",attrs:{src:(null==content?void 0:content.image)||"",alt:"image"}})])})),0)])})),0)],1)])}),[],!1,null,"6765de3a",null)),J=G.exports,K=(n(2008),{inject:["top"],data:function(){return{}},methods:{handleWord:function(t){var text=t.text,e=t.size,n=t.bold,o=this.top.baseData.eleList,r=Object(V.g)(o),l="<div>".concat(this.$t(text),"</div>"),param={type:"wordLayer",z:r,name:"".concat(this.$t("Layer")).concat(r),fontStyle:{innerHTML:l,size:e,bold:n}};this.top.initLayerStatus(),this.top.addLayerItem(param)},lookFontStyle:function(){this.top.baseData.leftMenu.actMenu="fontSizeList"}}}),Y=(n(2767),Object(d.a)(K,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"works-panel-box"},[e("div",{staticClass:"add-words-btn flex_c_m",on:{click:function(e){return t.handleWord({text:"addMintext",size:24,bold:!1})}}},[t._v("\n    "+t._s(t.$t("addWordsBox"))+"\n  ")]),t._v(" "),e("div",{staticClass:"words-title flex_m"},[e("div",{staticClass:"left"},[t._v(t._s(t.$t("wordsStyleInit")))]),t._v(" "),e("div",{staticClass:"right",on:{click:t.lookFontStyle}},[t._v(t._s(t.$t("viewMore"))+" >")])]),t._v(" "),e("div",{staticClass:"words-list-box"},[e("div",{staticClass:"item",staticStyle:{"font-size":"28px"},on:{click:function(e){return t.handleWord({text:"addTitleText",size:120,bold:!0})}}},[t._v("\n      "+t._s(t.$t("addTitleText"))+"\n    ")]),t._v(" "),e("div",{staticClass:"item",staticStyle:{"font-size":"18px"},on:{click:function(e){return t.handleWord({text:"addTitlefuText",size:50,bold:!0})}}},[t._v("\n      "+t._s(t.$t("addTitlefuText"))+"\n    ")]),t._v(" "),e("div",{staticClass:"item",staticStyle:{"font-size":"14px"},on:{click:function(e){return t.handleWord({text:"addWordsText",size:24,bold:!1})}}},[t._v("\n      "+t._s(t.$t("addWordsText"))+"\n    ")])])])}),[],!1,null,"62cc1f3f",null).exports),Q=n(3),X=(n(20),n(43),n(38)),Z=n(45),tt={inject:["top"],data:function(){return{list:[],loading:!1,paramsData:{page:1,page_size:20,category:"posterLocalMaterials",type:2},isHaveMore:!1,isUploading:!1,UPLOAD:new X.a({type:35})}},mounted:function(){this.top.token&&this.getList()},methods:{getList:function(){var t=this;this.loading=!0,Object(R.c)(this.paramsData).then((function(e){var data=e.data,n=t.paramsData,o=n.page,r=n.page_size;t.list=o>1?t.list.concat(data):data,t.isHaveMore=!(data.length<r),t.loading=!1}))},addProductImg:function(t){var e=this,image=t.image;Object(V.d)({url:image}).then((function(t){var n=t.realWidth,o=t.realHeight,r=t.renderWidth,l=t.renderHeight,c=e.top.baseData.eleList,d=Object(V.g)(c),param={type:"imgLayer",width:r,height:l,z:d,name:"".concat(e.$t("Layer")).concat(d),imgStyle:{imgSrc:image||"",realWidth:n,realHeight:o}};e.top.initLayerStatus(),e.top.addLayerItem(param)}))},handleBeforeUpload:function(t){var e=this;return Object(Q.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=["image/jpeg","image/png","image/jpg","image/webp"],!e.isUploading){n.next=3;break}return n.abrupt("return");case 3:if(o.includes(t.type)){n.next=6;break}return e.$message.error(e.$t("AllowImageFiles")),n.abrupt("return",!1);case 6:if(!t||t.size){n.next=8;break}return n.abrupt("return",!1);case 8:if(!(t.size/1024/1024>10)){n.next=19;break}return n.prev=9,n.next=12,Object(Z.a)(t,10485760);case 12:t=n.sent,n.next=19;break;case 15:return n.prev=15,n.t0=n.catch(9),console.error("Compression failed:",n.t0),n.abrupt("return",!1);case 19:return e.isUploading=!0,e.UPLOAD.startUpload(t).then((function(t){e.saveToList(t)})).finally((function(){e.isUploading=!1})),n.abrupt("return",!1);case 22:case"end":return n.stop()}}),n,null,[[9,15]])})))()},saveToList:function(image){var t=this,param={items:[{category:"posterLocalMaterials",image:image,name:""}]};Object(R.g)(param).then((function(e){t.$message.success(t.$t("UploadSuccess")),setTimeout((function(){t.isUploading=!1,t.getList()}),1e3)}))},handleDelete:function(t,e){var n=this;this.$confirm(this.$t("canvas_delete_tips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel")}).then((function(){Object(R.a)({id:t.id}).then((function(t){n.$message({type:"success",message:n.$t("deleteSuccess")}),n.list.splice(e,1)}))})).catch((function(){n.$message({type:"info",message:n.$t("Cancel")})}))},handleDownload:function(t){var img=new Image;img.crossOrigin="anonymous",img.src=t,img.onload=function(){var canvas=document.createElement("canvas");canvas.width=img.width,canvas.height=img.height,canvas.getContext("2d").drawImage(img,0,0);var t=canvas.toDataURL("image/png"),e=document.createElement("a");e.href=t,e.download="product.png",document.body.appendChild(e),e.click(),document.body.removeChild(e)},this.$message.success(this.$t("OperateSuccess"))},isScrollBottom:function(){if(this.isHaveMore){var t=this.$refs.product,e=t.clientHeight;t.scrollTop+e>=t.scrollHeight&&(this.paramsData.page+=1,this.getList())}}}},et=(n(2768),Object(d.a)(tt,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"product",staticClass:"product",on:{scroll:t.isScrollBottom}},[e("div",{staticClass:"product-list"},[e("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:t.isUploading,expression:"isUploading"}],key:"backgroundUpload",ref:"backgroundUpload",staticClass:"product-list-item",attrs:{action:"#","before-upload":t.handleBeforeUpload,disabled:t.isUploading,accept:".jpg, .jpeg, .png, .webp","http-request":function(){},"show-file-list":!1}},[e("div",{attrs:{slot:"trigger"},slot:"trigger"},[e("i",{staticClass:"el-icon-plus"}),t._v(" "),e("span",{staticClass:"upload-text"},[t._v(t._s(t.$t("SelectingMaterials")))])])]),t._v(" "),t._l(t.list,(function(n,o){return e("div",{key:n.id,staticClass:"product-list-item",on:{click:function(e){return t.addProductImg(n)}}},[e("img",{attrs:{src:n.image,alt:"image"}}),t._v(" "),e("div",{staticClass:"product-list-item-icon image-icon right36",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleDelete(n,o)}}},[e("i",{staticClass:"el-icon-delete"})]),t._v(" "),e("div",{staticClass:"product-list-item-icon image-icon",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleDownload(n.image)}}},[e("i",{staticClass:"el-icon-download"})])])}))],2)])}),[],!1,null,"08a4e3ee",null).exports);function it(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var at={inject:["top"],data:function(){return{list:[],loading:!1,paramsData:{page:1,page_size:50,category:"mine",type:2},isHaveMore:!1}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?it(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):it(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(l.c)("user",["cdnHostFun"])),mounted:function(){this.top.token&&this.getList(),y.a.on("$E_getMineList",this.getList)},methods:{getList:function(){var t=this;this.loading=!0,Object(R.c)(this.paramsData).then((function(e){var data=e.data;t.list=t.paramsData.page>1?t.list.concat(data):data,t.isHaveMore=!(data.length<50),t.loading=!1}))},handleUse:function(t){var e=this,image=t.image;Object(V.d)({url:image}).then((function(t){var n=t.realWidth,o=t.realHeight,r=t.renderWidth,l=t.renderHeight,c=e.top.baseData.eleList,d=Object(V.g)(c),param={type:"imgLayer",width:r,height:l,z:d,name:"".concat(e.$t("Layer")).concat(d),imgStyle:{imgSrc:image||"",realWidth:n,realHeight:o}};e.top.initLayerStatus(),e.top.addLayerItem(param)}))},handleDelete:function(t,e){var n=this;this.$confirm(this.$t("canvas_delete_tips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel")}).then((function(){try{Object(R.a)({id:t.id}).then((function(t){n.$message({type:"success",message:n.$t("deleteSuccess")}),n.list.splice(e,1)}))}catch(t){console.log(t)}})).catch((function(){n.$message({type:"info",message:n.$t("Cancel")})}))},isScrollBottom:function(){if(this.isHaveMore){var t=this.$refs.minematerial,e=t.clientHeight;t.scrollTop+e>=t.scrollHeight&&(this.paramsData.page+=1,this.getList())}}}},nt=at,ot=(n(2769),Object(d.a)(nt,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"minematerial",staticClass:"mine-panel",on:{scroll:t.isScrollBottom}},[t.list.length?e("div",{staticClass:"content"},[e("div",{staticClass:"label"},[t._v(t._s(t.$t("All")))]),t._v(" "),e("div",{staticClass:"materials"},t._l(t.list,(function(n,o){return e("div",{key:n.id,staticClass:"item-material",on:{click:function(e){return t.handleUse(n)}}},[e("img",{staticClass:"image",attrs:{src:n.image,alt:"image"}}),t._v(" "),e("div",{staticClass:"item-material-icon flex_c_m",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleDelete(n,o)}}},[e("i",{staticClass:"el-icon-close"})])])})),0)]):t._e(),t._v(" "),0!==t.list.length||t.loading?t._e():e("div",{staticClass:"empty-box"},[e("img",{staticClass:"empty-img",attrs:{src:"https://".concat(t.cdnHostFun(),"/static/upload/20240125/8b9a3975-7433-44ce-8244-5cb21cfe920c.webp"),alt:"empty image"}}),t._v(" "),e("div",{staticClass:"empty-tip"},[t._v(t._s(t.$t("no_data")))])])])}),[],!1,null,"23323a9f",null).exports);n(47),n(165);function st(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function lt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?st(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ct={inject:["top"],data:function(){return{}},computed:lt(lt({},Object(l.c)("user",["cdnHostFun"])),{},{renderLayer:function(){return this.top.baseData.eleList.sort((function(a,b){return b.z-a.z}))},getActiveList:function(){return this.top.baseData.eleList.filter((function(t){return t.active}))||[]},selectedLayer:function(){return this.getActiveList.map((function(t){return t.layerId}))},operationBtns:function(){return[{type:"copy",hoverTips:"copy",icon:"el-icon-document-copy"},{type:"down",hoverTips:"MoveDown",icon:"el-icon-arrow-down",hide:1!=this.selectedLayer.length},{type:"up",hoverTips:"MoveUp",icon:"el-icon-arrow-up",hide:1!=this.selectedLayer.length},{type:"delete",hoverTips:"canvas_delete_hover",icon:"el-icon-delete"}]}}),mounted:function(){y.a.on("$E_downLayer",this.downLayer),y.a.on("$E_upLayer",this.upLayer),y.a.on("$E_copyLayer",this.copyLayer),y.a.on("$E_deleteLayer",this.deleteLayer),y.a.on("$E_toTopLayer",this.toTopLayer),y.a.on("$E_toBottomLayer",this.toBottomLayer)},methods:{handleClick:function(t){this.top.initLayerStatus(),t.active=!0,y.a.emit("$E_LayerTopShowArea"),y.a.emit("$E_setActiveLayerList")},handleOperations:function(t){this["".concat(t,"Layer")]()},downLayer:function(){var t=this.top.getActiveIds(),e=Object(o.a)(t,1)[0],n=this.renderLayer.findIndex((function(t){return t.layerId===e})),r=this.renderLayer.length-1;if(n<r){n+=1;var l=this.renderLayer[n].layerId;this.top.setLayerReplace({oid:e,tid:l,keys:["z"]})}else n=r;this.top.setPosterInfoFn()},upLayer:function(){var t=this.top.getActiveIds(),e=Object(o.a)(t,1)[0],n=this.renderLayer.findIndex((function(t){return t.layerId===e}));if(n>0){n-=1;var r=this.renderLayer[n].layerId;this.top.setLayerReplace({oid:e,tid:r,keys:["z"]})}else n=0;this.top.setPosterInfoFn()},toTopLayer:function(){var t=this.top.getActiveIds(),e=Object(o.a)(t,1)[0],n=this.renderLayer.findIndex((function(t){return t.layerId===e})),r=this.renderLayer.filter((function(t,i){return i<n})).map((function(t){return t.layerId})),l=this.renderLayer[0].z;this.top.baseData.eleList.forEach((function(t){r.includes(t.layerId)&&(t.z-=1)})),this.top.setIdItem([e],{z:l})},toBottomLayer:function(){var t=this.renderLayer.length-1,e=this.top.getActiveIds(),n=Object(o.a)(e,1)[0],r=this.renderLayer.findIndex((function(t){return t.layerId===n})),l=this.renderLayer.filter((function(t,i){return i>r})).map((function(t){return t.layerId})),c=this.renderLayer[t].z;this.top.baseData.eleList.forEach((function(t){l.includes(t.layerId)&&(t.z+=1)})),this.top.setIdItem([n],{z:c})},copyLayer:function(){var t=this,e=this.top.getActiveLayer();this.top.initLayerStatus(),e.forEach((function(e){var n=t.top.baseData.eleList,o=Object(V.g)(n),r=JSON.parse(JSON.stringify(e));r.z=o,r.name="".concat(t.$t("Layer")).concat(o),r.x+=20,r.y+=20,t.top.addLayerItem(r)})),this.top.setPosterInfoFn()},deleteLayer:function(){var t=this.top.baseData.eleList.filter((function(t){return!1===t.active}));this.top.baseData.eleList=t,y.a.emit("$E_setActiveLayerList"),y.a.emit("$E_LayerTopHideArea"),this.top.setPosterInfoFn()},showLayer:function(t){t.show=!t.show,t.active=!1},lockLayer:function(t){t.lock=!t.lock,t.active=!1}}},ut=(n(2770),Object(d.a)(ct,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"layer-list-max"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.renderLayer.length>0,expression:"renderLayer.length > 0"}],staticClass:"title"},[t._v(t._s(t.$t("Layer")))]),t._v(" "),e("div",{staticClass:"list-box"},[t._l(t.renderLayer,(function(n){return e("div",{key:n.layerId,staticClass:"item flex_c_m",class:n.active&&"iacitve"},[e("div",{staticClass:"left flex_c_m"},[e("i",{staticClass:"iconfont",class:n.show?"icon-work-show":"icon-work-hide",on:{click:function(e){return t.showLayer(n)}}})]),t._v(" "),e("div",{staticClass:"center flex_m",on:{click:function(e){return t.handleClick(n)}}},["imgLayer"===n.type?[e("img",{staticClass:"la-img",attrs:{src:n.imgStyle.imgSrc,alt:"layer"}})]:t._e(),t._v(" "),"wordLayer"===n.type?[e("i",{staticClass:"iconfont icon-icon-T word-icon"})]:t._e(),t._v(" "),e("span",{staticClass:"la-name"},[t._v(t._s(n.name))])],2),t._v(" "),e("div",{staticClass:"right flex_c_m"})])})),t._v(" "),0===t.renderLayer.length?e("div",{staticClass:"empty-box"},[e("img",{staticClass:"empty-img",attrs:{src:"https://".concat(t.cdnHostFun(),"/static/upload/20240125/8b9a3975-7433-44ce-8244-5cb21cfe920c.webp"),alt:"empty image"}}),t._v(" "),e("div",{staticClass:"empty-tip"},[t._v(t._s(t.$t("no_data")))])]):t._e()],2),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.selectedLayer.length,expression:"selectedLayer.length"}],staticClass:"bottom-btns flex_c_m"},t._l(t.operationBtns,(function(n){return e("div",{directives:[{name:"show",rawName:"v-show",value:!n.hide,expression:"!item.hide"}],key:n.type,staticClass:"item-btn flex_c_m",on:{click:function(e){return t.handleOperations(n.type)}}},[e("el-tooltip",{attrs:{effect:"dark",disabled:!n.hoverTips,content:t.$t(n.hoverTips)}},[e("i",{class:n.icon})])],1)})),0)])}),[],!1,null,"388c896c",null).exports),pt=(n(2771),n(2772)),ht={inject:["top"],components:{Tree:n.n(pt).a},data:function(){return{list:[],defaultProps:{children:"fonts",label:"label"}}},mounted:function(){this.getFontList()},methods:{getFontList:function(){var t=this;Object(R.b)({}).then((function(e){t.list=e.data.items}))},handleNodeClick:function(t){var e=this,n=this.top.getActiveIds(),o=t.file_path,label=t.label,r=t.cover;if(n.length&&o){var l=new FontFace(label,"url(".concat(o,")"));this.top.setIdItem(n,{loading:!0}),l.load().then((function(){e.top.setIdItem(n,{loading:!1,fontStyle:{family:label,familyPath:o,familyImg:r}}),document.fonts.add(l),e.top.setPosterInfoFn(),y.a.emit("$E_setToolsStatus")}))}}}},mt=(n(2773),{inject:["top"],components:{MaterialPanel:J,WordsPanel:Y,UploadPanel:et,MinePanel:ot,LayerList:ut,FontList:Object(d.a)(ht,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"font-list-page"},[e("tree",{staticClass:"font-el-tree",attrs:{data:t.list,props:t.defaultProps,"empty-text":t.$t("no_data"),accordion:"","highlight-current":!0},on:{"node-click":t.handleNodeClick},scopedSlots:t._u([{key:"default",fn:function(n){var o=n.node;return e("div",{},[o.data.cover?t._e():e("div",{staticClass:"tree-item"},[e("span",[t._v(t._s(o.label))])]),t._v(" "),o.data.cover?e("div",{staticClass:"tree-item"},[e("img",{attrs:{src:o.data.cover}})]):t._e()])}}])})],1)}),[],!1,null,"549359be",null).exports},data:function(){return{}},computed:{leftMenu:function(){return this.top.baseData.leftMenu}},methods:{toggleMenuBard:function(){var t=this.top.baseData.leftMenu.showDrawer;this.top.baseData.leftMenu.showDrawer=!t},toggleLayerList:function(){this.top.baseData.leftMenu.showDrawer||(this.top.baseData.leftMenu.showDrawer=!0),this.top.baseData.leftMenu.actMenu="layerList"}}}),vt=(n(2774),{inject:["top"],components:{LeftDrawer:Object(d.a)(mt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"left-drawer",class:t.leftMenu.showDrawer?"show-menu":"hide-menu"},["material"===t.leftMenu.actMenu?e("MaterialPanel"):t._e(),t._v(" "),"characters"===t.leftMenu.actMenu?e("WordsPanel"):t._e(),t._v(" "),"upload"===t.leftMenu.actMenu?e("UploadPanel"):t._e(),t._v(" "),"mine"===t.leftMenu.actMenu?e("MinePanel"):t._e(),t._v(" "),e("LayerList",{directives:[{name:"show",rawName:"v-show",value:"layerList"===t.leftMenu.actMenu,expression:"leftMenu.actMenu === 'layerList'"}]}),t._v(" "),e("FontList",{directives:[{name:"show",rawName:"v-show",value:"fontSizeList"===t.leftMenu.actMenu,expression:"leftMenu.actMenu === 'fontSizeList'"}]}),t._v(" "),e("div",{staticClass:"open-btn",on:{click:t.toggleMenuBard}},[e("i",{class:"el-icon-arrow-".concat(t.leftMenu.showDrawer?"left":"right")})]),t._v(" "),e("div",{staticClass:"layer-btn flex_c_m",on:{click:t.toggleLayerList}},[e("el-tooltip",{attrs:{effect:"dark",content:t.$t("Layer")}},[e("i",{staticClass:"iconfont icon-icon_tuceng"})])],1)],1)}),[],!1,null,"6b97ef5e",null).exports},data:function(){return{menuList:[{label:"Material",name:"material",icon:"icon-icon_sucai",size:18},{label:"seoEraser_example_text",name:"characters",icon:"icon-icon-T",size:22},{label:"Upload",name:"upload",icon:"icon-icon-upload",size:22},{label:"Mine",name:"mine",icon:"icon-icon_wode",size:18}]}},methods:{changeMenu:function(t){this.top.baseData.leftMenu.showDrawer=!0,this.top.baseData.leftMenu.actMenu=t.name}}}),ft=(n(2775),Object(d.a)(vt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"left-menu-box"},[e("div",{staticClass:"menu-list"},t._l(t.menuList,(function(n){return e("div",{key:n.label,staticClass:"item",class:{active:t.top.baseData.leftMenu.actMenu===n.name},on:{click:function(e){return t.changeMenu(n)}}},[e("div",{staticClass:"icon"},[e("i",{staticClass:"iconfont",class:n.icon,style:{fontSize:n.size+"px"}})]),t._v(" "),e("div",{staticClass:"text"},[t._v(t._s(t.$t(n.label)))])])})),0),t._v(" "),e("left-drawer")],1)}),[],!1,null,"0f3721f3",null).exports),gt=(n(110),n(177)),_t=n(144),bt=(n(3226),n(87)),yt=n(99),wt={inject:["top"],name:"WordItem",components:{LineLoading:yt.a},props:{item:{type:Object,default:function(){return{}}},moveableRef:{type:Object,default:function(){return{}}},comKey:{type:String,default:""}},data:function(){return{fsize:40,updateTextDataFn:Object(bt.a)(this.updateTextData,1e3)}},computed:{FS:function(){return this.item.fontStyle},textDecoration:function(){var t=this.item.fontStyle;return[t.underline?"underline":"",t.strikeout?"line-through":""].filter((function(t){return""!==t})).join(" ")}},methods:{changeText:function(t){var e=this.item,n=document.querySelector("#layer-".concat(e.layerId)),o=n.querySelector(".words-content-box").clientHeight;n.style.height="".concat(o,"px"),this.moveableRef.updateRect()},updateTextData:function(t){var e=t.htmlStr,n=t.width,o=t.height,r=this.item.layerId,l={width:n,height:o,fontStyle:{innerHTML:e}};this.top.setIdItem([r],l),this.top.setPosterInfo()},blurText:function(t){var e=this.item,n=document.querySelector("#layer-".concat(e.layerId)),o=t.target.innerHTML,r=n.style,l=r.width,c=r.height,param={htmlStr:o,width:parseInt(l.trim()),height:parseInt(c.trim())};this.updateTextData(param)}}},Ct=(n(2776),Object(d.a)(wt,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.item.show,expression:"item.show"}],staticClass:"word-item-box layer-item",style:{zIndex:t.item.z,width:0===t.item.width?"auto":"".concat(t.item.width,"px"),height:0===t.item.height?"auto":"".concat(t.item.height,"px"),transform:"translate(".concat(t.item.x,"px, ").concat(t.item.y,"px) rotate(").concat(t.item.rotate,"deg)")},attrs:{id:"layer-".concat(t.item.layerId),"data-id":t.item.layerId,"data-type":t.item.type,"data-lock":t.item.lock+""}},[e("div",{staticClass:"words-content-box",style:{fontSize:t.FS.size+"px",color:"none"===t.FS.color?"#000":t.FS.color,fontWeight:t.FS.bold?"bold":"unset",fontStyle:t.FS.italic?"italic":"unset",textDecoration:t.textDecoration,textAlign:t.FS.textAlign,fontFamily:t.FS.family},attrs:{contenteditable:t.item.active},domProps:{innerHTML:t._s(t.FS.innerHTML)},on:{input:t.changeText,blur:t.blurText}}),t._v(" "),e("line-loading",{directives:[{name:"show",rawName:"v-show",value:t.item.loading,expression:"item.loading"}],staticClass:"loding-box"})],1)}),[],!1,null,"24dd1ba2",null).exports),kt={name:"ImgItem",props:{item:{type:Object,default:function(){return{}}},comKey:{type:String,default:""}},data:function(){return{}},methods:{onResize:function(t){t.target.style.width="".concat(t.width,"px"),t.target.style.height="".concat(t.height,"px"),t.target.style.transform=t.drag.transform}}},xt=(n(2777),Object(d.a)(kt,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.item.show,expression:"item.show"}],staticClass:"img-item-box layer-item",style:{zIndex:t.item.z,width:t.item.width+"px",height:t.item.height+"px",transform:"translate(".concat(t.item.x,"px, ").concat(t.item.y,"px) rotate(").concat(t.item.rotate,"deg)")},attrs:{id:"layer-".concat(t.item.layerId),"data-id":t.item.layerId,"data-type":t.item.type,"data-lock":t.item.lock+""}},[e("img",{staticClass:"img-tag",attrs:{src:t.item.imgStyle.imgSrc}})])}),[],!1,null,"7bb7f556",null).exports),Ot={inject:["top"],data:function(){return{}},computed:{board:function(){return this.top.baseData.whiteBoard}},methods:{changeSize:function(t,e){this.top.baseData.whiteBoard[e]=t,this.top.baseData.whiteBoard.x=0,this.top.baseData.whiteBoard.y=0,this.top.setPosterInfoFn()},resizeBoard:function(){var t=this;this.$confirm(this.$t("posterRemoveTips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel")}).then((function(){t.top.baseData.eleList=[],t.top.setPosterInfoFn()})).catch((function(){t.$message({type:"info",message:t.$t("Cancel")})}))}}},$t=(n(2778),Object(d.a)(Ot,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"board-title-nav flex_m"},[e("div",{staticClass:"left flex"},[e("div",{staticClass:"box"},[e("span",{staticClass:"words"},[t._v("W")]),t._v(" "),e("el-input-number",{staticClass:"input",attrs:{value:t.board.width,step:1,precision:0,controls:!1,min:t.board.min,max:t.board.max},on:{change:function(e){return t.changeSize(e,"width")}}})],1),t._v(" "),e("div",{staticClass:"box"},[e("span",{staticClass:"words"},[t._v("H")]),t._v(" "),e("el-input-number",{staticClass:"input",attrs:{value:t.board.height,step:1,precision:0,controls:!1,min:t.board.min,max:t.board.max},on:{change:function(e){return t.changeSize(e,"height")}}})],1)]),t._v(" "),e("div",{staticClass:"right"},[e("div",{staticClass:"btn-item flex_m",on:{click:t.resizeBoard}},[e("i",{staticClass:"iconfont icon-zhonghui"}),t._v(" "),e("span",[t._v(t._s(t.$t("S_ResetPrompt")))])])])])}),[],!1,null,"7958c34e",null).exports),Dt={inject:["top"],data:function(){return{offset:{left:-1e3,top:-1e3},btnList:[{label:"",type:"copy",icon:"icon-copy-ops"},{label:"",type:"del",icon:"icon-delete-gpt"},{label:"",type:"more",icon:"icon-editModel"}]}},mounted:function(){y.a.on("$E_LayerTopShowArea",this.showArea),y.a.on("$E_LayerTopHideArea",this.hideArea)},methods:{showArea:function(){var t=this,e=this.top.getActiveLayer();if(0===e.length)return this.offset.left=-1e3,void(this.offset.top=-1e3);if(1===e.length){var n=Object(o.a)(e,1)[0],r=document.querySelector("#layer-".concat(n.layerId)).getBoundingClientRect();this.offset.left=r.x,this.offset.top=r.y-50}e.length>1&&setTimeout((function(){var e=document.querySelector(".moveable-area").getBoundingClientRect();t.offset.left=e.x,t.offset.top=e.y-50}),300)},hideArea:function(){this.offset.left=-1e3,this.offset.top=-1e3},handMoer:function(t){var e=t.pageX,n=t.pageY,r=this.top.getActiveLayer();if(1===r.length){var l=Object(o.a)(r,1)[0],param={target:document.querySelector("#layer-".concat(l.layerId)),pageX:e,pageY:n};y.a.emit("$E_showRightMenu",param)}if(r.length>1){var c={target:document.querySelector(".moveable-area"),pageX:e,pageY:n};y.a.emit("$E_showRightMenu",c)}},layercopy:function(){var t=this;y.a.emit("$E_copyLayer"),this.$nextTick((function(){t.showArea()}))},layerdel:function(){y.a.emit("$E_deleteLayer"),this.hideArea()},handTopItem:function(t,e){var n=e.type;"more"!==n?this["layer".concat(n)]():this.handMoer(t)}}},St=(n(2779),Object(d.a)(Dt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"top-area-box",style:{left:t.offset.left+"px",top:t.offset.top+"px"},attrs:{"data-darg":"no"}},[e("div",{staticClass:"btn-list flex",attrs:{"data-darg":"no"}},t._l(t.btnList,(function(n){return e("div",{key:n.type,staticClass:"item flex_c_m",attrs:{"data-darg":"no"},on:{click:function(e){return t.handTopItem(e,n)}}},[e("i",{class:["iconfont",n.icon],attrs:{"data-darg":"no"}})])})),0)])}),[],!1,null,"18f21f24",null).exports),It=n(1884);function Tt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function jt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Tt(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Tt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Lt={inject:["top"],data:function(){return{offset:{left:-1e3,top:-1e3},singleArr:[],rightEvent:null}},mounted:function(){y.a.on("$E_showRightMenu",this.showRightMenu),y.a.on("$E_hideRightMenu",this.closeMenu),document.body.appendChild(this.$refs.rightMenuRef),document.addEventListener("click",this.closeMenu)},beforeDestroy:function(){document.body.removeChild(this.$refs.rightMenuRef),document.removeEventListener("click",this.closeMenu)},methods:{showRightMenu:function(t){var e,n=t.target,r=t.pageY,l=t.pageX,c=Object(V.c)(n,"layer-item");if(!this.top.baseData.whiteBoard.isHandBoard){if(this.rightEvent=t,c){var d=c.getAttribute("data-id"),h=c.getAttribute("data-type"),m=this.top.getIdlayer([d]);Object(o.a)(m,1)[0];this.singleArr=It.b,this.singleArr.forEach((function(t){"saveToMyGallery"===t.value&&(t.show="imgLayer"===h)})),this.top.initLayerStatus(),this.top.setIdItem([d],{active:!0}),y.a.emit("$E_setActiveLayerList"),y.a.emit("$E_setToolsStatus"),y.a.emit("$E_toggleFontTool"),this.offset.left=l,this.offset.top=r}(null==n||null===(e=n.classList)||void 0===e?void 0:e.contains("moveable-area"))&&(this.singleArr=It.a,this.offset.left=l,this.offset.top=r)}},closeMenu:function(t){(null==t?void 0:t.target)&&"no"===t.target.getAttribute("data-darg")||(this.offset.left=-1e3,this.offset.top=-1e3)},saveMyimgs:function(){var t=this,e=this.top.getActiveLayer(),param={items:[{category:"mine",image:Object(o.a)(e,1)[0].imgStyle.imgSrc}]};Object(R.g)(param).then((function(e){t.$message.success(t.$t("OperateSuccess")),y.a.emit("$E_getMineList")}))},handItem:function(t){var e=t.value;"saveToMyGallery"===e&&this.saveMyimgs(),"copy"===e&&(y.a.emit("$E_copyLayer"),this.$nextTick((function(){y.a.emit("$E_LayerTopShowArea")}))),"Delete"===e&&(y.a.emit("$E_deleteLayer"),y.a.emit("$E_LayerTopHideArea")),"toTop"===e&&y.a.emit("$E_toTopLayer"),"toBottom"===e&&y.a.emit("$E_toBottomLayer"),"moveUp"===e&&y.a.emit("$E_upLayer"),"moveDown"===e&&y.a.emit("$E_downLayer"),this.$emit("onRightItem",jt(jt({},t),{},{event:this.rightEvent})),this.$emit("E_LayerTopHideArea")}}},Pt=(n(2780),Object(d.a)(Lt,(function(){var t=this,e=t._self._c;return e("div",{ref:"rightMenuRef",staticClass:"right-menu-box",style:{left:t.offset.left+"px",top:t.offset.top+"px"}},t._l(t.singleArr,(function(n){return e("div",{directives:[{name:"show",rawName:"v-show",value:n.show,expression:"item.show"}],key:n.upscale,staticClass:"menu-item flex_m"},[e("div",{staticClass:"left",on:{click:function(e){return t.handItem(n)}}},[t._v(t._s(t.$t(n.label)))]),t._v(" "),e("div",{staticClass:"right",on:{click:function(e){return t.handItem(n)}}},[e("i",{staticClass:"ri-icon",class:n.rightIcon})]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:n.children,expression:"item.children"}],staticClass:"sub-list"},t._l(n.children,(function(sub){return e("div",{key:sub.value,staticClass:"menu-item flex_m"},[e("div",{staticClass:"left",on:{click:function(e){return t.handItem(sub)}}},[t._v(t._s(t.$t(sub.label)))]),t._v(" "),e("div",{staticClass:"right",on:{click:function(e){return t.handItem(sub)}}},[e("i",{staticClass:"ri-icon",class:sub.rightIcon})])])})),0)])})),0)}),[],!1,null,"c2ed1330",null).exports),Mt=n(713),Et={corner:!1,bothSides:!1},At={},Nt={inject:["top"],components:{Selecto:gt.a,Moveable:_t.a,LayerWords:Ct,LayerImage:xt,BoardTitle:$t,RightMenu:Pt,LayerTopArea:St},data:function(){return{moveableRef:null,moveableProps:{draggable:!0,rotatable:!0,origin:!1,scalable:!1,resizable:!0,rotationPosition:"bottom"},keepRatio:!1,renderDirections:["nw","n","ne","w","e","sw","s","se"],dragging:!1,translate:{x1:0,y1:0},targets:[]}},computed:{eleList:function(){return this.top.baseData.eleList},zoom:function(){return this.top.baseData.whiteBoard.zoom/100},board:function(){return this.top.baseData.whiteBoard}},mounted:function(){this.moveableRef=this.$refs.moveableRef,y.a.on("$E_updateLayerRect",this.updateLayerRect),y.a.on("$E_setActiveLayerList",this.setActiveLayerList)},methods:{onSelectStart:function(t){var e=this.$refs.moveableRef,n=t.inputEvent.target,o=e.isMoveableElement(n),r=this.targets.some((function(t){return t===n||t.contains(n)})),l="true"===n.getAttribute("data-lock"),c=this.board.isHandBoard,d="no"===n.getAttribute("data-darg");(o||r||l||c||d)&&t.stop()},onSelectEnd:function(t){var e=this.$refs.moveableRef,n=t.selected;t.isDragStart&&(t.inputEvent.preventDefault(),e.waitToChangeTarget().then((function(){e.dragStart(t.inputEvent)}))),window.getSelection().removeAllRanges();var r=this.top.baseData.eleList,l=void 0===r?[]:r;if(this.top.initLayerStatus(),n.forEach((function(t){var e=t.getAttribute("data-id"),n=l.find((function(t){var n=t.layerId===e,o=!t.lock;return n&&o}));n&&(n.active=!0)})),1===n.length){var c=Object(o.a)(n,1)[0].getAttribute("data-type");"wordLayer"===c&&(this.renderDirections=["nw","ne","w","e","sw","se"]),"imgLayer"===c&&(this.renderDirections=["nw","n","ne","w","e","sw","s","se"])}this.setActiveLayerList(),y.a.emit("$E_setToolsStatus"),y.a.emit("$E_toggleFontTool"),y.a.emit("$E_LayerTopShowArea")},setActiveLayerList:function(){var t=this;this.$nextTick((function(){var e=t.top.baseData.eleList,n=[];e.forEach((function(t){var e=t.active,o=t.layerId,r=document.querySelector("#layer-".concat(o));e&&r&&n.push(r)})),t.targets=n}))},onRender:function(t){t.target.style.cssText+=t.cssText,y.a.emit("$E_LayerTopHideArea"),y.a.emit("$E_hideRightMenu")},onRenderGroup:function(t){t.events.forEach((function(t){t.target.style.cssText+=t.cssText})),y.a.emit("$E_LayerTopHideArea"),y.a.emit("$E_hideRightMenu")},clickItem:function(t){var e=t.target;"wordLayer"===e.getAttribute("data-type")&&setTimeout((function(){var t=e.querySelector(".words-content-box");t&&t.focus()}),0)},onClickGroup:function(t){this.$refs.selectoRef.clickTarget(t.inputEvent,t.inputTarget)},dragLogic:function(t){if(t.lastEvent){var e=t.target.getAttribute("data-id"),n=Object(V.f)(t.lastEvent.transform).translate,r=Object(o.a)(n,2),l=r[0],c=r[1];this.top.setIdItem([e],{x:l,y:c})}},onDragEnd:function(t){this.dragLogic(t),this.top.setPosterInfoFn(),y.a.emit("$E_LayerTopShowArea")},onDragGroupEnd:function(t){var e=this;t.events.forEach((function(em){e.dragLogic(em)})),this.top.setPosterInfoFn(),y.a.emit("$E_LayerTopShowArea")},rotateLogic:function(t){if(t.lastEvent){var e=t.target.getAttribute("data-id"),n=Object(V.f)(t.lastEvent.afterTransform),r=n.rotate,l=n.translate,c=Object(o.a)(l,2),d=c[0],h=c[1];this.top.setIdItem([e],{rotate:r,x:d,y:h})}},onRotateEnd:function(t){this.rotateLogic(t),y.a.emit("$E_LayerTopShowArea"),this.top.setPosterInfoFn()},onRotateGroupEnd:function(t){var e=this;t.events.forEach((function(em){e.rotateLogic(em)})),y.a.emit("$E_LayerTopShowArea"),this.top.setPosterInfoFn()},resizeStartLogic:function(t,e){var n=Object(Mt.a)(e),o=n.corner,r=n.bothSides;Et.corner=o,Et.bothSides=r,At=Object(Mt.b)(t),this.keepRatio=o},onResizeStart:function(t){this.resizeStartLogic([t.target],t.direction),t.setMin([10,10])},orResizeGroupStart:function(t){this.resizeStartLogic(t.targets,t.direction),t.setMin([50,50])},resizeLogic:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=Et.corner,n=Et.bothSides;e&&(t.forEach((function(t){var e=t.target,n=t.width,o=e.getAttribute("data-id");"wordLayer"===e.getAttribute("data-type")&&(At[o].afterWidth=n)})),Object(Mt.c)(At)),n&&t.forEach((function(t){var e=t.target,n=t.width,o=e.getAttribute("data-id");if("wordLayer"===e.getAttribute("data-type")){var r=At[o].beforeSize;At[o].afterWidth=n,At[o].afterSize=r||12}}))},onResize:function(t){this.resizeLogic([t])},onResizeGroup:function(t){this.resizeLogic(t.events)},updateLayerRect:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.forEach((function(e){var n=e.getAttribute("data-type"),r=e.getAttribute("data-id");if("imgLayer"===n){var l=e.style,c=l.transform,d=l.width,h=l.height,m=Object(V.f)(c).translate,v=Object(o.a)(m,2),f=v[0],_=v[1],y={width:parseInt(d.trim()),height:parseInt(h.trim()),x:f,y:_};t.top.setIdItem([r],y)}if("wordLayer"===n){var w=e.querySelector(".words-content-box");if(!w)return;var C=w.clientHeight,k=w.clientWidth;e.style.height="".concat(C,"px"),e.style.width="".concat(k,"px");var x=e.style,O=x.transform,$=x.width,D=x.height,S=Object(V.f)(O).translate,I=Object(o.a)(S,2),T=I[0],j=I[1],L=w.style.fontSize,P={width:parseInt($.trim()),height:parseInt(D.trim()),x:T,y:j,fontStyle:{size:parseInt(L.trim())}};t.top.setIdItem([r],P)}})),e.some((function(t){return"wordLayer"===t.getAttribute("data-type")}))&&y.a.emit("$E_setToolsStatus"),this.moveableRef.updateRect()},onResizeEnd:function(t){this.updateLayerRect([t.target]),y.a.emit("$E_LayerTopShowArea"),this.top.setPosterInfoFn()},onResizeGroupEnd:function(t){var e=t.events.map((function(em){return em.target}));this.updateLayerRect(e),y.a.emit("$E_LayerTopShowArea"),this.top.setPosterInfoFn()},startDrag:function(t){var e=this.top.baseData.whiteBoard,n=e.x,o=e.y;e.isHandBoard&&(this.top.initLayerStatus(),y.a.emit("$E_setActiveLayerList"),y.a.emit("$E_LayerTopHideArea"),this.dragging=!0,this.translate.x1=t.clientX-n,this.translate.y1=t.clientY-o,document.addEventListener("mousemove",this.dragIng))},dragIng:function(t){var e=this.translate,n=e.x1,o=e.y1;this.dragging&&(this.top.baseData.whiteBoard.x=t.clientX-n,this.top.baseData.whiteBoard.y=t.clientY-o)},endDrag:function(){var t=this.top.baseData.whiteBoard.isHandBoard;this.dragging=!1,document.removeEventListener("mousemove",this.dragIng),t&&this.top.setPosterInfoFn()},handleRightClick:function(t){t.preventDefault(),y.a.emit("$E_showRightMenu",t)},onRightItem:function(t){},handleMouseWheel:function(t){t.preventDefault();var e=t.deltaY<0;this.top.initLayerStatus(),y.a.emit("$E_setActiveLayerList"),y.a.emit("$E_LayerTopHideArea"),e?this.top.baseData.whiteBoard.y+=50:this.top.baseData.whiteBoard.y-=50}}},Rt=Nt,Bt=(n(2781),Object(d.a)(Rt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"works-area-box flex_c_m",attrs:{id:"workAreaMaxId"},on:{mousedown:t.startDrag,mouseup:t.endDrag,contextmenu:t.handleRightClick,wheel:t.handleMouseWheel}},[e("div",{staticClass:"poster-area-box",style:{width:"".concat(t.board.width*t.zoom,"px"),height:"".concat(t.board.height*t.zoom+40,"px"),transform:"translate(".concat(t.board.x,"px, ").concat(t.board.y,"px)")},attrs:{id:"workBoxId"}},[e("board-title",{style:{width:"".concat(t.board.width*t.zoom,"px")},attrs:{"data-html2canvas-ignore":"true"}}),t._v(" "),e("div",{staticClass:"poster-whiteboard",style:{transform:"scale(".concat(t.zoom,")"),width:t.board.width+"px",height:t.board.height+"px"},attrs:{id:"workScaleBoxid"}},[t._l(t.eleList,(function(n){return["wordLayer"===n.type?e("layer-words",{key:n.layerId,ref:"LayerWordsRef",refInFor:!0,attrs:{item:n,comKey:n.layerId,moveableRef:t.moveableRef}}):t._e(),t._v(" "),"imgLayer"===n.type?e("layer-image",{key:n.layerId,ref:"LayerImageRef",refInFor:!0,attrs:{item:n,comKey:n.layerId}}):t._e()]}))],2)],1),t._v(" "),e("Moveable",t._b({ref:"moveableRef",attrs:{target:t.targets,keepRatio:t.keepRatio,renderDirections:t.renderDirections},on:{click:t.clickItem,clickGroup:t.onClickGroup,render:t.onRender,renderGroup:t.onRenderGroup,dragEnd:t.onDragEnd,dragGroupEnd:t.onDragGroupEnd,rotateEnd:t.onRotateEnd,rotateGroupEnd:t.onRotateGroupEnd,resize:t.onResize,resizeStart:t.onResizeStart,resizeEnd:t.onResizeEnd,resizeGroup:t.onResizeGroup,resizeGroupStart:t.orResizeGroupStart,resizeGroupEnd:t.onResizeGroupEnd}},"Moveable",t.moveableProps,!1)),t._v(" "),e("Selecto",{ref:"selectoRef",attrs:{dragContainer:"#workAreaMaxId",selectableTargets:[".layer-item"],hitRate:0,selectByClick:!0,selectFromInside:!1,toggleContinueSelect:["shift"],ratio:0},on:{dragStart:t.onSelectStart,selectEnd:t.onSelectEnd}}),t._v(" "),e("right-menu",{on:{onRightItem:t.onRightItem}}),t._v(" "),e("layer-top-area")],1)}),[],!1,null,"0b630572",null).exports),Ft={inject:["top"],data:function(){return{}},computed:{board:function(){return this.top.baseData.whiteBoard}},methods:{changeSize:function(t){this.top.baseData.whiteBoard.zoom=t,y.a.emit("$E_setActiveLayerList"),y.a.emit("$E_LayerTopHideArea"),this.top.initLayerStatus(),this.top.setPosterInfoFn()},changeHand:function(t){this.top.baseData.whiteBoard.isHandBoard=!t,this.top.setPosterInfoFn()}}},Ut=(n(2782),Object(d.a)(Ft,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"zoom-board-box flex_m"},[e("div",{staticClass:"hand-move flex_c_m",class:t.board.isHandBoard&&"hand-active",on:{click:function(e){return t.changeHand(t.board.isHandBoard)}}},[e("el-tooltip",{attrs:{effect:"dark",content:t.$t("move")}},[e("i",{staticClass:"iconfont icon-zhuashou-copy"})])],1),t._v(" "),e("el-input-number",{staticClass:"my-input-number",attrs:{value:t.board.zoom,size:"mini",min:10,max:500,step:10,precision:0},on:{change:t.changeSize}})],1)}),[],!1,null,"b71b4ce0",null).exports),Vt=n(208),qt=n(714);function Wt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var Ht={name:"posterBoard",provide:function(){return{top:this}},components:{TopNav:N,LeftMenu:ft,WorksArea:Bt,ZoomBoard:Ut,LoadingStatus:Vt.a,LineLoading:yt.a},data:function(){return{baseData:qt.b,setPosterInfoFn:Object(bt.a)(this.setPosterInfo,1e3),posterLoading:!0,exportLoading:!1}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Wt(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Wt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(l.e)("user",["token"])),mounted:function(){document.querySelector("body").classList.add("poster-board-page"),this.getPosterDetail()},beforeDestroy:function(){document.querySelector("body").classList.remove("poster-board-page")},methods:{getPosterDetail:function(){var t=this,e=this.$route.query,n=e.id,o=e.live;this.posterLoading=!0,setTimeout((function(){t.posterLoading=!1}),1e4),Object(R.e)({id:n}).then((function(e){var r,l;e.data?r=JSON.parse(null===(l=e.data)||void 0===l?void 0:l.json_str):r=JSON.parse(JSON.stringify(qt.b));r.eleList.forEach((function(t){t.active=!1})),r.leftMenu.actMenu="characters",r.whiteBoard.min=40,r.whiteBoard.max=3125,r.whiteBoard.isHandBoard=!1,"yes"===o?(t.baseData=r,Object(R.d)({id:n}).then((function(e){var n,o=JSON.parse(null===(n=e.data)||void 0===n?void 0:n.json_str).liveModel,l=o.width,c=o.height,d=o.result,h=t.baseData.eleList;h.length||(t.baseData.whiteBoard.width=l,t.baseData.whiteBoard.height=c);var m=h.some((function(t){return t.imgStyle.imgSrc===d}));Object(V.e)(r.eleList,(function(){t.posterLoading=!1})),m||Object(V.d)({url:d}).then((function(e){var n=e.realWidth,o=e.realHeight,r=e.renderWidth,l=e.renderHeight,c=Object(V.g)(h),param={type:"imgLayer",width:r,height:l,z:c,name:"".concat(t.$t("Layer")).concat(c),imgStyle:{imgSrc:d,realWidth:n,realHeight:o}};t.addLayerItem(param)}))}))):(t.baseData=r,Object(V.e)(r.eleList,(function(){t.posterLoading=!1})))}))},setPosterInfo:function(){var t={id:this.$route.query.id,json_str:JSON.stringify(this.baseData)};Object(R.h)(t).then((function(t){}))},addLayerItem:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object(V.a)(qt.a,t);e.layerId=Object(V.b)(),e.active=!0,this.baseData.eleList.push(e),y.a.emit("$E_setActiveLayerList"),y.a.emit("$E_setToolsStatus"),y.a.emit("$E_toggleFontTool"),this.$nextTick((function(){y.a.emit("$E_LayerTopShowArea")})),this.setPosterInfoFn()},setIdItem:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],data=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.baseData.eleList;n.forEach((function(o,i){var r=o.layerId;if(e.includes(r)){var l=Object(V.a)(o,data);t.$set(n,i,l)}}))},initLayerStatus:function(){this.baseData.eleList.forEach((function(t){t.active=!1}))},getActiveLayer:function(){return this.baseData.eleList.filter((function(t){return t.active}))||[]},getIdlayer:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.baseData.eleList.filter((function(e){return t.includes(e.layerId)}))||[]},getActiveIds:function(){return this.getActiveLayer().map((function(t){return t.layerId}))},setLayerReplace:function(data){var t=data.oid,e=data.tid,n=data.keys,r=void 0===n?[]:n,l=this.baseData.eleList,c=l.filter((function(e){return e.layerId===t})),d=Object(o.a)(c,1)[0],h=l.filter((function(t){return t.layerId===e})),m=Object(o.a)(h,1)[0];r.forEach((function(t){var e=d[t],n=m[t];d[t]=n,m[t]=e}))}}},zt=Ht,Gt=(n(2783),n(2784),Object(d.a)(zt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"poster-max-box"},[e("top-nav"),t._v(" "),e("left-menu"),t._v(" "),e("works-area"),t._v(" "),e("zoom-board"),t._v(" "),t.posterLoading?e("LoadingStatus",{staticClass:"poster-max-loading",attrs:{bgColor:"#02050e"}}):t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.exportLoading,expression:"exportLoading"}],staticClass:"screenshot-lod"},[e("line-loading"),t._v(" "),e("div",{staticClass:"text"},[t._v(t._s(t.$t("ai_dance_loading_toast")))])],1)],1)}),[],!1,null,"174872c0",null));e.default=Gt.exports},3245:function(t,e,n){"use strict";n.r(e);n(9),n(7),n(11),n(12);var o=n(97),r=n(3),l=n(31),c=n(2),d=(n(20),n(16),n(32),n(19),n(14),n(8),n(4),n(50),n(6),n(48),n(211)),h=n(501),m=n(15),v=(n(47),n(10),n(43),n(18),n(29),n(270)),f=n(109),_=(n(49),n(76),n(1)),y=n(5);function w(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function C(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?w(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n(28),n(125);var k=n(340),x=n(133),O=n(35),$=n.n(O),D=n(152),S=n(73),I=n(136),T=n(22),j={props:{info:{type:Object,default:function(){return{}}}},data:function(){return{formList:[]}},computed:{},mounted:function(){this.getMetaInfo()},methods:{isModelItem:function(t){return["CheckpointLoaderSimple","LoraLoader"].includes(t.node_type)},getMetaInfo:function(){var t=this,e=this.info.id;Object(T.h)({id:e}).then((function(e){var n;t.formList=(null==e||null===(n=e.data.meta)||void 0===n?void 0:n.comfyui_inputs)||[]}))},handleJumpDetail:function(){var t=((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})||{}).art_model,e=void 0===t?{}:t;null!=e&&e.id&&window.open("/models/detail/".concat(null==e?void 0:e.id),"_blank")},isWordsLine:function(){return String((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).val).length<40},handleCopyAll:function(){var content=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).val||"";content&&(this.$message.success(this.$t("CopySuccess")),Object(y.d)(content))}}},L=j,P=(n(2885),n(0)),M=Object(P.a)(L,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"config-databox"},t._l(t.formList,(function(n,o){var r,l,c;return e("div",{key:n.field+o},[t.isModelItem(n)?[e("div",{staticClass:"easy-tooltip-wraper-model-box"},[e("div",{staticClass:"easy-tooltip-wraper-model-box-item",on:{click:function(e){return e.stopPropagation(),t.handleJumpDetail(n)}}},[e("div",{staticClass:"easy-tooltip-wraper-model-box-item-cover"},[e("img",{attrs:{src:null==n||null===(r=n.art_model)||void 0===r||null===(r=r.banner)||void 0===r?void 0:r.url,alt:""}})]),t._v(" "),e("div",{staticClass:"easy-tooltip-wraper-model-box-item-content"},[e("div",{staticClass:"easy-tooltip-model-box-model-type-box"},[e("span",{staticClass:"easy-tooltip-model-box-model-type"},[t._v(t._s(t.$t(null==n||null===(l=n.art_model)||void 0===l?void 0:l.type)))])]),t._v(" "),e("div",{staticClass:"easy-tooltip-model-box-model-name"},[t._v("\n              "+t._s((null==n||null===(c=n.art_model)||void 0===c?void 0:c.name)||"")+"\n            ")])])])])]:t._e(),t._v(" "),t.isModelItem(n)?t._e():[n.val&&t.isWordsLine(n)?e("div",{staticClass:"line-cell flex"},[e("div",{staticClass:"title"},[t._v(t._s(n.field||""))]),t._v(" "),e("div",{staticClass:"content"},[t._v(t._s(n.val||""))])]):t._e(),t._v(" "),n.val&&!t.isWordsLine(n)?e("div",{staticClass:"lines-cell"},[e("div",{staticClass:"title flex_m"},[e("span",[t._v(" "+t._s(n.field||""))]),t._v(" "),e("span",{staticClass:"iconfont icon-codeCopy1 copy",on:{click:function(e){return e.stopPropagation(),t.handleCopyAll(n)}}})]),t._v(" "),e("div",{staticClass:"content"},[t._v(t._s(n.val||""))])]):t._e()]],2)})),0)}),[],!1,null,"872b89a4",null).exports;function E(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function A(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?E(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var N={name:"historyImg",inject:["top"],components:{taskImageViewer:k.a,SaveTo:D.a,ElImageViewer:x.a,auditDialog:I.a,CreateConfig:M},props:{src:{type:String,required:!0,default:function(){return""}},nsfw:{type:Number,default:2},width:{type:Number,default:100},height:{type:Number,default:100},message:{type:Object,default:function(){return{}}},imgInfo:{type:Object,default:function(){return{}}},operateNumber:{type:Number,default:function(){return 1}},baseSize:{type:String,default:""}},data:function(){return{loading:!0,loaded:!0,error:!1,dialogVisible:!1,retryCount:0,isShowImage:!0,baseImageWidth:200,imageUrl:"",checked:!1,alreadySave:!1,hoverBtnList:[{code:"download",icon:"modelDownload",useText:!1,order:5,tips:"DownloadImg",show:!0,showTypeOptions:[]},{code:"save",icon:"save",useText:!1,order:5,tips:"Save",show:!0,showTypeOptions:[]},{code:"deleteSingleImg",icon:"moveDeleteTask",useText:!1,order:5,tips:"Delete",show:!0,showTypeOptions:[]}],bigImageBtns:[{code:"save",icon:"save",useText:!1,order:5,tips:"Save",show:!0,showTypeOptions:[]},{code:"chat",icon:"a-home-top-personl1",useText:!1,order:0,tips:"createChartacterToChat",show:!0,showTypeOptions:[]},{code:"aiGenerateVideo",icon:"a-icon-VideoGeneration",useText:!1,order:6,tips:"ImageToVideoTip",show:!0,showTypeOptions:[]}],isShowHoverMask:!1}},computed:A(A(A(A({},Object(_.c)(["isSupportWebp"])),Object(_.c)("user",["userInfo","isCompanyAccount"])),Object(_.e)("user",["cdnHost"])),{},{currentImageIndex:function(){var t,e=this;return-1===(t=this.viewImageList.findIndex((function(t){return t.operateNumber===e.operateNumber})))?0:t},viewImageList:function(){var t=this,e=[],n=this.message.components,o=void 0===n?[]:n;return Array.isArray(o)&&o.length&&(e=($()(this.message.components||[])||[]).map((function(t,e){return t.operateNumber=e+1,t})).filter((function(e){return t.checkIsShowViewNsfw&&t.enableNsfwMode?![1,"1"].includes(e.nsfw)&&(null==e?void 0:e.canViewNsfw):![1,"1"].includes(null==e?void 0:e.nsfw)}))),e},renderUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20230401/62f66fbd-bc27-44f6-b744-5c5d7e5b18ee.webp")},isShowNsfwBg:function(){var t="";return 1===this.nsfw||(t=this.checkIsShowViewNsfw?this.handleShowNsfwImageUrl():this.isShowImage?this.imageUrl:"",this.renderUrl===t)},isBlur:function(){return 1===this.nsfw||(this.checkIsShowViewNsfw?(null==this||null===(t=this.imgInfo)||void 0===t?void 0:t.is_nsfw_plus)&&!this.imgInfo.canViewNsfw:1===this.nsfw);var t},isShowOperateBtn:function(){return!this.isBlur&&!this.error},isShowHover:function(){var t,e;return!!this.checkIsShowViewNsfw&&((null==this||null===(t=this.imgInfo)||void 0===t?void 0:t.is_nsfw_plus)&&!(null!=this&&null!==(e=this.imgInfo)&&void 0!==e&&e.canViewNsfw))},isNsfwPlus:function(){var t;return(null==this||null===(t=this.imgInfo)||void 0===t?void 0:t.is_nsfw_plus)&&1!==this.nsfw},getImageUrl:function(){return this.isShowImage?this.imageUrl:""},isVideoUrl:function(){var t=this;return[".mp4",".mkv",".webm",".avi",".mov",".flv",".wmv"].some((function(e){return(t.imageUrl||"").toLowerCase().endsWith(e)}))},checkIsShowViewNsfw:function(){var t;return null==this||null===(t=this.userInfo)||void 0===t?void 0:t.enable_nsfw_plus},hoverBtnRenderList:function(){var t=this;return this.hoverBtnList.map((function(e){return e.show=t.isShowBtn(e.code),e})).filter((function(t){return t.show}))},isShowSaveTo:function(){var t,e,n=this.message.components,o=void 0===n?[]:n;return!!o.length&&!(null!==(t=o[this.operateNumber-1])&&void 0!==t&&t.is_saved_personal||null!==(e=o[this.operateNumber-1])&&void 0!==e&&e.alreadySave||this.alreadySave)},isShowBtn:function(){var t={save:[this.isShowSaveTo&&1!==this.nsfw],deleteSingleImg:[!0],download:[1!==this.nsfw]};return function(e){return!!Object.keys(t).includes(e)&&t[e].every((function(t){return!!t}))}},isShowNsfwIcon:function(){return this.checkIsShowViewNsfw&&this.isNsfwPlus},enableNsfwMode:function(){var t;return![2,"2"].includes(null==this||null===(t=this.userInfo)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.nsfw_plus)}}),mounted:function(){this.$set(this.imgInfo,"canViewNsfw",this.checkIsShowViewNsfw&&this.enableNsfwMode)},watch:{src:{handler:function(t){t&&"string"==typeof t&&(this.imageUrl=this.isSupportWebp?Object(y.x)(t,"high"):this.src)},immediate:!0},dialogVisible:function(t){try{document.body.style.overflow=t?"hidden":""}catch(t){document.body.style.overflow=""}}},methods:A(A({},Object(_.b)("user",["getAccountInfo"])),{},{handleSaveSuccess:function(){this.$logEvent("log_actions",{operation:"creative_flow_single_picture",behavior_info:"save"});try{this.message.components[this.operateNumber-1].alreadySave=!0}catch(t){}this.alreadySave=!0,this.$emit("saveSuccess")},deleteSingleImg:function(){var t=this;this.$confirm(this.$t("deleteConfirm"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){t.$emit("deleteSingleImg",t.operateNumber,t.message)}))},handleShowNsfwImageUrl:function(){var t;return null!=this&&null!==(t=this.imgInfo)&&void 0!==t&&t.is_nsfw_plus&&!this.imgInfo.canViewNsfw?this.renderUrl:this.isShowImage?this.imageUrl:""},onLoad:function(t){this.loading=!1,this.loaded=!0,this.error=!1,this.$EventBus.$emit("needScrollBottom",$()(this.message))},onError:function(){this.loading=!1,this.imageUrl&&(this.imageUrl.includes("_high.webp")||this.imageUrl.includes("_low.webp"))&&(this.imageUrl=this.src),this.reLoadImage(),this.error=!0},reLoadImage:function(){var t=this;this.retryCount>=1||(this.isShowImage=!1,this.retryCount++,this.loading=!0,this.$nextTick((function(){t.isShowImage=!0})))},clickReloadImage:function(){this.retryCount=0,this.error=!1,this.imageUrl=this.isSupportWebp?Object(y.x)(this.src,"high"):this.src,this.reLoadImage()},viewBigImage:function(){1!==this.nsfw&&(this.isShowHover||(this.$logEvent("log_actions",{operation:"view_image",behavior_info:"on_quick_tools_created_records_page"}),this.dialogVisible=!0))},closeViewBigImage:function(){this.dialogVisible=!1},handleContextMenu:function(t){1===this.nsfw&&t.preventDefault()},downloadImage:function(){Object(y.z)(this.src,this.$t("WorkFlow"))},handleClick:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";["deleteSingleImg"].includes(e)?this.deleteSingleImg():"download"!==e?["save"].includes(e)&&(null===(t=this.$refs)||void 0===t||null===(t=t.saveToPopover[0])||void 0===t||t.doShow()):this.downloadImage()},settingViewNsfw:function(){var t;this.$logEvent("log_actions",{operation:"click_NSFW_on_task"}),this.enableNsfwMode||1===(null===(t=this.userInfo)||void 0===t?void 0:t.is_audit)?this.applyNsfw(!1):this.$refs.auditDialog.showDialog()},applyNsfw:function(){var t=this;if(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]){var e={};e.nsfw_plus=this.enableNsfwMode?2:1,e.mode=1,e.age_confirm=!0,Object(S.b)(e).then((function(e){var n=(e||{}).status.code;["10000",1e4].includes(void 0===n?"":n)&&(t.$message.success(t.$t(t.enableNsfwMode?"ClosedSuccessfully":"OpenedSuccessfully")),t.getAccountInfo())})).finally((function(){t.$set(t.imgInfo,"canViewNsfw",!t.imgInfo.canViewNsfw)}))}else this.$set(this.imgInfo,"canViewNsfw",!this.imgInfo.canViewNsfw)},handImageBtns:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).type,e={chat:"click_chat",aiGenerateVideo:"click_image_to_video"};e[t]&&this.$logEvent("log_actions",{operation:e[t],behavior_info:"on_image_detail_page"})}})},R=N,B=(n(2886),n(2887),Object(P.a)(R,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"c-history-img"},[n("div",{staticClass:"attachments-wrap"},[n("div",{staticClass:"message-attachment-media"},[n("div",{staticClass:"image-content"},[n("div",{staticClass:"image-content-wrap",class:[1===e.nsfw?"image-content-wrap-background":""],style:{"max-width":"".concat(e.baseSize),"min-width":"".concat(e.baseSize,"px")}},[n("div",{directives:[{name:"show",rawName:"v-show",value:1===e.nsfw,expression:"nsfw === 1"}],staticClass:"nsfw-flag"},[e._v("NSFW")]),e._v(" "),n("div",{staticClass:"image-render-box"},[1===e.nsfw?[n("img",{staticClass:"media-attachments-img image-opacity-0",attrs:{src:e.renderUrl,alt:"",decoding:"async",loading:"lazy"},on:{load:e.onLoad,error:e.onError,contextmenu:function(t){return e.handleContextMenu(t)}}})]:[e.isVideoUrl?e._e():n("img",{staticClass:"media-attachments-img",class:[e.loading?"":"media-attachments-img-show",e.loading?"image-opacity-0":"",e.isShowNsfwBg?"blurBackground":""],attrs:{src:e.getImageUrl,alt:"",decoding:"async",loading:"lazy"},on:{load:e.onLoad,error:e.onError,click:e.viewBigImage,contextmenu:function(t){return e.handleContextMenu(t)}}}),e._v(" "),e.isVideoUrl&&e.getImageUrl?n("video",{class:[e.loading?"image-opacity-0":"",e.isShowNsfwBg?"blurBackground":""],style:{borderRadius:"8px",width:"".concat(e.baseImageWidth,"px"),height:"".concat(parseInt(e.height*e.baseImageWidth/e.width),"px")},attrs:{src:e.getImageUrl,autoplay:"",loop:"",muted:"",controls:!1},domProps:{muted:!0},on:{play:function(t){e.loading=!1}}}):e._e()],e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.loading&&1!==e.nsfw,expression:"loading && nsfw !== 1"}],staticClass:"loading-wrapper"},[n("div",{staticClass:"loading-wrapper-inner"},[n("span",{staticClass:"spinner",attrs:{role:"img","aria-label":e.$t("Loading")}},[e._m(0)])])]),e._v(" "),e.isShowNsfwIcon?n("div",{staticClass:"generate-view-nsfw-plus",on:{click:function(t){return t.stopPropagation(),e.settingViewNsfw.apply(null,arguments)}}},[n("i",{staticClass:"iconfont",class:null!==(t=e.imgInfo)&&void 0!==t&&t.canViewNsfw?"icon-work-hide":"icon-work-show"})]):e._e(),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowOperateBtn&&e.isShowImage&&e.src&&!e.loading||1===e.nsfw,expression:"\n                (isShowOperateBtn && isShowImage && src && !loading) ||\n                nsfw === 1\n              "}],staticClass:"image-hover-mask",on:{click:e.viewBigImage}},[n("div",{staticClass:"image-hover-mask-btn-box"},e._l(e.hoverBtnRenderList,(function(t){var o;return n("el-tooltip",{key:t.code,attrs:{"popper-class":"task-image-viewer-popover",effect:"light",placement:"top",content:e.$t(null==t?void 0:t.tips)}},["save"!==t.code?n("span",{staticClass:"image-hover-mask-btn image-hover-mask-btn-single",on:{click:function(n){return n.stopPropagation(),e.handleClick(t.code)}}},[t.useText?[e._v("\n                      "+e._s(t.text)+"\n                    ")]:n("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(t.icon)})],2):e._e(),e._v(" "),"save"===t.code&&e.isShowSaveTo?n("save-to",{ref:"saveToPopover",refInFor:!0,attrs:{type:"artwork",category:!0,title:e.$t("Save"),message:C(C({},e.message),{},{img_uris:(null===(o=e.message)||void 0===o?void 0:o.components)||[]}),operateNumber:e.operateNumber,showArrowIcon:!1},on:{saveSuccess:e.handleSaveSuccess}},[n("span",{staticClass:"image-hover-mask-btn image-hover-mask-btn-single",on:{click:function(t){return t.stopPropagation(),e.handleClick("save")}}},[t.useText?[e._v("\n                        "+e._s(t.text)+"\n                      ")]:n("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(t.icon)})],2)]):e._e()],1)})),1)])],2)]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.error&&!e.loading,expression:"error && !loading"}],staticClass:"image-load-error"},[n("i",{staticClass:"iconfont icon-image-load-error image-load-error-icon"}),e._v(" "),n("span",{staticClass:"image-load-error-text",on:{click:function(t){return t.stopPropagation(),e.clickReloadImage.apply(null,arguments)}}},[e._v(e._s(e.$t("reloadImage")))])])])])]),e._v(" "),e.dialogVisible?n("task-image-viewer",{staticClass:"work-message-img-viewer",staticStyle:{"z-index":"999"},attrs:{"on-close":e.closeViewBigImage,"initial-index":e.currentImageIndex,"show-operate-btn":!0,hoverBtnRenderList:e.bigImageBtns,message:e.message,"url-list":e.viewImageList,customForm:!0},on:{onClickBtns:e.handImageBtns},scopedSlots:e._u([{key:"customContent",fn:function(){return[n("CreateConfig",{attrs:{info:e.message}})]},proxy:!0}],null,!1,1028422645)}):e._e(),e._v(" "),n("auditDialog",{ref:"auditDialog",on:{confirm:e.applyNsfw}})],1)}),[function(){var t=this._self._c;return t("span",{staticClass:"inner-MGEKwh wanderingCubes-2A046F"},[t("span",{staticClass:"item-2VgEex"}),t("span",{staticClass:"item-2VgEex"})])}],!1,null,"418db711",null)),F=B.exports,U=n(86),V=n(98);function W(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function H(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?W(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var z=n(124),G={name:"historyItem",components:{historyImg:F,TryCreateMask:v.a,QuickQueue:V.a},props:{message:{type:Object,default:function(){return{}},required:!0},viewMode:{type:String,default:""}},filters:{formatDateTime:function(t){var e=new Date(t),n=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),l=e.getHours().toString().padStart(2,"0"),c=e.getMinutes().toString().padStart(2,"0"),d=e.getSeconds().toString().padStart(2,"0");return Object(y.u)(e,new Date)?"".concat(l,":").concat(c,":").concat(d):"".concat(n,"/").concat(o,"/").concat(r," ").concat(l,":").concat(c,":").concat(d)}},data:function(){return{defaultAvatar:z,alreadySave:!1,customColor:"#2E9E60",isLoading:!1}},computed:H(H(H({},Object(_.e)("payment",["paymentInfo"])),Object(_.c)("user",["isLoggedIn"])),{},{computedPercentage:function(){return function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).process;return void 0===t?0:t}},convertStatusText:function(){var t,e={userCancelDesc:this.$t("userCancel"),sysCancelDesc:this.$t("systemCancel"),sysTimeoutDesc:this.$t("systemTimeoutCancel")};return null!==(t=this.message)&&void 0!==t&&t.status_desc?e[this.message.status_desc]:""},isShowExpireTime:function(){var t=this.paymentInfo.productLevel,e=this.message.expiration_time,n=[4,3].includes(t),o=e&&e>0,r=!this.alreadySave;return!n&&(o&&r)},getExpireTime:function(){var t=this.message.expiration_time,e=(new Date).getTime();if(t&&t>e){var n=t-e,o=Math.floor(n/864e5);return o?this.$t("TaskExpireTime",{param:o}):this.$t("ExpiresSoon")}return this.$t("TaskExpireTime",{param:0})},isShowCancel:function(){var t=this.message,e=t.status,n=t.category,o=t.type,r=![4,"4"].includes(e),l=![4,5,6,10,11,13,23,"23"].includes(o);return r&&![3,"3"].includes(n)&&l},isVip:function(){var t,e;return!!(null!==(t=this.paymentInfo)&&void 0!==t&&t.activeState||null!==(e=this.paymentInfo)&&void 0!==e&&e.liteActiveState)}}),methods:{handleDeleteTask:function(){var t=this;this.isLoggedIn?this.$confirm(this.$t("deleteTaskConfirm"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){var e=t.message.id;e&&Object(T.f)({ids:[e]}).then((function(){t.$message.success(t.$t("deleteSuccess")),t.$emit("deleteTask",e)}))})):this.$EventBus.$emit("openLoginDialog")},updateImageInfo:function(t,source,e,n){this.$emit("updateImageInfo",t,source,e,n)},deleteSingleImg:function(t){var e=this,n=this.message,o=n.id,r=void 0===o?"":o,l=n.components,c=(void 0===l?[]:l)[t-1].index,d=void 0===c?-1:c;Object(U.b)({id:r,index:d}).then((function(){var t;(e.$message({message:e.$t("deleteSuccess"),type:"success"}),e.message.components=e.message.components.filter((function(t){return t.index!==d})),e.message.components.length)||e.$emit("deleteTask",null==e||null===(t=e.message)||void 0===t?void 0:t.id)}))},retryWork:function(){var data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$emit("onRetryWork",data)},handleCancelTask:function(){this.isLoading||this.$emit("onCancelTask",{info:this.message})},toMall:function(){this.$logEvent("log_actions",{operation:"extend_maturity",behavior_info:"on_swtft_app_detail_page"});var t=this.paymentInfo.productLevel;this.isVip||this.$EventBus.$emit("showBreakDialog","ExpireTimeTipWeb","basic"),this.isVip&&1===t&&this.$EventBus.$emit("showUpgradeDialog","ExpireTimeTipWeb","standard"),this.isVip&&t>=2&&this.$EventBus.$emit("showUpgradeDialog","ExpireTimeTipWeb","professional")}}},J=G,K=(n(2888),Object(P.a)(J,(function(){var t,e,n,o,r,l,c,d,h,m,v,f,_=this,y=_._self._c;return y("div",{staticClass:"c-workflow-history-item"},[y("div",{staticClass:"workflow-history-item-header"},[y("div",{staticClass:"workflow-history-item__title"},[y("img",{staticClass:"workflow-history-item__avatar",attrs:{src:_.defaultAvatar,alt:"Avatar"}}),_._v(" "),y("el-tooltip",{attrs:{effect:"dark",content:null===(t=_.message)||void 0===t||null===(t=t.creativity)||void 0===t?void 0:t.name,placement:"top"}},[y("div",{staticClass:"workflow-history-item__title-task-tag"},[y("span",[_._v(_._s(null===(e=_.message)||void 0===e||null===(e=e.creativity)||void 0===e?void 0:e.name))])])]),_._v(" "),y("div",{staticClass:"workflow-history-item__btn-box"},[y("i",{directives:[{name:"show",rawName:"v-show",value:[3,"3"].includes(_.message.status),expression:"[3,'3'].includes(message.status)"}],staticClass:"iconfont icon-refresh-icon2",on:{click:function(t){return _.retryWork(_.message)}}}),_._v(" "),y("el-popover",{attrs:{trigger:"click","popper-class":"custom-popver"}},[y("div",{staticClass:"task-info-tips"},[y("p",[y("span",[_._v(_._s(_.$t("TaskID")))]),y("span",[_._v(_._s(_.message.id))])]),_._v(" "),3===_.message.status?[[1,2,"1","2"].includes(null===(n=_.message)||void 0===n?void 0:n.pub_community)?y("p",[y("span",{staticClass:"task-info-tips-label"},[_._v(_._s(_.$t("status")))]),_._v(" "),y("span",{staticClass:"task-pub-status"},[_._v(_._s([2,"2"].includes(null===(o=_.message)||void 0===o?void 0:o.pub_community)?_.$t("createSetting1"):_.$t("createSetting2")))])]):_._e(),_._v(" "),y("p",[y("span",{staticClass:"task-info-tips-label"},[_._v(_._s(_.$t("expend")))]),_._v(" "),y("span",{staticClass:"task-info-tips-content"},[y("span",[_._v(_._s(_.$t("tempCoins"))+" :\n                    "+_._s(null===(r=_.message)||void 0===r||null===(r=r.deduction_detail)||void 0===r?void 0:r.temp_hashrate))]),_._v(" "),y("span",[_._v(_._s(_.$t("calculateCoins"))+" :\n                    "+_._s(null===(l=_.message)||void 0===l||null===(l=l.deduction_detail)||void 0===l?void 0:l.hashrate))])])]),_._v(" "),null!==(c=_.message)&&void 0!==c&&null!==(c=c.deduction_detail)&&void 0!==c&&c.history_hashrate?y("p",[y("span",{staticClass:"task-info-tips-label"},[_._v(_._s(_.$t("currentBalance")))]),_._v(" "),y("span",{staticClass:"task-info-tips-content"},[y("span",[_._v(_._s(_.$t("tempCoins"))+" :\n                    "+_._s(null===(d=_.message)||void 0===d||null===(d=d.deduction_detail)||void 0===d?void 0:d.after_temp_hashrate))]),_._v(" "),y("span",[_._v(_._s(_.$t("calculateCoins"))+" :\n                    "+_._s(null===(h=_.message)||void 0===h||null===(h=h.deduction_detail)||void 0===h?void 0:h.after_hashrate))])])]):_._e()]:_._e()],2),_._v(" "),y("i",{staticClass:"iconfont icon-task_tips task-info-icon",attrs:{slot:"reference"},slot:"reference"})]),_._v(" "),y("span",{staticClass:"el-icon-delete task-info-icon",staticStyle:{"margin-left":"5px"},on:{click:_.handleDeleteTask}})],1)],1)]),_._v(" "),y("div",{staticClass:"workflow-history-item__title-time"},[_.message.create_at?y("span",[_._v(" "+_._s(_._f("formatDateTime")(_.message.create_at))+" ")]):_._e(),_._v(" "),y("span",{directives:[{name:"show",rawName:"v-show",value:_.isShowExpireTime,expression:"isShowExpireTime"}],staticClass:"expire-time-text",on:{click:function(t){return t.stopPropagation(),_.toMall.apply(null,arguments)}}},[_._v("\n        "+_._s(_.getExpireTime)+"\n      ")])]),_._v(" "),[2,"2",3,"3"].includes(_.message.status)?y("div",{staticClass:"workflow-history-image-container",class:[1===(null===(m=_.message)||void 0===m||null===(m=m.components)||void 0===m?void 0:m.length)&&"workflow-history-image-container-full"]},[!_.isLoggedIn&&null!==(v=_.message)&&void 0!==v&&null!==(v=v.components)&&void 0!==v&&v.length?y("TryCreateMask",{attrs:{behavior_info:"on_swift_ai_detail_page",reg_source:"swift_ai_detail_page"}}):_._e(),_._v(" "),_._l((null===(f=_.message)||void 0===f?void 0:f.components)||[],(function(t,e){return y("history-img",{key:"list-item_".concat(t.index),attrs:{src:t.url,nsfw:t.nsfw,width:t.width,height:t.height,"operate-number":e+1,"img-info":t,message:_.message},on:{updateImageInfo:_.updateImageInfo,deleteSingleImg:_.deleteSingleImg,saveSuccess:function(t){_.alreadySave=!0}}})}))],2):_._e(),_._v(" "),[1,"1",2,"2",4,"4"].includes(_.message.status)?y("div",{staticClass:"message-process-container"},[[2,"2"].includes(_.message.status)&&_.computedPercentage(_.message)?y("div",{staticClass:"message-process-panel"},[y("el-progress",{attrs:{percentage:_.computedPercentage(_.message),color:_.customColor,"show-text":!1,"stroke-width":7}})],1):_._e(),_._v(" "),y("div",{staticClass:"message-process-operate-box"},[[1,"1"].includes(_.message.status)?[y("span",{staticClass:"process-operate-box-text"},[_._v(_._s(_.$t("TaskStatusWaitingToStart"))+"\n          "),y("span",{staticClass:"message-process-loading-span"})]),_._v(" "),y("QuickQueue",{attrs:{quickOptions:_.message,quickStyle:{height:"26px",fontSize:"12px"}}})]:[2,"2"].includes(_.message.status)&&!_.computedPercentage(_.message)?[y("span",{staticClass:"process-operate-box-text"},[_._v(_._s(_.$t("TaskStatusPreparing"))+"\n          "),y("span",{staticClass:"message-process-loading-span"})])]:[4,"4"].includes(_.message.status)?y("span",{staticClass:"process-operate-box-text",staticStyle:{color:"#da373d"}},[_._v(_._s(_.convertStatusText))]):y("span",{staticClass:"process-operate-box-text"},[_._v(_._s(_.$t("youHaveCompleted"))),y("span",{staticClass:"process-operate-box-text-strong",staticStyle:{"margin-left":"5px"}},[_._v(_._s(_.computedPercentage(_.message))+"%")]),_._v(" "),y("span",{staticClass:"message-process-loading-span"})]),_._v(" "),y("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:_.$t("canceTaskNum",{num:3}),placement:"top"}},[_.isShowCancel?y("el-button",{staticClass:"message-process-operate-box-btn",class:{isLoading:_.isLoading},attrs:{type:"danger",size:"mini"},on:{click:_.handleCancelTask}},[_._v("\n          "+_._s(_.isLoading?"".concat(_.$t("canceling"),"..."):_.$t("CancelJob"))+"\n        ")]):_._e()],1)],2)]):_._e()])}),[],!1,null,"8be2ade2",null)),Y=K.exports,Q=n(297),X=n(53),Z=n(24),tt=n(168),et=n(354);function it(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function at(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?it(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):it(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var nt={name:"workFlowAppDetailHistoryPage",inject:["top"],data:function(){return{viewMode:"list",list:[],loading:!1,queryParams:{limit:10},hasMore:!0,showScroll:!0,debounceHandleScroll:function(){},dialogVisible:!1,viewImageList:[],activeCard:null,currentImageIndex:0}},watch:{},mixins:[Q.a],computed:at(at(at({},Object(_.c)("user",["taskExpireDay","isLoggedIn","userInfo"])),Object(_.e)("payment",["paymentInfo"])),{},{renderCardList:function(){return this.list.filter((function(t){var e;return[3,"3"].includes(t.status)&&(null==t||null===(e=t.components)||void 0===e?void 0:e.length)}))},getExpirationTime:function(){return this.taskExpireDay},isVip:function(){var t,e;return!!(null!==(t=this.paymentInfo)&&void 0!==t&&t.activeState||null!==(e=this.paymentInfo)&&void 0!==e&&e.liteActiveState)},showExpireTime:function(){var t=this.paymentInfo.productLevel,e=[4,3].includes(t);return this.isLoggedIn&&!e&&0!==this.getExpirationTime}}),components:{historyItem:Y,taskImageViewer:tt.a,historyImg:F,NoData:et.a,TryCreateMask:v.a},mounted:function(){var t=this;this.initScrollBar(),this.debounceHandleScroll=Object(Z.debounce)(this.handleScroll,600),this.getList(),this.$EventBus.$on("deleteHistoriesList",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=function(){var n=t.list.filter((function(t){return t.id!=e}));t.$set(t,"list",n),t.top.changeSelectedId("")};if(n.length){var r,l=t.list.findIndex((function(t){return t.id==e}))||0,c=null===(r=t.list)||void 0===r?void 0:r[l];if(c){var d=c.components.filter((function(t){return!n.includes(t.index)}));d.length?t.$set(t.list[l],"components",d):o()}}else o()}))},destroyed:function(){this.debounceHandleScroll=function(){}},methods:{doLogEvent:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={operation:t,behavior_info:"on_comfyui_project_editing_page"};e&&(n.behavior_info_sub=e),this.$logEvent("log_actions",n)},viewBigImage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.activeCard=t,this.viewImageList=[e],this.dialogVisible=!0},closeViewBigImage:function(){this.dialogVisible=!1,this.viewImageList=[],this.activeCard=null},deleteSingleImg:function(t,e){var n=this,o=e||{},r=o.id,l=void 0===r?"":r,c=o.components,d=(void 0===c?[]:c)[t-1].index,h=void 0===d?-1:d;Object(U.b)({id:l,index:h}).then((function(){n.$message({message:n.$t("deleteSuccess"),type:"success"}),n.list.forEach((function(t){var o;t&&(null==t?void 0:t.id)===(null==e?void 0:e.id)&&(n.$set(t,"components",((null==t?void 0:t.components)||[]).filter((function(t){return t.index!==h}))),null!=t&&null!==(o=t.components)&&void 0!==o&&o.length||n.handleDeleteTask(null==t?void 0:t.id))}))}))},updateImageInfo:function(t,source,e,n){var o=this;this.list.forEach((function(r){t&&t===(null==r?void 0:r.id)&&(r.components||[]).forEach((function(t){t.index===source.index&&o.$set(t,e,n)}))}))},insertDataToList:function(t){this.list.unshift(t)},handleDeleteTask:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.list.findIndex((function(e){return e.id===t}));-1!==e&&this.list.splice(e,1),this.top.changeSelectedId("")},changeViewMode:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.doLogEvent(e),this.scrollToTop("instant"),this.viewMode=t},scrollToTop:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{var e=this.$refs.scrollWrapper;if(e){e.scrollTo({top:0,behavior:t})}}catch(t){}},handleRefresh:function(){this.list=[],this.hasMore=!0,this.getList()},addHeadItem:function(t){var e=this,n=t||[],o=Object(l.a)(n,1)[0];this.list.unshift(o),setTimeout((function(){e.$refs.scrollWrapper.scrollTop=0}),0)},getList:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=(null===(t=this.$route.params)||void 0===t||t.id,{limit:20,scene:1});["",null,void 0].includes(n)||(o.time_from=n),this.loading=!0,this.isLoggedIn||(o.g_mode=1),Object(f.f)(o).then((function(t){var n=(null==t?void 0:t.data)||{},r=n.items,l=void 0===r?[]:r,c=n.has_more,d=void 0===c||c;if(e.hasMore=d,null!=o&&o.time_from){var h,v,f=Object(X.e)(e.list,l||[]),_=null===(h=e.$refs)||void 0===h||null===(h=h.scrollWrapper)||void 0===h?void 0:h.scrollHeight;(v=e.list).push.apply(v,Object(m.a)(f)),_&&f.length&&e.scrollToTop(_,"instant")}else e.list=Array.isArray(l)&&null!=l&&l.length?l:[],e.scrollToTop(0,"instant")})).finally((function(){e.loading=!1}))},toMall:function(){this.$logEvent("log_actions",{operation:"extend_maturity",behavior_info:"on_swtft_app_detail_page"});var t=this.paymentInfo.productLevel;this.isVip||this.$EventBus.$emit("showBreakDialog","ExpireTimeTipWeb","basic"),this.isVip&&1===t&&this.$EventBus.$emit("showUpgradeDialog","ExpireTimeTipWeb","standard"),this.isVip&&t>=2&&this.$EventBus.$emit("showUpgradeDialog","ExpireTimeTipWeb","professional")},initScrollBar:function(){var t=this;try{this.$refs.scrollWrapper.addEventListener("scroll",this.initScrollBarStatus),this.$once("hook:beforeDestroy",(function(){t.$refs.scrollWrapper.removeEventListener("scroll",t.initScrollBarStatus)}))}catch(t){}},initScrollBarStatus:function(){this.showScroll=!0},handleScroll:function(){try{var t=this.$refs.scrollWrapper;try{if(0===t.scrollTop&&0===t.scrollHeight)return}catch(t){}var e=(null==t?void 0:t.scrollHeight)-t.scrollTop;e-=null==t?void 0:t.clientHeight,t&&e<=30&&this.hasMore&&this.handleLoadMore()}catch(t){}},handleLoadMore:function(){var t=this.list.length?this.list[this.list.length-1]:"",e=t?t.create_at:"";this.getList(e)},retryWork:function(){var data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$emit("onRetryWork",data)},handleCancelTask:function(){var t=this,e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).info;console.log("info",e);var n=e.id,o=void 0===n?"":n,r={action:5,task_id:o};this.handleUpdateCancelBtnStatus(o,!0),Object(T.r)(r).then((function(e){var n=(e||{}).status,r=(void 0===n?{}:n).code,code=void 0===r?"":r;if([1e4,"10000"].includes(code)){var l=t.list.findIndex((function(t){return t.id===o}));-1!==l&&t.list.splice(l,1)}else[1e4,"10000"].includes(code)||t.handleTaskError(code),t.$logEvent("log_generates",{work_id:o,operation:"cancel_generate"})})).finally((function(){t.handleUpdateCancelBtnStatus(o,!1)}))},handleTaskError:function(code){var t={7e4:this.$t("taskOperateFailed"),70001:this.$t("taskExceededDailyGenerationLimit"),70002:this.$t("taskQueueFull"),70003:this.$t("taskModelVersionNotSupportVariations"),70009:this.$t("taskModelForbidden"),70008:this.$t("taskArtWorkForbidden"),80008:this.$t("InsufficientBalance")};code&&t[code]?this.$message.error(t[code]):this.$message.error(this.$t("ServerError"))},handleUpdateCancelBtnStatus:function(t,e){var n=this;this.list.forEach((function(o){o.id===t&&n.$set(o,"isLoading",e)}))}}},ot=nt,st=(n(2890),Object(P.a)(ot,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-workflow-history-modal"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"scrollWrapper",staticClass:"workflow-history-modal__content",class:["grid"===t.viewMode&&"card-flex-content"],on:{scroll:t.debounceHandleScroll}},["grid"===t.viewMode?[t._l(t.renderCardList,(function(n,i){return[t.isLoggedIn?t._e():e("TryCreateMask",{attrs:{behavior_info:"on_swift_ai_detail_page",reg_source:"swift_ai_detail_page"}}),t._v(" "),t._l((null==n?void 0:n.components)||[],(function(o,r){return[e("history-img",{key:"card-image_".concat(i,"_").concat(r),staticClass:"history-image-card",attrs:{src:o.url,nsfw:o.nsfw,width:o.width,height:o.height,"operate-number":r+1,"img-info":o,message:n},on:{deleteSingleImg:t.deleteSingleImg,updateImageInfo:t.updateImageInfo}})]}))]}))]:t._e(),t._v(" "),"list"===t.viewMode?t._l(t.list,(function(n){return e("history-item",{key:n.id,attrs:{message:n,viewMode:t.viewMode},on:{deleteTask:t.handleDeleteTask,onRetryWork:t.retryWork,onCancelTask:t.handleCancelTask}})})):t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading&&t.list.length&&!t.hasMore,expression:"!loading && list.length && !hasMore"}],staticClass:"workflow-history-modal-no-more"},[t._v("\n      "+t._s(t.$t("workFlow35"))+"\n    ")]),t._v(" "),t.list.length?t._e():e("no-data")],2),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"loadBox"}),t._v(" "),t.dialogVisible?e("task-image-viewer",{staticClass:"message-img-viewer",staticStyle:{"z-index":"9999"},attrs:{"on-close":t.closeViewBigImage,"initial-index":t.currentImageIndex,"show-operate-btn":!1,message:t.activeCard,"url-list":t.viewImageList}}):t._e()],1)}),[],!1,null,"0112d2aa",null).exports),lt=n(56),ct=n(343),ut=n(33),pt=n(39),ht=n(51);function mt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function vt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?mt(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):mt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ft={name:"ContentViewerTop",props:{workFlowAppData:{type:Object,default:function(){}}},components:{Evaluate:ct.a,CollectPopover:lt.a},mixins:[ut.a],data:function(){var t;return{formatNumberForeign:y.i,isFollow:(null===(t=this.workFlowAppData)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.is_follow)||!1}},computed:vt(vt(vt({},Object(_.e)("user",["userInfo"])),Object(_.c)("user",["isLoggedIn"])),{},{original:function(){var t;return 1===(null===(t=this.workFlowAppData.permission)||void 0===t?void 0:t.source)},getUpdateTime:function(){var t;return(null===(t=this.workFlowAppData)||void 0===t?void 0:t.update_at)||""},formatUpdateTime:function(){return this.getUpdateTime?Object(pt.h)(this.getUpdateTime,"yyyy-MM-dd hh:mm:ss"):""},getAuthorHead:function(){var t;return null===(t=this.workFlowAppData)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.head},getHeadStyle:function(){return{"background-color":this.getAuthorHead?"transparent":"#ADB8CD"}},getLetter:function(){var t,e=(null===(t=this.workFlowAppData)||void 0===t?void 0:t.author)||{},n=e.id,o=void 0===n?"":n,r=e.name,l=void 0===r?"":r;return l?l[0].toUpperCase():o[0].toUpperCase()},isShowJumper:function(){var t,e=this.workFlowAppData,n=e.author,o=void 0===n?{}:n,r=e.type;return(null===(t=this.userInfo)||void 0===t?void 0:t.id)===(null==o?void 0:o.id)&&4!=r}}),methods:{getPersonalInfoUrl:function(){var t,e,n=(null===(t=this.workFlowAppData)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id)||"",o=(null===(e=this.userInfo)||void 0===e?void 0:e.id)||"",path="/user/"+encodeURIComponent(n);return o==n&&(path="/personal"),path},jumpToOtherUser:function(){var path=this.getPersonalInfoUrl();this.$router.push(this.localePath(path))},goWorkflow:function(){var t,e=this.workFlowAppData,n=e.id,o=void 0===n?"":n,r=e.author,l=void 0===r?{}:r,path="/workflow?id="+o+"&source="+((null===(t=this.userInfo)||void 0===t?void 0:t.id)===(null==l?void 0:l.id)?3:4)+"&source_id="+o;this.$router.push(this.localePath({path:path}))},goPublish:function(){var t,e=(null===(t=this.$route.params)||void 0===t?void 0:t.id)||"",path="/workflow/publish/".concat(e,"?template_id=").concat(e);window.open(path,"_blank")},handleMark:function(){this.isLoggedIn?this.setCollectData(this.workFlowAppData).includes("icon-collect_selected")?(this.$refs.collectPopover.visible=!1,this.setCollect(this.workFlowAppData,"swtft_app")):this.$refs.collectPopover.visible=!0:this.$EventBus.$emit("openLoginDialog")},setFollowUser:function(t){var e,n=this,o={follow_account_no:(null===(e=this.workFlowAppData)||void 0===e?void 0:e.author).id||""};(t?ht.l:ht.o)(o).then((function(){n.isFollow=!t}))}}},gt=(n(2891),Object(P.a)(ft,(function(){var t,e,n,o,r,l,c,d=this,h=d._self._c;return h("div",{staticClass:"content-viewer-top"},[h("div",{staticClass:"content-viewer-top-info space-between"},[h("div",{staticClass:"content-viewer-top-info-left flex_m"},[h("div",{staticClass:"content-viewer-top-info-type flex-center"},[h("svg-icon",{attrs:{"icon-class":d.original?"modelOriginal":"modelReship"}}),d._v(" "),h("div",{staticClass:"txt"},[d._v(d._s(d.$t(d.original?"Original":"Reship")))])],1),d._v(" "),h("h1",{staticClass:"title overflow-ellipsis"},[d._v("\n        "+d._s(d.workFlowAppData.name)+"\n      ")]),d._v(" "),d.workFlowAppData.id?h("Evaluate",{staticClass:"evaluate-box",attrs:{from:"comfyuiAppDetail",evaluateData:d.workFlowAppData}}):d._e()],1)]),d._v(" "),h("div",{staticClass:"content-viewer-top-info space-user"},[null!==(t=d.workFlowAppData)&&void 0!==t&&t.author?h("div",{staticClass:"content-viewer-top-info-author"},[h("div",{staticClass:"head",style:d.getHeadStyle,on:{click:d.jumpToOtherUser}},[d.getAuthorHead?h("img",{directives:[{name:"webp",rawName:"v-webp",value:d.$imgL,expression:"$imgL"}],staticClass:"avatar",attrs:{src:d.getAuthorHead,alt:"avatar"}}):h("div",{staticClass:"letter"},[d._v("\n          "+d._s(d.getLetter)+"\n        ")])]),d._v(" "),h("div",{staticClass:"name flex-center overflow-ellipsis",on:{click:d.jumpToOtherUser}},[h("a",{staticClass:"personal-info-a overflow-ellipsis",attrs:{href:d.getPersonalInfoUrl(),rel:"nofollow"},on:{click:function(t){t.preventDefault()}}},[d._v("\n          "+d._s((null===(e=d.workFlowAppData)||void 0===e?void 0:e.author.name)||(null===(n=d.workFlowAppData)||void 0===n?void 0:n.author.id))+"\n        ")])])]):d._e(),d._v(" "),h("div",{staticClass:"follow-btn",on:{click:function(t){return d.setFollowUser(d.isFollow)}}},[d._v("\n      "+d._s(d.isFollow?d.$t("Followed"):d.$t("Follows"))+"\n    ")]),d._v(" "),d.getUpdateTime?h("div",{staticClass:"content-viewer-top-info-date"},[d._v("\n      "+d._s(d.formatUpdateTime)+" "+d._s(d.$t("renew"))+"\n    ")]):d._e(),d._v(" "),h("div",{staticClass:"content-viewer-top-info-right"},[h("div",{staticClass:"view-num"},[h("i",{staticClass:"iconfont icon-creation-center-icon"}),d._v(" "),h("span",{staticClass:"collect-num count"},[d._v(d._s(d.formatNumberForeign(null===(o=d.workFlowAppData)||void 0===o||null===(o=o.stat)||void 0===o?void 0:o.num_of_task)))])]),d._v(" "),h("div",{staticClass:"collect",on:{click:d.handleMark}},[h("CollectPopover",{ref:"collectPopover",attrs:{hideBtn:!0,type:"swtft_app",folder:d.workFlowAppData}},[h("div",{staticClass:"bntItem collectBnt"},[h("i",{staticClass:"iconfont",class:d.setCollectData(d.workFlowAppData)})]),d._v(" "),null!==(r=d.workFlowAppData)&&void 0!==r&&null!==(r=r.stat)&&void 0!==r&&r.num_of_collection?h("span",{staticClass:"collect-num"},[d._v(d._s(d.formatNumberForeign(null===(l=d.workFlowAppData)||void 0===l||null===(l=l.stat)||void 0===l?void 0:l.num_of_collection)))]):d._e()])],1),d._v(" "),h("div",{staticClass:"view-num"},[h("i",{staticClass:"iconfont icon-work-show"}),d._v(" "),h("span",{staticClass:"collect-num count"},[d._v(d._s(d.formatNumberForeign(null===(c=d.workFlowAppData)||void 0===c||null===(c=c.stat)||void 0===c?void 0:c.num_of_view)))])]),d._v(" "),h("div",{staticClass:"view-num share-btn flex_c_m",on:{click:function(t){return d.$emit("onHandShare")}}},[h("i",{staticClass:"iconfont icon-share-icon"}),d._v("\n        "+d._s(d.$t("ShareLink"))+"\n      ")]),d._v(" "),h("el-popover",{attrs:{placement:"bottom-end","popper-class":"workflow-app-popover jumper","append-to-body":!1,"visible-arrow":!1,trigger:"hover"}},[h("div",{staticClass:"content"},[h("div",{staticClass:"item",on:{click:d.goWorkflow}},[d._v("\n            "+d._s(d.$t("comfyui_enter"))+" ComfyUI\n          ")]),d._v(" "),h("div",{staticClass:"item",on:{click:d.goPublish}},[d._v("\n            "+d._s(d.$t("workflow_app_publish"))+"\n          ")])]),d._v(" "),h("i",{directives:[{name:"show",rawName:"v-show",value:d.isShowJumper,expression:"isShowJumper"}],staticClass:"icon-jumper iconfont icon-edit-03",attrs:{slot:"reference"},slot:"reference"})])],1)])])}),[],!1,null,"c1fd0f76",null).exports),_t=n(25);function bt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var yt={data:function(){return{isShowDialog:!1,message:{}}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bt(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(_.c)("user",["isCompanyAccount"])),methods:{openDialog:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.isShowDialog=!0,this.message=t},closeDialog:function(){this.isShowDialog=!1,this.message={}}}},wt=yt,Ct=(n(2892),Object(P.a)(wt,(function(){var t,e,n,o,r,l,c,d,h,m=this,v=m._self._c;return v("el-dialog",{staticClass:"consume-dialog custom-dialog-canvas",attrs:{width:"475px","append-to-body":"",visible:m.isShowDialog,"close-on-click-modal":!1},on:{"update:visible":function(t){m.isShowDialog=t}}},[v("div",{staticClass:"task-info-tips"},[v("p",[v("span",[m._v("\n\t\t\t\t"+m._s(m.$t("TaskID"))+"\n\t\t\t")]),m._v(" "),v("span",[m._v("\n\t\t\t\t"+m._s(null===(t=m.message)||void 0===t?void 0:t.id)+"\n\t\t\t")])]),m._v(" "),3!==(null===(e=m.message)||void 0===e?void 0:e.status)||m.isCompanyAccount?m._e():[[1,2,"1","2"].includes(null===(n=m.message)||void 0===n?void 0:n.pub_community)?v("p",[v("span",{staticClass:"task-info-tips-label"},[m._v(m._s(m.$t("status")))]),m._v(" "),v("span",{staticClass:"task-pub-status"},[m._v("\n\t\t\t\t\t"+m._s([2,"2"].includes(null===(o=m.message)||void 0===o?void 0:o.pub_community)?m.$t("createSetting1"):m.$t("createSetting2"))+"\n\t\t\t\t")])]):m._e(),m._v(" "),v("p",[v("span",{staticClass:"task-info-tips-label"},[m._v(m._s(m.$t("expend")))]),m._v(" "),v("span",{staticClass:"task-info-tips-content"},[v("span",[m._v("\n\t\t\t\t\t\t"+m._s(m.$t("tempCoins"))+" :\n\t\t\t\t\t\t"+m._s(null===(r=m.message)||void 0===r||null===(r=r.deduction_detail)||void 0===r?void 0:r.temp_hashrate)+"\n\t\t\t\t\t")]),m._v(" "),v("span",[m._v("\n\t\t\t\t\t\t"+m._s(m.$t("calculateCoins"))+" :\n\t\t\t\t\t\t"+m._s(null===(l=m.message)||void 0===l||null===(l=l.deduction_detail)||void 0===l?void 0:l.hashrate)+"\n\t\t\t\t\t")])])]),m._v(" "),null!==(c=m.message)&&void 0!==c&&null!==(c=c.deduction_detail)&&void 0!==c&&c.history_hashrate?v("p",[v("span",{staticClass:"task-info-tips-label"},[m._v(m._s(m.$t("currentBalance")))]),m._v(" "),v("span",{staticClass:"task-info-tips-content"},[v("span",[m._v("\n\t\t\t\t\t\t"+m._s(m.$t("tempCoins"))+" :\n\t\t\t\t\t\t"+m._s(null===(d=m.message)||void 0===d||null===(d=d.deduction_detail)||void 0===d?void 0:d.after_temp_hashrate)+"\n\t\t\t\t\t")]),m._v(" "),v("span",[m._v("\n\t\t\t\t\t\t"+m._s(m.$t("calculateCoins"))+" :\n\t\t\t\t\t\t"+m._s(null===(h=m.message)||void 0===h||null===(h=h.deduction_detail)||void 0===h?void 0:h.after_hashrate)+"\n\t\t\t\t\t")])])]):m._e()]],2)])}),[],!1,null,"97cd6198",null).exports),kt={name:"ContentViewerImages",inject:["top"],props:{workFlowAppData:{type:Object,default:function(){}}},components:{ConsumePopover:Ct,ElImageViewer:x.a},data:function(){return{isDescOverSize:!1,isShowMoreDesc:!0,currentIndex:1,displayMode:"default",imgBtns:[{icon:"icon-icon_xiazai",key:"download",label:"Download"},{icon:"icon-baocun",key:"save",label:"Save"},{icon:"icon-shanchu3",key:"delete",label:"Delete"}],thumbnailTopStatus:"edit",selectedArr:[],dialogVisible:!1,isTwo:!1,threeCarouse:!1}},computed:{getProgress:function(){return this.workFlowAppData.progress},getList:function(){var t=this.workFlowAppData,e=t.selectedId,n=t.histories,o={};e&&(o=n&&n.find((function(t){return t.id==e}))||{});var r=e?o.components:this.workFlowAppData.samples,l=[],c=[];if(r.forEach((function(t,e){c.push(t);var n=e+1;(n%2==0||1===r.length||n%2!=0&&n===r.length)&&(l.push(c),c=[])})),this.isTwo=2===l.length,this.isTwo){var d=l;l=l.concat(d)}return l},getSamples:function(){var t=this.workFlowAppData,e=t.selectedId,n=t.histories,o={};return e&&(o=n&&n.find((function(t){return t.id==e}))||{}),e?o.components:this.workFlowAppData.samples},handleCarousel:function(){return[{twoBox:this.isTwo},{elseBox:!this.isTwo},{isTowCarouse:this.isTwo&&!this.threeCarouse},{isThreeCarouse:this.threeCarouse}]},filterXss:function(){return function(t){return _t.default.prototype.xss(t)}},getMoreClass:function(){return[this.isShowMoreDesc?"is-open":"is-close"]},operateBtns:function(){var t="default"==this.displayMode;return[{icon:"icon-SVG2",key:"checkInfos",label:"ViewOriginalDescription"},{icon:"icon-icon_grid",key:"thumbnailView",label:"ThumbnailDisplay",hide:!t},{icon:"icon-morenzhanshi",key:"defaultView",label:"DefaultDisplay",hide:t},{icon:"icon-baocun",key:"saveAll",label:"SaveAllPictures"},{icon:"icon-shanchu3",key:"deleteAll",label:"DeleteAllPictures"}]},isShowOperates:function(){var t;return null===(t=this.workFlowAppData)||void 0===t?void 0:t.selectedId},isVideo:function(){return function(t){return Object(y.v)(t)}},getViewerSrc:function(){return this.getSamples.map((function(t){return t.url}))}},watch:{"workFlowAppData.desc":{handler:function(){var t=this;this.$nextTick((function(){try{var e=document.querySelector(".content-viewer-desc")||{};t.isDescOverSize=(null==e?void 0:e.offsetHeight)>24}catch(t){}}))},immediate:!0},dialogVisible:function(t){try{document.body.style.overflow=t?"hidden":""}catch(t){document.body.style.overflow=""}}},mounted:function(){this.$EventBus.$on("$E_sethandleSwiper",this.sethandleSwiper)},methods:{handlePrev:function(){var t=this.$refs.carousel;t&&t.prev()},handleNext:function(){var t=this.$refs.carousel;t&&t.next()},handleSwiper:function(t){this.threeCarouse=this.isTwo&&t>=2,this.currentIndex=t+1},sethandleSwiper:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.$refs.carousel;this.currentIndex=t+1,e&&e.setActiveItem(t)},getMessage:function(){var t=this.workFlowAppData,e=t.selectedId,n=void 0===e?"":e,o=t.histories;return(void 0===o?[]:o).find((function(t){return t.id==n}))},handleOperate:function(t){var e=this;switch(t){case"checkInfos":var n=this.getMessage();this.$refs.consumePopover.openDialog(n);break;case"thumbnailView":this.displayMode="thumbnail";break;case"defaultView":this.displayMode="default";break;case"saveAll":this.handleSaveTask();break;case"deleteAll":this.$confirm(this.$t("deleteConfirm"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){e.handleDeleteTask()}))}},handleSaveTask:function(){var t=this,e=this.workFlowAppData.selectedId,n=void 0===e?"":e;if(n){var o=this.getSamples.map((function(t){return{folder_no:"default",id:n,index:t.index}}));Object(f.c)({items:o}).then((function(){t.$EventBus.$emit("saveHistories",n),t.$message.success(t.$t("SaveToPersonalCenter"))}))}},handleDeleteTask:function(){var t=this,e=this.workFlowAppData.selectedId,n=void 0===e?"":e;n&&Object(T.f)({ids:[n]}).then((function(){t.$message.success(t.$t("deleteSuccess")),t.initData(),t.$EventBus.$emit("deleteHistories",n),t.$EventBus.$emit("deleteHistoriesList",n)}))},initData:function(){this.currentIndex=1,this.displayMode="default",this.thumbnailTopStatus="edit",this.selectedArr=[],this.top.changeSelectedId("")},handleBigPic:function(i,t){this.currentIndex=2*i+t,this.dialogVisible=!0}}},xt=kt,Ot=(n(2893),Object(P.a)(xt,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"content-viewer-images"},[null!==(t=e.workFlowAppData)&&void 0!==t&&t.desc?n("div",{staticClass:"content-viewer-images-top",class:e.getMoreClass},[n("div",{staticClass:"content-viewer-desc",domProps:{innerHTML:e._s(e.filterXss(e.workFlowAppData.desc))}}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isDescOverSize,expression:"isDescOverSize"}],staticClass:"switch-btn",on:{click:function(t){e.isShowMoreDesc=!e.isShowMoreDesc}}},[e._v("\n      "+e._s(e.isShowMoreDesc?e.$t("PackUp"):e.$t("more"))+"\n      "),n("i",{staticClass:"el-icon-arrow-up"})])]):e._e(),e._v(" "),n("div",{staticClass:"content-viewer-images-contents"},[n("el-popover",{attrs:{placement:"bottom-end","popper-class":"workflow-app-popover operate","append-to-body":!1,"visible-arrow":!1,trigger:"hover"}},[n("div",{staticClass:"content"},e._l(e.operateBtns,(function(t){return n("div",{directives:[{name:"show",rawName:"v-show",value:!t.hide,expression:"!item.hide"}],key:t.key,staticClass:"item",on:{click:function(n){return e.handleOperate(t.key)}}},[n("i",{staticClass:"iconfont",class:t.icon}),e._v(" "),n("div",{staticClass:"label"},[e._v("\n            "+e._s(e.$t(t.label))+"\n          ")])])})),0),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"more-operates flex-center",attrs:{slot:"reference"},slot:"reference"},[n("i",{staticClass:"iconfont icon-menu"})])]),e._v(" "),n("div",{class:e.handleCarousel},[n("el-carousel",{directives:[{name:"show",rawName:"v-show",value:"default"==e.displayMode,expression:"displayMode == 'default'"}],ref:"carousel",staticClass:"carouselBox",attrs:{"indicator-position":e.getList.length>1?"outside":"none",arrow:e.getList.length>1?"always":"never",autoplay:!1,"initial-index":e.currentIndex-1},on:{change:e.handleSwiper}},e._l(e.getList,(function(t,o){return n("el-carousel-item",{key:"img-".concat(t.index||o),staticClass:"swiper-item"},e._l(e.getList[o],(function(t,r){return n("div",{key:r,staticClass:"swiper-item-box"},[e.isVideo(t.url)?n("video",{staticClass:"video",attrs:{autoplay:"",muted:"",loop:"",controls:"",src:t.url},domProps:{muted:!0}}):n("div",{staticClass:"cover-box"},[n("img",{staticClass:"picture",attrs:{src:t.url,alt:e.workFlowAppData.desc},on:{click:function(t){return e.handleBigPic(o,r)}}})])])})),0)})),1)],1)],1),e._v(" "),n("ConsumePopover",{ref:"consumePopover"}),e._v(" "),e.dialogVisible?n("el-image-viewer",{staticClass:"message-img-viewer",staticStyle:{"z-index":"9999"},attrs:{"initial-index":e.currentIndex,"on-close":function(){return e.dialogVisible=!1},"url-list":e.getViewerSrc}}):e._e()],1)}),[],!1,null,"f9bd351a",null).exports);function $t(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Dt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$t(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$t(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var St={name:"ContentViewerHistories",inject:["top"],props:{workFlowAppData:{type:Object,default:function(){}}},mixins:[Q.a],data:function(){return{debounceHandleScroll:null,loading:!1,hasMore:!0,list:[],isOpen:!0,scrollHeight:0}},mounted:function(){var t=this;this.updateScrollHeight(),this.debounceHandleScroll=Object(Z.debounce)(this.handleScroll,600),this.$EventBus.$on("saveHistories",(function(e){t.list.find((function(t){return t.id==e})).expiration_time=-1})),this.$EventBus.$on("addHistories",(function(e,n){var o,r;"front"==e?(o=t.list).unshift.apply(o,Object(m.a)(n)):(r=t.list).push.apply(r,Object(m.a)(n))})),this.$EventBus.$on("deleteHistories",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=function(){var n=t.list.filter((function(t){return t.id!=e}));t.$set(t,"list",n),t.top.changeSelectedId("")};if(n.length){var r,l=t.list.findIndex((function(t){return t.id==e}))||0,c=null===(r=t.list)||void 0===r?void 0:r[l];if(c){var d=c.components.filter((function(t){return!n.includes(t.index)}));d.length?t.$set(t.list[l],"components",d):o()}}else o()}))},beforeDestroy:function(){this.debounceHandleScroll=null,this.$EventBus.$off("saveHistories"),this.$EventBus.$off("addHistories"),this.$EventBus.$off("deleteHistories")},computed:Dt(Dt({},Object(_.c)("user",["isLoggedIn","taskExpireDay"])),{},{getGroups:function(){return this.list.filter((function(t){return["waiting","processing","finish"].includes(t.status_desc)}))},getClasses:function(){var t=this;return function(e){var n;return{active:(null==e?void 0:e.id)==(null===(n=t.workFlowAppData)||void 0===n?void 0:n.selectedId),disabled:["waiting","processing"].includes(e.status_desc)}}},getCircumference:function(){return function(progress){return"".concat(29*Math.PI*(3.6*progress/180)," 1000")}},isVideo:function(){return function(t){return Object(y.v)(t)}},isShowExpireTime:function(){return function(t){return t&&t>0}},getExpireTime:function(){var t=this;return function(e){var n=(new Date).getTime();if(e&&e>n){var o=e-n,r=Math.floor(o/864e5);return r?t.$t("num_days",{param:r}):t.$t("ExpiresSoon")}return t.$t("num_days",{param:0})}},getStyle:function(){return{maxHeight:this.isOpen?"".concat(this.scrollHeight+20,"px"):"0px",padding:this.isOpen?"10px 0":"0px",borderTop:this.isOpen?"1px solid rgba(255, 255, 255, 0.06)":"0"}},getExpirationTime:function(){return this.taskExpireDay}}),watch:{isLoggedIn:{handler:function(t){this.hasMore=!0,this.list=[],t&&this.getList()},immediate:!0},list:{handler:function(t){this.updateScrollHeight(),this.top.updateHistories(t)},deep:!0,immediate:!0}},methods:{handleScroll:function(){try{var t=this.$refs.scrollWrapper;try{if(0===t.scrollTop&&0===t.scrollHeight)return}catch(t){}var e=(null==t?void 0:t.scrollHeight)-t.scrollTop;if(e-=null==t?void 0:t.clientHeight,t&&e<=30&&this.hasMore){var n=this.list.length,o=n?this.list[n-1]:"",r=o?o.create_at:"";this.getList(r)}}catch(t){}},getList:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o={limit:50,template_id:(null===(t=this.$route.params)||void 0===t?void 0:t.id)||""};n&&(o.time_from=n),this.loading=!0,Object(f.f)(o).then((function(t){var n,o=(null==t?void 0:t.data)||{},r=o.items,l=o.has_more,c=void 0===l||l;e.hasMore=c,(n=e.list).push.apply(n,Object(m.a)(r||[]))})).finally((function(){e.loading=!1}))},handleClick:function(t){var e=t.status_desc;["waiting","processing"].includes(e)||this.top.changeSelectedId((null==t?void 0:t.id)||"")},handleCollapseClick:function(){this.isOpen=!this.isOpen,this.updateScrollHeight()},updateScrollHeight:function(){var t=this;this.$nextTick((function(){var e;t.scrollHeight=(null===(e=t.$refs.content)||void 0===e?void 0:e.scrollHeight)||0}))},toMall:function(){this.$router.push(this.localePath({path:"/mall"}))}}},It=St,Tt=(n(2894),Object(P.a)(It,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"content-viewer-histories"},[e("div",{staticClass:"collapse-components-top",on:{click:t.handleCollapseClick}},[e("span",{staticClass:"collapse-components-top-title"},[e("span",[t._v(t._s(t.$t("workFlow11")))]),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:![void 0,0,null,""].includes(t.getExpirationTime),expression:"![undefined, 0, null, ''].includes(getExpirationTime)"}],staticClass:"longest-expiration-time"},[e("span",{staticClass:"times"},[t._v("\n\t\t\t\t\t"+t._s(t.$t("workFlow5",{num:t.getExpirationTime}))+"\n\t\t\t\t")]),t._v(" "),e("span",{staticClass:"to-mall",on:{click:function(e){return e.stopPropagation(),t.toMall.apply(null,arguments)}}},[t._v("\n\t\t\t\t\t"+t._s(t.$t("workFlow4"))+"\n\t\t\t\t")])])]),t._v(" "),e("i",{staticClass:"el-icon-arrow-down collapse-components-top-icon",class:{"is-open":t.isOpen}})]),t._v(" "),e("div",{ref:"content",staticClass:"collapse-components-content",style:t.getStyle},[t.getGroups.length?e("div",{ref:"scrollWrapper",staticClass:"content-viewer-histories-images",on:{scroll:t.debounceHandleScroll}},t._l(t.getGroups,(function(n,o){var r,l,c,d;return e("div",{key:"group-".concat(o),staticClass:"item-group flex-center",class:t.getClasses(n),on:{click:function(e){return t.handleClick(n)}}},["finish"==n.status_desc?e("div",{staticClass:"item-group-generated"},[t.isVideo(null==n||null===(r=n.components)||void 0===r||null===(r=r[0])||void 0===r?void 0:r.url)?e("video",{staticClass:"video",attrs:{autoplay:"",muted:"",loop:"",controls:!1,src:null==n||null===(l=n.components)||void 0===l||null===(l=l[0])||void 0===l?void 0:l.url},domProps:{muted:!0}}):e("img",{staticClass:"picture",attrs:{src:null==n||null===(c=n.components)||void 0===c||null===(c=c[0])||void 0===c?void 0:c.url,alt:"group image"}}),t._v(" "),e("div",{staticClass:"img-num flex-center"},[e("i",{staticClass:"iconfont icon-imgNum"}),t._v(" "),e("span",[t._v(t._s((null==n||null===(d=n.components)||void 0===d?void 0:d.length)||0))])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowExpireTime(null==n?void 0:n.expiration_time),expression:"isShowExpireTime(item?.expiration_time)"}],staticClass:"expiration-time flex-center"},[t._v("\n\t\t\t\t\t\t"+t._s(t.getExpireTime(null==n?void 0:n.expiration_time))+"\n\t\t\t\t\t")])]):e("div",{staticClass:"item-group-generating flex-center"},[e("div",{staticClass:"progress"},[t._v(t._s(n.process)+" %")]),t._v(" "),e("svg",{staticClass:"progress-ring",attrs:{width:"62",height:"62"}},[e("circle",{staticClass:"progress-ring-circle",attrs:{"stroke-dasharray":t.getCircumference(n.process),"stroke-dashoffset":0,r:"29",cx:"31",cy:"31",fill:"transparent","stroke-width":"3"}})])])])})),0):e("div",{staticClass:"content-viewer-histories-empty flex-center"},[t._v("\n\t\t\t-- "+t._s(t.$t("workFlow35"))+" -- ~\n\t\t")])])])}),[],!1,null,"669f84a8",null)),jt=Tt.exports,Lt=n(387),Pt=n(268),Mt=n(21),Et=n(64);function At(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Nt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?At(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):At(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Rt={mixins:[ut.a,Lt.a],components:{comfyItem:Pt.a,SwipeableList:Et.a},props:{list:{type:Array,default:function(){return[]}}},data:function(){return{dataList:this.list,contentStyle:{width:"100%"}}},computed:Nt(Nt(Nt({},Object(_.c)("user",["isLoggedIn","accountSettingsData"])),Object(_.e)("user",["userInfo","accountData"])),{},{getList:function(){var t=this,e=[],n=[];return this.list.forEach((function(o,r){n.push(o);var l=r+1;(l%5==0||1===t.list.length||l%5!=0&&l===t.list.length)&&(e.push(n),n=[])})),e}}),methods:Nt(Nt({},Object(_.b)("user",["getAccountInfo"])),{},{moreActions:function(t,e){var n=this,o=e.id,r=void 0===o?"":o,l=e.obj_type;switch(t){case"delete":this.$logEvent("log_actions",{operation:"click_delete",behavior_info:"on_personal_center",behavior_info_sub:l});this.$confirm(this.$t({13:"comfyui_delete_tips"}[l]||"canvas_delete_tips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){Object(Mt.g)({ids:[r],category:2,obj_type:l}).then((function(t){var e;1e4==(null==t||null===(e=t.status)||void 0===e?void 0:e.code)&&n.$message({message:n.$t("deleteSuccess"),type:"success"})}))})).catch((function(t){console.log("err",t)}));break;case"pinOrNot":this.$logEvent("log_actions",{operation:"click_top_to_overview",behavior_info:"on_personal_center",behavior_info_sub:l});var c={obj_id:r,obj_type:l};null!=e&&e.isTop&&(c.up_type="down"),Object(Mt.I)(c).then((function(t){var o;1e4==(null==t||null===(o=t.status)||void 0===o?void 0:o.code)&&(n.$message({message:n.$t(null!=e&&e.isTop?"UnpinSuccess":"PinSuccess"),type:"success"}),n.$set(e,"isTop",!e.isTop))}))}},handleBox:function(t){var e=t.id,n=t.obj_type,o=t.ai_video,r=t.pt;n=o?n+"_"+(null==o?void 0:o.video_type):n,this.$logEvent("log_actions",{operation:"click",obj_type:n,behavior_info:e,behavior_info_sub:r})},handleRefresh:function(){},adminHandle:function(t){this.setWaterFallDeleteLits(t)}})};n(2895);function Bt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Ft(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Bt(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Bt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ut={components:{Recommend:Object(P.a)(Rt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"homeList"},[e("SwipeableList",{attrs:{top:"0px",contentStyle:t.contentStyle}},[e("div",{staticClass:"scroll-box"},t._l(t.getList,(function(n,o){return e("div",{key:o,staticClass:"scroll-item"},t._l(t.getList[o],(function(n,o){return e("div",{key:n.id||o,staticClass:"box marking-item",on:{click:function(e){return t.handleBox(n)}}},[13==n.obj_type||14==n.obj_type?e("comfyItem",{attrs:{item:n,list:t.dataList},on:{moreActions:t.moreActions,change:function(e){return t.adminHandle(n.id)}}}):t._e()],1)})),0)})),0)])],1)}),[],!1,null,"3459c706",null).exports},data:function(){return{isReq:!1,listData:[],pageObj:{page:1,page_size:20,offset:0},formData:{order_by:"recommend",comfy_ui_type:2,run_available:0,batch:1}}},mounted:function(){this.getList()},methods:{getList:function(){var t=this;if(!this.isReq){this.isReq=!0;var e=this.$route.params,param=Ft(Ft(Ft({},this.pageObj),this.formData),{},{id:e.id});Object(ht.b)(param).then((function(e){var n,o,r=(null===(n=e.data)||void 0===n?void 0:n.items)||[];t.listData=t.listData.concat(r),t.pageObj.offset=(null===(o=e.data)||void 0===o?void 0:o.offset)||0,t.pageObj.page++,t.isReq=!1})).catch((function(){t.isReq=!1}))}}}},Vt=(n(2896),Object(P.a)(Ut,(function(){var t=this,e=t._self._c;return e("div",[e("p",{staticClass:"workapp-title"},[t._v(t._s(t.$t("relatedRecommend")))]),t._v(" "),e("div",{staticClass:"anli-workapp-box"},[e("Recommend",{attrs:{list:t.listData,container:"wraperWorkApp",cols:1,closeVirtualList:!1,isReverseLoad:!0,boxId:"anLiwraperWorkApp"},on:{onReverseLoad:t.getList}})],1)])}),[],!1,null,"e65f179e",null).exports),qt={model:{prop:"actVal",event:"onChange"},props:{actVal:{type:Number,default:1},bline:{type:Boolean,default:!0},list:{type:Array,default:function(){return[]}}},data:function(){return{formatNumberForeign:y.i}},methods:{changeTab:function(t){this.$emit("onChange",t.value)}}},Wt=(n(2897),Object(P.a)(qt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"tabs-box flex",class:t.bline&&"tab-bline"},t._l(t.list,(function(n){return e("div",{key:n.value,staticClass:"item flex_m",class:t.actVal===n.value&&"active",on:{click:function(e){return t.changeTab(n)}}},[e("span",[t._v(t._s(t.$t(n.label)))]),t._v(" "),n.icon?e("i",{class:[n.icon]}):t._e(),t._v(" "),n.vnum?e("div",{staticClass:"num-text flex_m"},[t._v("\n      "+t._s(t.formatNumberForeign(n.vnum||0))+"\n    ")]):t._e()])})),0)}),[],!1,null,"a0b5a732",null).exports),Ht=n(40),zt=n(55),Gt=n(167),Jt=n(557),Kt=n(558);function Yt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Qt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Yt(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Yt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Xt={components:{homeList:zt.a,PageSeo:Gt.a,NoData:et.a,PreferenceSelect:Jt.a,TimerSelect:Kt.a},inject:["top"],data:function(){return{isReq:!1,listData:[],pageObj:{page:1,page_size:35,offset:0},formData:{order_by:"new",timeType:"All",time_from:null,time_to:null},orderbyList:[{name:"Hot",id:"hot",icon:"hot",show:!0},{name:"New",id:"new",icon:"new1",show:!0}]}},computed:Qt(Qt({},Object(_.e)("user",["token"])),{},{hasTemp:function(){var t;return(null===(t=this.top.pageSEO)||void 0===t||null===(t=t.tempList)||void 0===t?void 0:t.length)>0},hasLogin:function(){return!!this.token},waterfallHeight:function(){return this.listData.length>4?700:350}}),mounted:function(){this.getList()},methods:{getList:function(){var t,e=this;if(!this.isReq){this.isReq=!0;var n=(null===(t=this.$route.params)||void 0===t?void 0:t.id)||"",o=this.formData,r=o.time_from,l=o.time_to,c=o.order_by,param=Qt(Qt({},this.pageObj),{},{order_by:c,time_from:r,time_to:l,relation_no:n});Object(Ht.squareList)(param).then((function(t){var n,o,r=(null===(n=t.data)||void 0===n?void 0:n.items)||[];e.listData=e.listData.concat(r),e.pageObj.offset=(null===(o=t.data)||void 0===o?void 0:o.offset)||0,e.pageObj.page++,e.isReq=!1})).catch((function(){e.isReq=!1}))}},openLogin:function(){this.$logEvent("log_actions",{operation:"login_in_now",behavior_info:"on_swtft_app_detail_page"}),this.$EventBus.$emit("openLoginDialog")},changeTime:function(data){var t=data.startTime,e=data.endTime;this.formData.time_from=t,this.formData.time_to=e,this.listData=[],this.pageObj.page=1,this.pageObj.offset=0,this.getList()},changePreference:function(){this.listData=[],this.pageObj.page=1,this.pageObj.offset=0,this.getList(),this.$logEvent("log_actions",{operation:"click_filter",behavior_info:this.formData.order_by})}}},Zt=(n(2900),Object(P.a)(Xt,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"workseo-box"},[n("div",{staticClass:"screen-box"},[n("TimerSelect",{staticClass:"item",on:{onChangeItem:e.changeTime},model:{value:e.formData.timeType,callback:function(t){e.$set(e.formData,"timeType",t)},expression:"formData.timeType"}}),e._v(" "),n("PreferenceSelect",{staticClass:"item",attrs:{list:e.orderbyList},on:{onChange:e.changePreference},model:{value:e.formData.order_by,callback:function(t){e.$set(e.formData,"order_by",t)},expression:"formData.order_by"}})],1),e._v(" "),n("div",{staticClass:"wraper-seo",class:!e.hasLogin&&"nologin-work",style:{height:e.hasLogin?"auto":e.waterfallHeight+"px"}},[n("div",{ref:"wraper",staticClass:"wraper"},[n("homeList",{attrs:{list:e.listData,container:"wraper",workAppParam:{isLogin:e.hasLogin,height:e.waterfallHeight},closeVirtualList:!1,isReverseLoad:!0},on:{load:e.getList}})],1),e._v(" "),e.listData.length?e._e():n("no-data"),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isReq,expression:"isReq"}],staticClass:"loadBox"}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.hasLogin&&e.listData.length,expression:"!hasLogin && listData.length"}],staticClass:"login-panel flex_c_m"},[n("div",{staticClass:"login-btn"},[n("div",{staticClass:"text"},[e._v(e._s(e.$t("loginLookWorks")))]),e._v(" "),n("div",{staticClass:"btn flex_c_m",on:{click:e.openLogin}},[e._v("\n          "+e._s(e.$t("loginNow"))+"\n        ")])])])],1),e._v(" "),e.hasTemp?n("page-seo",{attrs:{tempList:null===(t=e.top.pageSEO)||void 0===t?void 0:t.tempList}}):e._e()],1)}),[],!1,null,"818a30e8",null).exports),te={components:{cmtComments:n(134).a},inject:["top"],data:function(){return{modelInfo:this.top.workFlowAppData,dotReportInfo:{category:"default",view_domain:"details_model",batch_id:"",action:"",obj_no:"",obj_type:13,negative_ids:[]}}},mounted:function(){},methods:{commentEnd:function(data){this.$message({message:this.$t("commentSuc"),type:"success"}),this.$emit("onCommentEnd",data)}}},ee={inject:["top"],components:{Tabs:Wt,WorkSeo:Zt,CommentList:Object(P.a)(te,(function(){var t=this,e=t._self._c;return e("div",[e("cmtComments",{ref:"cmtComments",attrs:{infos:t.modelInfo,type:13,dotReportInfo:t.dotReportInfo,naturalScroll:"",inputPosition:"top",isReverseLoad:!0},on:{onCommentEnd:t.commentEnd}})],1)}),[],!1,null,"2c255941",null).exports},data:function(){return{actVal:1,tabList:[{label:"relatedWorks",value:1,vnum:this.top.workFlowAppData.stat.num_of_artwork},{label:"ntsPopTitCom",value:2,vnum:this.top.workFlowAppData.stat.num_of_comment}]}},methods:{commentEnd:function(){var data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("ssss",data),this.tabList[1].vnum=data.commTotal}}},ie=ee,ae=(n(2901),Object(P.a)(ie,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"right-works-box"},[e("Tabs",{staticClass:"tabs",attrs:{list:t.tabList},model:{value:t.actVal,callback:function(e){t.actVal=e},expression:"actVal"}}),t._v(" "),e("WorkSeo",{directives:[{name:"show",rawName:"v-show",value:1===t.actVal,expression:"actVal === 1"}]}),t._v(" "),e("CommentList",{directives:[{name:"show",rawName:"v-show",value:2===t.actVal,expression:"actVal === 2"}],on:{onCommentEnd:t.commentEnd}})],1)}),[],!1,null,"1cb080cc",null).exports),ne={name:"ContentViewer",props:{workFlowAppData:{type:Object,default:function(){}}},components:{ContentViewerTop:gt,ContentViewerImages:Ot,ContentViewerHistories:jt,RightWorks:ae,AnliWorkFlowApp:Vt},data:function(){return{}},mounted:function(){},computed:{},methods:{}},oe=(n(2902),Object(P.a)(ne,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"content-viewer"},[e("ContentViewerTop",{attrs:{workFlowAppData:t.workFlowAppData},on:{onHandShare:function(e){return t.$emit("onHandShare")}}}),t._v(" "),e("ContentViewerImages",{attrs:{workFlowAppData:t.workFlowAppData}}),t._v(" "),e("AnliWorkFlowApp"),t._v(" "),e("RightWorks")],1)}),[],!1,null,"4ba648a6",null).exports),se=(n(221),n(439),n(361),n(362),n(386),n(363),n(364),n(365),n(366),n(367),n(368),n(369),n(370),n(371),n(372),n(373),n(374),n(375),n(376),n(377),n(378),n(379),n(380),n(381),n(382),n(383),n(384),n(385),n(38)),re=n(74),le=n(352),ce=n(94),de=n.n(ce),ue=n(45);function pe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function he(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pe(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var me={name:"maskModal",props:{mask:{type:String,default:function(){return""}}},data:function(){return{dialogVisible:!1,intLoading:!0,intImg:{url:"",width:0,height:0,size:50},MasterDrawing:"",intHeight:0,intWidth:0,mouseX:0,mouseY:0,isMousedown:!1,sizeList:[{name:"400%",value:400},{name:"200%",value:200},{name:"125%",value:125},{name:"100%",value:100},{name:"75%",value:75},{name:"50%",value:50},{name:"30%",value:30},{name:"20%",value:20},{name:"10%",value:10},{name:"fitToScreen",value:50},{name:"ai_erase3",value:100}],toolType:"smear",toolList:[{name:this.$t("erasePage1"),icon:"iconfont icon-tumo",value:"smear"},{name:this.$t("fastToolsEraser"),icon:"iconfont icon-icon_zidongcachu",value:"eraser"},{name:this.$t("addMaticSelection"),icon:"iconfont icon-jianyiban",value:"quick"},{name:this.$t("cancelMaticSelection"),icon:"iconfont icon-jianyiban",value:"cancelQuick"}],brushSize:40,canvas:null,context:null,startX:0,startY:0,blankCanvas:"",currentStep:-1,historyList:[],isDrawing:!1,uploading:!1,UPLOAD:new se.a({type:20}),drewPoints:[],rectList:[],imgSegmentUrlList:[],hoverMaskUrl:"",hasHover:!0,debounceHandleMouseMove:null,imagesList:[],loading:!1,inTimes:!1,retryCount:0,jsonUrl:"",imgUrl:"",imgShow:!0,lengthOfLongSide:0,consumption:1,minScaleSize:10,maxScaleSize:400,fieldInfo:null}},watch:{dialogVisible:{handler:function(t){t||(this.intImg={url:"",width:0,height:0,size:100},this.toolType="smear",this.historyList=[],this.imagesList=[],this.imgSegmentUrlList=[],this.debounceHandleMouseMove=null,this.currentStep=-1,this.imgUrl="",this.imgShow=!0,this.MasterDrawing="")}}},components:{generateRectItem:le.a},computed:he(he({},Object(_.c)("user",["isLoggedIn","accountSettingsData","cdnHostFun"])),{},{setCanvasStyle:function(){var t="";if(["smear","eraser"].includes(this.toolType)){var e=this.brushSize;e<10&&(e=10);var n='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="'.concat(e,'" height="').concat(e,'" viewBox="0 0 ').concat(e," ").concat(e,'">\n    <circle cx="').concat(e/2,'" cy="').concat(e/2,'" r="').concat(e/2,'" fill="purple" fill-opacity="0.5" />\n  </svg>'),o=btoa(n),r="data:image/svg+xml;base64,".concat(o);t="url(".concat(r,") ").concat(e/2," ").concat(e/2,", auto")}return"rectangle"==this.toolType&&(t="url(https://".concat(this.cdnHostFun(),"/20240312/cb26a6cd-7ca5-4e32-a633-df7094cb570d.cur) 8 8, auto")),"noose"==this.toolType&&(t="url(https://".concat(this.cdnHostFun(),"/20240307/3b553f30-1a01-4287-85b9-b1840754b717.cur) 8 8, auto")),"drag"==this.toolType&&(t="grab"),t}}),created:function(){this.debounceHandleMouseMove=Object(re.throttle)(this.handleMouseMove,300)},mounted:function(){document.addEventListener("keydown",this.shortcutKey)},beforeDestroy:function(){document.removeEventListener("keydown",this.shortcutKey)},methods:{setImageZoomIn:function(){this.intImg.size+10>=this.maxScaleSize?this.intImg.size=this.maxScaleSize:this.intImg.size+=10},setImageZoomOut:function(){this.intImg.size-10<=this.minScaleSize?this.intImg.size=this.minScaleSize:this.intImg.size-=10},resetData:function(){this.intImg={url:"",width:0,height:0,size:100},this.toolType="smear",this.historyList=[],this.imagesList=[],this.imgSegmentUrlList=[],this.debounceHandleMouseMove=null,this.currentStep=-1,this.imgUrl="",this.imgShow=!0,this.MasterDrawing="",this.fieldInfo=null},reupload:function(){this.$emit("reupload")},shortcutKey:function(t){(t.ctrlKey||t.metaKey)&&t.shiftKey&&"z"===t.key.toLowerCase()?this.handleNext():(t.ctrlKey||t.metaKey)&&"z"===t.key.toLowerCase()&&this.handlePre()},dwn:function(){Object(y.z)(this.imgUrl)},changeTool:function(t){this.toolType=t.value,this.setDrawType(),["cancelQuick","quick"].includes(this.toolType)&&!this.imgSegmentUrlList.length&&this.getSegmentMaskData()},handleMouseMove:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.checkCoordinate(t.offsetX,t.offsetY,e.imagesList);case 2:(o=n.sent)>=0&&e.hasHover&&e.setHoverMask(o);case 4:case"end":return n.stop()}}),n)})))()},getCacheSegmentMaskData:function(){var t=arguments;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!["",null,void 0].includes(n=t.length>0&&void 0!==t[0]?t[0]:"")){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,de.a.getItem(n);case 5:return o=e.sent,e.abrupt("return",o||null);case 7:case"end":return e.stop()}}),e)})))()},setHoverMask:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!["",null,void 0,-1].includes(t)){n.next=3;break}return e.hoverMaskUrl="",n.abrupt("return");case 3:(o=new Image).src=e.imgSegmentUrlList[t],o.onload=Object(r.a)(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(n=document.createElement("canvas")).width=e.intImg.width,n.height=e.intImg.height,(r=n.getContext("2d")).clearRect(0,0,e.intImg.width,e.intImg.height),r.globalCompositeOperation="source-in",r.fillStyle="#fff",r.fillRect(0,0,e.intImg.width,e.intImg.height),r.globalCompositeOperation="source-over",r.drawImage(o,0,0,e.intImg.width,e.intImg.height),e.hoverMaskUrl=n.toDataURL();case 11:case"end":return t.stop()}}),t)})));case 6:case"end":return n.stop()}}),n)})))()},selectRegion:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(["cancelQuick","quick"].includes(e.toolType)){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,e.checkCoordinate(t.offsetX,t.offsetY,e.imagesList);case 4:(o=n.sent)>=0&&e.selectSegmentMask(o);case 6:case"end":return n.stop()}}),n)})))()},cancelSelectSegmentMask:function(t){var e=document.createElement("canvas"),n=this.intImg,o=n.width,r=n.height;e.width=o,e.height=r;var l=e.getContext("2d"),c=new Image;c.src=this.imgSegmentUrlList[t],c.onload=function(){for(var t=[-1,-1,0,-1,1,-1,-1,0,1,0,-1,1,0,1,1,1],i=0;i<t.length;i+=2)l.drawImage(c,4*t[i],4*t[i+1],o,r);l.drawImage(c,0,0,o,r);for(var e=l.getImageData(0,0,o,r).data,n=this.context.getImageData(0,0,o,r),d=n.data,h=0;h<r;h++)for(var m=0;m<o;m++){var v=4*(h*o+m);e[v+3]>0&&(d[v]=0,d[v+1]=0,d[v+2]=0,d[v+3]=0)}this.context.putImageData(n,0,0)}},selectSegmentMask:function(t){var e=this,n=new Image,o=this.$refs.canvas.getContext("2d"),r=this.intImg,l=r.width,c=r.height;n.src=this.imgSegmentUrlList[t],n.onload=function(){o.globalCompositeOperation=["cancelQuick"].includes(e.toolType)?"destination-out":"source-over";for(var t=[-1,-1,0,-1,1,-1,-1,0,1,0,-1,1,0,1,1,1],i=0;i<t.length;i+=2)o.drawImage(n,4*t[i],4*t[i+1],l,c);o.drawImage(n,0,0,l,c),e.saveToHistory()}},checkCoordinate:function(t,e,n){var o=this;return Object(r.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",o.detectClickedImage(t,e,n));case 1:case"end":return r.stop()}}),r)})))()},detectClickedImage:function(t,e,n){for(var o=this.canvas.width/this.canvas.offsetWidth,i=n.length-1;i>=0;i--){var r=n[i],l=parseInt(t*o),c=parseInt(e*o);if(this.checkPixelTransparency(r,l,c))return i}},checkPixelTransparency:function(t,e,n){return 0!==t.data[4*(e+n*t.width)+3]},getSegmentMaskData:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,c,d,h,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.loading||t.imgSegmentUrlList.length||t.uploading)){e.next=2;break}return e.abrupt("return");case 2:return t.loading=!0,e.next=5,t.getCacheSegmentMaskData(null===(n=t.intImg)||void 0===n?void 0:n.url);case 5:if(!(o=e.sent)||!o.imgSegmentUrlList.length){e.next=12;break}return l=(r=o||{}).imgSegmentUrlList,c=void 0===l?[]:l,d=r.imagesList,h=void 0===d?[]:d,t.imgSegmentUrlList=c,t.imagesList=h,t.loading=!1,e.abrupt("return");case 12:m={action:14,meta:{smart_edit:{uri:t.intImg.url}}},Object(T.d)(m).then((function(e){1e4==e.status.code&&t.getTaskInfo([e.data.id])})).catch((function(e){t.loading=!1}));case 14:case"end":return e.stop()}}),e)})))()},getTaskInfo:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o={};if(o.task_ids=t,o.scene=1,!["cancelQuick","quick"].includes(this.toolType))return this.inTimes&&clearTimeout(this.inTimes),this.loading=!1,this.uploading=!1,void(this.intLoading=!1);this.isLoggedIn||(o.g_mode=1),Object(T.a)(o).then((function(o){var r,l,c,d,h;if(1e4==o.status.code)if(null!==(r=o.data)&&void 0!==r&&r.items[0]&&3==(null===(l=o.data)||void 0===l||null===(l=l.items[0])||void 0===l?void 0:l.status))if(clearTimeout(e.inTimes),e.jsonUrl=null===(h=o.data)||void 0===h?void 0:h.items[0].segment,1==n)e.loadJsonFile(e.jsonUrl);else{var m,v;e.imgUrl=null===(m=o.data)||void 0===m||null===(m=m.items[0])||void 0===m||null===(m=m.img_uris[0])||void 0===m?void 0:m.url;var img=new Image;img.src=null===(v=o.data)||void 0===v||null===(v=v.items[0])||void 0===v||null===(v=v.img_uris[0])||void 0===v?void 0:v.url,img.onload=function(){e.intImg.url=img.src,e.uploading=!1,e.loading=!1,e.intLoading=!1,e.rectList=[],e.context.clearRect(0,0,e.canvas.width,e.canvas.height),e.saveToHistory()},img.onerror=function(){e.intImg.url=img.src,e.uploading=!1,e.loading=!1,e.intLoading=!1,e.rectList=[],e.context.clearRect(0,0,e.canvas.width,e.canvas.height),e.saveToHistory()}}else null!==(c=o.data)&&void 0!==c&&c.items[0]&&4==(null===(d=o.data)||void 0===d||null===(d=d.items[0])||void 0===d?void 0:d.status)?(clearTimeout(e.inTimes),e.loading=!1,e.intLoading=!1,e.uploading=!1):(clearTimeout(e.inTimes),e.inTimes=setTimeout((function(){e.getTaskInfo(t,n)}),1e3))})).catch((function(t){e.loading=!1,e.uploading=!1,e.intLoading=!1}))},loadJsonFile:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return fetch(e).then((function(e){return e.ok||t.$message.error(t.$t("ServerError")),e.json()})).then(function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(data){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.initCanvas(null==data?void 0:data.result);case 2:t.loading=!1;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(n){0===t.retryCount?(t.loadJsonFile(e).finally((function(){t.loading=!1})),t.retryCount++):t.$message.error(t.$t("ServerError"))}))},initCanvas:function(){var t=arguments,e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var data,o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return data=t.length>0&&void 0!==t[0]?t[0]:[],e.imgSegmentUrlList=data.map((function(t){return"data:image/png;base64,".concat(t.mask_png)})),n.next=4,e.loadAllMask(e.imgSegmentUrlList);case 4:if(e.imagesList=n.sent,!e.imagesList.length){n.next=10;break}return{},r={imgSegmentUrlList:e.imgSegmentUrlList,imagesList:e.imagesList},n.next=10,de.a.setItem(null===(o=e.intImg)||void 0===o?void 0:o.url,r);case 10:case"end":return n.stop()}}),n)})))()},loadAllMask:function(){var t=this,source=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=this.intImg||{},n=e.width,o=e.height,r=(source||[]).map((function(t){return new Promise((function(e,n){var img=new Image;img.onload=function(){return e(img)},img.onerror=function(t){return n(t)},img.src=t}))}));return Promise.all(r).then((function(e){for(var r=[],i=0;i<e.length;i++){var img=e[i],l=document.createElement("canvas");l.width=n,l.height=o;var c=l.getContext("2d");c.drawImage(img,0,0,t.intImg.width,t.intImg.height);var d=c.getImageData(0,0,t.intImg.width,t.intImg.height);d.data;c.putImageData(d,0,0);var h=l.toDataURL();t.$set(t.imgSegmentUrlList,i,h);var m=c.getImageData(0,0,t.intImg.width,t.intImg.height);r.push(m),l=null,c=null}return r}))},show:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.fieldInfo=n||null,this.currentStep=-1,this.historyList=[],this.rectList=[],this.toolType="smear",this.context&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.intImg.url="",this.imgUrl="",this.MasterDrawing="",this.imagesList=[],this.debounceHandleMouseMove=Object(re.throttle)(this.handleMouseMove,300),this.intLoading=!0,this.$nextTick((function(){e.intImg.url=t,e.MasterDrawing=t,e.dialogVisible=!0,e.imgLoad()}))},intSize:function(){var t=window.innerHeight-240,e=this.intImg.height;this.intImg.width>2*this.intImg.height&&(t=window.innerWidth-100,e=window.innerWidth),this.intImg.size=parseInt(t/e*100)},changeSize:function(t){var e=this;if("fitToScreen"==t.name){var n=this.$refs.draggable;return n.style.left=null,n.style.top=null,void this.$nextTick((function(){e.intSize()}))}this.intImg.size=t.value},setConsumption:function(){this.consumption=1,this.lengthOfLongSide>=1024&&this.lengthOfLongSide<=2048?this.consumption=1.5:this.lengthOfLongSide>=2048&&this.lengthOfLongSide<=4096&&(this.consumption=4)},setDrawType:function(){this.context&&(this.context.globalCompositeOperation="eraser"===this.toolType?"destination-out":"source-over")},imgLoad:function(){this.intLoading=!0;var img=new Image;img.src=this.intImg.url;var t=this;img.onload=function(){t.lengthOfLongSide=Math.max(this.width,this.height),t.setConsumption(),t.intImg.width=this.width,t.intImg.height=this.height,t.intSize(),t.intLoading=!1,t.$nextTick(Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.canvas=t.$refs.canvas,t.context=t.canvas.getContext("2d"),t.context.fillStyle="rgba(255, 255, 255, 1)",t.context.lineJoin="round",t.context.lineCap="round",t.rectCanvas=t.$refs.rectCanvas,t.rectText=t.rectCanvas.getContext("2d"),t.rectText.strokeStyle="rgba(0,0,0,1)",t.rectText.fillStyle="rgba(255, 255, 255, 1)",t.rectText.lineJoin="round",t.rectText.lineCap="round",t.blankCanvas=t.canvas.toDataURL(),!t.mask){e.next=15;break}return e.next=15,t.displayMaskToCanvas(t.mask);case 15:t.saveToHistory();case 16:case"end":return e.stop()}}),e)}))))},img.onerror=function(){t.$message.error(t.$t("ai_erase4")),t.intLoading=!1}},displayMaskToCanvas:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this;return new Promise((function(n,o){var img=new Image;img.onload=function(){e.context.clearRect(0,0,e.canvas.width,e.canvas.height),e.context.drawImage(img,0,0,e.canvas.width,e.canvas.height),n()},img.onerror=function(t){n()},img.src=t}))},downElement:function(t){if("drag"==this.toolType){this.isMousedown=!0;var e=this.$refs.draggable;this.mouseX=t.clientX-e.offsetLeft,this.mouseY=t.clientY-e.offsetTop}},moveElement:function(t){if(this.isMousedown&&"drag"==this.toolType){var e=this.$refs.draggable;e.style.left=t.clientX-this.mouseX+"px",e.style.top=t.clientY-this.mouseY+"px"}},seupElement:function(){"drag"==this.toolType&&(this.isMousedown=!1)},startDrawing:function(t){if(["smear","eraser","noose"].includes(this.toolType))if(this.isDrawing=!0,this.startX=t.offsetX,this.startY=t.offsetY,["smear","eraser"].includes(this.toolType))this.context.strokeStyle="#fff",this.context.lineWidth=this.brushSize<10?10:this.brushSize,this.context.setLineDash([]);else if("noose"==this.toolType){var e=this.$refs.draggable;this.context.strokeStyle="rgba(0,0,0,1)";var n=e.getBoundingClientRect();this.drewPoints.push([{x:t.clientX-n.left,y:t.clientY-n.top}]),this.context.setLineDash([10,5]),this.context.lineWidth=2}},draw:function(t){if(this.isDrawing){var e,n,o=this.canvas.width/this.canvas.offsetWidth;if(this.context.scale(o,o),["smear","eraser"].includes(this.toolType)){var r=t.offsetX,l=t.offsetY;this.context.beginPath(),this.context.moveTo(this.startX,this.startY),this.context.lineTo(r,l),this.context.stroke(),this.startX=r,this.startY=l}else if("noose"==this.toolType){var c,d,h=this.$refs.draggable.getBoundingClientRect();c=t.clientX,d=t.clientY;var m=this.drewPoints[this.drewPoints.length-1];m.push({x:c-h.left,y:d-h.top});var v=m[0],f=m[1],_=m.length;this.context.beginPath(),this.context.moveTo(v.x,v.y);for(var i=1;i<_;i++){var y=(n=f,{x:(e=v).x+(n.x-e.x)/2,y:e.y+(n.y-e.y)/2});this.context.quadraticCurveTo(v.x,v.y,y.x,y.y),v=m[i],f=m[i+1]}this.context.lineTo(v.x,v.y),this.context.stroke()}this.context.scale(1/o,1/o)}},stopDrawing:function(){["smear","noose","eraser"].includes(this.toolType)&&this.isDrawing&&(this.isDrawing=!1,"noose"==this.toolType&&(this.context.closePath(),this.context.stroke(),this.context.fill()),this.saveToHistory())},startRectDrawing:function(t){"rectangle"==this.toolType&&(this.isDrawing=!0,this.startX=t.offsetX,this.startY=t.offsetY)},rectDraw:function(t){var e=this;if(this.isDrawing){var n=t.offsetX,o=t.offsetY;this.rectText.clearRect(0,0,this.rectCanvas.width,this.rectCanvas.height),this.$nextTick((function(){var t=e.rectCanvas.width/e.rectCanvas.offsetWidth;e.rectText.scale(t,t),e.rectText.beginPath(),e.rectText.rect(e.startX,e.startY,n-e.startX,o-e.startY),e.rectText.fill(),e.rectText.stroke(),e.rectText.scale(1/t,1/t)})),this.rectCanvas.style.zIndex=9999}},stopRectDrawing:function(t){if("rectangle"==this.toolType&&this.isDrawing){this.isDrawing=!1,this.rectText.clearRect(0,0,this.rectCanvas.width,this.rectCanvas.height);var e=t.offsetX,n=t.offsetY;this.rectList.push({left:e-this.startX>0?this.startX:e,top:n-this.startY>0?this.startY:n,width:Math.abs(e-this.startX),height:Math.abs(n-this.startY)}),this.saveToHistory(),this.rectCanvas.style.zIndex=2}},rectDelete:function(t){this.rectList.splice(t,1)},rectChange:function(t){this.rectList[t.index].top=t.top,this.rectList[t.index].left=t.left,this.rectList[t.index].width=t.width,this.rectList[t.index].height=t.height},saveToHistory:function(){var t=JSON.parse(JSON.stringify(this.rectList)),e=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),img=JSON.parse(JSON.stringify(this.intImg.url));this.currentStep++,1==this.currentStep&&this.historyList.splice(1,this.historyList.length-1),this.historyList.push({currentImageData:e,rects:t,img:img}),this.currentStep=this.historyList.length-1},handlePre:function(){this.historyList.length>0&&this.currentStep>0&&(this.currentStep--,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.putImageData(this.historyList[this.currentStep].currentImageData,0,0),this.rectList=JSON.parse(JSON.stringify(this.historyList[this.currentStep].rects)),this.intImg.url=JSON.parse(JSON.stringify(this.historyList[this.currentStep].img)))},handleNext:function(){this.currentStep<this.historyList.length-1&&(this.currentStep++,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.putImageData(this.historyList[this.currentStep].currentImageData,0,0),this.rectList=JSON.parse(JSON.stringify(this.historyList[this.currentStep].rects)),this.intImg.url=JSON.parse(JSON.stringify(this.historyList[this.currentStep].img)))},handleReset:function(){this.historyList.length>1&&(this.currentStep=-1,this.historyList=[],this.rectList=[],this.toolType="smear",this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.intImg.url=this.MasterDrawing,this.imgUrl="",this.imgLoad())},checkImageSize:function(t){var e=this;return new Promise((function(n,o){var r=new FileReader;r.onload=function(t){var img=new Image;img.onload=function(){var t=img.width,o=img.height;e.$set(e,"style",{width:t,height:o});var r=[t,o].every((function(t){return t<=4096}));n(r)},img.onerror=function(){o(!1)},img.src=t.target.result},r.readAsDataURL(t)}))},uploadMaskImage:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r,i,l,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isLoggedIn){e.next=3;break}return t.$EventBus.$emit("openLoginDialog"),e.abrupt("return");case 3:if(t.intImg.width){e.next=5;break}return e.abrupt("return");case 5:if(!t.uploading&&!t.loading){e.next=7;break}return e.abrupt("return");case 7:for(t.uploading=!0,t.loading=!0,(n=document.createElement("canvas")).width=t.intImg.width,n.height=t.intImg.height,(o=n.getContext("2d")).clearRect(0,0,n.width,n.height),r=t.context.getImageData(0,0,t.canvas.width,t.canvas.height),i=0;i<r.data.length;i+=4)255===r.data[i]&&255===r.data[i+1]&&255===r.data[i+2]||(r.data[i]=255,r.data[i+1]=255,r.data[i+2]=255);if(o.putImageData(r,0,0),l=t.canvas.width/t.canvas.offsetWidth,t.rectList.length>0&&t.rectList.forEach((function(t){o.fillStyle="rgba(255, 255, 255, 1)",o.beginPath(),o.rect(t.left*l,t.top*l,t.width*l,t.height*l),o.fill()})),(c=n.toDataURL("image/png",.1))!==t.blankCanvas){e.next=26;break}return t.$emit("updateMask",""),t.uploading=!1,t.loading=!1,t.handleClose(),e.abrupt("return");case 26:return t.$emit("updateMask",c),e.next=29,t.handleMixGenerateMask();case 29:case"end":return e.stop()}}),e)})))()},handleMixGenerateMask:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var img;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(img=new Image).setAttribute("crossOrigin","anonymous"),img.src="".concat(t.intImg.url,"?t=").concat(Date.now()),img.onload=function(){var e=document.createElement("canvas"),n=e.getContext("2d",{willReadFrequently:!0}),o=document.createElement("canvas"),r=o.getContext("2d",{willReadFrequently:!0}),l=t.intImg||{},c=l.width,d=l.height;e.width=c,e.height=d,o.width=c,o.height=d,r.clearRect(0,0,e.width,e.height),r.drawImage(img,0,0,c,d,0,0,e.width,e.height),n.clearRect(0,0,e.width,e.height),n.drawImage(t.canvas,0,0,c,d,0,0,e.width,e.height);for(var h=n.getImageData(0,0,e.width,e.height),i=0;i<h.data.length;i+=4)255==h.data[i+3]?h.data[i+3]=0:h.data[i+3]=255,h.data[i]=0,h.data[i+1]=0,h.data[i+2]=0;n.globalCompositeOperation="source-over",n.putImageData(h,0,0),r.globalCompositeOperation="destination-in",r.drawImage(e,0,0);var m=o.toDataURL(),v=t.dataURLToBlob(m),f="clipspace-mask-"+Date.now()+".png";t.uploadMask(v,f)};case 4:case"end":return e.stop()}}),e)})))()},dataURLToBlob:function(t){for(var e=t.split(";base64,"),n=e[0].split(":")[1],o=atob(e[1]),r=new ArrayBuffer(o.length),l=new Uint8Array(r),i=0;i<o.length;i++)l[i]=o.charCodeAt(i);return new Blob([r],{type:n})},uploadMask:function(t,e){var n=this;return Object(r.a)(regeneratorRuntime.mark((function o(){var r,l,c,d;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(r="",o.prev=1,(c=(c=localStorage.getItem("userInfo"))&&JSON.parse(c))&&null!==(l=c)&&void 0!==l&&l.id){o.next=7;break}return null===(d=n.$EventBus)||void 0===d||d.$emit("openLoginDialog"),o.abrupt("return");case 7:if(!(t.size/1024/1024>10)){o.next=17;break}return o.prev=8,o.next=11,Object(ue.a)(t,10485760);case 11:t=o.sent,o.next=17;break;case 14:return o.prev=14,o.t0=o.catch(8),o.abrupt("return");case 17:return o.next=19,n.UPLOAD.startUpload(t,{category:20,name:"".concat(e),type:"png",isRedirection:!0}).then((function(t){r=t})).catch((function(t){n.$message.error(n.$t("uploadError"))}));case 19:n.$EventBus.$emit("workflowAppDetailModalConfirm",r,n.fieldInfo),n.loading=!1,n.uploading=!1,n.handleClose(),o.next=30;break;case 25:o.prev=25,o.t1=o.catch(1),n.$message.error(n.$t("uploadError")),n.loading=!1,n.uploading=!1;case 30:case"end":return o.stop()}}),o,null,[[1,25],[8,14]])})))()},handleClose:function(){this.resetData(),this.dialogVisible=!1}}},ve=me,fe=(n(2903),n(2904),Object(P.a)(ve,(function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{visible:t.dialogVisible,"custom-class":"c-generate-redraw-modal",fullscreen:!0,modal:!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.intLoading,expression:"intLoading"}],staticClass:"main"},[e("div",{staticClass:"top"},[e("div",{staticClass:"topItem"},[e("div",{staticClass:"back",on:{click:function(e){t.dialogVisible=!1}}},[e("i",{staticClass:"el-icon-back"})])]),t._v(" "),e("div",{staticClass:"topItem",class:{disabledStyle:t.intLoading}},[e("div",{staticClass:"bntBox"},[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("fastToolsUndo"),placement:"bottom"}},[e("div",{staticClass:"bnt",class:{disabledStyle:!t.historyList.length||1==t.historyList.length||0==t.currentStep},on:{click:function(e){return t.handlePre()}}},[e("i",{staticClass:"iconfont icon-draw-board-icon3"})])]),t._v(" "),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("fastToolsRedo"),placement:"bottom"}},[e("div",{staticClass:"bnt",class:{disabledStyle:t.currentStep==t.historyList.length-1},on:{click:function(e){return t.handleNext()}}},[e("i",{staticClass:"iconfont icon-draw-board-icon2"})])]),t._v(" "),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("S_ResetPrompt"),placement:"bottom"}},[e("div",{staticClass:"bnt",class:{disabledStyle:t.historyList.length<2},on:{click:function(e){return t.handleReset()}}},[e("i",{staticClass:"el-icon-refresh"})])])],1)]),t._v(" "),e("div",{staticClass:"topItem",staticStyle:{visibility:"hidden"}})]),t._v(" "),e("div",{staticClass:"right",class:{disabledStyle:t.intLoading}},[e("div",{staticClass:"dragIcon",on:{click:function(e){"drag"==t.toolType?t.toolType="smear":t.toolType="drag"}}},[e("i",{staticClass:"iconfont icon-zhuashou-copy",style:{color:"drag"==t.toolType?"#4784FF":null}})]),t._v(" "),e("div",{staticClass:"sizeBox"},[e("div",{staticClass:"sizeBnt",class:{disabledStyle:t.intImg.size<=t.minScaleSize},on:{click:t.setImageZoomOut}},[e("i",{staticClass:"el-icon-minus"})]),t._v(" "),e("el-popover",{attrs:{placement:"top",trigger:"hover","visible-arrow":!1,"popper-class":"sizeListBox"}},[e("div",{staticClass:"sizeList"},t._l(t.sizeList,(function(n,o){return e("div",{key:o,staticClass:"sizeItem",on:{click:function(e){return t.changeSize(n)}}},[t._v(t._s(t.$t(n.name)))])})),0),t._v(" "),e("div",{staticClass:"sizeNum",attrs:{slot:"reference"},slot:"reference"},[t._v(t._s(t.intImg.size)+"%")])]),t._v(" "),e("div",{staticClass:"sizeBnt",class:{disabledStyle:t.intImg.size>=t.maxScaleSize},on:{click:t.setImageZoomIn}},[e("i",{staticClass:"el-icon-plus"})])],1)]),t._v(" "),e("div",{staticClass:"left",class:{disabledStyle:t.intLoading}},t._l(t.toolList,(function(n,o){return e("div",{key:o,staticClass:"toolItem",class:{activateToolItem:t.toolType==n.value},on:{click:function(e){return t.changeTool(n)}}},[e("i",{class:n.icon}),t._v(" "),e("span",[t._v(t._s(t.$t(n.name)))]),t._v(" "),"smear"==n.value&&"smear"==t.toolType||"eraser"==n.value&&"eraser"==t.toolType?e("div",{staticClass:"lineSize"},[e("span",[t._v(t._s(t.$t("Size")))]),t._v(" "),e("el-slider",{attrs:{"show-input":"","show-input-controls":!1,min:10},model:{value:t.brushSize,callback:function(e){t.brushSize=e},expression:"brushSize"}})],1):t._e()])})),0),t._v(" "),t.intLoading?t._e():e("div",{ref:"draggable",staticClass:"draggable",style:{width:t.intImg.width*t.intImg.size/100+"px",height:t.intImg.height*t.intImg.size/100+"px",cursor:t.setCanvasStyle},attrs:{id:"draggable"},on:{mousedown:function(e){return e.preventDefault(),t.downElement.apply(null,arguments)},mousemove:function(e){return e.preventDefault(),t.moveElement.apply(null,arguments)},mouseup:function(e){return e.preventDefault(),t.seupElement.apply(null,arguments)}}},[t.loading?e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"laodMsk"}):t._e(),t._v(" "),t.intImg.url?e("img",{directives:[{name:"show",rawName:"v-show",value:t.imgShow,expression:"imgShow"}],attrs:{src:t.intImg.url,alt:""}}):t._e(),t._v(" "),t.MasterDrawing?e("img",{directives:[{name:"show",rawName:"v-show",value:!t.imgShow,expression:"!imgShow"}],attrs:{src:t.MasterDrawing,alt:""}}):t._e(),t._v(" "),e("canvas",{ref:"canvas",attrs:{width:t.intImg.width,height:t.intImg.height},on:{"&mousedown":function(e){return t.startDrawing.apply(null,arguments)},"&mousemove":function(e){["cancelQuick","quick"].includes(t.toolType)?t.debounceHandleMouseMove(e):t.draw(e)},"&mouseup":function(e){return t.stopDrawing.apply(null,arguments)},mouseenter:function(e){t.hasHover=!0},mouseleave:function(e){t.hasHover=!1,t.hoverMaskUrl="",t.stopDrawing()},mousedown:t.selectRegion}}),t._v(" "),t.hoverMaskUrl?e("img",{staticClass:"segment-image-draw-img-hover-mask",style:{width:t.intImg.width*t.intImg.size/100+"px",height:t.intImg.height*t.intImg.size/100+"px"},attrs:{src:t.hoverMaskUrl,alt:""}}):t._e(),t._v(" "),e("canvas",{directives:[{name:"show",rawName:"v-show",value:"rectangle"==t.toolType,expression:"toolType == 'rectangle'"}],ref:"rectCanvas",staticClass:"rectCanvas",attrs:{width:t.intImg.width,height:t.intImg.height},on:{"&mousedown":function(e){return t.startRectDrawing.apply(null,arguments)},"&mousemove":function(e){return t.rectDraw.apply(null,arguments)},"&mouseup":function(e){return t.stopRectDrawing.apply(null,arguments)}}}),t._v(" "),t._l(t.rectList,(function(n,o){return e("generate-rect-item",{key:"rect"+o,attrs:{item:n,index:o,size:t.intImg.size},on:{delete:t.rectDelete,change:t.rectChange}})}))],2),t._v(" "),e("el-button",{staticClass:"start",class:{disabledStyle:t.intLoading||t.loading},attrs:{disabled:t.intLoading||t.loading,loading:t.uploading},on:{click:t.uploadMaskImage}},[e("span",[t._v(t._s(t.$t("Done")))])])],1)])}),[],!1,null,"7040ad9f",null)),ge=fe.exports,_e=n(206),be=n(30),ye=["content"];function we(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Ce(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?we(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ke={name:"workFlowAppDetail",components:{BackIcon:d.a,CodeViewer:h.a,GenerateResults:st,ContentViewer:oe,maskModal:ge,PageSeo:Gt.a,Tabs:Wt,ShareDialog:_e.a},provide:function(){return{top:this,handleQuick:this.handleQuick}},inject:["app"],data:function(){return{workFlowAppData:{},pageSEO:{tempList:[],title:"",key_words:"",meta_description:""},quickOptions:{},noData:!1,actVal:1,tabList:[{label:"startGenerate",value:1},{label:"workFlow11",value:2}]}},watch:{$route:{handler:function(){this.remixWork()},deep:!0}},mounted:function(){var t,e,n,o=this;(null===(t=this.$route.params)||void 0===t?void 0:t.id)&&Object(be.g)({items:[{category:"default",view_domain:"details",action:"view",obj_no:null===(e=this.$route.params)||void 0===e?void 0:e.id,obj_type:13}]}),this.$EventBus.$on("$_workDetailRemix",this.workDetailRemix),this.remixWork(),null===(n=this.$refs)||void 0===n||null===(n=n.codeViewer)||void 0===n||null===(n=n.$refs)||void 0===n||null===(n=n.seedField)||void 0===n||n.initData(),this.$EventBus.$on("openWorkflowAppDetailModal",(function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null===(t=o.$refs)||void 0===t||null===(t=t.maskModal)||void 0===t||t.show(e,n)}))},beforeDestroy:function(){this.$EventBus.$off("openWorkflowAppDetailModal")},computed:{codeViewData:function(){var t;return(null===(t=this.workFlowAppData)||void 0===t?void 0:t.inputs)||[]},codeViewerHeight:function(){return this.app.isShowBanner?"calc(100vh - 20px - 74px - 46px - 62px)":"calc(100vh - 20px - 74px - 62px)"},isShowConsume:function(){var t;return 4==(null===(t=this.workFlowAppData)||void 0===t||null===(t=t.permission)||void 0===t?void 0:t.source)}},methods:{initData:function(){var t,e=this,n=(null===(t=this.$route.params)||void 0===t?void 0:t.id)||"";Object(f.d)({template_id:n}).then((function(t){var n,o=t.data,data=void 0===o?{}:o,r=(null==data||null===(n=data.inputs)||void 0===n?void 0:n.map((function(t){return Ce({val:""},t)})))||[];data.inputs=r,data.selectedId="",data.progress="none",e.workFlowAppData=Ce(Ce({},e.workFlowAppData),data),e.$refs.codeViewer.$refs.seedField.initData()}))},remixWork:function(){var t,e=this,n=null===(t=this.$route.query)||void 0===t?void 0:t.task;if(n){var o=n.split("-"),r=Object(l.a)(o,2),c=r[0],d=r[1];"retry"===c&&Object(T.h)({id:d}).then((function(t){var n,o=(null==t||null===(n=t.data)||void 0===n||null===(n=n.meta)||void 0===n?void 0:n.comfyui_inputs)||[];e.fillFormData(o)})),"mix"===c&&Object(T.o)({art_work_no:d,source:4}).then((function(t){var n,o=(null==t||null===(n=t.data)||void 0===n||null===(n=n.meta)||void 0===n?void 0:n.comfyui_inputs)||[];e.fillFormData(o)}))}},workDetailRemix:function(){var t=this,e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).artwork_id;this.actVal=1,Object(T.o)({art_work_no:e,source:4}).then((function(e){var n,o=(null==e||null===(n=e.data)||void 0===n||null===(n=n.meta)||void 0===n?void 0:n.comfyui_inputs)||[];t.fillFormData(o)}))},fillFormData:function(data){var t={};data.forEach((function(e){var n="".concat(e.field,"_").concat(e.node_id);t[n]={val:null==e?void 0:e.val,art_model:null==e?void 0:e.art_model}})),this.workFlowAppData.inputs.forEach((function(e){var n,o,r="".concat(e.field,"_").concat(e.node_id);e.val=(null===(n=t[r])||void 0===n?void 0:n.val)||e.val,e.art_model=null===(o=t[r])||void 0===o?void 0:o.art_model}))},handleQuick:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.quickOptions=t},changeVal:function(t){var e=t.field,n=t.node_id,o=t.node_type,r=t.val,l=this.workFlowAppData.inputs.find((function(t){return t.field==e&&t.node_id==n&&t.node_type==o}));l&&(l.val=r)},changeSelectedId:function(t){this.workFlowAppData.selectedId=t},updateHistories:function(t){this.$set(this.workFlowAppData,"histories",t)},updateProgress:function(t){var progress=t;"none"!=t&&(progress=Math.max(0,Math.min(100,progress))),this.workFlowAppData.progress=progress},changeTab:function(t){},createTask:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.actVal=2,this.tabList[1].icon="",this.$refs.GenerateResultsRef.addHeadItem(t)},handShare:function(){var t=this.workFlowAppData,e=t.author,n=t.samples,o=t.id,r=n[0].url,l=window.location.href,c=e.id+"_"+o,d=this.$route.params;this.$refs.ShareDialog.show(l,r,c,""),this.$logEvent("log_actions",{operation:"click_share",behavior_info:d.id})},retryWork:function(data){var t=this,e=this.$route.params,n=data.creativity.id,o=data.id;if(e.id===n)this.actVal=1,Object(T.h)({id:o}).then((function(e){var n,o=(null==e||null===(n=e.data)||void 0===n||null===(n=n.meta)||void 0===n?void 0:n.comfyui_inputs)||[];t.fillFormData(o)}));else{var r=this.localePath("/workFlowAppDetail/".concat(n,"?task=retry-").concat(o));window.open(r,"_blank")}}},asyncData:function(t){return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r,c,d,h,m,data,v,f,_,title,y,w,C,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,t.app,r=t.params,t.error,c=r.id,e.prev=2,e.next=5,Promise.all([n.$post("/api/v1/creativity/square/template/detail",{template_id:c}),n.$post("/api/v1/fast_ai/detail",{name:c})]);case 5:return h=e.sent,m=Object(l.a)(h,2),data=m[0].data,v=m[1].data,_=(f=v||{}).module,title=f.title,y=f.meta_description,w=f.key_words,C=null!=_&&_.length?_.map((function(t){var content=t.content;return Ce(Ce({},Object(o.a)(t,ye)),{},{content:JSON.parse(content)})})):[],k=(null==data||null===(d=data.inputs)||void 0===d?void 0:d.map((function(t){return Ce({val:""},t)})))||[],data.inputs=k,data.selectedId="",data.progress="none",e.abrupt("return",{workFlowAppData:Ce({},data),pageSEO:{tempList:C,title:title,key_words:w,meta_description:y}});case 18:return e.prev=18,e.t0=e.catch(2),e.abrupt("return",{noData:!0});case 21:case"end":return e.stop()}}),e,null,[[2,18]])})))()},head:function(){var t,e,n,o=this.workFlowAppData||{},r=o.desc,l=o.name,c=o.samples,d=o.stat,h=o.author,m=o.permission,v=o.id,f=this.pageSEO||{},title=f.title,_=f.key_words,y=f.meta_description,w=4==(null==m?void 0:m.source);title=this.$t(title)||(w?this.$t("Sd3SeoTitle"):"".concat(this.$t("SeaArt")," AI | ")+l);var desc=this.$t(y)||(w?this.$t("Sd3SeoDesc"):r),C="https://www.seaart.ai/workFlowAppDetail/".concat(v);return{title:title,meta:[{hid:"description",name:"description",content:desc},{hid:"keywords",name:"keywords",content:this.$t(_)},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:desc},{hid:"og:image",name:"og:image",content:null!=c&&c.length?null===(t=c[0])||void 0===t?void 0:t.url:""},{hid:"og:site_name",property:"og:site_name",content:"https://www.seaart.ai"},{hid:"og:url",property:"og:url",content:C},{name:"twitter:url",content:C},{hid:"twitter:image",name:"twitter:image",content:null!=c&&c.length?null===(e=c[0])||void 0===e?void 0:e.url:""},{property:"twitter:image",content:null!=c&&c.length?null===(n=c[0])||void 0===n?void 0:n.url:""},{name:"twitter:title",content:title},{name:"twitter:description",content:desc},{name:"twitter:site",content:"@SeaArt_Ai"},{name:"twitter:creator",content:(null==h?void 0:h.name)||"@SeaArt_Ai"},{name:"twitter:card",content:"summary_large_image"}],script:[{type:"application/ld+json",json:{"@context":"https://schema.org","@type":"SoftwareApplication",name:l,offers:{"@type":"Offer",price:"0",priceCurrency:"USD"},aggregateRating:{"@type":"AggregateRating",ratingValue:(null==d?void 0:d.rating)||1,ratingCount:(null==d?void 0:d.num_of_task)||1e4},creator:{name:(null==h?void 0:h.name)||"SeaArt","@type":"Person"}}}],__dangerouslyDisableSanitizers:["script"]}}},xe=ke,Oe=(n(2905),n(2906),Object(P.a)(xe,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"workflow-app-detail width-height-hundred fit-page my-workf-max"},[t.noData?e("div",{staticClass:"workflow-app-detail-content no-data"},[e("img",{staticClass:"null-image",attrs:{src:n(327),alt:"null_image"}}),t._v(" "),e("div",{staticClass:"null-tips"},[t._v(t._s(t.$t("WorkflowAppNoData")))])]):e("div",{staticClass:"workflow-app-detail-content width-height-hundred"},[e("BackIcon"),t._v(" "),e("div",{staticClass:"detail-content"},[e("div",{staticClass:"left-code-viewer"},[e("div",{staticClass:"left-tabs"},[e("Tabs",{attrs:{list:t.tabList,bline:!1},on:{onChange:t.changeTab},model:{value:t.actVal,callback:function(e){t.actVal=e},expression:"actVal"}})],1),t._v(" "),e("CodeViewer",{directives:[{name:"show",rawName:"v-show",value:1===t.actVal,expression:"actVal === 1"}],ref:"codeViewer",attrs:{isCreate:!0,height:t.codeViewerHeight,codeViewData:t.codeViewData},on:{onCreateTask:t.createTask}}),t._v(" "),e("GenerateResults",{directives:[{name:"show",rawName:"v-show",value:2===t.actVal,expression:"actVal === 2"}],ref:"GenerateResultsRef",style:{height:t.codeViewerHeight},on:{onRetryWork:t.retryWork}})],1),t._v(" "),e("ContentViewer",{staticClass:"right-content-viewer",attrs:{workFlowAppData:t.workFlowAppData},on:{onHandShare:t.handShare}})],1),t._v(" "),e("mask-modal",{ref:"maskModal"})],1),t._v(" "),e("el-backtop",{attrs:{bottom:30,right:30}},[e("i",{staticClass:"el-icon-top"})]),t._v(" "),e("ShareDialog",{ref:"ShareDialog"})],1)}),[],!1,null,"3ca8bf88",null));e.default=Oe.exports},3248:function(t,e,n){"use strict";n.r(e);n(9),n(7),n(11),n(12),n(6),n(288),n(44);var o=n(153),r=n.n(o),l=n(2),c=(n(32),n(10),n(19),n(14),n(28),n(8),n(4),n(18),n(1));function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m={props:{actIndex:{type:Number,default:1}},data:function(){return{list:[{name:this.$t("ModelEdit")},{name:this.$t("editVersionModel")},{name:this.$t("addImageModel")}]}},methods:{handItem:function(t){var e=this.list[t];this.$emit("onClick",h(h({},e),{},{index:t+1}))}}},v=(n(2450),n(0)),f=Object(v.a)(m,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"step-max-page flex_c"},[e("div",{staticClass:"step-box flex"},t._l(t.list,(function(n,o){return e("div",{key:o,staticClass:"item flex_m",class:o+1<=t.actIndex&&"highlight",on:{click:function(e){return t.handItem(o)}}},[e("div",{staticClass:"num flex_c_m"},[t._v(t._s(o+1))]),t._v(" "),e("div",{staticClass:"text"},[t._v(t._s(n.name))])])})),0)])}),[],!1,null,"0bc07c72",null).exports,_=(n(23),n(37),n(71),{model:{prop:"actVal",event:"onChange"},props:{width:{type:String,default:"auto"},list:{type:Array,default:function(){return[]}},actVal:{type:[String,Number],default:1},dis:{type:Boolean,default:!1}},data:function(){return{}},methods:{handItem:function(t){var e=t.value;!this.dis&&this.$emit("onChange",e)}}}),y=(n(2451),Object(v.a)(_,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"select-line-box flex_m",class:t.dis&&"dis-line",style:{width:t.width}},t._l(t.list,(function(n,o){return e("div",{key:o,staticClass:"item flex_c_m",class:n.value===t.actVal&&"act-item",on:{click:function(e){return t.handItem(n)}}},[t._v("\n    "+t._s(t.$t(n.label))+"\n  ")])})),0)}),[],!1,null,"358bed9a",null).exports),w=(n(16),n(36),n(81)),C=n(51),k=n(13),x={model:{prop:"actVal",event:"onChange"},props:{actVal:{type:Array,default:function(){return[]}}},data:function(){return{tabList:[]}},mounted:function(){this.getRecommendTag()},methods:{getRecommendTag:function(){var t=this;Object(w.a)({show_area:"model"}).then((function(e){if(1e4===e.status.code){var n=e.data||[];t.tabList=n.map((function(e){return{id:e[k.l[t.$i18n.locale]],title:e[k.l[t.$i18n.locale]]}})),t.tabList=t.tabList.concat(t.actVal)}}))},remoteMethod:function(t){var e=this;t&&Object(C.f)({prefix:t,except_num:20,source_type:3}).then((function(t){var n;if(1e4==t.status.code){e.tabList=[];var o=(null==t||null===(n=t.data)||void 0===n?void 0:n.items)||[];e.tabList=o.map((function(t){return{id:t.title,title:t.title}}))}}))},changeTab:function(t){var e=t.length-1;t[e]=t[e].slice(0,30),this.$emit("onChange",t)}}},O=(n(2452),Object(v.a)(x,(function(){var t=this,e=t._self._c;return e("div",[e("el-select",{staticClass:"show-tag",staticStyle:{width:"100%"},attrs:{value:t.actVal,multiple:"",filterable:"","allow-create":"","default-first-option":"",remote:"",placeholder:t.$t("pleaseEnte"),"popper-class":"show-tag-select","remote-method":t.remoteMethod},on:{change:t.changeTab}},t._l(t.tabList,(function(t,n){return e("el-option",{key:"tab"+n,attrs:{label:t.title,value:t.id}})})),1)],1)}),[],!1,null,"7b5bca8a",null).exports),$=n(349),D=n(192);function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var I={components:{SelectLine:y,SelectTab:O,MyEditor:$.a},data:function(){return{formData:{name:"",type:"LORA",tags:[],desc:"",publish_status:1,payment:{way:1,fee:0},refer:"",permission:{allow_commercial_use:1,allow_download:1,allow_model_mix:1,allow_resell:1,allow_sell:1,allow_use_in_haiyi:1}},rules:{name:[{required:!0,message:this.$t("pleaseEnte")}],type:{required:!0,message:this.$t("Pls_select")},desc:{required:!0,message:this.$t("pleaseEnte")},refer:{required:!0,message:this.$t("pleaseEnte")}},modelList:D.d,sourceList:D.h,payList:D.g,isOpenList:D.b,modelUseList:D.f,useModelType:1,worksSource:1,editorErr:!1,num_of_task:0}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(c.e)("user",["userInfo","openEdit","adminOff"])),mounted:function(){this.$route.query.train&&(this.formData.publish_status=1,this.worksSource=1)},methods:{HandNextStep:function(t){var e=this;this.$refs[t].validate((function(t){t?e.$emit("onNext",e.formData):e.editorErr=!e.formData.desc}))},changeEditor:function(t){t&&(this.editorErr=!1,this.$refs.modelForm.validateField("desc"))},feeInput:function(t){this.formData.payment.fee=t.replace(/\D/g,"")},setPayNum:function(t){var e=t.target.value;parseInt(e)>3&&(this.formData.payment.fee=3)},changeSource:function(t){2===t&&(this.useModelType=1,this.formData.payment.fee=0),1===t&&(this.formData.refer="")},changeModelUse:function(t){2===this.worksSource&&(this.useModelType=1),1===t&&(this.formData.payment.fee=0)},formDataFill:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.formData.name=t.name,this.formData.type=t.type,this.formData.tags=t.tags.map((function(t){return t.title})),this.formData.desc=t.desc,this.formData.publish_status=t.publish_status,this.formData.payment.way=t.payment.way||1,this.formData.payment.fee=t.payment.fee,this.formData.refer=t.refer,this.formData.permission=t.permission,this.useModelType=t.payment.fee>0?2:1,this.worksSource=t.refer?2:1,this.formData.permission.allow_use_in_haiyi=1,this.formData.permission.allow_resell=t.permission.allow_resell||2},goPlan:function(){var t=this.userInfo.join_stimulate,path=t?"/creationCenter":"/motivatingTask";t&&this.$logEvent("log_actions",{operation:"click_creator_revenue_center"}),window.open(path,"_blank")},onChangeOpen:function(t){if(this.$route.query.id&&this.num_of_task>=5e3){this.formData.publish_status=1;var e=this.$i18n.locale.startsWith("zh"),n="https://aihelp.net/questionnaire/#/?formId= ".concat(e?"formId=d9483db10f694841ba66414325fefbb6":"formId=291ecf705dee4ceaa97af1bcc0d017b8");window.open(n,"_blank")}}}},T=I,j=(n(2454),Object(v.a)(T,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"edit-model-max"},[e("el-form",{ref:"modelForm",staticClass:"custom-form my-edit-model-form",attrs:{"label-position":"top",model:t.formData,rules:t.rules}},[e("div",{staticClass:"content-box flex"},[e("div",{staticClass:"left"},[e("div",{staticClass:"board left-board"},[e("el-form-item",{attrs:{label:t.$t("ModelName"),prop:"name"}},[e("el-input",{attrs:{placeholder:t.$t("pleaseEnte"),maxlength:100},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),t._v(" "),e("el-form-item",{attrs:{label:t.$t("ModelType"),prop:"type"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{"popper-class":"custom-select",placeholder:t.$t("Pls_select"),disabled:!!t.$route.query.id||!!t.$route.query.verId},model:{value:t.formData.type,callback:function(e){t.$set(t.formData,"type",e)},expression:"formData.type"}},t._l(t.modelList,(function(n,o){return e("el-option",{key:"SD_"+o,attrs:{label:n.label,value:n.value}},[e("span",[t._v(t._s(n.label))]),t._v(" "),["Checkpoint","LORA","TextualInversion"].includes(n.value)?e("span",{staticClass:"yes-run-text"},[t._v(t._s(t.$t("yesRun")))]):t._e()])})),1)],1),t._v(" "),e("el-form-item",[e("template",{slot:"label"},[t._v("\n              "+t._s(t.$t("SetTags"))+"\n              "),e("el-tooltip",{attrs:{content:t.$t("setTabsTips"),placement:"top"}},[e("i",{staticClass:"iconfont icon-ruleIcon"})])],1),t._v(" "),e("SelectTab",{model:{value:t.formData.tags,callback:function(e){t.$set(t.formData,"tags",e)},expression:"formData.tags"}})],2),t._v(" "),e("el-form-item",{attrs:{label:t.$t("Source")}},[e("SelectLine",{attrs:{list:t.sourceList,dis:!!t.$route.query.train},on:{onChange:t.changeSource},model:{value:t.worksSource,callback:function(e){t.worksSource=e},expression:"worksSource"}})],1),t._v(" "),2===t.worksSource?e("el-form-item",{key:"refer",attrs:{label:t.$t("originalLink"),prop:"refer"}},[e("el-input",{attrs:{placeholder:t.$t("pleaseEnte"),maxlength:100},model:{value:t.formData.refer,callback:function(e){t.$set(t.formData,"refer",e)},expression:"formData.refer"}})],1):t._e(),t._v(" "),e("div",{staticClass:"push-income"},[e("span",[t._v(t._s(t.$t("motivatingTitle"))+"：")]),t._v(" "),e("span",{staticClass:"link-text",on:{click:t.goPlan}},[e("i",{staticClass:"iconfont icon-a-copylink"}),t._v("\n              "+t._s(t.$t("pushIncome"))+"\n            ")])])],1)]),t._v(" "),e("div",{staticClass:"right"},[e("div",{staticClass:"board form-one"},[t.$route.query.train?t._e():e("el-form-item",{attrs:{label:t.$t("hasPublic"),prop:"publish_status"}},[e("SelectLine",{attrs:{list:t.isOpenList},on:{onChange:t.onChangeOpen},model:{value:t.formData.publish_status,callback:function(e){t.$set(t.formData,"publish_status",e)},expression:"formData.publish_status"}})],1),t._v(" "),e("el-form-item",{attrs:{label:t.$t("ModelPayment")}},[e("SelectLine",{attrs:{list:t.modelUseList},on:{onChange:t.changeModelUse},model:{value:t.useModelType,callback:function(e){t.useModelType=e},expression:"useModelType"}})],1),t._v(" "),2===t.useModelType?e("el-row",{attrs:{gutter:16}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("paymentMethod"),prop:"payment.way"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{"popper-class":"custom-select",placeholder:t.$t("Pls_select")},model:{value:t.formData.payment.way,callback:function(e){t.$set(t.formData.payment,"way",e)},expression:"formData.payment.way"}},t._l(t.payList,(function(n,o){return e("el-option",{key:"SD_"+o,attrs:{label:t.$t(n.label),value:n.value,disabled:n.disabled}})})),1)],1)],1),t._v(" "),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:t.$t("paymentAmount"),prop:"payment.fee"}},[e("div",{class:"way-type-".concat(t.formData.payment.way||1)},[e("el-input",{on:{input:t.feeInput,blur:t.setPayNum},model:{value:t.formData.payment.fee,callback:function(e){t.$set(t.formData.payment,"fee",e)},expression:"formData.payment.fee"}})],1)])],1)],1):t._e()],1),t._v(" "),1===t.worksSource?e("div",{staticClass:"board form-two"},[e("el-form-item",{staticClass:"check-group-list",attrs:{label:t.$t("userEmpower")}},[e("div",{staticClass:"check-item"},[e("el-checkbox",{staticClass:"check-disabled",attrs:{label:t.$t("yesLineUse"),"true-label":1,"false-label":2,disabled:!0},model:{value:t.formData.permission.allow_use_in_haiyi,callback:function(e){t.$set(t.formData.permission,"allow_use_in_haiyi",e)},expression:"formData.permission.allow_use_in_haiyi"}},[t._v("\n                "+t._s(t.$t("yesLineUse"))+"\n                "),e("el-tooltip",{attrs:{content:t.$t("haiyiPluckImg"),placement:"top"}},[e("i",{staticClass:"iconfont icon-ruleIcon"})])],1)],1),t._v(" "),e("div",{staticClass:"check-item"},[e("el-checkbox",{attrs:{label:t.$t("comfyUpLoad9"),"true-label":1,"false-label":2},model:{value:t.formData.permission.allow_download,callback:function(e){t.$set(t.formData.permission,"allow_download",e)},expression:"formData.permission.allow_download"}})],1),t._v(" "),e("div",{staticClass:"check-item"},[e("el-checkbox",{attrs:{label:t.$t("fusionYes"),"true-label":1,"false-label":2},model:{value:t.formData.permission.allow_model_mix,callback:function(e){t.$set(t.formData.permission,"allow_model_mix",e)},expression:"formData.permission.allow_model_mix"}})],1)]),t._v(" "),e("el-form-item",{staticClass:"check-group-list",attrs:{label:t.$t("commercialYes")}},[e("div",{staticClass:"check-item"},[e("el-checkbox",{attrs:{label:t.$t("commercialYesImg"),"true-label":1,"false-label":2},model:{value:t.formData.permission.allow_commercial_use,callback:function(e){t.$set(t.formData.permission,"allow_commercial_use",e)},expression:"formData.permission.allow_commercial_use"}})],1),t._v(" "),e("div",{staticClass:"check-item"},[e("el-checkbox",{attrs:{label:t.$t("modelSellYes"),"true-label":1,"false-label":2},model:{value:t.formData.permission.allow_resell,callback:function(e){t.$set(t.formData.permission,"allow_resell",e)},expression:"formData.permission.allow_resell"}})],1)])],1):t._e()])])]),t._v(" "),e("div",{staticClass:"footer-box flex"},[e("div",{staticClass:"btnsub flex_c_m",on:{click:function(e){return t.HandNextStep("modelForm")}}},[t._v("\n      "+t._s(t.$t("NextStep"))+"\n    ")])])],1)}),[],!1,null,"85b41190",null).exports),L=(n(75),n(70),n(50),n(29),n(15)),P=(n(237),n(238),n(239),n(240),n(241),n(242),n(243),n(244),n(245),n(246),n(247),n(248),n(249),n(250),n(251),n(252),n(253),n(48),n(43),n(89),n(216)),M=n(390),E=n(5),A={props:{existObj:{type:Object,default:function(){return{name:"",url:"",open:!1}}}},data:function(){return{handleInitHelp:M.a,modelExistDialog:!1}},methods:{copyLink:function(){var text=this.existObj.url;text&&Object(E.d)(text),this.$message.success(this.$t("CopySuccess"))},claimModel:function(){var t="https://aihelp.net/questionnaire/#/?formId=78dea50f5cbb426cb136748154c029aa";this.$i18n.locale.startsWith("zh")&&(t="https://aihelp.net/questionnaire/#/?formId=bffe7a2307454e859f559913e28d4f19"),window.open(t,"_blank")}}};function N(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function R(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?N(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var B={props:["value","createId","modelType","disabled","modelTypeName","size32","baseModelFlux"],components:{modelExistDialog:Object(v.a)(A,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticStyle:{"margin-top":"25vh !important"},attrs:{title:t.$t("Tip"),visible:t.modelExistDialog,width:"500px","modal-append-to-body":!1,"close-on-click-modal":!1,"append-to-body":!0,"custom-class":"SaDialog"},on:{"update:visible":function(e){t.modelExistDialog=e}}},[e("div",{staticClass:"flex justify-between flex-wrap",staticStyle:{margin:"20px 0"}},[e("div",{staticClass:"left",staticStyle:{"margin-top":"15px","word-break":"break-word"}},[e("i",{staticClass:"el-icon-warning",staticStyle:{color:"#f19c5c","margin-right":"15px",transform:"scale(1.5)"}}),t._v("\n      "+t._s(t.$t("newUpload_Model_1"))+"，"),t.existObj.url&&t.existObj.open?e("span",[t._v(t._s(t.$t("Upload_Model_2"))),e("a",{staticStyle:{color:"#e5af5d",cursor:"pointer"},attrs:{href:t.existObj.url,target:"_blank"}},[t._v(t._s(t.existObj.name)+"，")])]):t._e(),t._v("\n      "+t._s(t.$t("Upload_Model_3"))+"\n      "),e("span",{staticStyle:{color:"#e5af5d",cursor:"pointer"},on:{click:function(e){return e.preventDefault(),t.handleInitHelp()}}},[t._v(t._s(t.$t("Contact_customer")))])]),t._v(" "),t.existObj.url&&t.existObj.open?e("div",{staticStyle:{color:"#4784ff",cursor:"pointer","margin-top":"15px"},on:{click:t.copyLink}},[e("i",{staticClass:"iconfont icon-link",staticStyle:{"margin-right":"5px"}}),t._v("\n      "+t._s(t.$t("CopyLink"))+"\n    ")]):t._e()]),t._v(" "),e("div",{staticClass:"bntitem",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.modelExistDialog=!1}}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("el-button",{on:{click:t.claimModel}},[t._v(t._s(t.$t("ClaimModel")))])],1)])}),[],!1,null,"6324ffff",null).exports},data:function(){return{uploadStatusIcon:{init:"",pending:"el-icon-loading",complete:"el-icon-circle-check",fail:"el-icon-refresh-left",error:"el-icon-close"},uploadingStatus:"init",uploadConfig:"",fileChunk:[],worker:null,progress:0,errNum:3,waitUploadIndex:[],existObj:{name:"",url:"",open:!1},fileObj:{name:""}}},computed:{isDisabled:function(){return"pending"===this.uploadingStatus||this.disabled},acceptFile:function(){return["Checkpoint","LORA"].includes(this.modelTypeName)?".ckpt,.safetensors":".safetensors,.pt,.zip"}},methods:{startUpload:function(t){var e=this,n=t.size,o=t.name;if(!this.isDisabled){var r=this.validFileSize(n),l=r.limit,c=r.item;if(!l){var d=c.limitTip||{},h=d.max,m=void 0===h?"":h,v=d.min,f=void 0===v?"":v,_=this.$t("HttpErrorCode_30003");return _=f?this.$t("fileMaxLimit",{min:f,max:m}):this.$t("fileMaxLimit2",{max:m}),void this.$message.warning(_)}var y={file_size:n,file_name:o,content_type:"application/octet-stream",category:1,model_type:this.modelType,create_id:this.createId,model_type_name:this.modelTypeName,sub_category:1};this.baseModelFlux||delete y.sub_category,this.uploadingStatus="pending",this.fileObj.name=o;try{Object(P.c)(y).then((function(r){e.uploadConfig=R(R({},r.data),{},{file_size:n,file_name:o}),e.cutFile(t,r.data.chunk_size,e.uploadConfig.presigned.length)}))}catch(t){this.uploadingStatus="init"}}},cutFile:function(t,e,n){var o=this;this.worker=this.$worker.run((function(t,e,n){for(var o=[],r=0;r<t.size;)0===--n&&(e=t.size-r),o.push({file:t.slice(r,r+e)}),r+=e;return o.map((function(t,e){return{uploadStatus:!1,file:t,index:e,progress:0}}))}),[t,e,n]).then((function(t){o.fileChunk=t,o.$set(o,"fileChunk",t),o.uploadFile()}))},uploadFile:function(){this.waitUploadIndex=this.getWaitUplaodChunkIndex(),this.uploadChunk()},reduceQueue:function(){this.waitUploadIndex.splice(0,1),this.uploadChunk()},uploadChunk:function(){var t=this;if(0!=this.waitUploadIndex.length){var e=this.waitUploadIndex[0],n=this.fileChunk[e],o=this.uploadConfig.presigned,r=new XMLHttpRequest;r.open("PUT",o[e]),r.setRequestHeader("Content-Type","application/octet-stream"),r.onerror=function(e){t.errNum--,t.errNum<0?t.uploadingStatus="fail":setTimeout((function(){t.uploadChunk()}),3e3)},r.upload.onprogress=function(e){var n=e.loaded,o=e.total,r=Math.floor(n/o*1e4),l=t.fileChunk.length,c=Math.floor(1/l*1e4);t.updateProgress(c*r/1e4)},r.onreadystatechange=function(){if(4===r.readyState&&200===r.status){if(t.errNum=3,!t.fileChunk[e])return;t.fileChunk[e].uploadStatus=!0,t.reduceQueue()}else 4===r.readyState&&200!==r.status&&0===t.errNum&&t.$message.error(t.$t("uploadError"))},r.send(n.file.file)}else this.chunkUploadCheck()},updateProgress:function(t){var e=this.fileChunk.filter((function(t){return t.uploadStatus})).length,n=this.fileChunk.length;if(n){var o=parseFloat((e/n*1e4).toFixed(2));o+=t,this.progress=parseFloat((o/100).toFixed(2))}},chunkUploadCheck:function(){var t=this,e=this.uploadConfig.file_id;Object(P.a)({create_id:this.createId,file_id:e}).then((function(e){if(e.data.model_id){var n=e.data,o=n.model_id,r=n.model_name,l=void 0===r?"Model":r,c=n.model_status,d=void 0===c?2:c;2===d&&(t.existObj.url="".concat(window.location.origin,"/")+"models/detail/"+o,t.existObj.name=l,t.existObj.open=2===d,t.$refs.modelExist.modelExistDialog=!0),1===d&&t.$alert(t.$t("modelNoUpdates"),t.$t("Tip"),{confirmButtonText:t.$t("Confirm"),type:"error"})}var h=e.data.unconfirmed;h.length?(h.forEach((function(e){t.fileChunk[Number(e)-1].progress=0,t.fileChunk[Number(e)-1].uploadStatus=!1})),t.waitUploadIndex=h.map((function(t){return Number(t)})),t.uploadingStatus="pending",t.uploadFile()):(t.progress=100,t.uploadingStatus="complete",t.$emit("input",t.uploadConfig.file_id),t.$emit("upfinish",R({},t.fileObj)))})).catch((function(e){t.uploadingStatus="error"}))},getWaitUplaodChunkIndex:function(){return this.fileChunk.filter((function(t){return!t.uploadStatus})).map((function(t){return t.index}))},curstomUpload:function(t){this.startUpload(t.file)},refresh:function(){["fail","error"].includes(this.uploadingStatus)&&("error"!==this.uploadingStatus?(this.uploadingStatus="pending",this.errNum=3,this.uploadChunk()):this.clear())},clear:function(){this.errNum=3,this.fileChunk=[],this.uploadConfig="",this.waitUploadIndex=[],this.progress=0,this.uploadingStatus="init"},validFileSize:function(t){var e=this.modelTypeName;this.size32&&(e="max23GBSize");var n=D.e[e],o=D.e[e],r=o.max,l=o.min;return{limit:t<r&&t>l,item:n}}}},F=(n(2455),Object(v.a)(B,(function(){var t=this,e=t._self._c;return e("div",[e("el-upload",{staticClass:"upload-file-item",attrs:{action:"/","http-request":t.curstomUpload,"show-file-list":!1,disabled:t.isDisabled,accept:t.acceptFile}},[e("div",{staticClass:"upload-btn"},[e("div",[e("i",{staticClass:"el-icon-upload2"}),t._v(" "),e("span",{staticClass:"file-name"},[t._v(t._s(t.uploadConfig?t.uploadConfig.file_name:t.value?t.value:t.$t("PickFile")))])]),t._v(" "),e("i",{class:t.uploadStatusIcon[t.uploadingStatus],on:{click:t.refresh}})]),t._v(" "),e("el-progress",{directives:[{name:"show",rawName:"v-show",value:t.uploadConfig,expression:"uploadConfig"}],attrs:{percentage:t.progress,color:"#0d9488"}})],1),t._v(" "),e("modelExistDialog",{ref:"modelExist",attrs:{existObj:t.existObj}})],1)}),[],!1,null,"73dd5e81",null).exports);function U(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function V(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?U(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var W={inject:["top"],components:{MyEditor:$.a,ModelFileUpload:F},props:{item:{type:Object,default:function(){return{}}},idx:{type:Number,default:0},open:{type:Boolean,default:!0},modelType:{type:Number,default:2},modelTypeName:{type:String,default:""},modelName:{type:String,default:""}},data:function(){return{disabledBaseModel:!1,formData:{name:"",base_model:"",permission:{allow_same:1},desc:"",file_id:"",file_name:"",trigger_words:[],epoch:1,step:0,clip_skip:1,train_model_result_no:""},rules:{name:[{required:!0,message:this.$t("pleaseEnte")}],base_model:{required:!0,message:this.$t("Pls_select")},file_id:{required:!0,message:this.$t("Pls_select")}},fileErr:!1,fileName:""}},watch:{modelListRender:{handler:function(t){var e=this;this.$nextTick((function(){1===t.length&&["Flux.1 D","SD 3.5L","SD 3.5M"].includes(t[0])&&(e.disabledBaseModel=!0,e.formData.base_model=t[0])}))},immediate:!0,deep:!0}},computed:V(V(V({},Object(c.e)("payment",["paymentInfo"])),Object(c.c)("user",["isCompanyAccount"])),{},{modelListRender:function(){var t;if("LORA"===this.modelTypeName&&(null===(t=this.item)||void 0===t||!t.id)){var e,n,o;if(null!==(e=this.top)&&void 0!==e&&e.baseModelIsFlux)return["Flux.1 D"];if(null!==(n=this.top)&&void 0!==n&&n.baseModelIsSD35)return[(null===(o=this.$route)||void 0===o||null===(o=o.query)||void 0===o?void 0:o.base_model)||"SD 3.5L"]}return this.disabledBaseModel=!1,D.a},isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)||this.isCompanyAccount},modelData:function(){return this.top.allFormData.model},wordsOptions:function(){var t,e=(null===(t=this.formData)||void 0===t?void 0:t.trigger_words)||[];return Array.from(e).map((function(t){return{value:t,label:t}}))}}),methods:{moveUp:function(){this.$emit("onMoveUp",this.item)},moveDown:function(){this.$emit("onMoveDown",this.item)},delItem:function(){this.$emit("onDelItem",this.item)},copyItem:function(){var t=this.formData,e=this.item,n=JSON.parse(JSON.stringify(t));n.file_id="",this.$emit("onCopyItem",{formData:n,item:e})},commChange:function(t){this.isVip||2!==t||(this.$EventBus.$emit("showBreakDialog","TrainLoraTipWeb","basic"),this.formData.permission.allow_same=1)},fileFinish:function(t){this.fileName=t.name,this.formData.file_name=t.name},fillFormData:function(){var data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.formData;this.formData=Object(E.e)(t,data),this.formData.trigger_words=Object(L.a)(new Set(this.formData.trigger_words)),this.$refs.MyEditorRef.setHtml(this.formData.desc)},submitForm:function(t){var e=this;this.$refs.modelVmForm.validate((function(n){e.fileErr=!e.formData.file_id,t&&t(n)}))}}},H=W,z=(n(2456),Object(v.a)(H,(function(){var t,e,n=this,o=n._self._c;return n.item.showDom?o("div",{staticClass:"vmformbox",attrs:{id:n.item.vmId}},[o("el-form",{ref:"modelVmForm",staticClass:"custom-form",attrs:{"label-position":"top",model:n.formData,rules:n.rules}},[o("div",{staticClass:"item-box board"},[o("el-form-item",{attrs:{label:n.$t("versionsName"),prop:"name"}},[o("el-row",{attrs:{gutter:16}},[o("el-col",{attrs:{span:20}},[o("el-input",{attrs:{maxlength:100,disabled:!0},model:{value:n.modelName,callback:function(t){n.modelName=t},expression:"modelName"}})],1),n._v(" "),o("el-col",{attrs:{span:4}},[o("el-input",{attrs:{maxlength:50},model:{value:n.formData.name,callback:function(t){n.$set(n.formData,"name",t)},expression:"formData.name"}})],1)],1)],1),n._v(" "),o("el-form-item",{directives:[{name:"show",rawName:"v-show",value:n.open,expression:"open"}],attrs:{label:n.$t("BaseModel"),prop:"base_model"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{disabled:n.disabledBaseModel,"popper-class":"custom-select",placeholder:n.$t("Pls_select")},model:{value:n.formData.base_model,callback:function(t){n.$set(n.formData,"base_model",t)},expression:"formData.base_model"}},n._l(n.modelListRender,(function(t,e){return o("el-option",{key:"SD_"+e,attrs:{label:t,value:t}})})),1)],1),n._v(" "),n.item.train_model_no?o("el-form-item",{directives:[{name:"show",rawName:"v-show",value:n.open,expression:"open"}],staticStyle:{"margin-bottom":"0"}},[o("div",{staticClass:"is_community-item"},[o("span",[n._v(n._s(n.$t("sameModel")))]),n._v(" "),o("el-switch",{attrs:{"active-value":1,"inactive-value":2},on:{change:n.commChange},model:{value:n.formData.permission.allow_same,callback:function(t){n.$set(n.formData.permission,"allow_same",t)},expression:"formData.permission.allow_same"}})],1)]):n._e(),n._v(" "),o("el-form-item",{attrs:{prop:"desc"}},[o("template",{slot:"label"},[n._v("\n          "+n._s(n.$t("verIntroduction"))+"\n          "),o("el-tooltip",{attrs:{content:n.$t("versionInfoTips"),placement:"top"}},[o("i",{staticClass:"iconfont icon-ruleIcon"})])],1),n._v(" "),o("MyEditor",{ref:"MyEditorRef",attrs:{height:"120px",defaultProps:{mode:"simple"}},model:{value:n.formData.desc,callback:function(t){n.$set(n.formData,"desc",t)},expression:"formData.desc"}})],2),n._v(" "),o("el-form-item",{directives:[{name:"show",rawName:"v-show",value:n.open,expression:"open"}],attrs:{label:n.$t("CheckpointFile"),prop:"file_id"}},[o("model-file-upload",{ref:"modelsFileUpload",class:n.fileErr&&"file-err",attrs:{baseModelFlux:(null===(t=n.formData)||void 0===t?void 0:t.base_model.includes("Flux"))||!1,size32:["Flux","SD 3.5"].includes(null===(e=n.formData)||void 0===e?void 0:e.base_model)||!1,createId:n.modelData.id,modelType:n.modelType,modelTypeName:n.modelTypeName,disabled:!!n.item.id||!!n.formData.train_model_result_no},on:{upfinish:n.fileFinish},model:{value:n.formData.file_id,callback:function(t){n.$set(n.formData,"file_id",t)},expression:"formData.file_id"}})],1),n._v(" "),o("el-row",{directives:[{name:"show",rawName:"v-show",value:n.open,expression:"open"}],attrs:{gutter:16}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:n.$t("TriggerWords"),prop:"trigger_words"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",filterable:"","popper-class":"custom-select","allow-create":"","default-first-option":"",placeholder:n.$t("pleaseEnte")},model:{value:n.formData.trigger_words,callback:function(t){n.$set(n.formData,"trigger_words",t)},expression:"formData.trigger_words"}},n._l(n.wordsOptions,(function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),n._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:n.$t("epochForNum"),prop:"epoch"}},[o("el-input-number",{staticClass:"my-input-number",attrs:{"controls-position":"right",min:1,max:1e5},model:{value:n.formData.epoch,callback:function(t){n.$set(n.formData,"epoch",t)},expression:"formData.epoch"}})],1)],1)],1),n._v(" "),o("el-row",{directives:[{name:"show",rawName:"v-show",value:n.open,expression:"open"}],attrs:{gutter:16}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:n.$t("stepsIterationNum"),prop:"step"}},[o("el-input-number",{staticClass:"my-input-number",attrs:{"controls-position":"right",min:0,step:500},model:{value:n.formData.step,callback:function(t){n.$set(n.formData,"step",t)},expression:"formData.step"}})],1)],1),n._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:n.$t("clipSkipClip"),prop:"clip_skip"}},[o("el-input-number",{staticClass:"my-input-number",attrs:{"controls-position":"right",min:1,max:12},model:{value:n.formData.clip_skip,callback:function(t){n.$set(n.formData,"clip_skip",t)},expression:"formData.clip_skip"}})],1)],1)],1),n._v(" "),o("div",{staticClass:"action-right-btns"},[o("div",{staticClass:"item flex_c_m",on:{click:n.delItem}},[o("i",{staticClass:"iconfont icon-postDelete"})]),n._v(" "),o("div",{staticClass:"item flex_c_m",on:{click:n.moveUp}},[o("i",{staticClass:"el-icon-arrow-up"})]),n._v(" "),o("div",{staticClass:"item flex_c_m",on:{click:n.moveDown}},[o("i",{staticClass:"el-icon-arrow-down"})]),n._v(" "),o("div",{staticClass:"item flex_c_m",on:{click:n.copyItem}},[o("i",{staticClass:"iconfont icon-fuzhi"})])])],1)])],1):n._e()}),[],!1,null,"cbd29104",null).exports),G=n(41);function J(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function K(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?J(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Y={inject:["top"],components:{FormItem:z},data:function(){return{versionList:[],vopen:!0,modelType:2,modelTypeName:"",modelName:""}},methods:{addVersion:function(){var t={prefixName:this.modelName||this.top.allFormData.model.name,vmId:"vm-".concat(Object(E.j)()),showDom:!0};this.versionList.push(t),this.versionList.length>1&&this.$nextTick((function(){var e=document.querySelector("#vmListId"),n=document.querySelector("#".concat(t.vmId)),o=e.querySelector(":first-child");setTimeout((function(){e.insertBefore(n,o)}),500)}))},toggleInfo:function(t){this.vopen=!t},onMoveUp:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).vmId,e=document.querySelector("#".concat(t));e.previousElementSibling&&e.parentNode.insertBefore(e,e.previousElementSibling),e.scrollIntoView({behavior:"auto",block:"start"})},onMoveDown:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).vmId,e=document.querySelector("#".concat(t));e.nextElementSibling&&e.parentNode.insertBefore(e.nextElementSibling,e),e.scrollIntoView({behavior:"auto",block:"start"})},onDelItem:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.vmId,o=e.id,r=this.$route.query.id;this.$confirm(this.$t("deleteModelVer"),this.$t("Tip"),{confirmButtonText:this.$t("Delete"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){o?Object(G.g)({model_id:r,ver_id:o}).then((function(){t.versionList.forEach((function(t){t.vmId===n&&(t.showDom=!1)}))})):t.versionList.forEach((function(t){t.vmId===n&&(t.showDom=!1)}))}))},onCopyItem:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).formData;this.addVersion();var e=this.$refs.FormItemRef,n=this.versionList.length-1,o=this.versionList[n];this.$nextTick((function(){e.forEach((function(e){e.item.vmId===o.vmId&&e.fillFormData(t)}))}))},NextUp:function(){this.$emit("onStepUp")},NextStep:function(){var t=this.$refs.FormItemRef||[],e=t.map((function(t){return K(K({},t.formData),t.item)})).filter((function(t){return t.showDom}));if(e.length){var n=Array.from(document.querySelector("#vmListId").querySelectorAll(".vmformbox")).map((function(t){return t.id})).map((function(t){return e.find((function(em){return em.vmId===t}))})),o=[];t.filter((function(t){return t.item.showDom})).forEach((function(t){t.submitForm&&t.submitForm((function(t){!t&&o.push(t)}))}));this.$route.query.id;if(Object(E.t)(this.$route.query))if(this.modelvFile(n))return;o.length?this.vopen=!0:this.$emit("onNext",n)}},modelvFile:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=D.c.find((function(e){return e.name===t.modelTypeName})),o=e.filter((function(t){var e=t.file_name.split(".").pop();return!n.fileTypes.includes(e)}));if(o.length>0){var r=o.map((function(t){return t.name})).filter((function(t){return t})),l=r.length?"：[".concat(r.join(),"]"):"",c="".concat(this.$t("modelFileOut")).concat(l);this.$message(c)}return o.length>0},versionFill:function(t){var e=this;this.versionList=t.map((function(t){var n={prefixName:e.top.allFormData.model.name,vmId:"vm-".concat(Object(E.j)()),showDom:!0,id:t.id,train_model_no:t.train_model_no};return e.top.allFormData.ver_list.push({id:t.id,vmId:n.vmId,samples:t.samples||[]}),n})),this.$nextTick((function(){var n;((null===(n=e.$refs)||void 0===n?void 0:n.FormItemRef)||[]).forEach((function(e,i){var n,o,r,l,c,d=t[i],h={name:d.name||"",base_model:d.base_model||"",desc:"<div>".concat((null==d?void 0:d.desc)||"","</div>"),file_id:(null==d||null===(n=d.resource)||void 0===n?void 0:n.name)||"",trigger_words:d.trained_words||[],train_model_result_no:d.train_model_result_no||"",epoch:(null==d||null===(o=d.train_param)||void 0===o?void 0:o.epoch)||1,step:(null==d||null===(r=d.train_param)||void 0===r?void 0:r.step)||0,clip_skip:(null==d||null===(l=d.train_param)||void 0===l?void 0:l.clip_skip)||1,permission:{allow_same:(null==d||null===(c=d.permission)||void 0===c?void 0:c.allow_same)||1}};e.fillFormData(h)}))}))}}},Q=Y,X=(n(2457),Object(v.a)(Q,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"edit-version-max"},[e("div",{staticClass:"top-btntab flex_c_m"},[e("div",{staticClass:"item flex_c_m",on:{click:t.addVersion}},[e("i",{staticClass:"iconfont icon-workflow_icon_new"}),t._v("\n      "+t._s(t.$t("pubLora2"))+"\n    ")]),t._v(" "),e("div",{staticClass:"item flex_c_m",on:{click:function(e){return t.toggleInfo(t.vopen)}}},[e("i",{staticClass:"iconfont",class:t.vopen?"icon-shousuo":"icon-icon-zhankai"}),t._v("\n      "+t._s(t.$t("toggleVersionInfo"))+"\n    ")])]),t._v(" "),e("div",{staticClass:"versions-tips flex_c"},[t._v(t._s(t.$t("versionsTips")))]),t._v(" "),e("div",{staticClass:"version-bord-list",attrs:{id:"vmListId"}},t._l(t.versionList,(function(n,i){return e("FormItem",{key:i,ref:"FormItemRef",refInFor:!0,attrs:{item:n,idx:i,open:t.vopen,modelType:t.modelType,modelTypeName:t.modelTypeName,modelName:t.modelName},on:{onMoveUp:t.onMoveUp,onMoveDown:t.onMoveDown,onDelItem:t.onDelItem,onCopyItem:t.onCopyItem}})})),1),t._v(" "),e("div",{staticClass:"action-btn-box flex_c_m"},[e("div",{staticClass:"item prenext flex_c_m",on:{click:t.NextUp}},[t._v("\n      "+t._s(t.$t("PreNext"))+"\n    ")]),t._v(" "),e("div",{staticClass:"item nextstep flex_c_m",on:{click:t.NextStep}},[t._v("\n      "+t._s(t.$t("NextStep"))+"\n    ")])])])}),[],!1,null,"e893d04e",null).exports),Z=(n(110),n(3)),tt=(n(20),n(38)),et=n(45);function it(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var at={props:{vmId:{type:String,default:""},verId:{type:String,default:""}},data:function(){return{uploading:!1,UPLOAD:new tt.a({type:2}),realWidth:0,realHeight:0,style:{}}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?it(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):it(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(c.e)("user",["token"])),methods:{handleBeforeUpload:function(t,e){var n=this;return Object(Z.a)(regeneratorRuntime.mark((function o(){var r,l;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(n.token){o.next=3;break}return n.$EventBus.$emit("openLoginDialog"),o.abrupt("return");case 3:if(r=n.UPLOAD,["image/jpeg","image/png","image/jpg","image/webp"].includes(t.type)){o.next=8;break}return n.$message.error(n.$t("AllowImageFiles")),o.abrupt("return",!1);case 8:if(!(l=t)||l.size){o.next=11;break}return o.abrupt("return",!1);case 11:if(!(l.size/1024/1024>10)){o.next=21;break}return o.prev=12,o.next=15,Object(et.a)(l,10485760);case 15:l=o.sent,o.next=21;break;case 18:return o.prev=18,o.t0=o.catch(12),o.abrupt("return",!1);case 21:if(!n.uploading){o.next=23;break}return o.abrupt("return");case 23:return n.uploading=!0,r.startUpload(l).then((function(t){n.getImgwh(t,l).then((function(t){n.uploading=!1;var o={info:t,vmId:n.vmId};e?e(o):n.$emit("onSuccess",o)})).catch((function(t){n.uploading=!1}))})).catch((function(t){n.uploading=!1,n.$message.error(n.$t("uploadError"))})),o.abrupt("return",!1);case 26:case"end":return o.stop()}}),o,null,[[12,18]])})))()},getImgwh:function(t,e){var n=this;return new Promise((function(o,r){var img=new Image;img.src=t,img.onload=function(){var l={width:img.width,height:img.height,url:t,has_meta:2,bytes:e.size},param={art_model_ver_no:n.verId||"",action:3,img_url:t,source:5};Object(G.h)(param).then((function(t){l.has_meta=1,10404===t.status.code&&(l.has_meta=2),o(l)})).catch((function(){l.has_meta=2,r(l)}))},img.error=function(){r({})}}))},handleBeforeUploadEmpty:function(){}}},nt=at,ot=(n(2458),Object(v.a)(nt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"upload-box"},[e("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:t.uploading,expression:"uploading"}],attrs:{drag:"",action:"#","before-upload":t.handleBeforeUpload,disabled:t.uploading,"http-request":t.handleBeforeUploadEmpty,"show-file-list":!1,accept:"image/*"}},[e("i",{staticClass:"el-icon-upload"}),t._v(" "),e("div",{staticClass:"el-upload__text"},[t._v("\n      "+t._s(t.$t("TaskUploadImageClickUploadTips"))+"\n    ")]),t._v(" "),e("div",{staticClass:"el-upload__text_1"},[t._v("\n      "+t._s(t.$t("uploadWarnTips"))+"\n    ")])])],1)}),[],!1,null,"638c8e3e",null).exports),st=n(105);function lt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function ct(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?lt(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ut={data:function(){return{dialogVisible:!1,nodataimg:n(577),params:{page:1,page_size:30,model_no:this.$route.query.id,order:"new",time_to:0},list:[],loading:!1,isEnd:!1,actItem:{}}},methods:{showModel:function(t){this.dialogVisible=!0,this.actItem=t,this.refreshList()},hideModel:function(){this.dialogVisible=!1},refreshList:function(){this.params.page=1,this.params.time_to=0,this.list=[],this.getWorkList()},getWorkList:function(){var t=this;this.loading=!0,Object(G.l)(this.params).then((function(e){var n=e.data,o=n.items,r=n.has_more,l=o.map((function(t){return ct(ct({},t),{},{active:!1})}));t.list=t.list.concat(l||[]),1===t.params.page&&(t.params.time_to=e.data.time_ms),t.isEnd=!r,t.loading=!1})).catch((function(e){t.loading=!1}))},handleScroll:function(){var t=this.$refs.scrollContainer;t.scrollTop+t.clientHeight>=t.scrollHeight&&(this.params.page++,this.getWorkList())},checkImg:function(t){t.active=!t.active},submitImg:function(){var t=this.list.filter((function(t){return t.active}));this.hideModel(),this.$emit("onClick",{list:t,item:this.actItem})},goCreateImg:function(){var t=this,e=this.$route.query.id;Object(st.b)({id:e}).then((function(e){t.hideModel(),t.$EventBus.$emit("openGenerate",{action:1,data:{source:Object.assign({},e.data,{taskSource:3,hsaModelEdit:!0})}})}))}}},pt=(n(2459),Object(v.a)(ut,(function(){var t=this,e=t._self._c;return e("div",[e("el-dialog",{staticClass:"my-relate-dialog",attrs:{title:t.$t("RelatedWorks"),visible:t.dialogVisible,top:"4vh",width:"1080px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[t.list.length?e("div",{ref:"scrollContainer",staticClass:"img-list-box flex",on:{scroll:t.handleScroll}},[e("div",{staticClass:"add-item flex_c_m",on:{click:t.goCreateImg}},[e("i",{staticClass:"iconfont icon-add-icon"})]),t._v(" "),t._l(t.list,(function(n,i){return e("div",{key:"img"+i,staticClass:"item",class:n.active&&"act-item"},[e("el-image",{staticClass:"image",attrs:{src:n.cover},on:{click:function(e){return t.checkImg(n)}}})],1)}))],2):t._e(),t._v(" "),t.list.length?t._e():e("div",{staticClass:"no-data-box flex_c_m"},[e("img",{staticClass:"image",attrs:{src:t.nodataimg}}),t._v(" "),e("div",{staticClass:"text flex_c"},[t._v("\n        "+t._s(t.$t("noRelatedWorks"))+"，\n        "),e("span",{on:{click:t.goCreateImg}},[t._v("\n          "+t._s(t.$t("GotoGenerate"))+"\n          "),e("i",{staticClass:"iconfont icon-right"})])])]),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{staticClass:"cancel-btn",on:{click:t.hideModel}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("el-button",{staticClass:"submit-btn",attrs:{type:"primary"},on:{click:t.submitImg}},[t._v(t._s(t.$t("Confirm")))])],1)])],1)}),[],!1,null,"5714d206",null).exports),ht=n(187),mt=n(236),vt={inject:["top"],components:{UploadImg:ot,RelatedWorksModal:pt,MetaTooltipVue:ht.a},data:function(){return{imgInfo:{},visiblePop:!1}},computed:{imgList:function(){return this.top.allFormData.ver_list}},methods:{fileSuccess:function(data){var t=data.info,e=data.vmId;this.top.allFormData.ver_list.forEach((function(n){n.samples.length<10&&n.vmId===e&&n.samples.push(t)}))},showImgModel:function(t){this.$refs.RelatedWorksModalRef.showModel(t)},checkImgok:function(t){var e=t.list,n=t.item,o=e.map((function(t){return{url:t.cover,width:t.cover_width,height:t.cover_height,has_meta:1,meta_id:"1",id:t.id}})),r=n.samples.concat(o),l=Object(L.a)(new Set(r.map((function(t){return t.url})))).map((function(t){return r.find((function(em){return em.url===t}))}));l.length>10&&l.slice(0,10),this.top.allFormData.ver_list.forEach((function(t){t.vmId===n.vmId&&(t.samples=l)}))},delImg:function(t){var e=t.id,n=t.ix;this.top.allFormData.ver_list.forEach((function(t){t.vmId===e&&t.samples.splice(n,1)}))},changeCover:function(t){var e=this,n=document.createElement("input");n.type="file",n.style.display="none",document.body.appendChild(n),n.click(),n.addEventListener("change",(function(){var o=n.files[0];e.$refs.uploadImgRef.forEach((function(n){n.vmId===t&&n.handleBeforeUpload(o,(function(n){e.top.allFormData.ver_list.forEach((function(e){if(e.vmId===t){var o=JSON.parse(JSON.stringify(e.samples));o[0]=n.info,e.samples=o}}))}))}))}))},publishModel:function(){var t=this.top.allFormData.ver_list,e=t.map((function(t){return!t.samples.length})).filter((function(t){return t})),n=t.map((function(t){return!t.samples.length||!t.samples.some((function(t){return t.url&&""!==t.url.trim()}))})).filter(Boolean);e.length||n.length?this.$message(this.$t("PleaseUploadExampleImages")):this.$emit("onPublish")},nextUp:function(){this.$emit("onStepUp")},showImageInfo:function(t,em){em.meta_id?this.getRelatedImg(em.id):this.getUploadImg(t,em)},getUploadImg:function(t,em){var e=this,param={art_model_ver_no:(null==t?void 0:t.id)||"",action:3,img_url:em.url,source:3},n=r.a.service();Object(G.h)(param).then((function(t){var n,o,r=(t||{}).data,data=void 0===r?{}:r;e.imgInfo.meta=data.meta,e.imgInfo.model_id=null===(n=data.art_model)||void 0===n?void 0:n.id,e.imgInfo.model_name=null===(o=data.art_model)||void 0===o?void 0:o.name,e.imgInfo.category=data.type,e.visiblePop=!e.visiblePop})).finally((function(){e.$nextTick((function(){n.close()}))}))},getRelatedImg:function(t){var e=this,n=r.a.service();Object(mt.a)({id:t}).then((function(t){var n=(t||{}).data,data=void 0===n?{}:n;e.imgInfo.meta=data.meta,e.imgInfo.model_id=data.model_id,e.imgInfo.model_name=data.model_name,e.imgInfo.category=data.type,e.visiblePop=!e.visiblePop})).finally((function(){e.$nextTick((function(){n.close()}))}))},showRelated:function(t){var e=this.top.allFormData.model.type,n=["Checkpoint","LORA","TextualInversion"].includes(e),o=this.$route.query.id,r=t.id;return n&&o&&r}}};n(2460);function ft(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function gt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ft(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ft(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var _t={provide:function(){return{top:this}},components:{Step:f,EditModel:j,EditVersion:X,AddImage:Object(v.a)(vt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"add-image-max"},[e("div",{staticClass:"image-edit-list"},t._l(t.imgList,(function(n,i){return e("div",{key:n.vmId,staticClass:"img-item board"},[e("div",{staticClass:"title-text"},[t._v(t._s(t.$t("versionsName"))+"："+t._s(n.name))]),t._v(" "),e("div",{staticClass:"update-img-title flex_m"},[e("div",{staticClass:"left"},[e("span",{staticClass:"text-1",attrs:{"data-star":"*"}},[t._v(t._s(t.$t("versionWork")))]),t._v(" "),e("span",{staticClass:"text-2"},[t._v("("+t._s(t.$t("numScoped"))+"1-10)")])]),t._v(" "),t.showRelated(n)?e("div",{staticClass:"right flex_m"},[e("span",{on:{click:function(e){return t.showImgModel(n)}}},[t._v(t._s(t.$t("checkInWorks")))]),t._v(" "),e("el-tooltip",{attrs:{content:t.$t("oneStyleWorkTips"),placement:"top"}},[e("i",{staticClass:"iconfont icon-ruleIcon"})])],1):t._e()]),t._v(" "),e("upload-img",{ref:"uploadImgRef",refInFor:!0,attrs:{vmId:n.vmId,verId:n.id},on:{onSuccess:t.fileSuccess}}),t._v(" "),e("div",{staticClass:"img-list-box flex"},t._l(n.samples,(function(em,o){return e("div",{key:o,staticClass:"item"},[e("el-image",{staticClass:"image",attrs:{src:em.url}}),t._v(" "),1===em.has_meta?e("div",{staticClass:"btn info",attrs:{slot:"reference"},slot:"reference"},[e("i",{staticClass:"iconfont icon-tips",on:{click:function(e){return t.showImageInfo(n,em)}}})]):t._e(),t._v(" "),e("div",{staticClass:"btn del",on:{click:function(e){return t.delImg({id:n.vmId,ix:o})}}},[e("i",{staticClass:"iconfont icon-postDelete"})]),t._v(" "),0===o&&0===i?e("div",{staticClass:"change-cover",on:{click:function(e){return t.changeCover(n.vmId)}}},[t._v("\n            "+t._s(t.$t("chgangeCover"))+"\n          ")]):t._e(),t._v(" "),2!==em.has_meta&&em.has_meta?t._e():e("div",{staticClass:"no-img-info flex_c_m"},[t._v("\n            "+t._s(t.$t("noImageInfo"))+"\n          ")])],1)})),0)],1)})),0),t._v(" "),e("RelatedWorksModal",{ref:"RelatedWorksModalRef",on:{onClick:t.checkImgok}}),t._v(" "),e("div",{staticClass:"action-btn-box flex_c_m"},[e("div",{staticClass:"item prenext flex_c_m",on:{click:t.nextUp}},[t._v("\n      "+t._s(t.$t("PreNext"))+"\n    ")]),t._v(" "),e("div",{staticClass:"item nextstep flex_c_m",on:{click:t.publishModel}},[t._v("\n      "+t._s(t.$t("Save"))+"\n    ")])]),t._v(" "),t.visiblePop?e("div",{staticClass:"img-info-box"},[e("div",{staticClass:"mask-box",on:{click:function(e){t.visiblePop=!1}}}),t._v(" "),e("div",{staticClass:"info"},[e("MetaTooltipVue",{attrs:{meta:t.imgInfo.meta,model:t.imgInfo.model_id,category:t.imgInfo.category,"model-name":t.imgInfo.model_name,showCreate:!1,"source-from":"imageDetail"}})],1)]):t._e()],1)}),[],!1,null,"56728f9c",null).exports},data:function(){return{versLength:0,tabIndex:1,syncAllFormData:{},allFormData:{model:{id:""},ver_list:[]}}},computed:gt(gt({},Object(c.e)("user",["token"])),{},{baseModelIsFlux:function(){var t;return(null===(t=this.$route)||void 0===t||null===(t=t.query)||void 0===t||null===(t=t.base_model)||void 0===t?void 0:t.includes("Flux"))||!1},baseModelIsSD35:function(){var t;return(null===(t=this.$route)||void 0===t||null===(t=t.query)||void 0===t||null===(t=t.base_model)||void 0===t?void 0:t.includes("SD 3.5"))||!1}}),mounted:function(){if(!this.token)return this.$router.push(this.localePath({path:"/"})),void this.$EventBus.$emit("openLoginDialog");this.getModelInfo()},methods:{changeTab:function(t){t.index},editModelNext:function(data){var t=this;this.allFormData.model=Object(E.e)(this.allFormData.model,data),this.tabIndex=2;var e=this.$route.query,n=e.id,o=e.verId;if(n&&this.$nextTick((function(){if(o){var e,n={train_model_result_no:o,resource:{name:o},train_model_no:"yes"},r=t.versLength+1;(null===(e=t.syncAllFormData.vers)||void 0===e?void 0:e.length)<r&&t.syncAllFormData.vers.unshift(n)}t.$refs.EditVersionRef.versionFill(t.syncAllFormData.vers)})),!n&&o){var r={train_model_result_no:o,resource:{name:o},train_model_no:"yes"};this.syncAllFormData={vers:[r]},this.$refs.EditVersionRef.versionFill(this.syncAllFormData.vers)}Object(E.t)(this.$route.query)&&this.$nextTick((function(){t.$refs.EditVersionRef.versionList.length||t.$refs.EditVersionRef.addVersion()})),this.$nextTick((function(){var e=t.allFormData.model,n=e.type,o=e.name,r="Checkpoint"===n?1:2;t.$refs.EditVersionRef.modelType=r,t.$refs.EditVersionRef.modelTypeName=n,t.$refs.EditVersionRef.modelName=o}))},editVersionNext:function(data){var t=this.allFormData.ver_list;this.allFormData.ver_list=data.map((function(e){var n=gt({},e),o=t.find((function(em){return em.vmId===e.vmId}))||{};return n.samples=(null==o?void 0:o.samples)||[],n.id=null==o?void 0:o.id,n})),this.tabIndex=3},editVersionUp:function(){this.tabIndex=1},addImageStepUp:function(){this.tabIndex=2},onPublish:function(){var t=this,e=JSON.parse(JSON.stringify(this.allFormData));e.model.tags=e.model.tags.map((function(t){return{id:"",title:t}})),e.model.cover=e.ver_list[0].samples[0],e.model.payment.fee=Number(e.model.payment.fee),e.ver_list=e.ver_list.map((function(t){var e=gt({},t);return t.train_model_no&&(e.file_id=""),!t.train_model_no&&(e.train_model_result_no=""),e})),1===this.$refs.EditModelRef.worksSource&&(e.model.refer="-");var n=r.a.service({text:this.$t("Announcing")});Object(G.t)(e).then((function(e){var n=e.data,o=n.model,r=n.ver,l=0===o.code,c=r.every((function(t){return 0===t.code}));if(l&&c&&t.$alert(t.$t("publishOkTips"),t.$t("Tip"),{confirmButtonText:t.$t("Confirm"),type:"success",callback:function(){t.$router.back()}}),!l){if(10408===o.code)return void t.$message(t.$t("CreativeCenterPopup41"));t.$message(t.$t("HttpErrorCode_30009"))}c||t.$message(t.$t("modelNoUpdates"))})).finally((function(e){t.$nextTick((function(){n.close()}))}))},getModelInfo:function(){var t=this,e=this.$route.query.id;if(e){this.allFormData.model.id=e;var n=r.a.service();Object(G.i)({id:e}).then((function(e){var n;t.syncAllFormData=e.data,t.versLength=(null===(n=t.syncAllFormData.vers)||void 0===n?void 0:n.length)||0,t.syncAllFormData.vers||(t.syncAllFormData.vers=[]),console.log("获取模型信息",e.data);var o=e.data.model;t.$route.query.id&&(["-","none"].includes(e.data.model.refer)&&(e.data.model.refer=""),t.$refs.EditModelRef.formDataFill(e.data.model),t.$refs.EditModelRef.num_of_task=o.stat.num_of_task||0)})).finally((function(e){t.$nextTick((function(){n.close()}))}))}}}},bt=Object(v.a)(_t,(function(){var t=this,e=t._self._c;return e("div",[e("step",{attrs:{actIndex:t.tabIndex},on:{onClick:t.changeTab}}),t._v(" "),e("EditModel",{directives:[{name:"show",rawName:"v-show",value:1===t.tabIndex,expression:"tabIndex === 1"}],ref:"EditModelRef",on:{onNext:t.editModelNext}}),t._v(" "),e("EditVersion",{directives:[{name:"show",rawName:"v-show",value:2===t.tabIndex,expression:"tabIndex === 2"}],ref:"EditVersionRef",on:{onNext:t.editVersionNext,onStepUp:t.editVersionUp}}),t._v(" "),e("AddImage",{directives:[{name:"show",rawName:"v-show",value:3===t.tabIndex,expression:"tabIndex === 3"}],ref:"AddImageRef",on:{onPublish:t.onPublish,onStepUp:t.addImageStepUp}})],1)}),[],!1,null,"32ccf2b8",null);e.default=bt.exports},3253:function(t,e,n){"use strict";n.r(e);n(9),n(7),n(11),n(12),n(4),n(6);var o=n(3),r=n(97),l=n(2),c=(n(20),n(16),n(19),n(14),n(8),n(23),n(125),n(37),n(29),n(1091),n(44),n(589)),d=n.n(c),h=(n(71),n(56)),m=n(1),v=n(5),f=n(33),_=n(41),y=n(105),w=n(82),C=n(264),k=n(266),x=n(13);function O(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function $(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?O(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var D={components:{CollectPopover:h.a,modelPayNum:w.a,AppealDialog:C.a,modelExistDialog:k.a},mixins:[f.a],props:["item"],filters:{formatNumberForeign:v.i},computed:$($($({},Object(m.e)("user",["userInfo"])),Object(m.c)("user",["isCompanyAccount"])),{},{url:function(){var t=this.item.banner,e=t.nsfw,o=t.url;return 1===e?n(171):Object(v.x)(o,"low")}}),data:function(){return{appealShow:!1,appealData:{obj_no:"",obj_type:2,remark:""},existObj:{name:"",url:"",open:!1}}},methods:{handleClick:function(t,e){switch(e){case"COLLECT":this.setCollect(t,"model");break;case"RELEASE":this.setRelease(t);break;case"GENERATE":this.openGenerate(t);break;case"appeal":this.openAppeal(t)}},openGenerate:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(y.b)({id:t.id,refer:"task"});case 2:o=n.sent,r=Object(x.E)(e.$route.name),l=Object.assign({},null==o?void 0:o.data,{taskSource:1,logEventSource:r}),e.$EventBus.$emit("openGenerate",{action:1,data:{source:l}});case 6:case"end":return n.stop()}}),n)})))()},openAppeal:function(t){console.log("申诉",t),this.appealData.obj_no=t.id,this.appealShow=!0},setRelease:function(t){var e=t.banner;this.$logEvent("log_actions",{action:"LORA"===t.type?"click_publish_style":"click_publish_model",action_info:t.id}),e.url?this.publishModel(t):this.$router.push({path:this.localePath("/modelEditStep"),query:{id:t.id}})},publishModel:function(t){var e=this;Object(_.w)({id:t.id}).then((function(n){var o;if(1e4==n.status.code)if(null!==(o=n.data)&&void 0!==o&&o.model_id){var r=n.data,l=r.model_id,c=r.model_name,d=void 0===c?"Model":c,h=r.model_status,m=void 0===h?2:h;e.existObj.url="".concat(window.location.origin,"/")+"models/detail/"+l,e.existObj.name=d,e.existObj.open=1===m,e.$refs.modelExist.modelExistDialog=!0}else e.$message.success(e.$t("PulishSuccess")),e.$emit("change");else 10403!=n.status.code&&40303!=n.status.code||e.$router.push({path:e.localePath("/modelEditStep"),query:{id:t.id}})}))},viewDetail:function(){var t=this.item.id;this.$logEvent("log_actions",{operation:"click_model",behavior_info:t}),this.$router.push(this.localePath("/models/detail/".concat(t)))},toUserPage:function(){var t=this.item.author.id,path="/user/"+encodeURIComponent(t);this.userInfo.id==t&&(path="/personal"),this.$router.push(this.localePath(path))},editItemFn:function(){var t=this.item.id;this.$router.push({path:this.localePath("/modelEditStep"),query:{id:t}})},reportItemFn:function(){var t=this,e=this.item.id;Object(y.e)({id:e}).then((function(e){t.$message.success(t.$t("ReportSuccess"))}))},offShelfItemFn:function(){var t=this,e=this.item.id;this.$confirm(this.$t("modelDelistTip"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(n){Object(_.q)({id:e}).then((function(e){if(1e4==e.status.code)t.$message.success(t.$t("modelDelistSuccess")),t.$emit("onReseList",t.item);else if(10500==e.status.code){var n="https://aihelp.net/questionnaire/#/?formId=291ecf705dee4ceaa97af1bcc0d017b8";t.$i18n.locale.startsWith("zh")&&(n="https://aihelp.net/questionnaire/#/?formId=d9483db10f694841ba66414325fefbb6"),window.open(n,"_blank")}}))}))},deleteItemFn:function(){var t=this,e=this.item.id;this.$confirm(this.$t("newDeleteModelDesc"),this.$t("Tip"),{confirmButtonText:this.$t("Delete"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(n){Object(_.x)({model_id:e}).then((function(e){t.$emit("onReseList",t.item)}))}))}}},S=(n(2424),n(0)),component=Object(S.a)(D,(function(){var t,e,n,o,r,l,c,d,h,m=this,v=m._self._c;return v("div",{staticClass:"model-box"},[m.item.is_agency_fee?v("div",{staticClass:"payNum",attrs:{num:""}},[v("modelPayNum",{attrs:{number:m.item.agency_fee}})],1):m._e(),m._v(" "),v("div",{staticClass:"img-box",style:{backgroundImage:"url("+m.url+")"},on:{click:m.viewDetail}},[m.url?m._e():v("p",[m._v(m._s(m.$t(m.isCompanyAccount?"PleaseSetCover":"EmptyBannerModelText")))])]),m._v(" "),v("div",{staticClass:"box-mask",class:{show:2===(null===(t=m.item)||void 0===t?void 0:t.status)},on:{click:m.viewDetail}}),m._v(" "),m.isLoggedIn&&1==m.item.status&&1===m.item.publish_status?v("div",{staticClass:"cltpop"},[v("collect-popover",{attrs:{type:"model",folder:m.item},on:{newCreate:function(t){return m.$emit("newCreate")}}})],1):m._e(),m._v(" "),v("div",{directives:[{name:"show",rawName:"v-show",value:2!==(null===(e=m.item)||void 0===e?void 0:e.status),expression:"item?.status !== 2"}],staticClass:"btn-group"},[v("el-button",{directives:[{name:"show",rawName:"v-show",value:1===m.item.publish_status||m.isCompanyAccount,expression:"item.publish_status === 1 || isCompanyAccount"}],staticClass:"try-btn",on:{click:function(t){return t.stopPropagation(),m.handleClick(m.item,"GENERATE")}}},[m._v(m._s(m.$t("Try")))]),m._v(" "),v("el-button",{directives:[{name:"show",rawName:"v-show",value:2===m.item.publish_status&&!m.isCompanyAccount,expression:"item.publish_status === 2 && !isCompanyAccount"}],staticClass:"release-btn",on:{click:function(t){return t.stopPropagation(),m.handleClick(m.item,"RELEASE")}}},[m._v(m._s(m.$t("createSetting1")))])],1),m._v(" "),v("div",{staticClass:"model-info"},[v("div",{staticClass:"model-author",on:{click:function(t){return t.stopPropagation(),m.toUserPage.apply(null,arguments)}}},[m.item.author.head?v("img",{staticClass:"author-img",attrs:{src:m.item.author.head,alt:""}}):v("span",{staticClass:"author-img"},[m._v(m._s((m.item.author.name||m.item.author.id)[0]))]),m._v(" "),v("span",{staticClass:"author-name ellipsis"},[m._v(m._s(m.item.name))])]),m._v(" "),v("div",{staticClass:"model-handle"},[v("div",{staticClass:"collect-info",on:{click:function(t){return t.preventDefault(),m.handleClick(m.item,"COLLECT")}}},[v("i",{staticClass:"iconfont",class:m.setCollectData(m.item)}),m._v(" "),(null===(n=m.item.stat)||void 0===n?void 0:n.num_of_collection)>0?v("span",[m._v(m._s(m._f("formatNumberForeign")(m.item.stat.num_of_collection)))]):m._e()]),m._v(" "),v("div",{directives:[{name:"show",rawName:"v-show",value:2!==(null===(o=m.item)||void 0===o?void 0:o.status),expression:"item?.status !== 2"}],staticClass:"generate-info",on:{click:function(t){return t.preventDefault(),m.handleClick(m.item,"GENERATE")}}},[v("i",{staticClass:"iconfont icon-play"}),m._v(" "),(null===(r=m.item.stat)||void 0===r?void 0:r.num_of_task)>0?v("span",[m._v(m._s(m._f("formatNumberForeign")(m.item.stat.num_of_task)))]):m._e()]),m._v(" "),v("el-popover",{attrs:{trigger:"hover"}},[v("div",{staticClass:"popBox"},[m.userInfo.id==(null===(l=m.item.author)||void 0===l?void 0:l.id)&&3!=m.item.status?v("div",{on:{click:m.editItemFn}},[m._v("\n              "+m._s(m.$t("Edit"))+"\n            ")]):m._e(),m._v(" "),1==m.item.publish_status?v("div",{on:{click:m.reportItemFn}},[m._v("\n              "+m._s(m.$t("Report"))+"\n            ")]):m._e(),m._v(" "),m.userInfo.id==(null===(c=m.item.author)||void 0===c?void 0:c.id)&&2===m.item.publish_status?v("div",{on:{click:m.deleteItemFn}},[m._v("\n              "+m._s(m.$t("Delete"))+"\n            ")]):m._e(),m._v(" "),m.userInfo.id==(null===(d=m.item.author)||void 0===d?void 0:d.id)&&2!=m.item.publish_status?v("div",{on:{click:m.offShelfItemFn}},[m._v("\n              "+m._s(m.$t("offShelf"))+"\n            ")]):m._e()]),m._v(" "),v("div",{staticClass:"generate-info more-btn",attrs:{slot:"reference"},slot:"reference"},[v("i",{staticClass:"iconfont icon-editModel"})])])],1)]),m._v(" "),2===(null===(h=m.item)||void 0===h?void 0:h.status)?v("div",{staticClass:"mid-banded flex flex-col items-center"},[v("i",{staticClass:"iconfont icon-forbidden forbidden-icon"}),m._v(" "),v("div",{staticClass:"disabled-text"},[m._v(m._s(m.$t("Model"))+" "+m._s(m.$t("Disabled")))]),m._v(" "),v("div",{staticClass:"disabled-btn",on:{click:function(t){return t.stopPropagation(),m.handleClick(m.item,"appeal")}}},[m._v("\n        "+m._s(m.$t("appeal"))+"\n      ")])]):m._e(),m._v(" "),m.appealShow?v("AppealDialog",{attrs:{"appeal-data":m.appealData,"is-appealing":m.isAppealLoading,"submit-callback":m.setResourceAppeal,"dialog-visible":m.appealShow},on:{"update:dialogVisible":function(t){m.appealShow=t},"update:dialog-visible":function(t){m.appealShow=t}}}):m._e(),m._v(" "),v("modelExistDialog",{ref:"modelExist",attrs:{existObj:m.existObj}})],1)}),[],!1,null,"43d64958",null);function I(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function T(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?I(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var j={components:{ModelItem:component.exports,ElEmpty:d.a},props:{tabData:{type:Object,default:function(){return{publish_status:"ALL",type:"LORA",list:[],loading:!1,isEnd:!1}}},getList:{type:Function}},data:function(){return{statusList:["All","createSetting1","createSetting2"]}},computed:T(T(T({},Object(m.e)("user",["userInfo","cdnHost"])),Object(m.c)("user",["isCompanyAccount"])),{},{emptyImgUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20230617/804ae1a7-d655-4a59-a93b-775bfe4ebb5d.png")},loadingText:function(){var t=this.tabData,e=t.isEnd,n=t.loading;return e?this.$t("NoMoreData"):n?this.$t("Loading")+"...":""},isShowLoading:function(){var t=this.tabData,e=t.isEnd,n=t.loading,o=t.page;return n||1!==o&&e},publish_status:function(){var t=this.tabData.publish_status;return this.statusList[t]}}),methods:{handlEvent:function(t,e){this.$emit("handle",{type:t,val:this.statusList.indexOf(e)})}}},L=(n(2425),Object(S.a)(j,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.tabData.loading,expression:"tabData.loading"}],ref:"modelList",staticClass:"model-list"},[e("div",{staticClass:"filter-panel custom-form"},[t.isCompanyAccount?t._e():e("el-select",{attrs:{value:t.publish_status,"popper-class":"custom-select"},on:{change:function(e){return t.handlEvent("STATUS",e)}}},t._l(t.statusList,(function(n,i){return e("el-option",{key:n+i,attrs:{label:t.$t(n),value:n}})})),1),t._v(" "),e("el-button",{directives:[{name:"show",rawName:"v-show",value:t.tabData.list.length,expression:"tabData.list.length"}],staticClass:"upload-btn",attrs:{type:"primary"},on:{click:function(e){return t.handlEvent("UPLOAD")}}},[e("i",{staticClass:"iconfont icon-shangchuan"}),t._v("\n        "+t._s(t.$t("Checkpoint"===t.tabData.type?"UploadModels":"UploadLORA"))+"\n      ")])],1),t._v(" "),t.tabData.list.length?e("div",{staticClass:"list-panel",attrs:{id:t.tabData.type+"Model"}},[t._l(t.tabData.list,(function(n,i){return e("model-item",{key:"model_"+i,attrs:{item:n},on:{change:function(e){return t.handlEvent("REFRESH")},onReseList:function(e){return t.$emit("onReseList")}}})})),t._v(" "),e("p",{directives:[{name:"show",rawName:"v-show",value:t.isShowLoading,expression:"isShowLoading"}],staticClass:"loading"},[t._v(t._s(t.loadingText))])],2):t.tabData.isEnd?e("el-empty",{attrs:{description:t.$t("ModelEmptyText",{modelType:"Checkpoint"===t.tabData.type?"Checkpoint":"LoRA"}),image:t.emptyImgUrl}},[e("el-button",{staticClass:"upload-btn",attrs:{type:"primary"},on:{click:function(e){return t.handlEvent("UPLOAD")}}},[e("i",{staticClass:"iconfont icon-shangchuan"}),t._v("\n        "+t._s(t.$t("Checkpoint"===t.tabData.type?"UploadModels":"UploadLORA"))+"\n      ")])],1):t._e()],1)}),[],!1,null,"48b33c42",null).exports);n(10),n(18),n(32);function P(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var M={name:"TrainBaseModelModal",components:{StyleModal:n(151).a},props:{width:{type:String,default:"508px"},modelId:{type:String,default:""}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?P(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(m.c)("user",["isCompanyAccount"])),data:function(){return{visible:!1,loading:!1,modelType:"Checkpoint",selectList:[],modelList:[],selectModel:"",modelName:"",urlList:[],modelTypeVal:"SD 1.5",modelTypeList:[{name:"SD",id:"SD 1.5"},{name:"SDXL",id:"SDXL 1.0"}],urlLoading:!1,EHpower:null}},watch:{visible:{handler:function(t){t?(this.getModelList(),this.getTrainModelEstimate()):(this.EHpower=null,this.selectModel="",this.modelName="",this.modelTypeVal="SD 1.5")}}},methods:{openModal:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.urlList=t,this.visible=!0},getTrainModelEstimate:function(){var t=this;Object(_.C)({id:this.modelId}).then((function(e){1e4==e.status.code&&(t.EHpower=e.data)}))},getModelList:function(){var t=this;this.urlLoading||(this.urlLoading=!0,Object(_.v)({type:"Checkpoint",urls:this.urlList,base_model:"SDXL 1.0"==this.modelTypeVal?"SDXL":this.modelTypeVal}).then((function(e){1e4==e.status.code&&(t.modelList=Array.isArray(e.data.items)?e.data.items:[],t.selectModel=t.modelList.length?t.modelList[0].id:"")})).finally((function(){t.urlLoading=!1})))},handleSelectModelType:function(t){this.getModelList()},handleSelectModel:function(t){"MoreModel"!==t?(this.selectModel=t,this.$refs.styleModal.handleClose()):this.$refs.styleModal.openModal()},selectLoraHandle:function(t){console.log(t,"选中的风格-----")},selectModelHandle:function(t){if(console.log(t,"选中的模型-----"),this.$refs.styleModal.handleClose(),["",void 0,null].includes(t))this.selectModel="";else{var e=this.modelList.find((function(e){return e.id===t.id}));["",void 0,null].includes(e)&&(this.modelList.push(t),this.selectModel=t.id)}},handleCancel:function(){this.visible=!1},handleConfirm:function(){["",null,void 0].includes(this.modelName)?this.$message.warning(this.$t("loraNameNotEmpty")):/\S/.test(this.modelName)?/^[a-zA-Z0-9\s_\u4e00-\u9fa5.\-]+$/.test(this.modelName)?this.$emit("confirm",{id:this.selectModel,modelName:this.modelName,type:this.modelTypeVal}):this.$message.warning(this.$t("newModelNameFormatWarn")):this.$message.warning(this.$t("namePurewhitespace"))}}},E=M,A=(n(2428),n(2429),Object(S.a)(E,(function(){var t,e,n=this,o=n._self._c;return o("el-dialog",{ref:"trainBaseModelModal",attrs:{title:n.$t("trainModel"),visible:n.visible,width:n.width,top:"30vh","custom-class":"c-train-base-model-modal custom-dialog","close-on-click-modal":!1,"modal-append-to-body":!1,center:""},on:{"update:visible":function(t){n.visible=t}}},[o("div",{staticClass:"train-model-main custom-form"},[o("div",{staticClass:"train-model-main-item"},[o("div",{staticClass:"train-model-main-item-label"},[n._v("\n        "+n._s(n.$t("loraName"))+"\n      ")]),n._v(" "),o("el-input",{attrs:{maxlength:50},model:{value:n.modelName,callback:function(t){n.modelName=t},expression:"modelName"}})],1),n._v(" "),o("div",{staticClass:"train-model-main-item"},[o("div",{staticClass:"train-model-main-item-label"},[n._v("\n        "+n._s(n.$t("Training")+n.$t("Type"))+"\n      ")]),n._v(" "),o("el-select",{staticClass:"train-model-main-item-select",attrs:{placeholder:"","popper-class":"custom-select","popper-append-to-body":!1},on:{change:n.handleSelectModelType},model:{value:n.modelTypeVal,callback:function(t){n.modelTypeVal=t},expression:"modelTypeVal"}},n._l(n.modelTypeList,(function(t,i){return o("el-option",{key:"modelType_"+i,attrs:{label:t.name,value:t.id}})})),1)],1),n._v(" "),o("div",{staticClass:"train-model-main-item"},[o("div",{staticClass:"train-model-main-item-label"},[n._v("\n        "+n._s(n.$t("BaseModel"))+"\n        "),o("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:n.$t("baseModelTips"),placement:"top-start"}},[o("span",{staticClass:"el-icon-warning custom-tips"})])],1),n._v(" "),o("el-select",{staticClass:"train-model-main-item-select",attrs:{value:n.selectModel,placeholder:"","popper-class":"custom-select","popper-append-to-body":!1},on:{change:n.handleSelectModel}},[n._l(n.modelList,(function(t,i){return o("el-option",{key:"model_"+i,attrs:{label:t.name,value:t.id}})})),n._v(" "),o("el-option",{attrs:{label:n.$t("selectMoreModel"),value:"MoreModel"}})],2)],1),n._v(" "),n.EHpower&&!n.isCompanyAccount?o("div",{staticClass:"eHpower"},[o("span",[n._v(n._s(n.$t("estimatedCost"))+"："+n._s(n.$t("approximately"))+"\n        "+n._s("SD 1.5"==n.modelTypeVal?null===(t=n.EHpower)||void 0===t?void 0:t.sd_hashrate:null===(e=n.EHpower)||void 0===e?void 0:e.sdxl_hashrate)+"\n        "+n._s(n.$t("tempCoins"))+"/"+n._s(n.$t("calculateCoins")))]),n._v(" "),o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:n.$t("eHpowerTip"),placement:"bottom"}},[o("i",{staticClass:"el-icon-warning-outline"})])],1):n._e()]),n._v(" "),o("div",{staticClass:"train-model-btn-box",attrs:{slot:"footer"},slot:"footer"},[o("span",{staticClass:"train-model-btn train-model-btn__cancel",on:{click:n.handleCancel}},[n._v(n._s(n.$t("Cancel")))]),n._v(" "),o("div",{directives:[{name:"loading",rawName:"v-loading",value:n.urlLoading,expression:"urlLoading"}],staticClass:"train-model-btn train-model-btn__confirm"},[o("div",{staticClass:"train-model-btn-text",on:{click:n.handleConfirm}},[n._v(n._s(n.$t("Confirm")))])])]),n._v(" "),o("style-modal",{ref:"styleModal",attrs:{"model-type":n.modelType,"select-list":n.selectList,isSDXL:"SDXL 1.0"==n.modelTypeVal,inTask:!0},on:{selectModel:n.selectModelHandle}})],1)}),[],!1,null,"64472f1c",null).exports),N=n(15),R=n(132),B={data:function(){return{setDate:v.B,dialogVisible:!1,formData:{limit:20,time_from:0},list:[],noMoreData:!1,loading:!1}},watch:{dialogVisible:{handler:function(t){t?0==this.list.length&&this.getList():(this.formData.time_from=0,this.noMoreData=!1,this.list=[])}}},methods:{show:function(){this.dialogVisible=!0},goTrainDet:function(t){window.open("/loraTrainingDet?id="+t.id,"_blank")},getList:function(){var t=this;this.loading||this.noMoreData||(this.loading=!0,Object(R.h)(this.formData).then((function(e){var n;1e4==e.status.code&&((n=t.list).push.apply(n,Object(N.a)(e.data.items)),t.list.length.length>0&&(t.formData.time_from=t.list[t.list.length-1].create_at),e.data.has_more||(t.noMoreData=!0))})).finally((function(){t.loading=!1})))},checkLoadMore:function(){var t=this.$refs.list,e=t.scrollTop,n=t.scrollHeight;e+t.clientHeight>=n-300&&this.getList()},setStatus:function(t){var e="expired";switch(t){case 1:e=this.$t("Queuing");break;case 2:e=this.$t("TrainingIng");break;case 3:e=this.$t("Completed");break;case 4:e=this.$t("systemCancel");break;case 5:e=this.$t("expired")}return e},setSateClass:function(t){var e="";switch(t){case 1:e="Queuing";break;case 2:e="TrainingIng"}return e},getExpireTime:function(t){var e=(new Date).getTime();if(t&&t>e){var n=t-e,o=Math.floor(n/864e5);return o?this.$t("TaskExpireTime",{param:o}):this.$t("ExpiresSoon")}return this.$t("ExpiresSoon")}}},F=(n(2430),Object(S.a)(B,(function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:t.$t("trainiRecords"),visible:t.dialogVisible,width:"815px",top:"10vh","custom-class":"trainDialog"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"LoraTrainingHistory",on:{scroll:t.checkLoadMore}},[e("div",{staticClass:"title row"},[e("span",{staticClass:"name-span"},[t._v(t._s(t.$t("datasetName")))]),t._v(" "),e("span",[t._v(t._s("ID"))]),t._v(" "),e("span",[t._v(t._s(t.$t("trainingTime")))]),t._v(" "),e("span",[t._v(t._s(t.$t("trainExpirationTime")))]),t._v(" "),e("span",[t._v(t._s(t.$t("status")))]),t._v(" "),e("span",[t._v(t._s(t.$t("operation")))])]),t._v(" "),t._l(t.list,(function(n,o){return e("div",{key:n.data_set_no+","+o,ref:"list",refInFor:!0,staticClass:"list row"},[e("el-tooltip",{attrs:{"popper-class":"custom-tips-popper custom-tips-popper-role",effect:"light",placement:"bottom"}},[e("div",{staticClass:"tooltip-txt",attrs:{slot:"content"},slot:"content"},[t._v("\n          "+t._s(n.data_set_name||"-")+"\n        ")]),t._v(" "),e("span",{staticClass:"overflow-ellipsis name-span"},[t._v(t._s(n.data_set_name||"-"))])]),t._v(" "),e("span",[t._v(t._s(n.id))]),t._v(" "),e("span",[t._v(t._s(t.setDate(n.create_at)))]),t._v(" "),e("span",[t._v(t._s(5==n.state?t.$t("expired"):t.getExpireTime(n.expiration_time)))]),t._v(" "),e("div",{staticClass:"stateBox"},[e("div",{class:t.setSateClass(n.state)},[t._v(t._s(t.setStatus(n.state)))])]),t._v(" "),e("span",{style:{opacity:4!=n.state&&5!=n.state?1:.5,color:4!=n.state&&5!=n.state?null:"#FCFCFC"},on:{click:function(e){4!=n.state&&5!=n.state&&t.goTrainDet(n)}}},[t._v("\n        "+t._s(4!=n.state&&5!=n.state?t.$t("viewTraining"):t.$t("cannotView"))+"\n      ")])],1)}))],2)])}),[],!1,null,"9603b098",null).exports),U={props:{url:{typl:String,default:""}},data:function(){return{src:""}},mounted:function(){var t=this,img=new Image;img.src=Object(v.x)(this.url,"low"),img.onload=function(){t.src=img.src},img.onerror=function(){t.src=t.url}}};function V(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function W(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?V(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var H={components:{TrainBaseModelModal:A,LoraTrainingHistory:F,trainImg:Object(S.a)(U,(function(){var t=this;return(0,t._self._c)("img",{directives:[{name:"show",rawName:"v-show",value:t.src,expression:"src"}],staticClass:"trainImg",attrs:{src:t.src,alt:""}})}),[],!1,null,"1ee05a27",null).exports},data:function(){return{defShow:!1,dialogVisible:!1,type:1,loading:!1,progressShow:!1,playLoading:!1,progressNum:0,hitTimes:"",modelId:"",typeOption:[{value:0,label:this.$t("realisticCharacter")},{value:1,label:this.$t("animeCharacter")},{value:2,label:this.$t("c_style")}],dataForm:{after_id:"",limit:40},list:[],dataCreate:{name:"",meta:{images:[],type:0}},createLoading:!1,datas:{},inTimes:"",dataSetNo:[],ModelPgsList:[],messageBoxShown:!1}},computed:W(W(W(W({},Object(m.e)("user",["userInfo","token"])),Object(m.c)("user",["isCompanyAccount"])),Object(m.c)("payment",["paymentInfo"])),{},{isShowVipTip:function(){var t=["Member","ToB_beginnerPlan","StandardPlan","ToB_professionalPlan","MasterPlan"][this.paymentInfo.productLevel]||"";return t&&"MasterPlan"!==t},currentVipLevel:function(){var t=["Member","ToB_beginnerPlan","StandardPlan","ToB_professionalPlan","MasterPlan"][this.paymentInfo.productLevel]||"",e="basic";return t&&(["Member","ToB_beginnerPlan","StandardPlan"].includes(t)&&(e="professional"),["ToB_professionalPlan"].includes(t)&&(e="MasterPlan")),e},canTrainQue:function(){var t,e,n;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.productLevel)&&(null===(e=this.paymentInfo)||void 0===e?void 0:e.productLevel)>=3&&(null===(n=this.paymentInfo)||void 0===n?void 0:n.svipActiveState)||this.isCompanyAccount},isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)||this.isCompanyAccount}}),watch:{dialogVisible:{handler:function(t){t||(this.dataCreate.name="",this.dataCreate.meta.type=0)}},progressShow:{handler:function(t){var e=!!t;this.setTrainState(e)},immediate:!0}},mounted:function(){var t=this;this.token||this.$cookies.get("T")?(this.getTrainModelList(),this.getDataSetList()):this.defShow=!0,clearTimeout(this.inTimes),this.$refs.list.addEventListener("scroll",this.checkLoadMore),this.$once("hook:beforeDestroy",(function(){var e;clearTimeout(t.inTimes),null===(e=t.$refs)||void 0===e||null===(e=e.list)||void 0===e||e.removeEventListener("scroll",t.checkLoadMore)}))},methods:W(W({},Object(m.d)("user",["setTrainState"])),{},{handleOpenVip:function(){this.$logEvent("log_actions",{operation:"click_upgrade",behavior_info:"on_model_train_page"});var t;t="professional"===this.currentVipLevel?"NoExpireTimeTipWeb1":"NoExpireTimeTipWeb2";var e=this.currentVipLevel;e&&this.$EventBus.$emit("showBreakDialog",t,e,!0)},goHistory:function(){this.$logEvent("log_actions",{operation:"click_train_history",behavior_info:"on_train_dataset_page"}),this.$refs.LoraTrainingHistory.show()},openCreatedPopup:function(t){t?this.$logEvent("log_actions",{operation:"click_go_immediately",behavior_info:"on_train_dataset_page"}):this.$logEvent("log_actions",{operation:"click_create_dataset",behavior_info:"on_train_dataset_page"}),this.$router.push(this.localePath({path:"/loraTrainingEdit",query:{}}))},checkLoadMore:function(){var t=this.$refs.list,e=t.scrollTop,n=t.scrollHeight;e+t.clientHeight>=n-300&&this.getDataSetList()},player:function(t){var e=this,n={data_set_no:this.datas.id,name:t.modelName,related_model_no:t.id,model_category:t.type,type:2};Object(_.B)(n).then((function(t){1e4==t.status.code&&(e.$message({message:e.$t("trainingStarted"),type:"success"}),e.$refs.trainModel.handleCancel(),e.getTrainModelList())}))},getData:function(t){var e=this;this.playLoading||(this.isVip?!this.progressShow||this.canTrainQue?(this.playLoading=!0,Object(_.d)({id:t.id}).then((function(n){if(1e4==n.status.code){if(e.datas=n.data,e.datas.meta.images.length<9)return e.$message.warning(e.$t("least9")),void(e.playLoading=!1);var o=[];n.data.meta.images.forEach((function(t,i){i<10&&o.push(t.url)})),e.modelId=t.id,e.$refs.trainModel.openModal(o),e.playLoading=!1}})).catch((function(t){e.playLoading=!1}))):this.$EventBus.$emit("showUpgradeDialog","LoRATrainQueVipTipWeb","professional"):this.$EventBus.$emit("showBreakDialog","LoRATrainTipWeb","professional"))},setTrainType:function(t){var e="waiting";return this.ModelPgsList.forEach((function(n){t==n.data_set_no&&(e=n.state_desc)})),e},getTrainModelList:function(){var t=this;Object(_.D)().then((function(e){var n;if(1e4==e.status.code)if((null===(n=e.data)||void 0===n||null===(n=n.items)||void 0===n?void 0:n.length)>0){var o,r=[];null===(o=e.data)||void 0===o||o.items.forEach((function(t){r.push(t.id)})),t.progressShow=!0,clearTimeout(t.inTimes),t.getTrainModelProgress(r)}else t.progressShow=!1}))},getTrainModelProgress:function(t){var e=this;Object(_.E)({ids:t}).then((function(n){if(1e4==n.status.code){var o,r,c,d,h,m,v,f,_,y;if(null!==(o=n.data)&&void 0!==o&&o.items.some((function(t){return"sysTimeoutDesc"===t.state_desc})))return clearTimeout(e.inTimes),void e.getTrainModelList();if(!(null!==(r=n.data)&&void 0!==r&&r.items.some((function(t){return"processing"===t.state_desc}))||null!==(c=n.data)&&void 0!==c&&c.items.some((function(t){return"waiting"===t.state_desc}))))return e.progressShow=!1,e.dataSetNo=[],void clearTimeout(e.inTimes);if(e.ModelPgsList=null===(d=n.data)||void 0===d?void 0:d.items,e.dataSetNo=[],null===(h=n.data)||void 0===h||h.items.forEach((function(t){3!=t.state&&4!=t.state&&5!=t.state&&e.dataSetNo.push(t.data_set_no),"processing"==t.state_desc&&(e.progressNum=t.process)})),null!==(m=n.data)&&void 0!==m&&m.items.some((function(t){return 4===t.state}))||null!==(v=n.data)&&void 0!==v&&v.items.some((function(t){return 5===t.state})))return e.messageBoxShown||(e.messageBoxShown=!0,e.$alert(e.$t("newTrainingCompletederr"),e.$t("Tip"),Object(l.a)({confirmButtonText:e.$t("Confirm"),callback:function(t){e.messageBoxShown=!1}},"callback",(function(t){e.messageBoxShown=!1})))),clearTimeout(e.inTimes),void e.getTrainModelList();if(null!==(f=n.data)&&void 0!==f&&f.items.some((function(t){return 3===t.state})))return e.messageBoxShown||(e.messageBoxShown=!0,e.$alert(e.$t("trainingCompleted"),e.$t("Tip"),Object(l.a)({confirmButtonText:e.$t("Confirm"),callback:function(t){e.messageBoxShown=!1}},"callback",(function(t){e.messageBoxShown=!1})))),clearTimeout(e.inTimes),void e.getTrainModelList();null!==(_=n.data)&&void 0!==_&&_.items.some((function(t){return"processing"===t.state_desc}))||null!==(y=n.data)&&void 0!==y&&y.items.some((function(t){return"waiting"===t.state_desc}))?(clearTimeout(e.inTimes),e.inTimes=setTimeout((function(){e.getTrainModelProgress(t)}),6e4)):(e.progressShow=!1,e.dataSetNo=[],clearTimeout(e.inTimes))}else clearTimeout(e.inTimes),e.inTimes=setTimeout((function(){e.getTrainModelProgress(t)}),6e4)}))},getDataSetList:function(){var t=this;this.noMore||this.loading||(this.loading=!0,Object(_.f)(this.dataForm).then((function(e){var n,o,r,l,c;1e4==e.status.code&&(0==(null==e||null===(n=e.data)||void 0===n?void 0:n.items.length)&&(t.noMore=!0),t.list=t.list.concat((null==e||null===(o=e.data)||void 0===o?void 0:o.items)||[]),0==t.list.length?t.defShow=!0:t.defShow=!1,(null==e||null===(r=e.data)||void 0===r?void 0:r.items.length)>0&&(t.dataForm.after_id=null==e||null===(l=e.data)||void 0===l?void 0:l.items[(null==e||null===(c=e.data)||void 0===c?void 0:c.items.length)-1].id))})).finally((function(){t.loading=!1})))},onCreate:function(){var t=this;this.dataCreate.name?this.createLoading||(this.createLoading=!0,Object(_.b)(this.dataCreate).then((function(e){1e4===e.status.code&&(t.dialogVisible=!1,t.loading=!1,t.noMore=!1,t.dataForm.after_id="",t.list=[],t.getDataSetList())})).finally((function(){t.createLoading=!1}))):this.$message.warning(this.$t("trainEnterName"))}})},z=(n(2431),n(2432),Object(S.a)(H,(function(){var t,e,o,r,l,c=this,d=c._self._c;return d("div",{directives:[{name:"loading",rawName:"v-loading",value:c.loading,expression:"loading"}],staticClass:"LoraTrainingList"},[d("div",{staticClass:"cntTop"},[d("div",{staticClass:"topBntBox"},[d("div",{staticClass:"addBox",on:{click:c.openCreatedPopup}},[d("div",{staticClass:"add",staticStyle:{padding:"11px 24px"}},[d("span",[c._v(c._s(c.$t("createDataset")))])])]),c._v(" "),d("div",{staticClass:"trainiRecord",on:{click:c.goHistory}},[c._v(c._s(c.$t("trainiRecords")))]),c._v(" "),c.isCompanyAccount?c._e():d("el-popover",{attrs:{placement:"right",trigger:"hover","visible-arrow":!1,"popper-class":"balance-tips"}},[d("div",{staticClass:"balance-tips-text"},[c._v("\n          "+c._s(c.$t("newCreateDatasetDesc"))+"\n        ")]),c._v(" "),d("i",{staticClass:"iconfont icon-help-icon balance-tips-icon",attrs:{slot:"reference"},slot:"reference"})])],1),c._v(" "),c.progressShow?["waiting"===(null===(t=c.ModelPgsList[0])||void 0===t?void 0:t.state_desc)?d("div",{staticClass:"wait-box"},["waiting_push"===(null===(e=c.ModelPgsList[0])||void 0===e?void 0:e.state_sub_desc)?d("div",{staticClass:"wait-text"},[c._v(c._s(c.$t("waiteLoading")))]):c._e(),c._v(" "),"waiting_train"===(null===(o=c.ModelPgsList[0])||void 0===o?void 0:o.state_sub_desc)?[d("div",{staticClass:"wait-text"},[c._v(c._s(c.$t("upgradeLoading",{current:null===(r=c.ModelPgsList[0])||void 0===r?void 0:r.queue_position,total:null===(l=c.ModelPgsList[0])||void 0===l?void 0:l.queue_total})))]),c._v(" "),c.isShowVipTip?d("div",{staticClass:"wait-icon-box",on:{click:c.handleOpenVip}},[d("img",{staticClass:"wait-icon",attrs:{src:n(397),alt:"seaArtVip"}}),c._v(" "),d("p",[c._v(c._s(c.$t("upgrade")))])]):c._e()]:c._e()],2):d("div",{staticClass:"progress"},[d("div",[c._v("\n          "+c._s(c.$t("trainingTaskProgress"))+"\n          "+c._s(c.ModelPgsList.some((function(t){return"processing"===t.state_desc}))?" "+c.progressNum+"%":c.$t("Queuing"))+"\n        ")])])]:c._e()],2),c._v(" "),c.defShow?d("div",{staticClass:"defBox"},[d("img",{attrs:{src:n(760),alt:""}}),c._v(" "),d("div",{staticClass:"defDesc"},[c._v(c._s(c.$t("trainModelDefTxt")))]),c._v(" "),d("div",{staticClass:"goPage",on:{click:function(t){c.$router.push(c.localePath("/lora_train"))}}},[c._v(c._s(c.$t("goNow")))])]):d("div",{ref:"list",staticClass:"cnt"},[d("div",{staticClass:"list"},c._l(c.list,(function(t,e){return d("div",{key:e,staticClass:"item",on:{click:function(e){c.$router.push(c.localePath("/loraTrainingEdit?id="+t.id))}}},[t.covers&&t.covers[0]?d("trainImg",{attrs:{url:t.covers[0]}}):c._e(),c._v(" "),t.covers&&t.covers[1]?d("trainImg",{attrs:{url:t.covers[1]}}):c._e(),c._v(" "),t.covers&&t.covers[2]?d("trainImg",{attrs:{url:t.covers[2]}}):c._e(),c._v(" "),d("div",{staticClass:"name"},[c._v(c._s(t.name))]),c._v(" "),d("div",{staticClass:"bntBox"}),c._v(" "),c.dataSetNo.includes(t.id)?d("div",{staticClass:"TrainType",class:{TrainIngType:"waiting"!=c.setTrainType(t.id)},on:{click:function(t){return t.stopPropagation(),c.goHistory.apply(null,arguments)}}},[c._v("\n          "+c._s("waiting"==c.setTrainType(t.id)?c.$t("waitingTraining"):c.$t("TrainingIng"))+"\n        ")]):c._e()],1)})),0)]),c._v(" "),d("el-dialog",{attrs:{title:c.$t("createNewDataset"),visible:c.dialogVisible,top:"30vh",width:"510px","modal-append-to-body":!1,"close-on-click-modal":!1,"custom-class":"SaDialog train"},on:{"update:visible":function(t){c.dialogVisible=t}}},[d("div",{staticClass:"main"},[d("div",{staticClass:"diaTitle",staticStyle:{"margin-top":"14px"}},[c._v(c._s(c.$t("trainName")))]),c._v(" "),d("input",{directives:[{name:"model",rawName:"v-model",value:c.dataCreate.name,expression:"dataCreate.name"}],attrs:{maxlength:"50",type:"text",placeholder:c.$t("myNewDataset")},domProps:{value:c.dataCreate.name},on:{input:function(t){t.target.composing||c.$set(c.dataCreate,"name",t.target.value)}}}),c._v(" "),d("div",{staticClass:"diaTitle",staticStyle:{"margin-top":"24px"}},[c._v(c._s(c.$t("Category")))]),c._v(" "),d("el-select",{staticClass:"showType custom-select",attrs:{"popper-class":"custom-select"},model:{value:c.dataCreate.meta.type,callback:function(t){c.$set(c.dataCreate.meta,"type",t)},expression:"dataCreate.meta.type"}},c._l(c.typeOption,(function(t){return d("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),c._v(" "),d("div",{directives:[{name:"loading",rawName:"v-loading",value:c.createLoading,expression:"createLoading"}],staticClass:"addBox",staticStyle:{width:"100%"},attrs:{slot:"footer"},on:{click:c.onCreate},slot:"footer"},[d("div",{staticClass:"add",staticStyle:{"background-color":"#1c1d2a"}},[d("span",[c._v(c._s(c.$t("createDataset")))])])])]),c._v(" "),d("TrainBaseModelModal",{ref:"trainModel",attrs:{modelId:c.modelId},on:{confirm:c.player}}),c._v(" "),d("LoraTrainingHistory",{ref:"LoraTrainingHistory"})],1)}),[],!1,null,"39a78def",null)),G=z.exports;n(89);function J(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function K(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?J(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Y={components:{ModelFileUpload:n(342).a},data:function(){var t=this;return{isShow:!1,formData:{create_id:"",name:"",base_model:"",type:"Checkpoint",file_id:""},SDList:x.p,submitLoading:!1,rules:{name:[{required:!0,message:this.$t("PleaseEnterModelsName")},{validator:function(e,n,o){/^[a-zA-Z0-9\s_\u4e00-\u9fa5.\-]+$/.test(n)?o():o(new Error(t.$t("newModelNameFormatWarn")))}}],file_id:[{required:!0,message:this.$t("PleaseUploadModelsFIle")},{validator:function(e,n,o){var r=n?n.split("/")[1]:0;r=parseFloat((r/1e9).toFixed(2)),console.log(t.formData,r);var l=t.formData.type;if("Checkpoint"===l?r<1:r>1){var c="Checkpoint"===l?"Model":"LORA";o(new Error(t.$t(c+"FileSizeError")))}else o()}}],base_model:[{required:!0,message:this.$t("PleaseSelectBaseName")}]}}},computed:K(K(K({},Object(m.e)("user",["userInfo"])),Object(m.c)("user",["isCompanyAccount"])),{},{modelType:function(){return"Checkpoint"===this.formData.type?1:2}}),methods:{show:function(t){this.formData.type=t,this.isShow=!0,this.getModelConfig()},getModelConfig:function(){var t=this;this.submitLoading=!0,Object(_.m)({account_no:this.userInfo.id}).then((function(e){t.submitLoading=!1,t.formData.create_id=e.data.create_id})).catch((function(t){}))},closeDialog:function(t){var e=this;this.getEditStatus()&&!t?this.$confirm(this.$t("ModelCancelTips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){e.isShow=!1,e.$refs.modelsFileUpload.clear(),e.$refs.modelForm.resetFields(),e.$emit("hide")})):(this.isShow=!1,this.$refs.modelsFileUpload.clear(),this.$refs.modelForm.resetFields(),this.$emit("hide"))},getEditStatus:function(){var t=this.formData.file_id,e=this.$refs.modelsFileUpload.uploadingStatus;return t||"init"!==e},submit:function(){var t=this;this.$refs.modelForm.validate((function(e){e&&t.submiData()}))},submiData:function(){var t=this;this.submitLoading=!0;var e=K(K({},this.formData),{},{file_id:this.formData.file_id.split("/")[0]});Object(_.A)(e).then((function(e){console.log("上传模型",e),t.submitLoading=!1,t.isCompanyAccount?t.$message.success(t.$t("SaveSuccess")):t.$message.success(t.$t("CreateModelTips")),t.$emit("change",t.formData.type),t.closeDialog(!0)})).catch((function(){t.submitLoading=!1}))},getTranslationKey:function(t){return"Checkpoint"===this.formData.type?t:t.replace("Model","LORA")}}},Q=(n(2434),Object(S.a)(Y,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"upload-model-dialog custom-dialog",attrs:{visible:t.isShow,title:t.$t("UploadModel"),"append-to-body":"","close-on-click-modal":!1,"before-close":t.closeDialog},on:{"update:visible":function(e){t.isShow=e}}},[e("div",{staticClass:"dialog-form"},[e("el-form",{ref:"modelForm",staticClass:"custom-form",attrs:{"label-position":"top",model:t.formData,rules:t.rules}},[e("el-form-item",{attrs:{label:t.$t("ModelsName"),required:"",prop:"name"}},[e("el-input",{attrs:{placeholder:t.$t("PleaseEnterModelsName"),maxlength:100},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),t._v(" "),e("el-form-item",{attrs:{label:t.$t("BaseModel"),required:"",prop:"base_model"}},[e("el-select",{attrs:{"popper-class":"custom-select",placeholder:t.$t("Pls_select")},model:{value:t.formData.base_model,callback:function(e){t.$set(t.formData,"base_model",e)},expression:"formData.base_model"}},t._l(t.SDList,(function(t,n){return e("el-option",{key:"SD_"+n,attrs:{label:t,value:t}})})),1)],1),t._v(" "),e("el-form-item",{attrs:{label:t.$t("Type"),required:""}},[e("div",{staticClass:"type-select"},[e("span",{class:{active:"Checkpoint"===t.formData.type},on:{click:function(e){t.formData.type="Checkpoint"}}},[t._v("CheckPoint")]),t._v(" "),e("span",{class:{active:"LORA"===t.formData.type},on:{click:function(e){t.formData.type="LORA"}}},[t._v("LoRA")])])]),t._v(" "),e("el-form-item",{attrs:{label:t.$t("CheckpointFile"),required:"",prop:"file_id"}},[e("model-file-upload",{ref:"modelsFileUpload",attrs:{createId:t.formData.create_id,modelType:t.modelType},model:{value:t.formData.file_id,callback:function(e){t.$set(t.formData,"file_id",e)},expression:"formData.file_id"}})],1)],1),t._v(" "),t.isCompanyAccount?e("p",{staticClass:"upload-tips"},[t._v(t._s(t.$t("ToBModelsUploadTips")))]):e("p",{staticClass:"upload-tips"},[t._v(t._s(t.$t("ModelsUploadTips")))])],1),t._v(" "),e("div",{staticClass:"dialog-btn",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{staticClass:"cancel-btn",on:{click:function(e){return t.closeDialog()}}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("el-button",{staticClass:"save-btn",attrs:{type:"primary",loading:t.submitLoading},on:{click:t.submit}},[t._v(t._s(t.$t("Save")))])],1)])}),[],!1,null,"9b1362fa",null).exports),X=n(167),Z=["activateTab","autoOpen"],tt=["content"];function et(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function it(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?et(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var at={name:"AIModel",components:{ModelList:L,CreateModelPopup:Q,LoraTrainingList:G,PageSeo:X.a},data:function(){return{activeTab:"Training",tabData:{Checkpoint:{type:"Checkpoint",list:[],page:1,loading:!1,isEnd:!1,publish_status:0,time_to:""},LORA:{type:"LORA",list:[],page:1,loading:!1,isEnd:!1,publish_status:0,time_to:""}},pageSEO:{tempList:[]}}},computed:it(it({},Object(m.e)("user",["token"])),{},{isShowSEO:function(){var t;return(null===(t=this.pageSEO)||void 0===t||null===(t=t.tempList)||void 0===t?void 0:t.length)&&!this.token}}),beforeRouteLeave:function(t,e,n){null!==this.$refs.training.inTimes&&clearTimeout(this.$refs.training.inTimes),n()},mounted:function(){this.initTab()},watch:{$route:function(t){"AIModel"===t.name?(this.activeTab=localStorage.getItem("AIModelTab")||"Training",this.reflectList()):localStorage.setItem("AIModelTab",this.activeTab)},"$route.query.autoOpen":function(t){"true"===t&&this.$route.path.endsWith("/models")&&this.showUploadPopup()},"$route.query.activateTab":function(t){t&&(this.activeTab=t,localStorage.setItem("AIModelTab",this.activeTab))}},methods:{initTab:function(){var t,e,n;null!==(t=this.$route)&&void 0!==t&&null!==(t=t.query)&&void 0!==t&&t.activateTab&&(this.activeTab=null===(e=this.$route)||void 0===e||null===(e=e.query)||void 0===e?void 0:e.activateTab,"true"===(null===(n=this.$route)||void 0===n||null===(n=n.query)||void 0===n?void 0:n.autoOpen)&&(this.reflectList(this.activeTab),this.showUploadPopup()))},clearQuery:function(){var t=this.$route.query,e=t.activateTab,n=t.autoOpen,o=Object(r.a)(t,Z);(e||n)&&this.$router.replace({path:this.$route.path,query:o})},handleClick:function(t){if("Training"!==this.activeTab){var e=this.tabData[this.activeTab],n=e.isEnd,o=e.list;e.loading||o.length||n||this.getModelList()}},changeStatus:function(t,e){this.tabData[e].publish_status=t,this.reflectList()},listHandle:function(t,e){var n=t.type,o=t.val;switch(n){case"UPLOAD":this.$router.push({path:this.localePath("/modelEditStep")});break;case"STATUS":this.changeStatus(o,e);break;default:this.reflectList()}},showUploadPopup:function(){this.token?(this.$logEvent("log_actions",{operation:"LORA"===this.activeTab?"click_upload_style":"click_upload_model",action_info:"LORA"===this.activeTab?"style_id":"model_id"}),this.$refs.uploadModelPopup.show(this.activeTab)):this.$EventBus.$emit("openLoginDialog")},reflectList:function(t){t?this.activeTab=t:t=this.activeTab,this.tabData[t]=it(it({},this.tabData[t]),{},{page:1,list:[],loading:!1,isEnd:!1,time_to:""}),this.getModelList()},getModelList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeTab,n=this.tabData[e],o=this.getParams(e);n.loading=!0,Object(_.r)(o).then((function(o){t.setModelList(o,e),n.loading=!1,setTimeout((function(){t.addScrollEvent(e)}),1500)})).catch((function(t){n.loading=!1}))},getParams:function(t){var e=this.tabData[t],n=e.page,o=e.time_to,r={publish_status:e.publish_status,model_type:t,order_by:"new",page:n,page_size:30,type:"user_upload"};return o&&(r.time_to=o),r},setModelList:function(t,e){var n=t.data,o=n.items,r=n.has_more,l=n.time_ms,c=this.tabData[e];c.isEnd=!r,c.time_to=l,o&&(c.list=c.list.concat(o||[])),this.$set(this.tabData,e,c)},addScrollEvent:function(t){var e=this,n=this.tabData[t],o=document.querySelector("#"+t+"Model");!n.isEnd&&o&&(o.removeEventListener("scroll",(function(){})),o.addEventListener("scroll",(function(){!(o.scrollHeight-o.scrollTop<=o.clientHeight+250)||n.loading||n.isEnd||(n.page++,e.getModelList(t))})))}},head:function(){var t=this.pageSEO,title=t.title,e=t.key_words,n=t.meta_description;return{title:title=this.$t(title),meta:[{hid:"description",name:"description",content:n=this.$t(n)},{hid:"keywords",name:"keywords",content:e=this.$t(e)},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:n}]}},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,data,l,c,title,d,h,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,t.app,t.params,t.error,e.prev=1,e.next=4,n.$post("/api/v1/fast_ai/detail",{name:"train_model"});case 4:return o=e.sent,data=o.data,c=(l=data||{}).module,title=l.title,d=l.meta_description,h=l.key_words,m=null!=c&&c.length?c.map((function(t){var content=t.content;return it(it({},Object(r.a)(t,tt)),{},{content:JSON.parse(content)})})):[],e.abrupt("return",{pageSEO:{tempList:m,title:title,key_words:h,meta_description:d}});case 11:e.prev=11,e.t0=e.catch(1);case 13:case"end":return e.stop()}}),e,null,[[1,11]])})))()}},nt=at,ot=(n(2449),Object(S.a)(nt,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"model-container"},[n("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[n("el-tab-pane",{attrs:{label:e.$t("Training"),name:"Training"}},[n("lora-training-list",{ref:"training",attrs:{type:"model"},on:{upload:e.showUploadPopup}})],1),e._v(" "),n("el-tab-pane",{attrs:{label:e.$t("Model"),name:"Checkpoint"}},[n("model-list",{attrs:{type:"model",tabData:e.tabData.Checkpoint},on:{handle:function(t){return e.listHandle(t,"Checkpoint")},onReseList:function(t){return e.reflectList()}}})],1),e._v(" "),n("el-tab-pane",{attrs:{label:e.$t("LoRA"),name:"LORA"}},[n("model-list",{attrs:{type:"lora",tabData:e.tabData.LORA},on:{handle:function(t){return e.listHandle(t,"LORA")},onReseList:function(t){return e.reflectList()}}})],1)],1),e._v(" "),e.isShowSEO?n("page-seo",{attrs:{tempList:null===(t=e.pageSEO)||void 0===t?void 0:t.tempList}}):e._e(),e._v(" "),n("client-only",[n("create-model-popup",{ref:"uploadModelPopup",on:{change:e.reflectList,hide:e.clearQuery}})],1)],1)}),[],!1,null,"a2929a5c",null));e.default=ot.exports},3254:function(t,e,n){"use strict";n.r(e);n(9),n(85),n(101),n(75),n(36),n(11),n(12),n(6);var o=n(31),r=n(3),l=n(2),c=(n(16),n(7),n(10),n(70),n(19),n(14),n(28),n(287),n(8),n(4),n(23),n(49),n(18),n(50),n(37),n(48),n(29),n(142),n(143),n(112),n(20),n(1)),d=n(489).a,h=(n(2334),n(0)),m=Object(h.a)(d,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"c-workflow-version-info-modal",attrs:{title:t.$t("workFlow47"),visible:t.visible,width:"475px",modal:!1,"before-close":t.handleClose},on:{"update:visible":function(e){t.visible=e}}},[e("div",{staticClass:"version-info-title"},[e("span",{staticClass:"version-info-title-text"},[t._v(t._s(t.$t("workFlow48")))]),t._v(" "),e("span",{staticClass:"version-info-title-icon iconfont icon-icon_wenjuan",on:{click:function(e){return e.stopPropagation(),t.openFeedBack()}}})]),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"version-info-node-info"},[e("el-collapse",{on:{change:t.handleChange},model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[t._l(t.templateData,(function(n,o){return[e("el-collapse-item",{key:"".concat(n.package,"_").concat(o),staticClass:"version-info-node-info-item",attrs:{title:"".concat(n.package," (").concat(n.node_num,")"),name:n.package}},[t._l(n.nodes,(function(r){return[e("span",{key:"".concat(n.package,"_").concat(o,"_").concat(r.name),staticClass:"child-node-item"},[t._v(t._s(r.name))])]}))],2)]}))],2)],1)])}),[],!1,null,null,null).exports;function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var _={name:"workFlowHeader",inject:["top"],props:{saveStatus:{type:String,default:""},showBadge:{type:Boolean,default:!1}},components:{workflowVersionInfoModal:m},data:function(){return{title:this.$t("workFlow3")}},mounted:function(){this.initTitle()},computed:f(f({},Object(c.e)("user",["userInfo"])),{},{isSelfWorkflow:function(){var t,e,n,o,r=(null==this?void 0:this.userInfo).id,l=void 0===r?"":r,c=l&&l===(null===(t=this.top)||void 0===t||null===(t=t.workflowInfo)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id),d=null===(e=this.$route.query)||void 0===e?void 0:e.workId,h=!(null!==(n=this.$route.query)&&void 0!==n&&n.workId||null!==(o=this.$route.query)&&void 0!==o&&o.id);return c||d||h}}),methods:{openFeedBack:function(){try{window.open("https://aihelp.net/questionnaire/#/?formId=1a9a30d2b11545e5beba287164f8b05d","_blank")}catch(t){}},initTitle:function(){try{var t,e=localStorage.getItem("workflow_title"),n=e?JSON.parse(e):{},o=n.title,title=void 0===o?"":o;n.id;title=(null===(t=title)||void 0===t?void 0:t.length)>25?title.slice(0,25):title,this.title=""!==title?title:this.title}catch(t){}},backPreview:function(){var t;(null===(t=history)||void 0===t?void 0:t.length)>1?this.$router.back():this.$router.push(this.localePath("/"))},handleTitleChange:function(t){[null,void 0,""].includes(t)||localStorage.setItem("workflow_title",JSON.stringify({id:"",title:t}))},openVersionInfoModal:function(){this.$refs.workflowVersionInfoModal.openModal()},handleClick:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";null!==(t=this.userInfo)&&void 0!==t&&t.id?this.$emit("command",e):this.$EventBus.$emit("openLoginDialog")}}},y=_,w=(n(2335),n(2336),Object(h.a)(y,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-work-flow-header"},[e("div",{staticClass:"work-flow-header-item-left"},[e("div",{staticClass:"back-preview-btn",on:{click:function(e){return e.stopPropagation(),t.backPreview.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-back"})]),t._v(" "),t.isSelfWorkflow?e("div",{staticClass:"header-item-left-box"},[e("div",{staticClass:"header-btn"},[e("div",{staticClass:"header-btn-inner",on:{click:function(e){return t.handleClick("openCreateWorkflowModal")}}},[e("i",{staticClass:"iconfont icon-workflow_icon_new header-btn-icon"}),t._v("\n          "+t._s(t.$t("workFlow15"))+"\n        ")])]),t._v(" "),e("div",{staticClass:"header-btn",on:{click:function(e){return t.handleClick("openHistoryRecordModal")}}},[e("div",{staticClass:"header-btn-inner"},[e("i",{staticClass:"iconfont icon-workflow_icon_folder_open header-btn-icon"}),t._v("\n          "+t._s(t.$t("workFlow3"))+"\n        ")])]),t._v(" "),e("div",{staticClass:"header-btn",on:{click:function(e){return e.stopPropagation(),t.handleClick("clearWorkFlow")}}},[e("div",{staticClass:"header-btn-inner"},[e("i",{staticClass:"iconfont icon-workflow_icon_clear header-btn-icon"}),t._v("\n          "+t._s(t.$t("workFlow13"))+"\n        ")])]),t._v(" "),e("div",{staticClass:"header-btn",on:{click:function(e){return e.stopPropagation(),t.openVersionInfoModal()}}},[e("div",{staticClass:"header-btn-inner"},[e("span",{staticClass:"header-btn-icon el-icon-info"}),t._v("\n          "+t._s(t.$t("workFlow47"))+"\n        ")]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showBadge,expression:"showBadge"}],staticClass:"header-btn-badge"},[t._v("New")])])]):t._e()]),t._v(" "),e("div",{staticClass:"work-flow-header-item-title"},[e("div",[e("el-popover",{attrs:{placement:"bottom",title:"",width:"200",trigger:"click","popper-class":"work-flow-header-title-popup-wrap","visible-arrow":!0,content:""}},[e("div",{staticClass:"header-item-title-btn",attrs:{slot:"reference"},slot:"reference"},[e("span",{staticClass:"header-item-title-btn-content"},[t._v(t._s(t.title))]),t._v(" "),e("span",{staticClass:"header-item-title-btn-icon el-icon-edit"})]),t._v(" "),e("div",{staticClass:"work-flow-header-title-wrap custom-form"},[e("el-input",{staticClass:"work-flow-header-title-input",attrs:{placeholder:t.$t("pleaseEnte"),maxlength:"25"},on:{change:t.handleTitleChange},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1)])],1),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.saveStatus,expression:"saveStatus"}],staticClass:"is-save"},[t._v("\n    "+t._s(t.$t("saved"==t.saveStatus?"SavedToMyWorkflow":"Saving"))+"\n  ")])]),t._v(" "),e("div",{staticClass:"work-flow-header-item-right"},[e("div",{staticClass:"header-btn",on:{click:function(e){return e.stopPropagation(),t.openFeedBack()}}},[e("div",{staticClass:"header-btn-inner"},[e("span",{staticClass:"header-btn-icon iconfont icon-icon_wenjuan"}),t._v("\n      "+t._s(t.$t("Feedback"))+"\n    ")])]),t._v(" "),e("div",{staticClass:"header-btn",on:{click:function(e){return e.stopPropagation(),t.handleClick("saveAsWorkFlow")}}},[e("div",{staticClass:"header-btn-inner"},[e("i",{directives:[{name:"show",rawName:"v-show",value:!t.top.saveAsWorkflowLoading,expression:"!top.saveAsWorkflowLoading"}],staticClass:"iconfont icon-a-icon-SaveAs header-btn-icon"}),t._v(" "),e("i",{directives:[{name:"show",rawName:"v-show",value:t.top.saveAsWorkflowLoading,expression:"top.saveAsWorkflowLoading"}],staticClass:"header-btn-icon el-icon-loading"}),t._v("\n      "+t._s(t.isSelfWorkflow?t.$t("SaveAs"):t.$t("workFlow12"))+"\n    ")])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isSelfWorkflow,expression:"isSelfWorkflow"}],staticClass:"header-btn",on:{click:function(e){return e.stopPropagation(),t.handleClick("saveWorkFlow")}}},[e("div",{staticClass:"header-btn-inner"},[e("i",{directives:[{name:"show",rawName:"v-show",value:!t.top.saveWorkflowLoading,expression:"!top.saveWorkflowLoading"}],staticClass:"iconfont icon-workflow_icon_save header-btn-icon"}),t._v(" "),e("i",{directives:[{name:"show",rawName:"v-show",value:t.top.saveWorkflowLoading,expression:"top.saveWorkflowLoading"}],staticClass:"header-btn-icon el-icon-loading"}),t._v("\n      "+t._s(t.$t("Save"))+"\n    ")])]),t._v(" "),e("div",{staticClass:"header-btn",on:{click:function(e){return e.stopPropagation(),t.handleClick("viewHistory")}}},[e("div",{staticClass:"header-btn-inner"},[e("i",{directives:[{name:"show",rawName:"v-show",value:!t.top.isGenerating,expression:"!top.isGenerating"}],staticClass:"iconfont icon-workflow_icon_lishi header-btn-icon"}),t._v(" "),e("i",{directives:[{name:"show",rawName:"v-show",value:t.top.isGenerating,expression:"top.isGenerating"}],staticClass:"header-btn-icon el-icon-loading"}),t._v("\n      "+t._s(t.$t("workFlow11"))+"\n    ")])]),t._v(" "),e("div",{staticClass:"header-btn",on:{click:function(e){return e.stopPropagation(),t.handleClick("downloadWorkFlow")}}},[e("div",{staticClass:"header-btn-inner"},[e("i",{staticClass:"iconfont icon-icon-Download header-btn-icon"}),t._v("\n      "+t._s(t.$t("Download"))+"\n    ")])]),t._v(" "),t.isSelfWorkflow?e("div",{staticClass:"header-btn header-btn-gradient",on:{click:function(e){return e.stopPropagation(),t.handleClick("publishWorkFlow")}}},[e("div",{staticClass:"header-btn-inner"},[t._v("\n      "+t._s(t.$t("workFlow10"))+"\n    ")])]):t._e()]),t._v(" "),e("workflow-version-info-modal",{ref:"workflowVersionInfoModal"})],1)}),[],!1,null,"700eca7c",null)),C=w.exports,k=n(15),x=(n(47),n(43),n(96)),O=(n(76),n(5));function $(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function D(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n(125);var S=n(168),I=n(35),T=n.n(I),j=n(152);function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var M={name:"historyImg",components:{taskImageViewer:S.a,SaveTo:j.a},props:{src:{type:String,required:!0,default:function(){return""}},nsfw:{type:Number,default:2},width:{type:Number,default:100},height:{type:Number,default:100},message:{type:Object,default:function(){return{}}},imgInfo:{type:Object,default:function(){return{}}},operateNumber:{type:Number,default:function(){return 1}},baseSize:{type:String,default:""}},data:function(){return{loading:!0,loaded:!0,error:!1,dialogVisible:!1,retryCount:0,isShowImage:!0,baseImageWidth:200,imageUrl:"",checked:!1,alreadySave:!1,hoverBtnList:[{code:"download",icon:"modelDownload",useText:!1,order:5,tips:"DownloadImg",show:!0,showTypeOptions:[]},{code:"save",icon:"save",useText:!1,order:5,tips:"Save",show:!0,showTypeOptions:[]},{code:"deleteSingleImg",icon:"moveDeleteTask",useText:!1,order:5,tips:"Delete",show:!0,showTypeOptions:[]}],isShowHoverMask:!1}},computed:P(P(P(P({},Object(c.c)(["isSupportWebp"])),Object(c.c)("user",["userInfo","isCompanyAccount"])),Object(c.e)("user",["cdnHost"])),{},{currentImageIndex:function(){var t,e=this;return-1===(t=this.viewImageList.findIndex((function(t){return t.operateNumber===e.operateNumber})))?0:t},viewImageList:function(){var t=this,e=[],n=this.message.components,o=void 0===n?[]:n;return Array.isArray(o)&&o.length&&(e=(T()(this.message.components||[])||[]).map((function(t,e){return t.operateNumber=e+1,t})).filter((function(e){return t.checkIsShowViewNsfw&&t.enableNsfwMode?![1,"1"].includes(e.nsfw)&&(null==e?void 0:e.canViewNsfw):![1,"1"].includes(null==e?void 0:e.nsfw)}))),e},renderUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20230401/62f66fbd-bc27-44f6-b744-5c5d7e5b18ee.webp")},isShowNsfwBg:function(){var t="";return 1===this.nsfw||(t=this.checkIsShowViewNsfw?this.handleShowNsfwImageUrl():this.isShowImage?this.imageUrl:"",this.renderUrl===t)},isBlur:function(){return 1===this.nsfw||(this.checkIsShowViewNsfw?(null==this||null===(t=this.imgInfo)||void 0===t?void 0:t.is_nsfw_plus)&&!this.imgInfo.canViewNsfw:1===this.nsfw);var t},isShowOperateBtn:function(){return!this.isBlur&&!this.error},isShowHover:function(){var t,e;return!!this.checkIsShowViewNsfw&&((null==this||null===(t=this.imgInfo)||void 0===t?void 0:t.is_nsfw_plus)&&!(null!=this&&null!==(e=this.imgInfo)&&void 0!==e&&e.canViewNsfw))},isNsfwPlus:function(){var t;return(null==this||null===(t=this.imgInfo)||void 0===t?void 0:t.is_nsfw_plus)&&1!==this.nsfw},getImageUrl:function(){return this.isShowImage?this.imageUrl:""},isVideoUrl:function(){var t=this;return[".mp4",".mkv",".webm",".avi",".mov",".flv",".wmv"].some((function(e){return(t.imageUrl||"").toLowerCase().endsWith(e)}))},checkIsShowViewNsfw:function(){var t;return null==this||null===(t=this.userInfo)||void 0===t?void 0:t.enable_nsfw_plus},hoverBtnRenderList:function(){var t=this;return this.hoverBtnList.map((function(e){return e.show=t.isShowBtn(e.code),e})).filter((function(t){return t.show}))},isShowSaveTo:function(){var t,e,n=this.message.components,o=void 0===n?[]:n;return!!o.length&&!(null!==(t=o[this.operateNumber-1])&&void 0!==t&&t.is_saved_personal||null!==(e=o[this.operateNumber-1])&&void 0!==e&&e.alreadySave||this.alreadySave)},isShowBtn:function(){var t={save:[this.isShowSaveTo&&1!==this.nsfw],deleteSingleImg:[!0],download:[1!==this.nsfw]};return function(e){return!!Object.keys(t).includes(e)&&t[e].every((function(t){return!!t}))}},isShowNsfwIcon:function(){return this.checkIsShowViewNsfw&&this.isNsfwPlus},enableNsfwMode:function(){var t;return![2,"2"].includes(null==this||null===(t=this.userInfo)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.nsfw_plus)}}),mounted:function(){this.$set(this.imgInfo,"canViewNsfw",this.checkIsShowViewNsfw&&this.enableNsfwMode)},watch:{src:{handler:function(t){t&&"string"==typeof t&&(this.imageUrl=this.isSupportWebp?Object(O.x)(t,"high"):this.src)},immediate:!0}},methods:{handleSaveSuccess:function(){this.$logEvent("log_actions",{operation:"creative_flow_single_picture",behavior_info:"save"});try{this.message.components[this.operateNumber-1].alreadySave=!0}catch(t){}this.alreadySave=!0,this.$emit("saveSuccess")},deleteSingleImg:function(){var t=this;this.$confirm(this.$t("deleteConfirm"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){t.$emit("deleteSingleImg",t.operateNumber,t.message)}))},handleShowNsfwImageUrl:function(){var t;return null!=this&&null!==(t=this.imgInfo)&&void 0!==t&&t.is_nsfw_plus&&!this.imgInfo.canViewNsfw?this.renderUrl:this.isShowImage?this.imageUrl:""},onLoad:function(t){this.loading=!1,this.loaded=!0,this.error=!1,this.$EventBus.$emit("needScrollBottom",T()(this.message))},onError:function(){this.loading=!1,this.imageUrl&&(this.imageUrl.includes("_high.webp")||this.imageUrl.includes("_low.webp"))&&(this.imageUrl=this.src),this.reLoadImage(),this.error=!0},reLoadImage:function(){var t=this;this.retryCount>=1||(this.isShowImage=!1,this.retryCount++,this.loading=!0,this.$nextTick((function(){t.isShowImage=!0})))},clickReloadImage:function(){this.retryCount=0,this.error=!1,this.imageUrl=this.isSupportWebp?Object(O.x)(this.src,"high"):this.src,this.reLoadImage()},viewBigImage:function(){1!==this.nsfw&&(this.isShowHover||(this.dialogVisible=!0))},closeViewBigImage:function(){this.dialogVisible=!1},handleContextMenu:function(t){1===this.nsfw&&t.preventDefault()},downloadImage:function(){Object(O.z)(this.src,this.$t("WorkFlow"))},handleClick:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";["deleteSingleImg"].includes(e)?this.deleteSingleImg():"download"!==e?["save"].includes(e)&&(null===(t=this.$refs)||void 0===t||null===(t=t.saveToPopover[0])||void 0===t||t.doShow()):this.downloadImage()},settingViewNsfw:function(){this.$logEvent("log_actions",{operation:"click_NSFW_on_task"}),this.$set(this.imgInfo,"canViewNsfw",!this.imgInfo.canViewNsfw)}}},E=M,A=(n(2342),n(2343),Object(h.a)(E,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"c-history-img"},[n("div",{staticClass:"attachments-wrap"},[n("div",{staticClass:"message-attachment-media"},[n("div",{staticClass:"image-content"},[n("div",{staticClass:"image-content-wrap",class:[1===e.nsfw?"image-content-wrap-background":""],style:{"max-width":"".concat(e.baseSize),"min-width":"".concat(e.baseSize,"px")}},[n("div",{directives:[{name:"show",rawName:"v-show",value:1===e.nsfw,expression:"nsfw === 1"}],staticClass:"nsfw-flag"},[e._v("NSFW")]),e._v(" "),n("div",{staticClass:"image-render-box"},[1===e.nsfw?[n("img",{staticClass:"media-attachments-img image-opacity-0",attrs:{src:e.renderUrl,alt:"",decoding:"async",loading:"lazy"},on:{load:e.onLoad,error:e.onError,contextmenu:function(t){return e.handleContextMenu(t)}}})]:[e.isVideoUrl?e._e():n("img",{staticClass:"media-attachments-img",class:[e.loading?"":"media-attachments-img-show",e.loading?"image-opacity-0":"",e.isShowNsfwBg?"blurBackground":""],attrs:{src:e.getImageUrl,alt:"",decoding:"async",loading:"lazy"},on:{load:e.onLoad,error:e.onError,click:e.viewBigImage,contextmenu:function(t){return e.handleContextMenu(t)}}}),e._v(" "),e.isVideoUrl&&e.getImageUrl?n("video",{class:[e.loading?"image-opacity-0":"",e.isShowNsfwBg?"blurBackground":""],style:{borderRadius:"8px",width:"".concat(e.baseImageWidth,"px"),height:"".concat(parseInt(e.height*e.baseImageWidth/e.width),"px")},attrs:{src:e.getImageUrl,autoplay:"",loop:"",muted:"",controls:!1},domProps:{muted:!0},on:{play:function(t){e.loading=!1}}}):e._e()],e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.loading&&1!==e.nsfw,expression:"loading && nsfw !== 1"}],staticClass:"loading-wrapper"},[n("div",{staticClass:"loading-wrapper-inner"},[n("span",{staticClass:"spinner",attrs:{role:"img","aria-label":e.$t("Loading")}},[e._m(0)])])]),e._v(" "),e.isShowNsfwIcon?n("div",{staticClass:"generate-view-nsfw-plus",on:{click:function(t){return t.stopPropagation(),e.settingViewNsfw.apply(null,arguments)}}},[n("i",{staticClass:"iconfont",class:null!==(t=e.imgInfo)&&void 0!==t&&t.canViewNsfw?"icon-work-hide":"icon-work-show"})]):e._e(),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowOperateBtn&&e.isShowImage&&e.src&&!e.loading||1===e.nsfw,expression:"(isShowOperateBtn && isShowImage && src && !loading) || nsfw === 1"}],staticClass:"image-hover-mask",on:{click:e.viewBigImage}},[n("div",{staticClass:"image-hover-mask-btn-box"},[e._l(e.hoverBtnRenderList,(function(t){var o;return[n("el-tooltip",{key:t.code,attrs:{"popper-class":"task-image-viewer-popover",effect:"light",placement:"top",content:e.$t(null==t?void 0:t.tips)}},["save"!==t.code?n("span",{staticClass:"image-hover-mask-btn image-hover-mask-btn-single",on:{click:function(n){return n.stopPropagation(),e.handleClick(t.code)}}},[t.useText?[e._v("\n                            "+e._s(t.text)+"\n                          ")]:n("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(t.icon)})],2):e._e(),e._v(" "),"save"===t.code&&e.isShowSaveTo?n("save-to",{ref:"saveToPopover",refInFor:!0,attrs:{type:"artwork",category:!0,title:e.$t("Save"),message:D(D({},e.message),{},{img_uris:(null===(o=e.message)||void 0===o?void 0:o.components)||[]}),operateNumber:e.operateNumber,showArrowIcon:!1},on:{saveSuccess:e.handleSaveSuccess}},[n("span",{staticClass:"image-hover-mask-btn image-hover-mask-btn-single",on:{click:function(t){return t.stopPropagation(),e.handleClick("save")}}},[t.useText?[e._v("\n                            "+e._s(t.text)+"\n                          ")]:n("i",{staticClass:"iconfont image-hover-mask-btn-icon",class:"icon-".concat(t.icon)})],2)]):e._e()],1)]}))],2)])],2)]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.error&&!e.loading,expression:"error && !loading"}],staticClass:"image-load-error"},[n("i",{staticClass:"iconfont icon-image-load-error image-load-error-icon"}),e._v(" "),n("span",{staticClass:"image-load-error-text",on:{click:function(t){return t.stopPropagation(),e.clickReloadImage.apply(null,arguments)}}},[e._v(e._s(e.$t("reloadImage")))])])])])]),e._v(" "),e.dialogVisible?n("task-image-viewer",{staticClass:"message-img-viewer",staticStyle:{"z-index":"9999"},attrs:{"on-close":e.closeViewBigImage,"initial-index":e.currentImageIndex,"show-operate-btn":!1,message:e.message,"url-list":e.viewImageList}}):e._e()],1)}),[function(){var t=this._self._c;return t("span",{staticClass:"inner-MGEKwh wanderingCubes-2A046F"},[t("span",{staticClass:"item-2VgEex"}),t("span",{staticClass:"item-2VgEex"})])}],!1,null,"0fd78960",null)),N=A.exports,R=n(86),B=n(22);n(98);function F(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function U(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?F(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var V=n(124),W={name:"historyItem",components:{historyImg:N},props:{message:{type:Object,default:function(){return{}},required:!0},viewMode:{type:String,default:""}},filters:{formatDateTime:function(t){var e=new Date(t),n=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),l=e.getHours().toString().padStart(2,"0"),c=e.getMinutes().toString().padStart(2,"0"),d=e.getSeconds().toString().padStart(2,"0");return Object(O.u)(e,new Date)?"".concat(l,":").concat(c,":").concat(d):"".concat(n,"/").concat(o,"/").concat(r," ").concat(l,":").concat(c,":").concat(d)}},data:function(){return{defaultAvatar:V,customColor:"#2E9E60",alreadySave:!1}},computed:U(U({},Object(c.e)("payment",["paymentInfo"])),{},{getTitle:function(){var t;return(null===(t=this.message)||void 0===t||null===(t=t.creativity)||void 0===t?void 0:t.name)||this.$t("beenDeleted")},isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)||this.isCompanyAccount},isShowExpireTime:function(){var t=this.message.expiration_time;return!this.alreadySave&&t&&t>0},getExpireTime:function(){var t=this.message.expiration_time,e=(new Date).getTime();if(t&&t>e){var n=t-e,o=Math.floor(n/864e5);return o?this.$t("TaskExpireTime",{param:o}):this.$t("ExpiresSoon")}return this.$t("TaskExpireTime",{param:0})},computedPercentage:function(){return function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).process;return void 0===t?0:t}},convertStatusText:function(){var t,e={userCancelDesc:this.$t("userCancel"),sysCancelDesc:this.$t("systemCancel"),sysTimeoutDesc:this.$t("systemTimeoutCancel")};return null!==(t=this.message)&&void 0!==t&&t.status_desc?e[this.message.status_desc]:""}}),methods:{expireClick:function(){this.$logEvent("log_actions",{operation:"click_expire",behavior_info:"on_comfyui_page"});var t=(this.paymentInfo||{}).vipType,e=["svip_1","svip_2","svip_1_trial","svip_2_trial","vip_lite"].includes(t)||t.includes("vip_day");this.isVip?e&&this.$EventBus.$emit("showUpgradeDialog","NoExpireTimeTipWeb","professional"):this.$EventBus.$emit("showBreakDialog","ExpireTimeTipWeb","basic")},handleDeleteTask:function(){var t=this;this.$confirm(this.$t("deleteTaskConfirm"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){var e=t.message.id;e&&Object(B.f)({ids:[e]}).then((function(){t.$message.success(t.$t("deleteSuccess")),t.$emit("deleteTask",e)}))}))},updateImageInfo:function(t,source,e,n){this.$emit("updateImageInfo",t,source,e,n)},deleteSingleImg:function(t){var e=this,n=this.message,o=n.id,r=void 0===o?"":o,l=n.components,c=(void 0===l?[]:l)[t-1].index,d=void 0===c?-1:c;Object(R.b)({id:r,index:d}).then((function(){var t;(e.$message({message:e.$t("deleteSuccess"),type:"success"}),e.message.components=e.message.components.filter((function(t){return t.index!==d})),e.message.components.length)||e.$emit("deleteTask",null==e||null===(t=e.message)||void 0===t?void 0:t.id)}))}}},H=W,z=(n(2345),Object(h.a)(H,(function(){var t,e,n,o,r,l,c,d,h,m,v=this,f=v._self._c;return f("div",{staticClass:"c-workflow-history-item"},[f("div",{staticClass:"workflow-history-item-header"},[f("div",{staticClass:"workflow-history-item__title"},[f("img",{staticClass:"workflow-history-item__avatar",attrs:{src:v.defaultAvatar,alt:"Avatar"}}),v._v(" "),f("div",{staticClass:"workflow-history-item__title-task-tag overflow-ellipsis",attrs:{title:v.getTitle}},[v._v(v._s(v.getTitle))]),v._v(" "),f("div",{staticClass:"workflow-history-item__btn-box"},[null!==(t=v.message)&&void 0!==t&&null!==(t=t.creativity)&&void 0!==t&&t.is_support_retry?f("span",{staticClass:"iconfont icon-refresh-icon2 task-info-icon",staticStyle:{"margin-left":"5px"},on:{click:function(t){return v.$emit("retry",v.message.creativity)}}}):v._e(),v._v(" "),f("el-popover",{attrs:{trigger:"click","popper-class":"custom-popver"}},[f("div",{staticClass:"task-info-tips"},[f("p",[f("span",[v._v(v._s(v.$t("TaskID")))]),f("span",[v._v(v._s(v.message.id))])]),v._v(" "),3===v.message.status?[[1,2,"1","2"].includes(null===(e=v.message)||void 0===e?void 0:e.pub_community)?f("p",[f("span",{staticClass:"task-info-tips-label"},[v._v(v._s(v.$t("status")))]),v._v(" "),f("span",{staticClass:"task-pub-status"},[v._v(v._s([2,"2"].includes(null===(n=v.message)||void 0===n?void 0:n.pub_community)?v.$t("createSetting1"):v.$t("createSetting2")))])]):v._e(),v._v(" "),f("p",[f("span",{staticClass:"task-info-tips-label"},[v._v(v._s(v.$t("expend")))]),v._v(" "),f("span",{staticClass:"task-info-tips-content"},[f("span",[v._v(v._s(v.$t("tempCoins"))+" : "+v._s(null===(o=v.message)||void 0===o||null===(o=o.deduction_detail)||void 0===o?void 0:o.temp_hashrate))]),v._v(" "),f("span",[v._v(v._s(v.$t("calculateCoins"))+" : "+v._s(null===(r=v.message)||void 0===r||null===(r=r.deduction_detail)||void 0===r?void 0:r.hashrate))])])]),v._v(" "),null!==(l=v.message)&&void 0!==l&&null!==(l=l.deduction_detail)&&void 0!==l&&l.history_hashrate?f("p",[f("span",{staticClass:"task-info-tips-label"},[v._v(v._s(v.$t("currentBalance")))]),v._v(" "),f("span",{staticClass:"task-info-tips-content"},[f("span",[v._v(v._s(v.$t("tempCoins"))+" : "+v._s(null===(c=v.message)||void 0===c||null===(c=c.deduction_detail)||void 0===c?void 0:c.after_temp_hashrate))]),v._v(" "),f("span",[v._v(v._s(v.$t("calculateCoins"))+" : "+v._s(null===(d=v.message)||void 0===d||null===(d=d.deduction_detail)||void 0===d?void 0:d.after_hashrate))])])]):v._e()]:v._e()],2),v._v(" "),f("i",{staticClass:"iconfont icon-task_tips task-info-icon",staticStyle:{"margin-left":"5px"},attrs:{slot:"reference"},slot:"reference"})]),v._v(" "),f("span",{staticClass:"el-icon-delete task-info-icon",staticStyle:{"margin-left":"5px"},on:{click:v.handleDeleteTask}})],1)])]),v._v(" "),f("div",{staticClass:"workflow-history-item__title-time"},[v.message.create_at?f("div",{staticClass:"workflow-history-item__title-create-time"},[v._v("\n        "+v._s(v._f("formatDateTime")(v.message.create_at))+"\n      ")]):v._e(),v._v(" "),v.isShowExpireTime?f("div",{staticClass:"workflow-history-item__title-expire-time",on:{click:v.expireClick}},[v._v("\n        "+v._s(v.getExpireTime)+"\n      ")]):v._e()]),v._v(" "),[2,"2",3,"3"].includes(v.message.status)?f("div",{staticClass:"workflow-history-image-container",class:[1===(null===(h=v.message)||void 0===h||null===(h=h.components)||void 0===h?void 0:h.length)&&"workflow-history-image-container-full"]},[v._l((null===(m=v.message)||void 0===m?void 0:m.components)||[],(function(t,e){return[f("history-img",{key:"list-item_".concat(t.index),attrs:{src:t.url,nsfw:t.nsfw,width:t.width,height:t.height,"operate-number":e+1,"img-info":t,message:v.message},on:{updateImageInfo:v.updateImageInfo,deleteSingleImg:v.deleteSingleImg,saveSuccess:function(t){v.alreadySave=!0}}})]}))],2):v._e(),v._v(" "),[1,"1",2,"2",4,"4"].includes(v.message.status)?f("div",{staticClass:"message-process-container"},[[2,"2"].includes(v.message.status)&&v.computedPercentage(v.message)?f("div",{staticClass:"message-process-panel"},[f("el-progress",{attrs:{percentage:v.computedPercentage(v.message),color:v.customColor,"show-text":!1,"stroke-width":7}})],1):v._e(),v._v(" "),f("div",{staticClass:"message-process-operate-box"},[[1,"1"].includes(v.message.status)?[f("span",{staticClass:"process-operate-box-text"},[v._v(v._s(v.$t("TaskStatusWaitingToStart"))+" "),f("span",{staticClass:"message-process-loading-span"})]),v._v(" "),f("QuickQueue",{attrs:{quickOptions:v.message,quickStyle:{height:"26px",fontSize:"12px"}}})]:[2,"2"].includes(v.message.status)&&!v.computedPercentage(v.message)?[f("span",{staticClass:"process-operate-box-text"},[v._v(v._s(v.$t("TaskStatusPreparing"))+" "),f("span",{staticClass:"message-process-loading-span"})])]:[4,"4"].includes(v.message.status)?f("span",{staticClass:"process-operate-box-text",staticStyle:{color:"#DA373D"}},[v._v(v._s(v.convertStatusText))]):f("span",{staticClass:"process-operate-box-text"},[v._v(v._s(v.$t("youHaveCompleted"))),f("span",{staticClass:"process-operate-box-text-strong",staticStyle:{"margin-left":"5px"}},[v._v(v._s(v.computedPercentage(v.message))+"%")]),v._v(" "),f("span",{staticClass:"message-process-loading-span"})]),v._v(" "),[1,2,"1","2"].includes(v.message.status)?f("el-tooltip",{attrs:{"popper-class":"custom-tips-popper",effect:"light",content:v.$t("canceTaskNum",{num:3}),placement:"top-start"}},[f("el-button",{staticClass:"message-process-operate-box-btn",class:{isLoading:v.isLoading},attrs:{type:"danger",size:"mini"},on:{click:function(t){return v.$emit("cancelTask",v.message)}}},[v._v("\n            "+v._s(v.isLoading?"Canceling…":v.$t("CancelJob"))+"\n          ")])],1):v._e()],2)]):v._e()])}),[],!1,null,"2f5683b4",null).exports),G=n(297),J=n(53),K=n(24);function Y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Y(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var X={name:"historyPage",inject:["top"],data:function(){return{viewMode:"list",list:[],loading:!1,queryParams:{limit:10},hasMore:!0,showScroll:!0,debounceHandleScroll:null,dialogVisible:!1,viewImageList:[],activeCard:null,currentImageIndex:0}},mixins:[G.a],computed:Q(Q({},Object(c.c)("user",["taskExpireDay","isLoggedIn"])),{},{renderCardList:function(){return this.list.filter((function(t){var e;return[3,"3"].includes(t.status)&&(null==t||null===(e=t.components)||void 0===e?void 0:e.length)}))},getExpirationTime:function(){return this.taskExpireDay}}),components:{historyItem:z,taskImageViewer:S.a,historyImg:N},mounted:function(){this.initScrollBar(),this.debounceHandleScroll=Object(K.debounce)(this.handleScroll,600),null!=this&&this.isLoggedIn&&this.getList()},destroyed:function(){this.debounceHandleScroll=null},methods:{doLogEvent:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={operation:t,behavior_info:"on_comfyui_project_editing_page"};e&&(n.behavior_info_sub=e),this.$logEvent("log_actions",n)},viewBigImage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.activeCard=t,this.viewImageList=[e],this.dialogVisible=!0},closeViewBigImage:function(){this.dialogVisible=!1,this.viewImageList=[],this.activeCard=null},deleteSingleImg:function(t,e){var n=this,o=e||{},r=o.id,l=void 0===r?"":r,c=o.components,d=(void 0===c?[]:c)[t-1].index,h=void 0===d?-1:d;Object(R.b)({id:l,index:h}).then((function(){n.$message({message:n.$t("deleteSuccess"),type:"success"}),n.list.forEach((function(t){var o;t&&(null==t?void 0:t.id)===(null==e?void 0:e.id)&&(n.$set(t,"components",((null==t?void 0:t.components)||[]).filter((function(t){return t.index!==h}))),null!=t&&null!==(o=t.components)&&void 0!==o&&o.length||n.handleDeleteTask(null==t?void 0:t.id))}))}))},updateImageInfo:function(t,source,e,n){var o=this;this.list.forEach((function(r){t&&t===(null==r?void 0:r.id)&&(r.components||[]).forEach((function(t){t.index===source.index&&o.$set(t,e,n)}))}))},insertDataToList:function(t){this.list.unshift(t)},handleRetry:function(t){this.$emit("retry",t)},handleDeleteTask:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.list.findIndex((function(e){return e.id===t}));-1!==e&&this.list.splice(e,1)},changeViewMode:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.doLogEvent(e),this.scrollToTop("instant"),this.viewMode=t},scrollToTop:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{var e=this.$refs.scrollWrapper;if(e){e.scrollTo({top:0,behavior:t})}}catch(t){}},handleRefresh:function(){this.list=[],this.hasMore=!0,this.getList()},getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n={limit:20,scene:2};["",null,void 0].includes(e)||(n.time_from=e),this.loading=!0,Object(x.h)(n).then((function(e){var o=(null==e?void 0:e.data)||{},r=o.items,l=void 0===r?[]:r,c=o.has_more,d=void 0===c||c;if(t.hasMore=d,null!=n&&n.time_from){var h,m,v=Object(J.e)(t.list,l||[]),f=null===(h=t.$refs)||void 0===h||null===(h=h.scrollWrapper)||void 0===h?void 0:h.scrollHeight;(m=t.list).push.apply(m,Object(k.a)(v)),f&&v.length&&t.scrollToTop(f,"instant")}else t.list=Array.isArray(l)&&null!=l&&l.length?l:[],t.scrollToTop(0,"instant")})).finally((function(){t.loading=!1}))},toMall:function(){this.doLogEvent("click_enter_vip"),this.$router.push(this.localePath({path:"/mall"}))},initScrollBar:function(){var t=this;try{this.$refs.scrollWrapper.addEventListener("scroll",this.initScrollBarStatus),this.$once("hook:beforeDestroy",(function(){t.$refs.scrollWrapper.removeEventListener("scroll",t.initScrollBarStatus)}))}catch(t){}},initScrollBarStatus:function(){this.showScroll=!0},handleScroll:function(){try{var t=this.$refs.scrollWrapper;try{if(0===t.scrollTop&&0===t.scrollHeight)return}catch(t){}var e=(null==t?void 0:t.scrollHeight)-t.scrollTop;e-=null==t?void 0:t.clientHeight,t&&e<=30&&this.hasMore&&this.handleLoadMore()}catch(t){}},handleLoadMore:function(){var t=this.list.length?this.list[this.list.length-1]:"",e=t?t.create_at:"";this.getList(e)},handleCancelTask:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;this.$logEvent("log_actions",{operation:"click_cancel_task",behavior_info:"on_comfyui_page"});var o=e.id,r=void 0===o?"":o,l={action:5,task_id:r};this.handleUpdateCancelBtnStatus(r,!0),Object(B.r)(l).then((function(e){t.$message.warning(t.$t("cancelJobSuccess"));var o=(e||{}).status,l=(void 0===o?{}:o).code,code=void 0===l?"":l;if(n&&n(),[1e4,"10000"].includes(code)){var c=t.list.findIndex((function(t){return t.id===r}));-1!==c&&t.list.splice(c,1)}else[1e4,"10000"].includes(code)||t.handleTaskError(code)})).finally((function(){t.handleUpdateCancelBtnStatus(r,!1)}))},handleUpdateCancelBtnStatus:function(t,e){var n=this;this.list.forEach((function(o){o.id===t&&n.$set(o,"isLoading",e)}))}}},Z=X,tt=(n(2346),Object(h.a)(Z,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-workflow-history-modal"},[e("div",{staticClass:"workflow-history-modal__header"},[e("div",{staticClass:"workflow-history-modal__header-left"},[e("i",{staticClass:"iconfont icon-workflow_icon_list workflow-history-modal__header-icon",class:["list"===t.viewMode&&"header-icon-active"],on:{click:function(e){return e.stopPropagation(),t.changeViewMode("list","click_history_create_info")}}}),t._v(" "),e("i",{staticClass:"iconfont icon-workflow_icon_grid workflow-history-modal__header-icon",class:["grid"===t.viewMode&&"header-icon-active"],on:{click:function(e){return e.stopPropagation(),t.changeViewMode("grid","click_thumbnail_display")}}})]),t._v(" "),e("div",{staticClass:"workflow-history-modal__header-right"},[e("span",{staticClass:"workflow-history-modal__header-icon el-icon-refresh header-icon-active",on:{click:function(e){return e.stopPropagation(),t.handleRefresh()}}})])]),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"scrollWrapper",staticClass:"workflow-history-modal__content",class:["grid"===t.viewMode&&"card-flex-content"],on:{scroll:t.debounceHandleScroll}},["grid"===t.viewMode?[t._l(t.renderCardList,(function(n,i){return[t._l((null==n?void 0:n.components)||[],(function(o,r){return[e("history-img",{key:"card-image_".concat(i,"_").concat(r),staticClass:"history-image-card",attrs:{src:o.url,nsfw:o.nsfw,width:o.width,height:o.height,"operate-number":r+1,"img-info":o,message:n},on:{deleteSingleImg:t.deleteSingleImg,updateImageInfo:t.updateImageInfo}})]}))]}))]:t._e(),t._v(" "),"list"===t.viewMode?[t._l(t.list,(function(n){return[e("history-item",{key:n.id,attrs:{message:n,viewMode:t.viewMode},on:{deleteTask:t.handleDeleteTask,retry:t.handleRetry,cancelTask:t.handleCancelTask}})]}))]:t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading&&t.list.length&&!t.hasMore,expression:"!loading && list.length && !hasMore"}],staticClass:"workflow-history-modal-no-more"},[t._v(t._s(t.$t("workFlow35")))])],2),t._v(" "),0!==t.getExpirationTime?e("div",{staticClass:"workflow-history-modal__bottom"},[e("div",{staticClass:"workflow-history-modal__bottom-text"},[t._v(t._s(t.$t("workFlow5",{num:t.getExpirationTime})))]),t._v(" "),e("div",{staticClass:"workflow-history-modal__bottom-link-text",on:{click:function(e){return e.stopPropagation(),t.toMall.apply(null,arguments)}}},[t._v(t._s(t.$t("workFlow4")))])]):t._e(),t._v(" "),t.dialogVisible?e("task-image-viewer",{staticClass:"message-img-viewer",staticStyle:{"z-index":"9999"},attrs:{"on-close":t.closeViewBigImage,"initial-index":t.currentImageIndex,"show-operate-btn":!1,message:t.activeCard,"url-list":t.viewImageList}}):t._e()],1)}),[],!1,null,"62cbb7ae",null)),et=tt.exports,it=n(1889),at=(n(3209),{name:"historyRecordModal",data:function(){return{visible:!1,list:[],hasMore:!0,loading:!1,debounceHandleScroll:null,showScroll:!0,activeId:"",nowTime:new Date}},computed:{formatDate:function(t){var e=this;return function(t){if(!t)return"";var n=new Date(t),o=e.nowTime.getTime()-n.getTime(),r=Math.floor(o/1e3),l=Math.floor(o/6e4),c=Math.floor(o/36e5),d=Math.floor(o/864e5);return r<60?e.$t("workFlow9",{num:r}):l<60?e.$t("workFlow6",{num:l}):c<24?e.$t("workFlow7",{num:c}):e.$t("workFlow8",{num:d})}}},mounted:function(){var t=this;this.interval=setInterval((function(){t.$set(t,"nowTime",new Date)}),6e4),this.initScrollBar(),this.debounceHandleScroll=Object(K.debounce)(this.handleScroll,600),this.getList()},beforeDestroy:function(){this.interval&&clearInterval(this.interval),this.debounceHandleScroll=null},methods:{openModal:function(){this.resetData(),this.getList(),this.visible=!0},handleSelect:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.activeId=t},initScrollBar:function(){var t=this;try{this.$refs.scrollWrapper.addEventListener("scroll",this.initScrollBarStatus),this.$once("hook:beforeDestroy",(function(){t.$refs.scrollWrapper.removeEventListener("scroll",t.initScrollBarStatus)}))}catch(t){}},initScrollBarStatus:function(){this.showScroll=!0},resetData:function(){this.list=[],this.loading=!1,this.hasMore=!0,this.activeId=""},handleScroll:function(){try{var t=this.$refs.scrollWrapper;try{if(0===t.scrollTop&&0===t.scrollHeight)return}catch(t){}var e=(null==t?void 0:t.scrollHeight)-t.scrollTop;e-=null==t?void 0:t.clientHeight,t&&e<=30&&this.hasMore&&this.handleLoadMore()}catch(t){}},handleLoadMore:function(){var t=this.list.length?this.list[this.list.length-1]:"",e=t?t.update_at:"";this.getList(e)},getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n={limit:20};["",null,void 0].includes(e)||(n.time_from=e),this.loading=!0,Object(x.e)(n).then((function(e){var o=(null==e?void 0:e.data)||{},r=o.items,l=void 0===r?[]:r,c=o.has_more,d=void 0===c||c;if(t.hasMore=d,null!=n&&n.time_from){var h,m,v=Object(J.e)(t.list,l||[]),f=null===(h=t.$refs)||void 0===h||null===(h=h.scrollWrapper)||void 0===h?void 0:h.scrollHeight;(m=t.list).push.apply(m,Object(k.a)(v)),f&&v.length&&t.scrollToTop(f,"instant")}else t.list=Array.isArray(l)&&null!=l&&l.length?l:[],t.scrollToTop(0,"instant")})).finally((function(){t.loading=!1}))},scrollToTop:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{var e=this.$refs.scrollWrapper;if(e){e.scrollTo({top:0,behavior:t})}}catch(t){}},handleClose:function(){this.visible=!1},handleConfirm:function(){this.activeId&&this.$emit("loadJson",this.activeId),this.handleClose()},handleDelete:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;n&&(null==n?void 0:n.id)===(null===(t=this.$route)||void 0===t||null===(t=t.query)||void 0===t?void 0:t.workId)||this.$confirm(this.$t("canvas_delete_tips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(t){Object(x.c)({id:null==n?void 0:n.id}).then((function(t){var o;if(1e4===(null==t||null===(o=t.status)||void 0===o?void 0:o.code)){var r=(e.list||[]).findIndex((function(t){return(null==t?void 0:t.id)===n.id}));e.list.splice(r,1),(null==n?void 0:n.id)===e.activeId&&(e.activeId=""),e.$emit("removeQuery",null==n?void 0:n.id)}}))})).catch((function(){}))},handleEdit:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this;this.$prompt(this.$t("workFlow49"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),customClass:"custom-confirm",inputValue:null==t?void 0:t.name,inputPlaceholder:e.$t("pleaseEnte")}).then((function(n){var o=n.value;e.handleEditTitle(t,o)})).catch((function(){}))},handleCopy:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n={action:3,id:e.id};return Object(x.n)(n).then((function(n){var o=((null==n?void 0:n.data)||{}).work_flow,r=void 0===o?null:o;r&&(r.node_num=e.node_num,t.list.unshift(r),t.$message.success(t.$t("CopySuccess")))})).finally((function(){}))},handleEditTitle:function(t,e){var n=this;if(e!==(null==t?void 0:t.name)&&!["",null,void 0].includes(e)){var o={id:t.id,name:e};Object(x.m)(o).then((function(o){var r;1e4===(null==o||null===(r=o.status)||void 0===r?void 0:r.code)&&(n.$set(t,"name",e),n.$message.success(n.$t("SuccessfullyModified")))}))}}}}),nt=at,ot=(n(2371),Object(h.a)(nt,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"workflow-history-record-modal",attrs:{title:t.$t("workFlow20"),visible:t.visible,width:"563px","before-close":t.handleClose},on:{"update:visible":function(e){t.visible=e}}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"scrollWrapper",staticClass:"history-record-list",on:{scroll:t.debounceHandleScroll}},t._l(t.list,(function(n){var o,r;return e("div",{key:n.id,staticClass:"history-record-list-item",class:[(null==n?void 0:n.id)===t.activeId&&"history-record-list-item-active"],on:{click:function(e){return t.handleSelect(null==n?void 0:n.id)}}},[e("div",{staticClass:"history-record-list-item-left"},[e("div",{staticClass:"history-record-list-item-img"},[e("img",{attrs:{src:(null==n||null===(o=n.cover)||void 0===o?void 0:o.url)||"https://image.cdn2.seaart.ai/static/upload/20240316/b3b9ad7e-1ba1-467b-b48e-fe3b38719370_low.webp",alt:""}})]),t._v(" "),e("div",{staticClass:"list-item-content"},[e("div",{staticClass:"list-item-content-title"},[t._v(t._s(n.name))]),t._v(" "),e("div",{staticClass:"list-item-content-sub-title"},[e("span",{staticClass:"list-item-content-sub-title-1"},[t._v(t._s((null==n?void 0:n.node_num)||0)+" Nodes")]),t._v(" "),e("span",{staticClass:"list-item-content-sub-title-split"},[t._v("·")]),t._v(" "),e("span",{staticClass:"list-item-content-sub-title-2"},[t._v(t._s(t.formatDate(null==n?void 0:n.update_at)))])])])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:(null==n?void 0:n.id)!==(null===(r=t.$route)||void 0===r||null===(r=r.query)||void 0===r?void 0:r.workId),expression:"item?.id !== $route?.query?.workId"}],staticClass:"history-record-list-item-right"},[e("span",{staticClass:"el-icon-edit-outline operate-icon",on:{click:function(e){return t.handleEdit(n)}}}),t._v(" "),e("span",{staticClass:"el-icon-copy-document operate-icon",on:{click:function(e){return t.handleCopy(n)}}}),t._v(" "),e("span",{staticClass:"el-icon-delete delete-icon",on:{click:function(e){return t.handleDelete(n)}}})])])})),0),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{staticClass:"cancel-btn",on:{click:function(e){return t.handleClose()}}},[t._v(t._s(t.$t("Cancel")))]),t._v(" "),e("el-button",{staticClass:"confirm-btn",attrs:{type:"primary"},on:{click:t.handleConfirm}},[t._v(t._s(t.$t("Confirm")))])],1)])}),[],!1,null,null,null).exports),st=n(210),lt=n(38),ct=n(281),ut=n(1880),pt=n(2372),ht=n(208),mt=n(94),vt=n.n(mt);function ft(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function gt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ft(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ft(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var _t={name:"createWorkflowModal",data:function(){return{visible:!1,list:[],hasMore:!0,loading:!1,debounceHandleScroll:null,showScroll:!0,activeId:"",nowTime:new Date,retryCount:0,templateData:"",templateFileLoading:!1}},computed:gt(gt({},Object(c.e)("user",["userInfo"])),{},{formatDate:function(t){var e=this;return function(t){if(!t)return"";var n=new Date(t),o=e.nowTime.getTime()-n.getTime(),r=Math.floor(o/1e3),l=Math.floor(o/6e4),c=Math.floor(o/36e5),d=Math.floor(o/864e5);return r<60?e.$t("workFlow9",{num:r}):l<60?e.$t("workFlow6",{num:l}):c<24?e.$t("workFlow7",{num:c}):e.$t("workFlow8",{num:d})}}}),mounted:function(){var t=this;this.interval=setInterval((function(){t.$set(t,"nowTime",new Date)}),6e4),this.initScrollBar(),this.debounceHandleScroll=Object(K.debounce)(this.handleScroll,600),this.getList()},beforeDestroy:function(){this.interval&&clearInterval(this.interval),this.debounceHandleScroll=null},methods:{openModal:function(){this.resetData(),this.getList(),this.visible=!0},doLogEvent:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={operation:t,behavior_info:"on_comfyui_pop"};e&&(n.behavior_info_sub=e),this.$logEvent("log_actions",n)},handleClick:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";null!==(t=this.userInfo)&&void 0!==t&&t.id?("createByLocalFile"===e&&this.doLogEvent("click_import_comfyui_from_local"),"createByEmpty"===e&&this.doLogEvent("click_create_new_comfyui"),this.$emit("command",e,!0)):this.$EventBus.$emit("openLoginDialog")},applyTemplate:function(){var t=arguments,e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=((t.length>0&&void 0!==t[0]?t[0]:{})||{}).file_url,r=void 0===o?"":o,e.templateData="",e.templateFileLoading=!0,n.next=6,e.loadJsonFile(r);case 6:e.templateFileLoading=!1,e.templateData&&(e.doLogEvent("click_other_functions","file_url"),e.$emit("applyTemplate",e.templateData));case 8:case"end":return n.stop()}}),n)})))()},loadJsonFile:function(){var t=arguments,e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=t.length>0&&void 0!==t[0]?t[0]:"",n.next=3,vt.a.getItem(o);case 3:if(!(l=n.sent)){n.next=8;break}return e.templateData=l||{},e.templateFileLoading=!1,n.abrupt("return");case 8:return n.abrupt("return",fetch(o).then((function(t){return t.ok||e.$message.error(e.$t("ServerError")),t.json()})).then(function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(data){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.templateData=data||{},!e.templateData){t.next=4;break}return t.next=4,vt.a.setItem(o,e.templateData);case 4:e.templateFileLoading=!1;case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){0===e.retryCount?(e.loadJsonFile(o),e.retryCount++):e.$message.error(e.$t("ServerError"))})));case 9:case"end":return n.stop()}}),n)})))()},handleSelect:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.activeId=t},initScrollBar:function(){var t=this;try{this.$refs.scrollWrapper.addEventListener("scroll",this.initScrollBarStatus),this.$once("hook:beforeDestroy",(function(){t.$refs.scrollWrapper.removeEventListener("scroll",t.initScrollBarStatus)}))}catch(t){}},initScrollBarStatus:function(){this.showScroll=!0},resetData:function(){this.list=[],this.loading=!1,this.hasMore=!0,this.activeId="",this.retryCount=0,this.templateData="",this.templateFileLoading=!1},handleScroll:function(){try{var t=this.$refs.scrollWrapper;try{if(0===t.scrollTop&&0===t.scrollHeight)return}catch(t){}var e=(null==t?void 0:t.scrollHeight)-t.scrollTop;e-=null==t?void 0:t.clientHeight,t&&e<=30&&this.hasMore&&this.handleLoadMore()}catch(t){}},handleLoadMore:function(){this.getList()},getList:function(){var t=this;this.loading=!0,Object(x.j)({}).then((function(e){var n=(null==e?void 0:e.data)||{},o=n.items,r=void 0===o?[]:o,l=n.has_more,c=void 0!==l&&l;t.hasMore=c,t.list=Array.isArray(r)&&null!=r&&r.length?r:[],t.scrollToTop(0,"instant")})).finally((function(){t.loading=!1}))},scrollToTop:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{var e=this.$refs.scrollWrapper;if(e){e.scrollTo({top:0,behavior:t})}}catch(t){}},handleClose:function(){this.visible=!1,this.$emit("closeWorkflowModal")},handleConfirm:function(){this.$emit("loadJson",this.activeId),this.handleClose()},handleDelete:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;n&&(null==n?void 0:n.id)===(null===(t=this.$route)||void 0===t||null===(t=t.query)||void 0===t?void 0:t.workId)||this.$confirm(this.$t("canvas_delete_tips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(t){Object(x.c)({id:null==n?void 0:n.id}).then((function(t){var o;if(1e4===(null==t||null===(o=t.status)||void 0===o?void 0:o.code)){var r=(e.list||[]).findIndex((function(t){return(null==t?void 0:t.id)===n.id}));e.list.splice(r,1),(null==n?void 0:n.id)===e.activeId&&(e.activeId=""),e.$emit("removeQuery",null==n?void 0:n.id)}}))})).catch((function(){}))}}},bt=_t,yt=(n(2373),Object(h.a)(bt,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"create-workflow-modal",attrs:{title:t.$t("workFlow45"),visible:t.visible,width:"1346px","before-close":t.handleClose},on:{"update:visible":function(e){t.visible=e}}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"scrollWrapper",staticClass:"create-template-list",on:{scroll:t.debounceHandleScroll}},[e("div",{staticClass:"create-template-list-item create-template-list-item-add",on:{click:function(e){return e.stopPropagation(),t.handleClick("createByLocalFile")}}},[e("div",{staticClass:"list-item-title-icon iconfont icon-daoru2"}),t._v(" "),e("div",{staticClass:"list-item-title"},[t._v(t._s(t.$t("workFlow19")))])]),t._v(" "),e("div",{staticClass:"create-template-list-item create-template-list-item-add",on:{click:function(e){return e.stopPropagation(),t.handleClick("createByEmpty")}}},[e("div",{staticClass:"list-item-title-icon el-icon-plus"}),t._v(" "),e("div",{staticClass:"list-item-title"},[t._v(t._s(t.$t("workFlow16")))])]),t._v(" "),t._l(t.list,(function(n,o){return e("div",{key:o,staticClass:"create-template-list-item",on:{click:function(e){return e.stopPropagation(),t.applyTemplate(n)}}},[n.cover?e("img",{staticClass:"create-template-list-item-image",attrs:{src:n.cover,alt:""}}):t._e(),t._v(" "),e("div",{staticClass:"list-item-bottom"},[e("div",{staticClass:"list-item-bottom-title"},[t._v(t._s(n.name))]),t._v(" "),e("div",{staticClass:"list-item-bottom-operate-bar"},[e("div",{staticClass:"node-num-title"},[t._v(t._s(n.node_num)+" NODE")]),t._v(" "),e("div",{staticClass:"list-item-bottom-operate-bar-btn"},[t._v(t._s(t.$t("workFlow46")))])])])])}))],2)])}),[],!1,null,null,null).exports);function wt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,a){if(t){if("string"==typeof t)return Ct(t,a);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Ct(t,a):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,l=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw l}}}}function Ct(t,a){(null==a||a>t.length)&&(a=t.length);for(var e=0,n=Array(a);e<a;e++)n[e]=t[e];return n}function kt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function xt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?kt(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ot={name:"workFLow",components:{workFlowHeader:C,historyPage:et,workflowPublish:it.default,historyRecordModal:ot,workflowStyleModal:st.a,LoadingStatus:ht.a,createWorkflowModal:yt},provide:function(){return{top:this}},data:function(){return{loading:!0,workFlowApp:null,workFlowGraph:null,showHistoryModal:!1,workflowInfo:null,UPLOAD:new lt.a({type:20}),UPLOADVIDEO:new ct.a({category:20}),saveWorkflowLoading:!1,saveAsWorkflowLoading:!1,taskInfo:{},workflowConfig:{categories:[],controlnet:[],nodes:[],vae:[]},generateCost:0,lastOutput:[],timer:null,autoSaveTimer:null,canPublish:1,isReady:!1,showVersionUpdateFlag:!1,retryCount:0,apiData:"",uiData:"",saveStatus:""}},computed:xt(xt({},Object(c.c)("user",["userInfo","isLoggedIn"])),{},{getIframeUrl:function(){var t,e=(null===(t=window)||void 0===t||null===(t=t.location)||void 0===t?void 0:t.origin)||"https://www.seaart.ai";return"".concat(e,"/comfyui/")},currentPageType:function(){var t,e,n="create";return null!==(t=this.$route)&&void 0!==t&&null!==(t=t.query)&&void 0!==t&&t.id&&(n="create"),null!==(e=this.$route)&&void 0!==e&&null!==(e=e.query)&&void 0!==e&&e.workId&&(n="edit"),n}}),mounted:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var iframe;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(iframe=document.getElementById("myIframe"))?(iframe.addEventListener("load",(function(){t.isReady=!0})),iframe.addEventListener("error",(function(){t.isReady=!0}))):t.isReady=!0,t.$EventBus.$off("openWorkflowSelectModel"),window.workflow_upload=t.UPLOAD,window.workflow_upload_video=t.UPLOADVIDEO,e.next=7,t.getWorkflowConfig();case 7:return e.next=9,t.initWorkflow();case 9:t.initVersionInfo();try{document.body.classList.add("litegraph")}catch(t){}window.addEventListener("message",(function(e){e.origin===location.origin&&t.handleComfyuiMessage(e.data)})),t.$EventBus.$on("openWorkflowSelectModel",(function(e){var n=e.node,o=e.pickWidget,r=e.inputName,l=e.inputData,c=e.modelType;t.$refs.workflowStyleModal.openModal({modelType:c,node:n,pickWidget:o,inputName:r,inputData:l})}));case 13:case"end":return e.stop()}}),e)})))()},beforeDestroy:function(){this.timer&&clearTimeout(this.timer),this.timer=null,this.autoSaveTimer&&clearInterval(this.autoSaveTimer),this.autoSaveTimer=null,this.loading=!1,this.workFlowGraph=null,this.showHistoryModal=!1,this.$EventBus.$off("openWorkflowSelectModel")},methods:{handleApplyTemplate:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.closeCreateWorkflowModal(),Object.keys((null===(o=e.$route)||void 0===o?void 0:o.query)||[]).length&&e.$router.replace({query:{}}),e.workflowInfo=null,r=t,e.postMsgToIframe({type:"loadGraphData",data:r});case 5:case"end":return n.stop()}}),n)})))()},handleReloadData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n={};n.id=e,this.loading=!0,Object(x.f)(n).then((function(e){var n,o,r=(null==e?void 0:e.data)||{},l=null==e||null===(n=e.data)||void 0===n?void 0:n.data;try{l=JSON.parse(l)}catch(t){}t.workflowInfo=xt(xt({},r),{},{data:l}),t.$router.replace({query:{workId:null==t||null===(o=t.workflowInfo)||void 0===o?void 0:o.id}});try{["",null,void 0].includes(null==r?void 0:r.name)||(t.$refs.workFlowHeader.title=r.name,localStorage.setItem("workflow_title",JSON.stringify({id:"",title:r.name})))}catch(t){}t.postMsgToIframe({type:"loadGraphData",data:l})})).finally((function(){t.loading=!1}))},getWorkflowConfig:function(){var t=this;return Object(x.g)().then((function(e){t.workflowConfig=Object.assign(t.workflowConfig,e.data||{}),window.workflowConfig=t.workflowConfig})).catch((function(t){}))},initWorkflow:function(){var t,e;return null!==(t=this.$route)&&void 0!==t&&null!==(t=t.query)&&void 0!==t&&t.id?this.getOtherWorkflowData():null!==(e=this.$route)&&void 0!==e&&null!==(e=e.query)&&void 0!==e&&e.workId?this.getSelfWorkflowData():void 0},handleRemoveQuery:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e&&e===(null===(t=this.$route)||void 0===t||null===(t=t.query)||void 0===t?void 0:t.id)&&this.$router.replace({query:{}});try{delete this.workflowInfo.id}catch(t){}},initVersionInfo:function(){var t=(this.workflowConfig||{}).package_node_url,e=void 0===t?"":t;e&&this.checkVersionInfo(e)},initOpenCreateModal:function(){var t,e,n=this,o=localStorage.getItem("workflow_retry_json");if(o){var r=JSON.parse(o);this.postMsgToIframe({type:"loadGraphData",data:r}),localStorage.removeItem("workflow_retry_json")}else if(null!==(t=this.$route.query)&&void 0!==t&&t.id||null!==(e=this.$route.query)&&void 0!==e&&e.workId){var l,c=xt({},ut.a);this.postMsgToIframe({type:"loadGraphData",data:(null==this||null===(l=this.workflowInfo)||void 0===l?void 0:l.data)||c})}else this.$nextTick((function(){n.openCreateWorkflowModal()}))},checkVersionInfo:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,vt.a.getItem(t);case 2:if(!(o=n.sent)){n.next=8;break}return l=o||[],e.showVersionUpdateFlag=(l||[]).some((function(t){return!(null==t||!t.node_has_new)})),e.retryCount=0,n.abrupt("return");case 8:return n.abrupt("return",fetch(t).then((function(t){return t.ok,t.json()})).then(function(){var n=Object(r.a)(regeneratorRuntime.mark((function n(data){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(o=data||[])){n.next=5;break}return e.retryCount=0,n.next=5,vt.a.setItem(t,o);case 5:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()).catch((function(n){0===e.retryCount&&(e.checkVersionInfo(t),e.retryCount++)})));case 9:case"end":return n.stop()}}),n)})))()},getOtherWorkflowData:function(){var t,e=this,n={};return n.template_id=null===(t=this.$route.query)||void 0===t?void 0:t.id,Object(x.d)(n).then((function(t){var n,o=(null==t?void 0:t.data)||{},r=null==t||null===(n=t.data)||void 0===n?void 0:n.data;try{r=JSON.parse(r)}catch(t){}e.workflowInfo=xt(xt({},o),{},{data:r});try{["",null,void 0].includes(null==o?void 0:o.name)||(e.$refs.workFlowHeader.title=o.name,localStorage.setItem("workflow_title",JSON.stringify({id:"",title:o.name})))}catch(t){}})).catch((function(t){}))},getSelfWorkflowData:function(){var t,e=this,n={};return n.id=null===(t=this.$route.query)||void 0===t?void 0:t.workId,Object(x.f)(n).then((function(t){var n,o=(null==t?void 0:t.data)||{},r=null==t||null===(n=t.data)||void 0===n?void 0:n.data;try{r=JSON.parse(r)}catch(t){}e.workflowInfo=xt(xt({},o),{},{data:r})})).catch((function(t){}))},handleGenerate:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,c,d,h,m,v,f,_,y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.clearNodeErrorMessage(),null!==(n=t.userInfo)&&void 0!==n&&n.id){e.next=4;break}return t.$EventBus.$emit("openLoginDialog"),e.abrupt("return");case 4:return d=((null==t||null===(o=t.workFlowApp)||void 0===o||null===(o=o.graph)||void 0===o?void 0:o._nodes)||[]).filter((function(t){return t&&(null==t?void 0:t.valueControl)})).map((function(t){var e;return null===(e=t.valueControl)||void 0===e?void 0:e.afterQueued()})),e.next=7,Promise.all(d);case 7:h={},t.postMsgToIframe({type:"generateParams"}),null!==(r=t.$route)&&void 0!==r&&null!==(r=r.query)&&void 0!==r&&r.workId&&(h.work_flow_id=null==t||null===(m=t.workflowInfo)||void 0===m?void 0:m.id),null!==(l=t.$route)&&void 0!==l&&null!==(l=l.query)&&void 0!==l&&l.source&&(f=Number(null===(v=t.$route)||void 0===v||null===(v=v.query)||void 0===v?void 0:v.source),!isNaN(f)&&(h.source=f)),null!==(c=t.$route)&&void 0!==c&&null!==(c=c.query)&&void 0!==c&&c.source_id&&(h.source_id=null===(_=t.$route)||void 0===_||null===(_=_.query)||void 0===_?void 0:_.source_id),t.showHistoryModal||(t.showHistoryModal=!0),y=setInterval((function(){t.apiData&&(clearInterval(y),h.api_data=t.apiData,t.apiData="",t.handleGenerateTask(h))}),1e3);case 14:case"end":return e.stop()}}),e)})))()},handleGenerateTask:function(t){var e=this;Object(x.b)(t).then((function(n){var data=n.data,o=null==data?void 0:data.id,r=localStorage.getItem("workflow_title"),l=(r?JSON.parse(r):{}).title,c={id:o,status:1,process:0,creativity:{name:(void 0===l?"":l)||e.$t("workFlow3"),is_support_retry:!0}};e.taskInfo={},e.taskInfo.api_data=t.api_data,e.taskInfo.taskId=o,e.taskInfo.status=1,e.taskInfo.process=0,e.$refs.historyPage.insertDataToList(c),e.postMsgToIframe({type:"postTaskInfo",data:e.taskInfo})})).catch((function(t){console.log("error",t)}))},handleSelectModel:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.info,n=void 0===e?{}:e,o=t.modelType,r=t.node,l=t.pickWidget,c="".concat(n.id,"@").concat(n.model_ver_no),d="".concat(n.name,"-").concat(n.version_name);this.postMsgToIframe({type:"onModelPicked",data:{node:r,pickWidget:l,id:c,name:d,modelType:o}})},handleUpdateTask:function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=n||{},r=o.status,l=o.comfyui_current_node,c=void 0===l?{}:l;null!=n&&n.id&&n.id===(null===(t=this.taskInfo)||void 0===t?void 0:t.taskId)&&this.$set(this.taskInfo,"status",r),null!==(e=Object.keys(c))&&void 0!==e&&e.length&&this.postMsgToIframe({type:"nodesError",data:{comfyui_current_node:c}})},formatExecutionError:function(t){if(null==t)return"(unknown error)";var e=t.traceback.join(""),n=(t.node_id,t.node_type);return"Error occurred when executing ".concat(n,":\n\n").concat(t.exception_message,"\n\n").concat(e)},formatPromptError:function(t){if(null==t)return"(unknown error)";if("string"==typeof t)return t;if(t.stack&&t.message)return t.toString();if(t.response){var e=t.response.error.message;t.response.error.details&&(e+=": "+t.response.error.details);for(var n=0,r=Object.entries(t.response.node_errors);n<r.length;n++){var l=Object(o.a)(r[n],2),c=(l[0],l[1]);e+="\n"+c.class_type+":";var d,h=wt(c.errors);try{for(h.s();!(d=h.n()).done;){var m=d.value;e+="\n    - "+m.message+": "+m.details}}catch(t){h.e(t)}finally{h.f()}}return e}return"(unknown error)"},clearNodeErrorMessage:function(){try{this.workFlowApp.lastExecutionError=null,this.workFlowApp.lastNodeErrors=null,this.workFlowApp.ui.dialog.close(),this.workFlowApp.draw(!0,!0)}catch(t){}},openCreateWorkflowModal:function(){try{this.$refs.createWorkflowModal.openModal()}catch(t){}},closeCreateWorkflowModal:function(){try{this.$refs.createWorkflowModal.handleClose()}catch(t){}},handleClick:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(t){case"openCreateWorkflowModal":this.openCreateWorkflowModal();break;case"clearWorkFlow":this.doLogEvent("click_clear_comfyui"),this.clearWorkFlow();break;case"createByEmpty":this.handleCreateByEmpty(e);break;case"createByImageToImage":this.doLogEvent("create_comfyui_template","image_to_image"),this.handleCreateByImageToImage();break;case"createByTextToImage":this.doLogEvent("create_comfyui_template","text_to_image"),this.handleCreateByTextToImage();break;case"createByLocalFile":this.handleCreateByLocalFile(e);break;case"openHistoryRecordModal":this.doLogEvent("click_open_comfyui"),this.openHistoryRecordModal();break;case"saveWorkFlow":this.doLogEvent("click_save_comfyui_template"),this.handleSaveWorkflow();break;case"saveAsWorkFlow":this.doLogEvent("click_save_as_comfyui_template"),this.handleSaveAsWorkflow();break;case"viewHistory":this.doLogEvent("click_view_history"),this.handleViewHistory();break;case"downloadWorkFlow":this.doLogEvent("click_download"),this.handleDownloadWorkflow();break;case"publishWorkFlow":this.doLogEvent("click_publish"),this.handlePublish()}},doLogEvent:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={operation:t,behavior_info:"on_comfyui_project_editing_page"};e&&(n.behavior_info_sub=e),this.$logEvent("log_actions",n)},openHistoryRecordModal:function(){this.saveWorkflowLoading||this.saveAsWorkflowLoading||this.$refs.historyRecordModal.openModal()},handleSaveWorkflow:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d,h,m,v,f,_,y,w,C,k,O,$,D,S,I,title;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.saveWorkflowLoading||t){n.next=2;break}return n.abrupt("return");case 2:return!t&&(e.saveWorkflowLoading=!0),m={action:1},v="",f="",e.postMsgToIframe({type:"getBothJson"}),n.next=9,e.getJsonData();case 9:if(_=n.sent,y=_.uiData,w=_.apiData,f=w,!["none","",void 0,void 0,null].includes(v=y)){n.next=18;break}return e.$message.success(e.$t("SaveFailed")),e.saveWorkflowLoading=!1,n.abrupt("return");case 18:null!==(o=e.$route)&&void 0!==o&&null!==(o=o.query)&&void 0!==o&&o.id&&(m.action=1,m.source=4),null!==(r=e.$route.query)&&void 0!==r&&r.id||null!==(l=e.$route.query)&&void 0!==l&&l.workId||(m.action=1,m.source=1),null!==(c=e.$route.query)&&void 0!==c&&c.workId&&(m.action=2,m.id=null===(C=e.$route.query)||void 0===C?void 0:C.workId),null!==(d=e.$route)&&void 0!==d&&null!==(d=d.query)&&void 0!==d&&d.source&&(O=Number(null===(k=e.$route)||void 0===k||null===(k=k.query)||void 0===k?void 0:k.source),m.source=isNaN(O)?4:O),null!==(h=e.$route)&&void 0!==h&&null!==(h=h.query)&&void 0!==h&&h.source_id&&(m.source_id=null===($=e.$route)||void 0===$||null===($=$.query)||void 0===$?void 0:$.source_id),m.data=v,m.api_data=f,m.action="edit"===e.currentPageType?2:1;try{D=localStorage.getItem("workflow_title"),S=D?JSON.parse(D):{},I=S.title,title=void 0===I?"":I,m.name=title||e.$t("workFlow3")}catch(t){console.log("error",t)}return n.abrupt("return",Object(x.n)(m).then((function(n){var o;if(1e4===(null==n||null===(o=n.status)||void 0===o?void 0:o.code)){var r,l=(null==n?void 0:n.data)||{},c=l.work_flow,d=l.publish_state,h=void 0===d?2:d;if(e.workflowInfo=Object.assign(e.workflowInfo||{},(null==m?void 0:m.cover)||{},c||{}),e.canPublish=h,1===m.action)e.$router.replace({query:{workId:null==e||null===(r=e.workflowInfo)||void 0===r?void 0:r.id}});!t&&e.$message.success(e.$t("workflow51"))}else e.$message.success(e.$t("SaveFailed"))})).finally((function(){e.saveWorkflowLoading=!1})));case 28:case"end":return n.stop()}}),n)})))()},handleSaveAsWorkflow:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,c,d,h,m,v,f,_,y,w,C,k,O,$,title;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.saveAsWorkflowLoading){e.next=2;break}return e.abrupt("return");case 2:return t.saveAsWorkflowLoading=!0,d={action:1},h="",m="",t.postMsgToIframe({type:"getBothJson"}),e.next=9,t.getJsonData();case 9:if(v=e.sent,f=v.uiData,_=v.apiData,m=_,!["none","",void 0,void 0,null].includes(h=f)){e.next=18;break}return t.$message.success(t.$t("SaveFailed")),t.saveAsWorkflowLoading=!1,e.abrupt("return");case 18:null!==(n=t.$route)&&void 0!==n&&null!==(n=n.query)&&void 0!==n&&n.id&&(d.source=4),null!==(o=t.$route.query)&&void 0!==o&&o.id||null!==(r=t.$route.query)&&void 0!==r&&r.workId||(d.source=1),null!==(l=t.$route)&&void 0!==l&&null!==(l=l.query)&&void 0!==l&&l.source&&(w=Number(null===(y=t.$route)||void 0===y||null===(y=y.query)||void 0===y?void 0:y.source),d.source=isNaN(w)?4:w),null!==(c=t.$route)&&void 0!==c&&null!==(c=c.query)&&void 0!==c&&c.source_id&&(d.source_id=null===(C=t.$route)||void 0===C||null===(C=C.query)||void 0===C?void 0:C.source_id),d.data=h,d.api_data=m;try{k=localStorage.getItem("workflow_title"),O=k?JSON.parse(k):{},$=O.title,title=void 0===$?"":$,d.name=title||t.$t("workFlow3")}catch(t){console.log("error",t)}return e.abrupt("return",Object(x.n)(d).then((function(e){var n;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)?t.$message.success(t.$t("workflow51")):t.$message.success(t.$t("SaveFailed"))})).finally((function(){t.saveAsWorkflowLoading=!1})));case 26:case"end":return e.stop()}}),e)})))()},handleRetry:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d,h,m;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.$logEvent("log_actions",{operation:"click_retry",behavior_info:"on_comfyui_page"}),o=t.id,r=t.type,l=t.name,c=x.f,[3,4].includes(r)&&(c=x.i),d="",n.prev=5,n.next=8,c({id:o});case 8:m=n.sent,d=null==m||null===(h=m.data)||void 0===h?void 0:h.data,d=JSON.parse(d),n.next=16;break;case 13:n.prev=13,n.t0=n.catch(5),console.log("error",n.t0);case 16:e.$confirm(e.$t("OverwriteWorkflowTip"),e.$t("OverwriteWorkflow"),{distinguishCancelAndClose:!0,confirmButtonText:e.$t("OpenInNewPage"),cancelButtonText:e.$t("OpenInCurrentPage"),type:"warning",customClass:"custom-confirm"}).then((function(){d&&(localStorage.setItem("workflow_retry_json",JSON.stringify(d)),window.open(e.localePath("/workflow"),"_blank"))})).catch((function(t){"cancel"===t&&d&&(e.$refs.workFlowHeader.title=l,localStorage.setItem("workflow_title",JSON.stringify({id:"",title:l})),e.postMsgToIframe({type:"loadGraphData",data:d}))}));case 17:case"end":return n.stop()}}),n,null,[[5,13]])})))()},getJsonData:function(){var t=this;return new Promise((function(e,n){var o=setInterval((function(){if(t.uiData&&t.apiData){clearInterval(o);var n=t.uiData;t.uiData="";var r=t.apiData;t.apiData="",e({uiData:n,apiData:r})}}),1e3)}))},handleViewHistory:function(){this.showHistoryModal=!this.showHistoryModal},checkImageSize:function(t){return new Promise((function(e,n){var img=new Image;img.onload=function(){var t={width:img.width,height:img.height,realWidth:img.naturalWidth,realHeight:img.naturalHeight};t.url=img.src,e(t)},img.onerror=function(){n(!1)},img.src=t}))},handleDownloadWorkflow:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,c,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="sa_workflow.json",t.postMsgToIframe({type:"getBothJson"}),e.next=4,t.getJsonData();case 4:o=e.sent,r=o.uiData,l=new Blob([r],{type:"application/json"}),c=URL.createObjectURL(l),(a=document.createElement("a")).href=c,a.download=n,a.style.display="none",document.body.appendChild(a),a.click(),setTimeout((function(){var t,e;null===(t=document)||void 0===t||null===(t=t.body)||void 0===t||t.removeChild(a),null===(e=window)||void 0===e||null===(e=e.URL)||void 0===e||e.revokeObjectURL(c)}),0);case 15:case"end":return e.stop()}}),e)})))()},handlePublish:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,c,d,h,m,v,f,_;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l="",c="",t.postMsgToIframe({type:"getBothJson"}),e.next=5,t.getJsonData();case 5:return d=e.sent,h=d.uiData,m=d.apiData,c=h,v={api_data:l=m},null!==(n=t.$route)&&void 0!==n&&null!==(n=n.query)&&void 0!==n&&n.source_id&&(v.template_id=null===(f=t.$route)||void 0===f||null===(f=f.query)||void 0===f?void 0:f.source_id),e.next=14,t.handleSaveWorkflow();case 14:if(2!==t.canPublish){e.next=17;break}return t.$message.error(t.$t("workFlow32")),e.abrupt("return");case 17:t.workflowInfo.ui_json=c,t.workflowInfo.api_json=l,_=(null===(o=t.workflowInfo)||void 0===o?void 0:o.id)||(null===(r=t.$route.query)||void 0===r?void 0:r.workId),window.open(t.localePath("/workflow/publish/".concat(_)),"_blank");case 21:case"end":return e.stop()}}),e)})))()},checkHasWorkFlow:function(){var t,e,n=this,o=this,r=!1;return null==this||null===(t=this.workFlowGraph)||void 0===t||null===(t=t._nodes)||void 0===t||!t.length||null!==(e=this.$route)&&void 0!==e&&null!==(e=e.query)&&void 0!==e&&e.workId||(r=!0),new Promise((function(t,e){r?n.$confirm(o.$t("workFlow2"),o.$t("Tip"),{confirmButtonText:n.$t("Confirm"),cancelButtonText:n.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(e){t("confirm")})).catch((function(){t("cancel")})):t("confirm")}))},clearWorkFlow:function(){var t=this;this.$confirm(this.$t("workFlow1"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then(function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(n){var o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(o=t.$route)||void 0===o||null===(o=o.query)||void 0===o||!o.workId){e.next=3;break}return e.next=3,Object(x.a)({id:null===(r=t.$route)||void 0===r||null===(r=r.query)||void 0===r?void 0:r.workId});case 3:t.postMsgToIframe({type:"clean"});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(){}))},handleCreateByEmpty:function(){var t=arguments,e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o,r,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.length>0&&void 0!==t[0]&&t[0],n.next=3,e.checkHasWorkFlow();case 3:if("cancel"!==n.sent){n.next=6;break}return n.abrupt("return");case 6:r&&e.closeCreateWorkflowModal(),Object.keys((null===(o=e.$route)||void 0===o?void 0:o.query)||[]).length&&e.$router.replace({query:{}}),e.workflowInfo=null,e.postMsgToIframe({type:"clean"}),l=e.$t("workFlow3"),e.$refs.workFlowHeader.title=l,localStorage.setItem("workflow_title",JSON.stringify({id:"",title:l}));case 13:case"end":return n.stop()}}),n)})))()},handleCreateByImageToImage:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.checkHasWorkFlow();case 2:if("cancel"!==e.sent){e.next=5;break}return e.abrupt("return");case 5:Object.keys((null===(n=t.$route)||void 0===n?void 0:n.query)||[]).length&&t.$router.replace({query:{}}),t.workflowInfo=null,o=xt({},pt.a),t.postMsgToIframe({type:"loadGraphData",data:o});case 9:case"end":return e.stop()}}),e)})))()},handleCreateByTextToImage:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.checkHasWorkFlow();case 2:if("cancel"!==e.sent){e.next=5;break}return e.abrupt("return");case 5:Object.keys((null===(n=t.$route)||void 0===n?void 0:n.query)||[]).length&&t.$router.replace({query:{}}),t.workflowInfo=null,o=xt({},ut.a),t.postMsgToIframe({type:"loadGraphData",data:o});case 9:case"end":return e.stop()}}),e)})))()},handleCreateByLocalFile:function(){var t=arguments,e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=t.length>0&&void 0!==t[0]&&t[0],e.$confirm(e.$t("workFlow2"),e.$t("Tip"),{confirmButtonText:e.$t("Confirm"),cancelButtonText:e.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(t){o&&e.closeCreateWorkflowModal(),e.createByLocalFile()})).catch((function(){}));case 2:case"end":return n.stop()}}),n)})))()},createByLocalFile:function(){var t;Object.keys((null===(t=this.$route)||void 0===t?void 0:t.query)||[]).length&&this.$router.replace({query:{}}),this.workflowInfo=null,this.postMsgToIframe({type:"createByLocalFile"})},handleComfyuiMessage:function(data){var t=data.type,e=data.info;switch(t){case"openWorkflowSelectModel":var n=e.modelType,o=e.ckptNameWidget,r=e.node;e.params;this.$EventBus.$emit("openWorkflowSelectModel",{modelType:n,pickWidget:JSON.parse(o),node:r});break;case"generateParams":this.apiData=e;break;case"getBothJson":var l=e.uiData,c=e.apiData;this.uiData=l,this.apiData=c;break;case"comfyuiReady":this.initOpenCreateModal()}},postMsgToIframe:function(data){var t,iframe=null===(t=document.getElementById("myIframe"))||void 0===t?void 0:t.contentWindow;iframe&&iframe.postMessage(data,"*")}}},$t=Ot,Dt=(n(2374),n(2375),Object(h.a)($t,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"p-work-flow"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isReady,expression:"isReady"}],staticClass:"p-work-flow-box"},[e("work-flow-header",{ref:"workFlowHeader",attrs:{saveStatus:t.saveStatus,showBadge:t.showVersionUpdateFlag},on:{command:t.handleClick}}),t._v(" "),e("iframe",{attrs:{id:"myIframe",src:t.getIframeUrl,width:"100%",height:"100%",frameborder:"0"}}),t._v(" "),e("div",{staticClass:"work-flow-bottom-btn",on:{click:function(e){return e.stopPropagation(),t.handleGenerate.apply(null,arguments)}}},[e("div",{staticClass:"work-flow-bottom-btn-inner"},[e("div",{staticClass:"work-flow-bottom-btn-main-text"},[t._v("\n          "+t._s(t.$t("Generate"))+"\n          "),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("workFlow31"),placement:"top"}},[e("span",{staticClass:"el-icon-question work-flow-bottom-btn-main-text-icon"})])],1)])]),t._v(" "),t.isLoggedIn?e("history-page",{directives:[{name:"show",rawName:"v-show",value:t.showHistoryModal,expression:"showHistoryModal"}],ref:"historyPage",on:{updateTask:t.handleUpdateTask,retry:t.handleRetry}}):t._e(),t._v(" "),t.isLoggedIn?e("history-record-modal",{ref:"historyRecordModal",on:{loadJson:t.handleReloadData,removeQuery:t.handleRemoveQuery}}):t._e(),t._v(" "),e("workflow-style-modal",{ref:"workflowStyleModal",on:{selectModel:t.handleSelectModel}}),t._v(" "),e("create-workflow-modal",{ref:"createWorkflowModal",on:{command:t.handleClick,applyTemplate:t.handleApplyTemplate}})],1),t._v(" "),e("LoadingStatus",{directives:[{name:"show",rawName:"v-show",value:!t.isReady,expression:"!isReady"}],attrs:{bgColor:"#02050e"}})],1)}),[],!1,null,"5460e81f",null));e.default=Dt.exports},3259:function(t,e,n){"use strict";n.r(e);n(9),n(7),n(11),n(12),n(8),n(6);var o=n(2),r=(n(16),n(10),n(19),n(14),n(28),n(4),n(1));function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var d={name:"NoticeTab",props:{activeTab:{type:Number,default:0},unRead:{type:Array,default:function(){return[]}}},computed:c(c({},Object(r.c)("chatgpt",["unreadMsgNum"])),{},{tabs:function(){return this.defaultTabs},unreadList:function(){return 0===this.unRead.length?[0,0,0,0]:this.unRead},unreadNum:function(){return function(t){return t>99?"99+":t}},numClass:function(){return function(t){return t?t<10&&t>0?"tab-round tab-basic":"tab-num tab-basic":""}}}),watch:{},data:function(){return{defaultTabs:[{name:"系统",lang:"noticeSystem",type:0,icon:"sound"},{name:"评论",lang:"noticeComment",type:1,icon:"messages"},{name:"赞和收藏",lang:"noticeLike",type:2,icon:"likeAndCollect"},{name:"新的关注",lang:"noticeFollow",type:3,icon:"follow2"}],readLoading:!1}},mounted:function(){},methods:c(c({},Object(r.b)("chatgpt",["setReadMsgAll"])),{},{handleTabClick:function(t,e){e!==this.activeTab&&this.$emit("changeTab",t,e),this.$emit("clickTab",t,e)},readAll:function(){var t=this;console.log("readAll"),0!==this.unreadMsgNum?(this.readLoading=!0,this.setReadMsgAll().then((function(e){var n;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&(t.$message.success(t.$t("msgReadDone")),t.$emit("readAll"))})).finally((function(){t.readLoading=!1}))):this.$message.warning(this.$t("msgNoRead"))}})},h=(n(2725),n(0)),m=Object(h.a)(d,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"notice-tab flex flex-col"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t("noticeCenter")))]),t._v(" "),e("div",{staticClass:"tabs flex flex-col justify-between"},[e("div",{staticClass:"all-tabs"},t._l(t.tabs,(function(n,i){return e("div",{key:"notice-type".concat(i),staticClass:"tab flex items-center justify-between",class:{active:t.activeTab===i},on:{click:function(e){return t.handleTabClick(n,i)}}},[e("div",{staticClass:"tab-left flex items-center"},[e("div",{staticClass:"tab-icon"},[n.icon?e("i",{staticClass:"iconfont icon",class:"icon-".concat(n.icon)}):t._e()]),t._v(" "),e("div",{staticClass:"tab-name"},[t._v(t._s(t.$t(n.lang)))])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.unreadList[i],expression:"unreadList[i]"}],class:t.numClass(t.unreadList[i])},[t._v(t._s(t.unreadNum(t.unreadList[i])))])])})),0),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.readLoading,expression:"readLoading"}],staticClass:"read-all flex justify-center items-center",on:{click:t.readAll}},[e("i",{staticClass:"el-icon-check"}),t._v("\n      "+t._s(t.$t("msgReadAll"))+"\n    ")])])])}),[],!1,null,"5d47df30",null).exports,v=n(15),f=(n(36),n(49),n(76),n(25)),_=n(5),y={name:"msgHead",props:{author:{type:Object,default:function(){}}},computed:{},data:function(){return{}},mounted:function(){},methods:{getNameFirst:function(){var t=this.author,e=t.name,n=t.id;return e||n?(e?e[0]:n[0]).toUpperCase():""}}},w=(n(2726),Object(h.a)(y,(function(){var t,e,n=this,o=n._self._c;return null!==(t=n.author)&&void 0!==t&&t.id?o("div",{staticClass:"msg-head"},[o("div",{staticClass:"head-event"},[o("div",{staticClass:"head-start flex items-center"},[null!==(e=n.author)&&void 0!==e&&e.head?o("div",{directives:[{name:"bg-webp",rawName:"v-bg-webp",value:{src:n.author.head,quality:n.$imgL},expression:"{src: author.head, quality: $imgL}"}],staticClass:"card-user-avatar",on:{click:function(t){return t.stopPropagation(),n.$emit("toUser")}}},[n._v("\n        "+n._s(n.author.head?"":n.getNameFirst())+"\n      ")]):o("div",{staticClass:"card-user-avatar",on:{click:function(t){return t.stopPropagation(),n.$emit("toUser")}}},[n._v("\n        "+n._s(n.getNameFirst())+"\n      ")]),n._v(" "),o("div",{staticClass:"msg-desc"},[n._t("desc")],2)])]),n._v(" "),o("span",{staticClass:"msg-content"},[n._t("detail")],2)]):n._e()}),[],!1,null,"161c0aa8",null).exports);function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var x={name:"NoticeItem",props:{message:{type:Object,default:function(){}}},components:{msgHead:w},computed:k(k({},Object(r.c)("chatgpt",["unreadMsgNum"])),{},{msgSource:function(){var t,e,n,o,r={1:{type:1,lang:"taskTabTasks",from:"task",url:""},2:{type:2,lang:"Work",from:"work",url:"/explore/detail/"},3:{type:3,lang:"Model",from:"model",url:"/models/detail/"},4:{type:4,lang:"gather",from:"gallery",url:"/artWorkDetail/"},5:{type:5,lang:"Video",from:"video",url:"/video/"},6:{type:6,lang:"User",from:"user",url:"/user/"},7:{type:7,lang:"System",from:"system",url:""},8:{type:8,lang:"Board",from:"board",url:"/editBoard/detail/"},9:{type:9,lang:"WorkFlow",from:"workFlow",url:"/workFlowDetail/"},16:{type:16,lang:"Audio",from:"Audio",url:"/ai-audio/detail/"},19:{type:19,lang:"digitalHuman",from:"Character",url:"/cyberPubPage/"},20:{type:20,lang:"Swtft_App",from:"SwiftApp",url:"/workFlowAppDetail/"},21:{type:21,lang:"WorkFlow",from:"WorkFlow",url:"/workFlowDetail/"},22:{type:22,lang:"Article",from:"Article",url:"/articleDetail/"}};return null!==(t=this.message)&&void 0!==t&&t.components&&null!==(e=this.message)&&void 0!==e&&null!==(e=e.components[0])&&void 0!==e&&e.type?r[null===(n=this.message)||void 0===n||null===(n=n.components[0])||void 0===n?void 0:n.type]?r[null===(o=this.message)||void 0===o||null===(o=o.components[0])||void 0===o?void 0:o.type]:(console.log("no such msg type 1"),{type:7,lang:"System",from:"system",url:""}):(console.log("no such msg type 2"),{type:7,lang:"System",from:"system",url:""})},sourceId:function(){var t;return null===(t=this.message)||void 0===t||null===(t=t.components[0])||void 0===t?void 0:t.custom_id},eventType:function(){var t,e;return null!==(t=this.message)&&void 0!==t&&t.components?null===(e=this.message)||void 0===e||null===(e=e.components[0])||void 0===e?void 0:e.event:99},msgTitleImg:function(){var t,e;if(null!==(t=this.message)&&void 0!==t&&t.attachments&&null!==(e=this.message)&&void 0!==e&&null!==(e=e.attachments)&&void 0!==e&&e.length){for(var n,o=null===(n=this.message)||void 0===n?void 0:n.attachments,r={},i=0;i<o.length;i++){var l,c;"title"===(null===(l=o[i])||void 0===l?void 0:l.content_type)?r.title=o[i].title:"image"===(null===(c=o[i])||void 0===c?void 0:c.content_type)&&(r.url=o[i].url)}return r}return{}},author:function(){var t;return(null===(t=this.message)||void 0===t?void 0:t.author)||{}},msgMain:function(){var t,e,n,o,r,l={desc:"",content:(null===(t=this.message)||void 0===t?void 0:t.content)||"",title:(null===(e=this.msgTitleImg)||void 0===e?void 0:e.title)||"",showTitle:!0,showImg:!0};switch(this.eventType){case 1:l.showTitle=!0,l.showImg=!0,l.desc=this.$t("msgMainDescLike",{type:this.$t((null===(n=this.msgSource)||void 0===n?void 0:n.lang)||"Work")});break;case 2:l.showTitle=!0,l.showImg=!0,l.desc=this.$t("msgMainDescCollect",{type:this.$t((null===(o=this.msgSource)||void 0===o?void 0:o.lang)||"Work")});break;case 3:l.showTitle=!1,l.showImg=!0,l.desc=this.$t("msgMainDescCom",{type:this.$t((null===(r=this.msgSource)||void 0===r?void 0:r.lang)||"Work")});break;case 4:l.showTitle=!1,l.showImg=!1,l.desc=this.$t("msgFollowTxt");break;case 5:case 6:case 8:case 10:case 11:case 99:break;case 7:l.showTitle=!1,l.showImg=!0,l.desc=this.$t("msgMainDescReply");break;case 9:l.showTitle=!1,l.showImg=!0,l.desc=this.$t("msgMainDescLikeComment");break;default:l.desc=""}return l},msgTime:function(){var t;return null!==(t=this.message)&&void 0!==t&&t.timestamp?this.formatDate(this.message.timestamp):""},isRead:function(){var t;return!0===(null===(t=this.message)||void 0===t?void 0:t.is_read)||0===this.unreadMsgNum},filterXss:function(){return function(t){return f.default.prototype.xss(t)}}}),data:function(){return{replaceImageType:_.x,errorTimes:0}},mounted:function(){},methods:{handleClickMsg:function(){!1===this.message.is_read&&this.$emit("setRead",this.message),this.openPage()},openPage:function(){var t,e;switch(this.eventType){case 1:case 2:case 3:case 7:case 9:if(this.msgSource.url){var path=this.msgSource.url+this.message.components[0].custom_id,n=this.$router.resolve({path:path});window.open(n.href,"_blank")}break;case 4:path="/user/".concat(this.sourceId),n=this.$router.resolve({path:path});window.open(n.href,"_blank");break;case 5:case 6:if(5===this.msgSource.type){var o=this.msgSource.url+this.message.components[0].custom_id,r=this.$router.resolve({path:o});window.open(r.href,"_blank")}break;case 8:case 10:case 11:case 14:case 17:case 18:case 19:case 99:var l={title:(null===(t=this.msgTitleImg)||void 0===t?void 0:t.title)||this.$t("noticeSystem"),content:this.message.content,time:this.message.timestamp};this.$emit("showSysUpdate",l);break;case 12:case 13:default:break;case 15:this.$emit("showSysUpdate",{title:(null===(e=this.msgTitleImg)||void 0===e?void 0:e.title)||this.$t("noticeSystem"),content:this.message.content,time:this.message.timestamp,linkList:this.convertComfyUiJumpLink()})}},convertComfyUiJumpLink:function(){var t,e,n=this,o=null!==(t=this.message)&&void 0!==t&&null!==(t=t.attachments)&&void 0!==t&&t.length?null===(e=this.message)||void 0===e?void 0:e.attachments[0]:{},r=(null==o?void 0:o.custom_value)||{},l=r.application_ids,c=void 0===l?[]:l,d=r.workflow_ids,h=void 0===d?[]:d;return c=(c||[]).map((function(t){return"".concat(location.origin)+n.localePath("/workFlowAppDetail/".concat(t))})),h=(h||[]).map((function(t){return"".concat(location.origin)+n.localePath("/workFlowDetail/".concat(t))})),[].concat(Object(v.a)(c),Object(v.a)(h))},formatDate:function(t){var e,n;(null===(n=t=null===(e=t)||void 0===e?void 0:e.toString())||void 0===n?void 0:n.length)>13&&(t=t.slice(0,13));var o=new Date(Number(t)),r=o.getFullYear(),l=String(o.getMonth()+1).padStart(2,"0"),c=String(o.getDate()).padStart(2,"0"),d=o.getHours().toString().padStart(2,"0"),h=o.getMinutes().toString().padStart(2,"0"),m=o.getSeconds().toString().padStart(2,"0");return Object(_.u)(o,new Date)?"".concat(d,":").concat(h,":").concat(m):"".concat(r,"/").concat(l,"/").concat(c," ").concat(d,":").concat(h,":").concat(m)},imgError:function(t){this.errorTimes+=1,this.errorTimes>3||(console.log("imgError",t),this.$refs.msgImg.src=t)},toUser:function(){var t=this.author.id,e=this.$router.resolve({path:"/user/"+t});window.open(e.href,"_blank")}}},O=(n(2727),Object(h.a)(x,(function(){var t,e,n,o,r,l,c,d,h,m,v,f=this,_=f._self._c;return f.message.id?_("div",{staticClass:"notice-item",on:{click:f.handleClickMsg}},[[5,6,8,10,11,12,13,14,15,17,18,19].includes(f.eventType)?[[8,10,11,12,13,14,15,17,18,19].includes(f.eventType)?_("div",{staticClass:"item-content"},[_("div",{staticClass:"sys-content-title"},[null!==(d=f.msgTitleImg)&&void 0!==d&&d.title||!f.message.components?_("span",{staticClass:"sys-content-title-text"},[f._v("\n          "+f._s((null===(h=f.msgTitleImg)||void 0===h?void 0:h.title)||f.$t("noticeSystem"))+"\n        ")]):f._e(),f._v(" "),f.msgTime?_("span",{staticClass:"sys-content-title-time"},[f._v(f._s(f.msgTime))]):f._e(),f._v(" "),_("span",{staticClass:"read-status",class:{hide:f.isRead}})]),f._v(" "),_("div",{staticClass:"main-content text-wrap-2"},[f._v(f._s(f.message.content))])]):[5,6].includes(f.eventType)?_("div",{staticClass:"item-content"},[_("div",{staticClass:"sys-content-title"},[_("span",{staticClass:"sys-content-title-text"},[f._v(f._s(5===f.eventType?f.$t("sysReviewSuccess"):f.$t("sysReviewFail")))]),f._v(" "),f.msgTime?_("span",{staticClass:"sys-content-title-time"},[f._v(f._s(f.msgTime))]):f._e(),f._v(" "),_("span",{staticClass:"read-status",class:{hide:f.isRead}})]),f._v(" "),_("div",{staticClass:"main-content"},[f._v(f._s(5===f.eventType?f.$t("sysReviewTextSuccess",{type:f.$t((null===(m=f.msgSource)||void 0===m?void 0:m.lang)||"Work")}):f.$t("sysReviewTextFail",{type:f.$t((null===(v=f.msgSource)||void 0===v?void 0:v.lang)||"Work")})))])]):f._e()]:[null!==(t=f.msgMain)&&void 0!==t&&t.desc?_("div",{staticClass:"item-content flex items-center"},[_("span",{staticClass:"item-content-main"},[_("msgHead",{attrs:{author:f.author},on:{toUser:f.toUser},scopedSlots:f._u([null!==(e=f.msgMain)&&void 0!==e&&e.desc?{key:"desc",fn:function(){var t;return[null!==(t=f.author)&&void 0!==t&&t.name?_("span",{staticClass:"name",on:{click:function(t){return t.stopPropagation(),f.toUser.apply(null,arguments)}}},[f._v(f._s(f.author.name))]):f._e(),f._v(" "),_("span",{staticClass:"desc"},[f._v(f._s(f.msgMain.desc))])]},proxy:!0}:null,null!==(n=f.msgMain)&&void 0!==n&&n.showTitle&&null!==(o=f.msgMain)&&void 0!==o&&o.title?{key:"detail",fn:function(){var t;return[f._v(" "+f._s(null===(t=f.msgMain)||void 0===t?void 0:t.title)+" ")]},proxy:!0}:null!==(r=f.msgMain)&&void 0!==r&&r.content?{key:"detail",fn:function(){var t;return[f._v(" "+f._s(null===(t=f.msgMain)||void 0===t?void 0:t.content)+" ")]},proxy:!0}:null],null,!0)}),f._v(" "),f.msgTime?_("span",{staticClass:"msg-time"},[f._v(f._s(f.msgTime))]):f._e()],1),f._v(" "),null!==(l=f.msgMain)&&void 0!==l&&l.showImg&&null!==(c=f.msgTitleImg)&&void 0!==c&&c.url?_("div",{staticClass:"item-content-img"},[_("img",{ref:"msgImg",attrs:{src:f.replaceImageType(f.msgTitleImg.url,"low"),alt:"msg-img"},on:{error:function(t){return f.imgError(f.msgTitleImg.url)}}})]):f._e(),f._v(" "),_("div",{staticClass:"other-read-status",class:{hide:f.isRead}})]):f._e()]],2):f._e()}),[],!1,null,"68c2875e",null)),$=O.exports,D=(n(23),n(37),n(728),n(39)),S={name:"SystemMsg",props:{sysMsg:{type:Object,default:function(){}},showSys:{type:Boolean,default:!1}},computed:{},data:function(){return{}},methods:{formatTime:function(t){return t.length>13?Object(D.e)(t.slice(0,13)):Object(D.e)(t)},formatContent:function(content){return content?content=content.replaceAll("\n","<br/>"):""}}},I=(n(2728),Object(h.a)(S,(function(){var t,e,n,o=this,r=o._self._c;return null!==(t=o.sysMsg)&&void 0!==t&&t.title&&o.showSys?r("div",{staticClass:"system-msg"},[r("div",{staticClass:"notice__title"},[o._v(o._s(o.sysMsg.title))]),o._v(" "),r("div",{staticClass:"notice__time"},[o._v(o._s(o.formatTime(o.sysMsg.time)))]),o._v(" "),r("div",{staticClass:"notice__content",domProps:{innerHTML:o._s(o.formatContent(o.sysMsg.content))}}),o._v(" "),null!==(e=o.sysMsg)&&void 0!==e&&null!==(e=e.linkList)&&void 0!==e&&e.length?r("div",{staticClass:"notice_comfy-ui-app"},o._l(null===(n=o.sysMsg)||void 0===n?void 0:n.linkList,(function(t){return r("a",{staticClass:"notice_comfy-ui-app-link",attrs:{href:t,target:"_blank"}},[o._v(o._s(t))])})),0):o._e()]):o._e()}),[],!1,null,"5e641c2e",null).exports),T=n(230);function j(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function L(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?j(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var P={name:"notice",props:{},components:{NoticeTab:m,NoticeItem:$,SystemMsg:I},computed:L(L({},Object(r.c)("chatgpt",["unreadMsgAll"])),{},{channelId:function(){return["int#sys","int#com","int#like&col","int#fol"][this.activeTab]},unReadList:function(){var t=this,e=["sys","com","likeCol","fol"].map((function(e){return t.unreadMsgAll[e]}));return console.log("unread",e),e},showMsg:function(){return function(t){var e,n;null!=t&&t.components&&null!=t&&null!==(e=t.components[0])&&void 0!==e&&e.type&&[9,"9"].includes(null==t||null===(n=t.components[0])||void 0===n?void 0:n.type);return!0}}}),data:function(){return{loading:!1,activeTab:0,messageList:[],sysMsg:{},showSys:!1,paramKeyMap:{}}},mounted:function(){this.initTab(),this.getAllUnread()},methods:L(L({},Object(r.b)("chatgpt",["getUnreadMsgNum","getMainMessage","setReadMsg"])),{},{initTab:function(){var t,e=null===(t=this.$route)||void 0===t||null===(t=t.query)||void 0===t?void 0:t.name;["0","1","2","3"].includes(e)&&(this.activeTab=Number(e)),this.getMessage(this.activeTab),this.$logEvent("log_actions",{operation:"notify_show",behavior_info:"detail_page"})},getAllUnread:function(){this.getUnreadMsgNum().then((function(t){var e;1e4===(null==t||null===(e=t.status)||void 0===e?void 0:e.code)&&console.log("unread all：",null==t?void 0:t.data)}))},getMessage:function(){var t=this,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={channel_id:this.channelId,page_size:20};if(e&&this.hasMore){var o=this.messageList[this.messageList.length-1],r=o?o.timestamp:"";r&&(n.time_from=r)}this.loading=!0,this.getMainMessage(n).then((function(n){var o;if(1e4===(null==n||null===(o=n.status)||void 0===o?void 0:o.code)){var r,l;t.hasMore=null==n||null===(r=n.data)||void 0===r?void 0:r.has_more;var c=(null==n||null===(l=n.data)||void 0===l?void 0:l.items)||[];t.messageList=e?t.messageList.concat(c):c,console.log("消息列表",t.messageList)}})).finally((function(){t.loading=!1}))},changeTab:function(t){console.log("changeTab",t);t[0];this.activeTab=t[1]||0,this.getMessage(this.activeTab)},handleScroll:function(){var t=this.$refs.noticeWindowContainer,e=this.$refs.noticeList;t.scrollTop+t.clientHeight>=e.clientHeight-50&&!this.loading&&this.moreMessage()},moreMessage:function(){console.log("scroll to more msg"),this.hasMore&&(console.log("get more msg"),this.getMessage(this.activeTab,!0))},readMsg:function(t){var e=this,n=[t.id],o={channel_id:this.channelId,ids:n};Object(T.e)(o).then((function(t){var n;if(1e4===(null==t||null===(n=t.status)||void 0===n?void 0:n.code)){console.log("set as read success");var p={type:["sys","com","likeCol","fol"][e.activeTab],num:1};e.setReadMsg(p)}})),t.is_read=!0},clickMsg:function(){console.log("点击消息")},showSysUpdate:function(t){this.sysMsg=t,this.showSys=!0},backTo:function(){this.showSys?this.showSys=!1:window.history.length>1&&"/"!=this.fromPath?this.$router.back():this.$router.push(this.localePath("/"))}})},M=P,E=(n(2729),Object(h.a)(M,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"notice"},[e("div",{staticClass:"backIcon",on:{click:function(e){return e.stopPropagation(),t.backTo.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-back"})]),t._v(" "),e("div",{staticClass:"notice-content flex"},[[e("NoticeTab",{directives:[{name:"show",rawName:"v-show",value:!t.showSys,expression:"!showSys"}],attrs:{activeTab:t.activeTab,unRead:t.unReadList},on:{changeTab:function(e){return t.changeTab(arguments)}}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.showSys,expression:"!showSys"},{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"notice-window flex items-center justify-center"},[t.messageList.length>0?e("div",{ref:"noticeWindowContainer",staticClass:"notice-window-container w-full",on:{scroll:t.handleScroll}},[e("div",{ref:"noticeList",staticClass:"items flex flex-col"},t._l(t.messageList,(function(n,i){return e("div",{key:"notice-item".concat(i),staticClass:"notice-window-item w-full"},[n.id&&t.showMsg(n)?[e("NoticeItem",{attrs:{message:n},on:{setRead:function(e){return t.readMsg(e)},clickMsg:function(e){return t.clickMsg(e)},showSysUpdate:function(e){return t.showSysUpdate(e)}}})]:t._e()],2)})),0)]):t.loading?t._e():e("div",{staticClass:"no-messages flex flex-col items-center"},[e("div",{staticClass:"no-messages-icon"},[e("img",{attrs:{src:n(635),alt:""}})]),t._v(" "),e("div",{staticClass:"no-messages-text"},[t._v(t._s(t.$t("noMessages")))])])])],t._v(" "),[e("SystemMsg",{attrs:{showSys:t.showSys,sysMsg:t.sysMsg}})]],2)])}),[],!1,null,"66aa185a",null));e.default=E.exports},3260:function(t,e,n){"use strict";n.r(e);var o=n(31),r=n(2),l=n(3),c=(n(9),n(16),n(89),n(7),n(11),n(12),n(8),n(4),n(49),n(76),n(6),n(20),n(211)),d=n(189),h=n(39),m={props:{item:{type:Object,default:function(){return{}}},type:{type:String,default:"WAIT"},changePrice:{type:Function,default:function(){return function(){}}}},filters:{timestampToTime:function(t){return Object(h.h)(t,"yyyy/MM/dd")}},computed:{withdrawAccount:function(){var t;return(null===(t=this.item)||void 0===t?void 0:t.withdraw_account)||{account_type:3,third_account:" - "}}}},v=(n(2872),n(0)),f=Object(v.a)(m,(function(){var t,e,n,o,r=this,l=r._self._c;return l("div",{staticClass:"table-rows"},["WAIT"===r.type?[l("div",{staticClass:"cols"},[l("p",[r._v(r._s(r.$t("IncomeTableKey"))+": "+r._s(r.item.date))]),r._v(" "),l("span",[r._v(r._s(r.$t("OrderNo"))+": "+r._s(r.item.order_no))])]),r._v(" "),l("div",{staticClass:"cols"},[l("p",[r._v(r._s(r._f("timestampToTime")(r.item.update_at)))])]),r._v(" "),l("div",{staticClass:"cols"},[l("p",[r._v(r._s(r.changePrice(r.item.earnings)))])])]:[l("div",{staticClass:"cols"},[l("p",[r._v(r._s(r.$t("HISTORYIncomeTableHead1"))+": "+r._s(r.item.order_no))])]),r._v(" "),l("div",{staticClass:"cols"},[1===(null===(t=r.item)||void 0===t?void 0:t.status)?[l("p",[r._v(r._s(r._f("timestampToTime")(r.item.update_at)))]),r._v(" "),l("span",[r._v(r._s(r.$t("IncomeTableKey"+r.withdrawAccount.account_type))+r._s(r.withdrawAccount.third_account))])]:l("p",[r._v("-")])],2),r._v(" "),l("div",{staticClass:"cols status-cols"},[l("p",[r._v(r._s(r.changePrice(null===(e=r.item)||void 0===e?void 0:e.current_amount)))]),r._v(" "),l("span",{staticClass:"income-status",class:"status"+(null===(n=r.item)||void 0===n?void 0:n.status)},[r._v(r._s(r.$t("IncomeStatus"+(null===(o=r.item)||void 0===o?void 0:o.status))))])])]],2)}),[],!1,null,"6d25b02c",null).exports,_=n(169),y={props:["changePrice","total"],components:{IncomeTableRows:f,STooltip:d.a},data:function(){return{activeTab:"WAIT",tableData:{WAIT:[],HISTORY:[]},updateTab:["WAIT","HISTORY"]}},computed:{totalNum:function(){return"HISTORY"===this.activeTab?this.total:this.getWithdrawTotal(this.tableData.WAIT)},isShowTips:function(){return this.$isChinaSite&&"HISTORY"===this.activeTab},fqaUrl:function(){return"ja"!==this.$i18n.locale?"https://docs.seaart.ai/guide-1/6-permanent-events/creator-incentive-program-faq":"https://docs.seaart.ai/guide-1/ri-ben-yu/6-naibento/kuritpuroguramufaq"}},mounted:function(){this.initList()},methods:{initList:function(){this.tableData={WAIT:[],HISTORY:[]},this.getList()},changeTab:function(t){this.activeTab=t,this.getList()},getList:function(){var t=this,e="WAIT"===this.activeTab?_.g:_.f;this.tableData[this.activeTab].length||e().then((function(e){t.tableData[t.activeTab]=(null==e?void 0:e.data)||[]}))},getWithdrawTotal:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tableData.WAIT;return e.length?e.reduce((function(e,n){return e+=n.earnings,console.log(e),t.roundToDecimalPlace(e,2)}),0):0},roundToDecimalPlace:function(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}}},w=y,C=(n(2873),Object(v.a)(w,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"income-table"},[e("div",{staticClass:"table-left"},[e("div",{staticClass:"tab"},[e("div",{staticClass:"tab-item",class:{active:"WAIT"===t.activeTab},on:{click:function(e){return t.changeTab("WAIT")}}},[e("i",{staticClass:"iconfont icon-a-tixianjilu11"}),t._v("\n        "+t._s(t.$t("IncomeTab1"))+"\n      ")]),t._v(" "),e("div",{staticClass:"tab-item",class:{active:"HISTORY"===t.activeTab},on:{click:function(e){return t.changeTab("HISTORY")}}},[e("i",{staticClass:"iconfont icon-a-tixianjiluicon1"}),t._v("\n        "+t._s(t.$t("IncomeTab2"))+"\n      ")])]),t._v(" "),e("a",{staticClass:"fqa",attrs:{href:t.fqaUrl,target:"_blank"}},[e("i",{staticClass:"el-icon-warning-outline"}),t._v("\n      "+t._s(t.$t("FrequentlyAskedQuestions"))+"\n    ")])]),t._v(" "),e("div",{staticClass:"table-content"},[e("div",{staticClass:"table-rows table-head"},[e("div",{staticClass:"cols"},[t._v(t._s(t.$t(t.activeTab+"IncomeTableHead1")))]),t._v(" "),e("div",{staticClass:"cols"},[t._v(t._s(t.$t(t.activeTab+"IncomeTableHead2")))]),t._v(" "),e("div",{staticClass:"cols"},[t._v(t._s(t.$t(t.activeTab+"IncomeTableHead3"))+" "+t._s(t.$t(t.$isChinaSite?"IncomeTableHeadTips":""))+"\n      ")])]),t._v(" "),t.tableData[t.activeTab].length?e("div",{staticClass:"table-body"},t._l(t.tableData[t.activeTab],(function(n){return e("income-table-rows",{key:n.id,attrs:{type:t.activeTab,item:n,changePrice:t.changePrice}})})),1):e("div",{staticClass:"empty-panel"},[e("img",{attrs:{src:n(625),alt:""}}),t._v(" "),e("p",[t._v(t._s(t.$t("IncomeEmpty")))])]),t._v(" "),e("div",{staticClass:"table-bottom"},[e("span",{staticClass:"tips"},[t._v(t._s(t.$t(t.activeTab+"IncomeTableTips")))]),t._v(" "),e("div",{staticClass:"total-info"},[e("s-tooltip",{directives:[{name:"show",rawName:"v-show",value:t.isShowTips,expression:"isShowTips"}],attrs:{info:t.$t("IncomeTotalTips"),icon:"iconfont el-icon-warning-outline"}}),t._v("\n        "+t._s(t.$t(t.activeTab+"IncomeTableTotal"))+": "+t._s(t.changePrice(t.totalNum))+"\n      ")],1)])])])}),[],!1,null,"5262b81a",null).exports),k=(n(19),n(29),n(21)),x=n(5);function O(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function $(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?O(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var D={data:function(){return{isShow:!1,isEdit:!1,loading:!1,countdown:0,isIncomplete:!0,formData:{p0:"",p1:"",p2:"",p3:"",p4:"",p5:"",p6:"",p7:"",p8:"",p9:"",verify_code:""},captchaToken:""}},computed:{formLeng:function(){return this.$isChinaSite?4:10},paramsLangKey:function(){var t=this;return(this.$isChinaSite?["RealName","IdCard","phone","BindAccountKey5"]:["BindAccountKey0","BindAccountKey1","BindAccountKey6","BindAccountKey7","BindAccountKey2","BindAccountKey8","BindAccountKey9","BindAccountKey10","BindAccountKey3","BindAccountKey4"]).map((function(e){return t.$t(e)}))},rules:function(){for(var t=this.formLeng,e=this.$isChinaSite?3:0,n={verify_code:[{required:!0,message:this.$t("VerifiCodeError")}]},i=0;i<t;i++){var o=i==e,r=[{required:!0,message:this.getValidMsg(i)}];o&&r.push({validator:this.validateBind(i),trigger:"blur"}),n["p"+i]=r}return n},paramsKey:function(){return this.$isChinaSite?["name","id_num","phone","third_account"]:["third_account","bank_account_name","bank_name","bank_address","swift_code","country","zip_code","city","address","email"]},params:function(){var t=this,e=this.paramsKey,n={};return Object.keys(this.formData).forEach((function(o,i){"verify_code"!==o?e[i]&&(n[e[i]]=t.formData[o]):n.verify_code=t.formData[o]})),n}},methods:{getValidMsg:function(i){return this.paramsLangKey[i]+this.$t("BindAccountWarn1")},validateBind:function(i){var t=this;return function(){var e=Object(l.a)(regeneratorRuntime.mark((function e(n,o,r){var l,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=8;break}return e.next=3,Object(_.j)({third_account:o});case 3:l=e.sent,data=l.data,r(data.has?new Error(t.$t("BindAccountWarn0")):""),e.next=9;break;case 8:r(new Error(t.$t("gptRulesSpace")));case 9:case"end":return e.stop()}}),e)})));return function(t,n,o){return e.apply(this,arguments)}}()},show:function(t,e){this.isShow=!0,this.isEdit=!!t,this.isIncomplete=(null==t?void 0:t.third_account)&&!(null!=t&&t.bank_name)&&!this.$isChinaSite||!(null!=t&&t.country),this.isIncomplete&&e&&this.$message.warning(this.$t("BindAccountError10")),t&&this.initParams(t)},close:function(){this.isShow=!1,this.$refs.bindForm.resetFields()},initParams:function(t){var e=this;Object.keys(this.formData).forEach((function(n,i){e.formData["p"+i]=t[e.paramsKey[i]]}))},sendCode:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.countdown,e.t0){e.next=5;break}return e.next=4,t.validParams();case 4:e.t0=e.sent;case 5:if(!e.t0){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,t.updateCaptcha();case 9:n=t.$isChinaSite?k.fb:_.i,o=t.params,r=o.third_account,l=o.email,c=t.$isChinaSite?{phone_number:"86-"+r,g_recaptcha_token:t.captchaToken}:{email:l},n(c).then((function(e){t.sendCodeDown(),t.$message.success(t.$t("VerifiCodeSend"))}));case 13:case"end":return e.stop()}}),e)})))()},updateCaptcha:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=window)||void 0===n||!n.grecaptcha||null===(o=window)||void 0===o||null===(o=o.grecaptcha)||void 0===o||!o.enterprise){e.next=5;break}return e.next=3,t.getToken();case 3:e.next=16;break;case 5:return e.prev=5,e.next=8,t.loadCaptcha();case 8:return e.next=10,t.getToken();case 10:console.log("captchaToken",t.captchaToken),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),console.log("Google Captcha failed to load or execute",e.t0);case 16:case"end":return e.stop()}}),e,null,[[5,13]])})))()},loadCaptcha:function(){return Object(l.a)(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(e=window)||void 0===e||!e.grecaptcha||null===(n=window)||void 0===n||null===(n=n.grecaptcha)||void 0===n||!n.enterprise){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,Object(x.w)("https://www.recaptcha.net/recaptcha/enterprise.js?render=".concat("6LfuV2wqAAAAAJ83QW1gae0CmT7GrgzzecQbFpJ5"));case 5:return t.next=7,new Promise((function(t,e){var n,o;null!==(n=window)&&void 0!==n&&n.grecaptcha&&null!==(o=window)&&void 0!==o&&null!==(o=o.grecaptcha)&&void 0!==o&&o.enterprise?grecaptcha.enterprise.ready(t):e(new Error("grecaptcha.enterprise not available"))}));case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),console.log("Google Captcha failed to load or execute",t.t0);case 12:case"end":return t.stop()}}),t,null,[[2,9]])})))()},getToken:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(n=window)&&void 0!==n&&null!==(n=n.grecaptcha)&&void 0!==n&&n.enterprise){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,grecaptcha.enterprise.execute("6LfuV2wqAAAAAJ83QW1gae0CmT7GrgzzecQbFpJ5",{action:"LOGIN"});case 5:t.captchaToken=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error("Error executing recaptcha:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})))()},validParams:function(){var t=this;return new Promise((function(e,n){var o=t.$isChinaSite?3:4;t.$refs.bindForm.validateField("p"+o,(function(t){console.log("valid: ",t),e(!!t)}))}))},sendCodeDown:function(){var t=this;this.countdown=60;var e=setInterval((function(){t.countdown--,t.countdown<=0&&(clearInterval(e),e=null)}),1e3)},bindAccount:function(){var t=this;this.$refs.bindForm.validate((function(e){e&&t.submitBindInfo()}))},submitBindInfo:function(){var t=this,e=$($({},this.params),{},{account_type:this.$isChinaSite?1:3});console.log("params---",e),this.loading=!0,(this.isEdit?_.c:_.b)(e).then((function(n){t.$message.success(t.$t("BindSuccess")),t.$emit("change",$($({},e),{},{isEdit:!t.isIncomplete&&t.isEdit})),t.close()})).finally((function(){t.loading=!1}))},openServices:function(){SUHelpSupport.show()}}},S=D,I=(n(2874),Object(v.a)(S,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"custom-dialog big-head-dialog bind-account",attrs:{visible:t.isShow,"before-close":t.close,"z-index":"1000"},on:{"update:visible":function(e){t.isShow=e}}},[e("div",{staticClass:"dialog-body"},[e("i",{staticClass:"el-icon-close close-btn",on:{click:t.close}}),t._v(" "),e("h1",{staticClass:"title"},[t._v(t._s(t.$t("BindAccount")))]),t._v(" "),e("p",{staticClass:"tips"},[t._v(t._s(t.$t("BindAccountTips"+(t.$isChinaSite?"1":"2"))))]),t._v(" "),e("el-form",{ref:"bindForm",staticClass:"custom-form",attrs:{model:t.formData,rules:t.rules}},[t._l(t.formLeng,(function(n,i){return e("el-form-item",{key:"formLeng_"+i,attrs:{prop:"p"+i}},[e("el-input",{attrs:{placeholder:t.paramsLangKey[i],maxlength:"100"},model:{value:t.formData["p"+i],callback:function(e){t.$set(t.formData,"p"+i,e)},expression:"formData['p' + i]"}})],1)})),t._v(" "),e("el-form-item",{attrs:{prop:"verify_code"}},[e("el-input",{attrs:{placeholder:t.$t("VerifiCodePls"),maxlength:"10"},model:{value:t.formData.verify_code,callback:function(e){t.$set(t.formData,"verify_code",e)},expression:"formData.verify_code"}},[e("span",{staticClass:"send-btn",attrs:{slot:"append"},on:{click:function(e){return e.stopPropagation(),t.sendCode.apply(null,arguments)}},slot:"append"},[t._v("\n            "+t._s(t.countdown?t.countdown+"s":t.$t("VerifiCodeGet"))+"\n          ")])])],1)],2),t._v(" "),e("el-button",{staticClass:"bind-btn",attrs:{type:"primary",loading:t.loading},on:{click:t.bindAccount}},[t._v("\n      "+t._s(t.$t("BindAccountSubmitBtn"))+"\n    ")]),t._v(" "),e("p",{staticClass:"bind-tips"},[t._v(t._s(t.$t("BindAccountTips3"))),e("span",{on:{click:t.openServices}},[t._v(t._s(t.$t("BindAccountTips4")))])])],1)])}),[],!1,null,"a9c815b0",null)),T=I.exports,j=(n(23),n(37),{props:{bindInfo:{type:Object,default:function(){return{third_account:"-"}}},changePrice:{type:Function,default:function(){return function(){}}}},data:function(){return{isShow:!1,withdrawTotal:"0.00",loading:!1}},computed:{incomeTips:function(){var t=this.$t("IncomePopupTips3"),e=this.$isChinaSite?"https://image.cdn2.seaart.ai/private/creator_bonus_cn.html":"https://image.cdn2.seaart.ai/private/creator_bonus.html";return t.replace("{ATTR}",'href="'.concat(e,'" target="_blank"'))}},methods:{show:function(t){this.withdrawTotal=t,this.isShow=!0},close:function(){this.isShow=!1},withdrawing:function(){var t=this;if(this.withdrawTotal<100){var e=this.$t("ApplyWithdrawWarning",{price:this.changePrice(100,!0)});this.$message.warning(e)}else this.loading=!0,Object(_.a)().then((function(e){t.$message.success(t.$t("ApplyWithdrawSuccess")),t.$emit("change")})).finally((function(){t.loading=!1}))}}}),L=(n(2875),Object(v.a)(j,(function(){var t,e=this,o=e._self._c;return o("el-dialog",{staticClass:"custom-dialog big-head-dialog income-popup",attrs:{visible:e.isShow,"before-close":e.close},on:{"update:visible":function(t){e.isShow=t}}},[o("div",{staticClass:"dialog-body"},[o("i",{staticClass:"el-icon-close close-btn",on:{click:e.close}}),e._v(" "),o("img",{staticClass:"popup-icon",attrs:{src:n(626),alt:""}}),e._v(" "),o("p",{staticClass:"title"},[e._v(e._s(e.$t("IncomePopupTitle")))]),e._v(" "),o("p",{staticClass:"price"},[e._v(e._s(e.changePrice(e.withdrawTotal,!0)))]),e._v(" "),o("p",{staticClass:"tips"},[e._v(e._s(e.$t("IncomePopupTips",{price:e.changePrice(100,!0)})))]),e._v(" "),o("div",{staticClass:"income-info"},[o("p",{staticClass:"income-type"},[o("i",{directives:[{name:"show",rawName:"v-show",value:e.$isChinaSite,expression:"$isChinaSite"}],staticClass:"iconfont icon-zhifubao"}),e._v("\n        "+e._s(e.$t("IncomePopupTips"+(e.$isChinaSite?"1":"2")))+"\n      ")]),e._v(" "),o("p",{staticClass:"income-number"},[e._v(e._s(null===(t=e.bindInfo)||void 0===t?void 0:t.third_account))])]),e._v(" "),o("el-button",{staticClass:"income-btn",attrs:{type:"primary",loading:e.loading},on:{click:e.withdrawing}},[e._v("\n      "+e._s(e.$t("IncomePopupBtn"))+"\n    ")]),e._v(" "),o("p",{staticClass:"income-tips",domProps:{innerHTML:e._s(e.incomeTips)}})],1)])}),[],!1,null,"4217aa8c",null).exports);function P(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function M(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?P(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var E={components:{BackIcon:c.a,IncomeTable:C,BindAccount:T,IncomePopup:L},data:function(){return{cardList:[{key:"prev.total_score",icon:"icon-zongjifen",color:"225,80,137"},{key:"now.total_score",icon:"icon-a-zongjifen11",color:"223,154,77"},{key:"now.character",icon:"icon-duihua",color:"104,173,128",isHide:this.$isChinaSite},{key:"now.model",icon:"icon-a-moxingpeizhi-moxing1",color:"77,154,171"},{key:"now.lora_train",icon:"icon-a-fengge1",color:"66,86,174"},{key:"now.palette",icon:"icon-a-huaban11",color:"70,55,169"},{key:"now.comfy_ui",icon:"icon-icon_jiedian",color:"196, 103, 211"}],bindAccountInfo:null,pointsInfo:null,loading:!0}},mounted:function(){this.loading=!0,this.init()},methods:{init:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getBindInfo();case 2:return t.loading=!1,e.next=5,t.getPoints();case 5:case"end":return e.stop()}}),e)})))()},getBindInfo:function(){var t=this;return Object(_.d)().then((function(e){t.bindAccountInfo=e.data}))},getPoints:function(){var t=this;return Object(_.e)().then((function(e){t.pointsInfo=e.data}))},showBindPopup:function(){this.$refs.bindAccountPopup.show(this.bindAccountInfo)},editAccount:function(){var t=this;this.bindAccountInfo.edit_month!==this.getNowDate()?this.$confirm(this.$t("BindAccountTips"),this.$t("BindAccountPopupTitle"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),customClass:"custom-confirm"}).then((function(){t.showBindPopup()})):this.$message.warning(this.$t("BindPaymentWarning"))},showIncomePopup:function(){var t=this.bindAccountInfo,e=t.bank_name,n=t.country;if(this.$isChinaSite||n&&e){var o=this.$refs.incomeTable.getWithdrawTotal();this.$refs.incomePopup.show(o)}else this.$refs.bindAccountPopup.show(this.bindAccountInfo,!0)},getNowDate:function(){var t=new Date,e=t.getFullYear(),n=(t.getMonth()+1).toString().padStart(2,"0");return"".concat(e).concat(n)},changeBindInfo:function(t){this.bindAccountInfo=M(M({},t),{},{edit_month:t.isEdit?this.getNowDate():""})},getPointNum:function(t){var e=t.split("."),n=Object(o.a)(e,2),r=n[0],l=n[1];return this.pointsInfo?this.pointsInfo[r][l]:0},changePrice:function(t,e){var n=null!=this&&this.$isChinaSite?"¥":"$";return n+=e?"":" ",t?null!=this&&this.$isChinaSite?n+(7*t).toFixed(2):n+t:n+"0.00"},updateList:function(){this.$refs.incomeTable.initList()}}},A=(n(2876),Object(v.a)(E,(function(){var t,e,o=this,r=o._self._c;return r("div",{staticClass:"creation-center"},[r("back-icon"),o._v(" "),r("div",{staticClass:"head"},[r("div",{staticClass:"earnings-info"},[r("img",{attrs:{src:n(618),alt:""}}),o._v(" "),r("span",[o._v(o._s(o.$t("CumulativeIncome"))+": "),r("b",[o._v(o._s(o.changePrice(null===(t=o.pointsInfo)||void 0===t?void 0:t.earnings)))])])]),o._v(" "),r("div",{staticClass:"handle-btn"},[r("el-button",{directives:[{name:"show",rawName:"v-show",value:o.bindAccountInfo,expression:"bindAccountInfo"}],staticClass:"edit-btn",attrs:{type:"primary",loading:o.loading},on:{click:o.editAccount}},[o._v("\n        "+o._s(o.$t("EditPaymentNumber"))+"\n      ")]),o._v(" "),r("el-button",{directives:[{name:"show",rawName:"v-show",value:o.bindAccountInfo,expression:"bindAccountInfo"}],staticClass:"withdraw-btn rounded-border",attrs:{type:"primary",loading:o.loading},on:{click:o.showIncomePopup}},[o._v("\n        "+o._s(o.$t("Withdraw"))+"\n      ")]),o._v(" "),r("el-button",{directives:[{name:"show",rawName:"v-show",value:!o.bindAccountInfo,expression:"!bindAccountInfo"}],staticClass:"bind-btn",attrs:{type:"primary",loading:o.loading},on:{click:o.showBindPopup}},[o._v("\n        "+o._s(o.$t("BindPaymentNumber"))+"\n      ")])],1)]),o._v(" "),r("div",{staticClass:"card-list"},o._l(o.cardList,(function(t,i){return r("div",{directives:[{name:"show",rawName:"v-show",value:!t.isHide,expression:"!card.isHide"}],key:"card_"+i,staticClass:"card-item",style:{backgroundColor:"rgba(".concat(t.color,",0.1)"),borderBottom:"1px solid rgba(".concat(t.color,")")}},[r("p",{staticClass:"card-num"},[o._v(o._s(o.getPointNum(t.key)))]),o._v(" "),r("span",{staticClass:"card-title"},[o._v(o._s(o.$t("CreationCenterCard"+i)))]),o._v(" "),r("span",{staticClass:"card-icon",style:{backgroundColor:"rgba(".concat(t.color,")")}},[r("i",{staticClass:"iconfont",class:t.icon})])])})),0),o._v(" "),r("income-table",{ref:"incomeTable",attrs:{changePrice:o.changePrice,total:null===(e=o.pointsInfo)||void 0===e?void 0:e.earnings_take}}),o._v(" "),r("bind-account",{ref:"bindAccountPopup",on:{change:o.changeBindInfo}}),o._v(" "),r("income-popup",{ref:"incomePopup",attrs:{changePrice:o.changePrice,bindInfo:o.bindAccountInfo},on:{change:o.updateList}})],1)}),[],!1,null,"726350ec",null));e.default=A.exports},3262:function(t,e,n){"use strict";n.r(e);n(14),n(318),n(71),n(9),n(7),n(11),n(12),n(8);var o=n(2),r=(n(32),n(10),n(4),n(6),n(132)),l=(n(16),n(70),n(3)),c=(n(20),n(75),n(43),n(18),n(50),n(48),n(29),n(142),n(143),n(112),n(38)),d=n(45),h=(n(28),{props:{url:{type:String,default:""},prompt:{type:String,default:""},width:{type:Number,default:155},height:{type:Number,default:155}},data:function(){return{src:"",imgW:0,imgH:0}},watch:{url:{handler:function(t){t&&this.loadImg()}}},created:function(){this.loadImg()},methods:{imgDelete:function(){this.$emit("imgDelete")},loadImg:function(){var t=this,img=new Image;img.src=this.url,img.onload=function(){img.width&&(t.imgW=img.width),img.height&&(t.imgH=img.height),t.src=t.url}}}}),m=(n(2464),n(2465),n(0)),v=Object(m.a)(h,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:!t.src,expression:"!src"}],staticClass:"imgItem",style:{width:t.width+"px",height:t.height+"px"},on:{click:function(e){return t.$emit("click")}}},[t.imgW&&t.imgH?e("div",{staticClass:"imgSize"},[t._v(t._s("".concat(t.imgW,"*").concat(t.imgH)))]):t._e(),t._v(" "),t.src?e("img",{attrs:{src:t.src,alt:""}}):t._e(),t._v(" "),t.prompt?e("el-popover",{attrs:{placement:"top-start",trigger:"hover","popper-class":"popoverPrompt","visible-arrow":!1}},[e("div",{staticClass:"promptTxt"},[t._v(t._s(t.prompt))]),t._v(" "),e("div",{staticClass:"prompt",attrs:{slot:"reference"},slot:"reference"},[e("i",{staticClass:"iconfont icon-Union"})])]):t._e(),t._v(" "),e("div",{staticClass:"deleteBox"},[e("i",{staticClass:"iconfont icon-shanchu1",on:{click:t.imgDelete}})])],1)}),[],!1,null,"805a23a8",null).exports,f=n(22),_=n(522),y=(n(277),n(1));function w(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function C(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?w(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var k={props:{value:{type:Array,default:function(){return[]}},isShowActivityBanner:Boolean,type:{type:String,default:"default"},defConfig:{type:Object,default:function(){return[]}}},computed:C(C({},Object(y.c)("user",["isLoggedIn"])),{},{imgs:{get:function(){return this.value},set:function(t){this.$emit("input",t)}},isImgsComplete:function(){for(var t=0,i=0;i<this.imgs.length;i++){var e,n;((null===(e=this.imgs[i])||void 0===e?void 0:e.tags.length)>1||null!==(n=this.imgs[i])&&void 0!==n&&n.raw_url)&&t++}return t==this.imgs.length&&0!=this.imgs.length}}),components:{imgItem:v,imgDet:_.a},watch:{trigger:{handler:function(t){this.$emit("triggerChaneg",t)}},type:{handler:function(t){this.setConfig()}}},data:function(){return{isUploading:!1,setTagLoading:!1,inTimes:null,unmatchedImages:[],maxImgNum:200,loadingProgress:0,trigger:"",uploadType:-1,handleImgFormData:{cutting_plan:2,marking_plan:3,process_height:512,process_width:512,deepbooru_threshold:.3,image_url:[]},cropSizeIndex:"512*512",cropType:[{value:1,label:this.$t("newTrainIntr14")},{value:2,label:this.$t("newTrainIntr15")},{value:3,label:this.$t("newTrainIntr16")}],cropSize:[{value:"512*512",label:"512*512"},{value:"512*768",label:"512*768"},{value:"768*512",label:"768*512"},{value:"1024*1024",label:"1024*1024"}],labeling:[{value:1,label:"BLIP"},{value:2,label:"Deepbooru"},{value:5,label:"wd 1.4 tagger"},{value:6,label:"LIava"},{value:3,label:this.$t("newTrainIntr17")},{value:4,label:this.$t("newTrainIntr18")}]}},created:function(){this.setConfig()},beforeDestroy:function(){clearTimeout(this.inTimes)},methods:{setConfig:function(){["sdxl_default","flux_default","sd35_default"].includes(this.type)?this.cropSize=[{value:"512*512",label:"512*512"},{value:"512*768",label:"512*768"},{value:"768*512",label:"768*512"},{value:"768*768",label:"768*768"},{value:"1024*1024",label:"1024*1024"}]:this.cropSize=[{value:"512*512",label:"512*512"},{value:"512*768",label:"512*768"},{value:"768*512",label:"768*512"}],this.handleImgFormData.cutting_plan=this.defConfig.crop_method,this.handleImgFormData.marking_plan=this.defConfig.crop_algorithm,this.handleImgFormData.process_height=this.defConfig.crop_height,this.handleImgFormData.process_width=this.defConfig.crop_width,this.handleImgFormData.deepbooru_threshold=this.defConfig.deepbooru_threshold,this.cropSizeIndex="".concat(this.defConfig.crop_width,"*").concat(this.defConfig.crop_height)},openDel:function(t){this.$refs.imgDet.show(t)},markChange:function(){4==this.handleImgFormData.marking_plan&&3==this.handleImgFormData.cutting_plan&&(this.handleImgFormData.cutting_plan=this.defConfig.crop_method),4==this.handleImgFormData.marking_plan&&(this.trigger="")},cuttingChange:function(){3==this.handleImgFormData.cutting_plan&&4==this.handleImgFormData.marking_plan&&(this.handleImgFormData.marking_plan=this.defConfig.crop_algorithm)},resFeature:function(){var t=this;this.$confirm(this.$t("reAddTagTip"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){t.onFeature()})).catch((function(){}))},onFeature:function(){var t,e=this;if(!this.setTagLoading){if(this.setTagLoading=!0,3==this.handleImgFormData.marking_plan){if(3==this.handleImgFormData.cutting_plan)return this.imgs.forEach((function(t,i){e.trigger&&(e.imgs[i].tags=[],e.imgs[i].tags.unshift(e.trigger))})),void(this.setTagLoading=!1);this.handleImgFormData.marking_plan=1}if(this.handleImgFormData.image_url=[],this.imgs.forEach((function(t){var n;e.isImgsComplete?e.handleImgFormData.image_url.push(t.raw_url||t.url):t.tags&&0!=(null===(n=t.tags)||void 0===n?void 0:n.length)&&t.raw_url||e.handleImgFormData.image_url.push(t.url)})),this.loadingProgress=0,(null===(t=this.handleImgFormData)||void 0===t||null===(t=t.image_url)||void 0===t?void 0:t.length)>0){var n=C({},this.handleImgFormData);2!=n.marking_plan&&5!==n.marking_plan&&delete n.deepbooru_threshold,Object(r.b)(n).then((function(t){1e4==t.status.code&&e.onBatchFetchTaskProcess(t.data.task_id)})).catch((function(t){e.setTagLoading=!1}))}}},isSameResource:function(t,e){return new URL(t).pathname===new URL(e).pathname},onBatchFetchTaskProcess:function(t){var e=this;Object(f.a)({task_ids:[t]}).then((function(n){var o,r,l,c,d,h;1e4==n.status.code&&(e.loadingProgress=null===(o=n.data)||void 0===o?void 0:o.items[0].process,null!==(r=n.data)&&void 0!==r&&r.items[0]&&3==(null===(l=n.data)||void 0===l||null===(l=l.items[0])||void 0===l?void 0:l.status)?(clearTimeout(e.inTimes),null===(h=n.data)||void 0===h||null===(h=h.items[0])||void 0===h||h.image_tags.forEach((function(t){e.imgs.forEach((function(n,i){e.isSameResource(n.raw_url||n.url,t.url)&&(e.imgs[i].raw_url||(e.imgs[i].raw_url=e.imgs[i].url),e.imgs[i].url=t.crop_url,e.imgs[i].tags=t.tags,e.trigger&&-1==e.imgs[i].tags.indexOf(e.trigger)&&e.imgs[i].tags.unshift(e.trigger))}))})),e.onSave()):null!==(c=n.data)&&void 0!==c&&c.items[0]&&4==(null===(d=n.data)||void 0===d||null===(d=d.items[0])||void 0===d?void 0:d.status)?(clearTimeout(e.inTimes),e.$message.warning(e.$t("newTrainIntrTip4")),e.setTagLoading=!1):(clearTimeout(e.inTimes),e.inTimes=setTimeout((function(){e.onBatchFetchTaskProcess(t)}),1e3)))})).catch((function(t){e.setTagLoading=!1}))},imgDelete:function(t){this.imgs.splice(t,1),0==this.imgs.length&&(this.unmatchedImages=[],this.uploadType=-1)},onDeleteAll:function(){this.imgs=[],this.unmatchedImages=[],this.uploadType=-1},sizeChange:function(){this.handleImgFormData.process_width=parseInt(this.cropSizeIndex.split("*")[0]),this.handleImgFormData.process_height=parseInt(this.cropSizeIndex.split("*")[1])},uploadFolder:function(){var t;this.isLoggedIn?this.isUploading||null!==(t=this.$refs)&&void 0!==t&&t.foldeInput&&(this.$refs.foldeInput.value=null,this.$refs.foldeInput.click(),this.$logEvent("log_actions",{operation:"click_upload_dataset",behavior_info:"on_training_detail_page"})):this.$EventBus.$emit("openLoginDialog")},uploadImg:function(){var t;this.isLoggedIn?this.isUploading||null!==(t=this.$refs)&&void 0!==t&&t.imgInput&&(this.$refs.imgInput.value=null,this.$refs.imgInput.click(),this.$logEvent("log_actions",{operation:"click_upload_image",behavior_info:"on_training_detail_page"})):this.$EventBus.$emit("openLoginDialog")},handleImgUpload:function(t){var e=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,r,h,i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.isUploading){n.next=2;break}return n.abrupt("return");case 2:if(o=t.target.files,!(e.maxImgNum-e.imgs.length<o.length)){n.next=6;break}return e.$message(e.$t("newTrainIntrTip3")),n.abrupt("return");case 6:if(e.isUploading=!0,e.loadingProgress=0,e.uploadType=1,e.$emit("changeUploadType",1),r=0,!o||!o.length){n.next=23;break}h=regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!((n=o[i]).size/1024/1024>2)){t.next=16;break}return t.prev=2,t.next=5,Object(d.a)(n,2097152);case 5:n=t.sent,t.next=16;break;case 8:return t.prev=8,t.t0=t.catch(2),console.error("Compression failed:",t.t0),r++,e.loadingProgress=parseInt(r/o.length*100),e.unmatchedImages.push({name:n.name,tip:e.$t(t.t0.message)}),r===o.length&&(e.isUploading=!1),t.abrupt("return",1);case 16:new c.a({type:2}).startUpload(n,{name:"train_img".concat(Date.now(),".png"),type:"png",category:31,size:n.size}).then(function(){var t=Object(l.a)(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.imgs.push({url:n,tags:[]}),e.$nextTick((function(){e.$refs.imgBox.scrollTo(0,e.$refs.imgBox.scrollHeight)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){30005==t.code?e.unmatchedImages.push({name:n.name,tip:e.$t("uploadImageViolatesRules")}):e.unmatchedImages.push({name:n.name,tip:e.$t("uploadError")})})).finally((function(){r++,e.loadingProgress=parseInt(r/o.length*100),r==o.length&&(e.isUploading=!1)}));case 18:case"end":return t.stop()}}),t,null,[[2,8]])})),i=0;case 14:if(!(i<o.length)){n.next=21;break}return n.delegateYield(h(),"t0",16);case 16:if(!n.t0){n.next=18;break}return n.abrupt("continue",18);case 18:i++,n.next=14;break;case 21:n.next=24;break;case 23:e.isUploading=!1;case 24:case"end":return n.stop()}}),n)})))()},handleFolderUpload:function(t){var e=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,r,h,m,i,v,f;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.isUploading){n.next=2;break}return n.abrupt("return");case 2:o=t.target.files,e.isUploading=!0,e.loadingProgress=0,e.uploadType=2,e.$emit("changeUploadType",2),r=[],h=0,m=regeneratorRuntime.mark((function t(){var n,l,c,d,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=o[i],l=["image/png","image/jpeg","image/jpg","image/webp"],!n.type.startsWith("image/")||!l.includes(n.type)){t.next=13;break}if(c=n.name.split(".")[0],!(d=Array.from(o).find((function(t){return t.name===c+".txt"})))){t.next=12;break}return t.next=8,e.readTextFile(d);case 8:h=t.sent,r.push({file:n,tags:h.split(",")}),t.next=13;break;case 12:e.unmatchedImages.push({name:n.name,tip:e.$t("newTrainIntr19")});case 13:case"end":return t.stop()}}),t)})),i=0;case 11:if(!(i<o.length)){n.next=16;break}return n.delegateYield(m(),"t0",13);case 13:i++,n.next=11;break;case 16:if(!(e.maxImgNum-e.imgs.length<r.length)){n.next=21;break}return e.isUploading=!1,0==e.imgs.length&&(e.uploadType=-1),e.$message(e.$t("newTrainIntrTip3")),n.abrupt("return");case 21:if(0!=r.length){n.next=24;break}return e.isUploading=!1,n.abrupt("return");case 24:v=regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r[f],!((o=n.file).size/1024/1024>2)){t.next=17;break}return t.prev=3,t.next=6,Object(d.a)(o,2097152);case 6:o=t.sent,t.next=17;break;case 9:return t.prev=9,t.t0=t.catch(3),h++,e.loadingProgress=parseInt(h/r.length*100),e.unmatchedImages.push({name:o.name,tip:e.$t(t.t0.message)}),h===r.length&&(e.isUploading=!1),console.error("Compression failed:",t.t0,t.t0.message),t.abrupt("return",1);case 17:new c.a({type:2}).startUpload(o,{name:"train_img".concat(Date.now(),".png"),type:"png",category:31,size:o.size}).then(function(){var t=Object(l.a)(regeneratorRuntime.mark((function t(o){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.imgs.push({url:o,tags:n.tags}),e.$nextTick((function(){e.$refs.imgBox.scrollTo(0,e.$refs.imgBox.scrollHeight)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.unmatchedImages.push({name:o.name,tip:e.$t("uploadImageViolatesRules")})})).finally((function(){h++,e.loadingProgress=parseInt(h/r.length*100),h==r.length&&(e.isUploading=!1)}));case 19:case"end":return t.stop()}}),t,null,[[3,9]])})),f=0;case 26:if(!(f<r.length)){n.next=33;break}return n.delegateYield(v(),"t1",28);case 28:if(!n.t1){n.next=30;break}return n.abrupt("continue",30);case 30:f++,n.next=26;break;case 33:case"end":return n.stop()}}),n)})))()},readTextFile:function(t){return new Promise((function(e,n){var o=new FileReader;o.onload=function(t){e(t.target.result)},o.onerror=n,o.readAsText(t)}))}}},x=k,O=(n(2468),n(2469),Object(m.a)(x,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"TrainUploadImgBox"},[e("div",{staticClass:"imgBoxTit"},[e("div",{staticClass:"imgBoxTitLeft"},[e("div",{staticClass:"imgNumBox"},[e("img",{attrs:{src:n(761),alt:""}}),t._v(" "),e("span",[t._v(t._s("".concat(this.$t("newTrainIntr1")," (").concat(t.imgs.length,"/").concat(t.maxImgNum,")")))])]),t._v(" "),t.unmatchedImages.length>0?e("el-popover",{attrs:{placement:"bottom-start",trigger:"hover","popper-class":"popoverUnmatched","visible-arrow":!1}},[e("div",{staticClass:"unmatchedCnt"},t._l(t.unmatchedImages,(function(n,o){return e("div",{key:o,staticClass:"unmatchedItem"},[e("div",{staticClass:"unmatchedItemName"},[t._v(t._s(n.name))]),t._v(" "),e("div",{staticClass:"unmatchedItemTip"},[t._v(t._s(n.tip))])])})),0),t._v(" "),e("div",{staticClass:"imgErrBox",attrs:{slot:"reference"},slot:"reference"},[e("i",{staticClass:"el-icon-warning"}),t._v(" "),e("span",[t._v(t._s(t.$t("newTrainIntr11",{number:t.unmatchedImages.length})))])])]):t._e()],1),t._v(" "),t.imgs.length>0?e("div",{staticClass:"otherUploadBtn"},[2==t.uploadType?e("div",{directives:[{name:"loading",rawName:"v-loading",value:this.isUploading,expression:"this.isUploading"}],on:{click:t.uploadFolder}},[t._v("\n        "+t._s(t.$t("newTrainIntr2"))+"\n        "),e("input",{ref:"foldeInput",staticStyle:{display:"none"},attrs:{type:"file",webkitdirectory:""},on:{change:t.handleFolderUpload}})]):t._e(),t._v(" "),1==t.uploadType?e("div",{directives:[{name:"loading",rawName:"v-loading",value:this.isUploading,expression:"this.isUploading"}],on:{click:t.uploadImg}},[t._v("\n        "+t._s(t.$t("UploadImg"))+"\n        "),e("input",{ref:"imgInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/png, image/jpeg, image/jpg', image/webp",multiple:""},on:{change:t.handleImgUpload}})]):t._e()]):t._e()]),t._v(" "),e("div",{staticClass:"main",class:{"main-banner":t.isShowActivityBanner},style:2==this.uploadType?"height:calc(100vh - 314px)":null},[t.isUploading||t.setTagLoading?e("div",{staticClass:"loadingBox"},[e("div",{staticClass:"progressBox"},[e("el-progress",{attrs:{type:"circle",percentage:t.loadingProgress,width:104,"stroke-width":10,color:"#22D19D","text-color":"#ffffff"}}),t._v(" "),e("div",{staticClass:"progressTip"},[t._v(" "+t._s(t.isUploading?t.$t("newTrainIntr12"):t.$t("newTrainIntr13"))+" ")])],1)]):t._e(),t._v(" "),0==t.imgs.length?e("div",{staticClass:"uplaodBox"},[e("div",{staticClass:"mainTit"},[t._v(t._s(t.$t("newTrainIntr3")))]),t._v(" "),e("div",{staticClass:"mainTip"},[t._v(t._s(t.$t("newTrainIntr4",{count:200})))]),t._v(" "),e("div",{staticClass:"mainTip"},[t._v(t._s(t.$t("newTrainIntr5")))]),t._v(" "),e("div",{staticClass:"btnItem"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:this.isUploading,expression:"this.isUploading"}],on:{click:t.uploadFolder}},[t._v("\n          "+t._s(t.$t("newTrainIntr2"))+"\n          "),e("input",{ref:"foldeInput",staticStyle:{display:"none"},attrs:{type:"file",webkitdirectory:""},on:{change:t.handleFolderUpload}})]),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:this.isUploading,expression:"this.isUploading"}],on:{click:t.uploadImg}},[t._v("\n          "+t._s(t.$t("UploadImg"))+"\n          "),e("input",{ref:"imgInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/png, image/jpeg, image/jpg', image/webp",multiple:""},on:{change:t.handleImgUpload}})])])]):e("div",{ref:"imgBox",staticClass:"imgBox"},t._l(t.imgs,(function(n,o){var r;return e("imgItem",{key:n.url+"_"+o,attrs:{url:n.url,prompt:null===(r=n.tags)||void 0===r?void 0:r.join(",")},on:{imgDelete:function(e){return t.imgDelete(o)},click:function(e){return t.openDel(o)}}})})),1),t._v(" "),t.imgs.length>0?e("div",{staticClass:"allDelete",on:{click:t.onDeleteAll}},[t._v(t._s(t.$t("DeleteAll")))]):t._e()]),t._v(" "),2!=this.uploadType?e("div",{staticClass:"featureBox",style:1!=this.uploadType||t.isUploading?"opacity:.2":null},[1!=this.uploadType||t.isUploading?e("div",{staticClass:"featureBoxZg"}):t._e(),t._v(" "),e("div",{staticClass:"featureForm"},[e("div",{staticClass:"formItem"},[e("div",{staticClass:"formLabel"},[t._v(t._s(t.$t("newTrainIntr6")))]),t._v(" "),e("el-select",{attrs:{"popper-class":"custom-select"},on:{change:t.cuttingChange},model:{value:t.handleImgFormData.cutting_plan,callback:function(e){t.$set(t.handleImgFormData,"cutting_plan",e)},expression:"handleImgFormData.cutting_plan"}},t._l(t.cropType,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),e("div",{staticClass:"formItem"},[e("div",{staticClass:"formLabel"},[t._v(t._s(t.$t("newTrainIntr7")))]),t._v(" "),e("el-select",{attrs:{"popper-class":"custom-select"},on:{change:t.sizeChange},model:{value:t.cropSizeIndex,callback:function(e){t.cropSizeIndex=e},expression:"cropSizeIndex"}},t._l(t.cropSize,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),e("div",{staticClass:"formItem"},[e("div",{staticClass:"formLabel"},[t._v(t._s(t.$t("newTrainIntr8")))]),t._v(" "),e("el-select",{attrs:{"popper-class":"custom-select"},on:{change:t.markChange},model:{value:t.handleImgFormData.marking_plan,callback:function(e){t.$set(t.handleImgFormData,"marking_plan",e)},expression:"handleImgFormData.marking_plan"}},t._l(t.labeling,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),[2,5,6].includes(t.handleImgFormData.marking_plan)?e("div",{staticClass:"formItem"},[e("div",{staticClass:"formLabel"},[t._v(t._s(t.$t("newTrainIntr20")))]),t._v(" "),e("el-input-number",{attrs:{"controls-position":"right",min:0,max:1,step:.05},model:{value:t.handleImgFormData.deepbooru_threshold,callback:function(e){t.$set(t.handleImgFormData,"deepbooru_threshold",e)},expression:"handleImgFormData.deepbooru_threshold"}})],1):t._e(),t._v(" "),e("div",{staticClass:"formItem"},[e("div",{staticClass:"formLabel"},[t._v(t._s(t.$t("TriggerWords")))]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.trigger,expression:"trigger"}],staticClass:"tris",style:{cursor:4==t.handleImgFormData.marking_plan?"not-allowed":null},attrs:{type:"text",disabled:4==t.handleImgFormData.marking_plan},domProps:{value:t.trigger},on:{input:function(e){e.target.composing||(t.trigger=e.target.value)}}})])]),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.setTagLoading,expression:"setTagLoading"}],staticClass:"featureBtn",on:{click:function(e){t.isImgsComplete?t.resFeature():t.onFeature()}}},[t._v("\n      "+t._s(t.isImgsComplete?this.$t("newTrainIntr10"):this.$t("newTrainIntr9"))+"\n    ")])]):t._e(),t._v(" "),e("imgDet",{ref:"imgDet",model:{value:t.imgs,callback:function(e){t.imgs=e},expression:"imgs"}})],1)}),[],!1,null,"678812b6",null).exports),$=n(151),D=(n(47),n(5)),S={props:{value:{type:Array,default:function(){return[]}},createId:{type:String,default:""},max:{type:Number,default:500},category:{type:Number,default:2},compressSize:{type:Number,default:2}},components:{},data:function(){return{replaceImageType:D.x,isUploading:!1,accept:".jpg,.jpeg,.png,.svg,.webp,.bmp,.tif",fileList:[],tempList:[],batchSize:2,selectedFilesCount:0}},computed:{showImgLoading:function(){return function(img){return!img.tags&&!img.disabled_tag&&"check"!=img.type&&(100!=img.uploadStatus||!img.error&&!img.ready)}}},watch:{value:function(t){t&&this.$set(this,"fileList",t)}},mounted:function(){this.value&&this.value&&this.$set(this,"fileList",this.value)},methods:{curstomUpload:function(t){var e=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.isUploading=!0,!((o=t.file).size/1024/1024>e.compressSize)){n.next=14;break}return n.prev=3,n.next=6,Object(d.a)(o,1024*e.compressSize*1024);case 6:o=n.sent,n.next=14;break;case 9:return n.prev=9,n.t0=n.catch(3),e.isUploading=!1,console.error("error:",n.t0),n.abrupt("return");case 14:e.addFileByUpload(o).then((function(t){console.log("自定义id",t);var n=new c.a({type:2});n.startUpload(o,{name:"train_img".concat(Date.now(),"_").concat(o.name),category:e.category||2,size:o.size}).then((function(o){var r=e.fileList.find((function(e){return e.id===t}));r.url=o,r.uploadStatus=100,r.ready=!0,r.file_id=n.fileId})).catch((function(n){var o=e.fileList.findIndex((function(e){return e.id===t}));e.deleteFile(o)})).finally((function(){console.log("finally"),e.isUploading=!1}))}));case 15:case"end":return n.stop()}}),n,null,[[3,9]])})))()},handleChange:function(t,e){var n=this;this.tempList=e,this.$emit("input",this.fileList),setTimeout((function(){n.$emit("handleChange",n.fileList)}),500)},addFileByUpload:function(t){var e=this;return new Promise((function(n,o){var r=new FileReader;r.readAsDataURL(t),r.onload=function(){var o={id:e.fileList.length+t.name,uploadStatus:0,ready:!1};e.fileList.push(o),n(o.id)},r.onerror=function(t){return o(t)}}))},addFile:function(t){var e=t.id,n=t.url;this.fileList.push({file_id:e,url:n,uploadStatus:100,ready:!0})},updateProgress:function(t,e){var n=t.loaded,o=t.total,r=Math.round(n/o*100),l=this.fileList.findIndex((function(t){return t.file_id==e.file_id}));l>-1&&(this.fileList[l].uploadStatus=r)},clear:function(){var t=this;this.$confirm(this.$t("DeleteAllFiles"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){t.fileList=[],t.$emit("clearAll",t.fileList),t.$emit("handleChange",t.fileList)})).catch((function(){}))},deleteFile:function(t){var e=this.fileList[t];this.fileList.splice(t,1),this.$emit("delete",e),this.$emit("handleChange",this.fileList)},fileExceed:function(){this.$message({type:"warning",message:this.$t("UploadImageExceed",{max:this.max})})},refreshUpload:function(t){var e=this.fileList[t].file_id;this.fileList[t].error=!1,this.fileList[t].uploadStatus=0,e?this.startUpload(e):this.getUploadSign(e)},imgError:function(t){var e="imgError".concat(t.url);this[e]?this[e]+=1:this[e]=1,this[e]>3||(console.log("load img error",this.$refs[t.url]),this.$refs[t.url][0].src=t.url)}}},I=(n(2470),Object(m.a)(S,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"upload-image-item flex flex-col"},[e("div",{staticClass:"upload-content flex flex-wrap"},[e("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:t.isUploading,expression:"isUploading"}],ref:"imageUpload",staticClass:"upload-image",attrs:{action:"/",drag:"",multiple:"","http-request":t.curstomUpload,limit:t.max,"on-exceed":t.fileExceed,accept:t.accept,"file-list":t.fileList,"show-file-list":!1,"on-change":t.handleChange}},[e("i",{staticClass:"el-icon-plus"})]),t._v(" "),t._l(t.fileList,(function(img,i){return e("div",{key:"upload_".concat(i),staticClass:"image-item flex"},[e("div",{staticClass:"img-handle"},[e("i",{staticClass:"el-icon-delete",on:{click:function(e){return t.deleteFile(i)}}}),t._v(" "),e("i",{directives:[{name:"show",rawName:"v-show",value:img.error,expression:"img.error"}],staticClass:"el-icon-refresh-left refresg-icon",on:{click:function(e){return t.refreshUpload(i)}}})]),t._v(" "),img.url?e("img",{ref:img.url,refInFor:!0,attrs:{src:t.replaceImageType(img.url,"low")},on:{error:function(e){return t.imgError(img)}}}):t._e(),t._v(" "),t.showImgLoading(img)?e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.showImgLoading(img),expression:"showImgLoading(img)"}],staticClass:"loading"}):t._e()])}))],2),t._v(" "),t.fileList.length>0?e("el-button",{staticClass:"clear text-right",attrs:{type:"text"},on:{click:t.clear}},[e("i",{staticClass:"iconfont icon-moveDelete"}),t._v("\n    "+t._s(t.$t("DeleteAll"))+"\n  ")]):t._e()],1)}),[],!1,null,"2a4a3729",null).exports),T=n(523),j=n(41);function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var M={name:"LoraTrainingEdit",components:{TrainUploadImgBox:O,UploadImageItem:I,TarinAdvSet:T.a,StyleModal:$.a},data:function(){return{selectModelDisabled:!1,isShowBanner:!1,isLoading:!1,pageLaoding:!0,selectModel:"",modelList:[],defConfig:{},formData:{name:"",meta:null,mode:1,category:1,related_model_no:"",related_model_ver_no:""},typeIndex:"default",activeName:"training",intSeed:null,train_estimated:{hashrate_base_value:2.5,reg_image_base_value:2,sdxl_base_value:6,sd35_base_value:6,sd_batch_size_base_value:{1:2.8,2:2.5,3:1.8,4:1.5,5:1.3,6:1.1,7:.9,8:.8},sdxl_batch_size_base_value:{1:4.5,2:4},flux_batch_size_base_value:{1:5.5},sd35l_batch_size_base_value:{1:6,2:4},sd35m_batch_size_base_value:{1:18,2:12}},typeList:[{name:this.$t("Customization"),value:"default"},{name:"SD 3.5L",value:"sd35L_default",url:"https://image.cdn2.seaart.me/train/trainIcon6.png"},{name:"SD 3.5M",value:"sd35M_default",url:"https://image.cdn2.seaart.me/train/trainIcon7.png"},{name:"FLUX",value:"flux_default",url:"https://image.cdn2.seaart.me/train/trainIcon0.png"},{name:"SDXL",value:"sdxl_default",url:"https://image.cdn2.seaart.me/train/trainIcon1.png"},{name:this.$t("trainPortrait"),value:"portrait_default",url:"https://image.cdn2.seaart.me/train/trainIcon2.png"},{name:this.$t("animation"),value:"anime_default",url:"https://image.cdn2.seaart.me/train/trainIcon3.png"},{name:this.$t("c_style"),value:"style_default",url:"https://image.cdn2.seaart.me/train/trainIcon4.png"},{name:this.$t("viewMore"),value:"more"}]}},computed:P(P(P(P({},Object(y.c)("activity",["isShowActivityBanner"])),Object(y.c)("user",["isLoggedIn","isCompanyAccount"])),Object(y.e)("payment",["paymentInfo"])),{},{isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)},intStep:function(){var t,e,n,o,r,l,c=parseInt((null===(t=this.formData)||void 0===t||null===(t=t.meta)||void 0===t?void 0:t.repeat)*(null===(e=this.formData)||void 0===e||null===(e=e.meta)||void 0===e?void 0:e.epoch)/(null===(n=this.formData)||void 0===n||null===(n=n.meta)||void 0===n?void 0:n.train_batch_size));(null===(o=this.formData)||void 0===o||null===(o=o.meta)||void 0===o?void 0:o.reg_images.length)>0?c*=this.train_estimated.reg_image_base_value*(null===(r=this.formData)||void 0===r||null===(r=r.meta)||void 0===r||null===(r=r.images)||void 0===r?void 0:r.length):c*=null===(l=this.formData)||void 0===l||null===(l=l.meta)||void 0===l||null===(l=l.images)||void 0===l?void 0:l.length;return c},steps:function(){var t;return(null===(t=this.formData)||void 0===t||null===(t=t.meta)||void 0===t||null===(t=t.images)||void 0===t?void 0:t.length)>0?this.intStep:this.$t("calculateAfter")},inFluxActivity:function(){var t=Date.now();return t>17276544e5&&t<17294688e5},getSdTime:function(){var t,e,n,o,r,l,c=0;switch(this.typeIndex){case"sdxl_default":c=this.intStep/this.train_estimated.sdxl_batch_size_base_value[null===(t=this.formData.meta)||void 0===t?void 0:t.train_batch_size];break;case"flux_default":c=this.intStep/this.train_estimated.flux_batch_size_base_value[null===(e=this.formData.meta)||void 0===e?void 0:e.train_batch_size];break;case"sd35_default":c=this.intStep/this.train_estimated.sd35l_batch_size_base_value[null===(n=this.formData.meta)||void 0===n?void 0:n.train_batch_size];break;case"sd35M_default":c=this.intStep/this.train_estimated.sd35m_batch_size_base_value[null===(o=this.formData.meta)||void 0===o?void 0:o.train_batch_size];break;case"sd35L_default":c=this.intStep/this.train_estimated.sd35l_batch_size_base_value[null===(r=this.formData.meta)||void 0===r?void 0:r.train_batch_size];break;default:c=this.intStep/this.train_estimated.sd_batch_size_base_value[null===(l=this.formData.meta)||void 0===l?void 0:l.train_batch_size]}return c},EtdCost:function(){var t=this.getSdTime,e=t*this.train_estimated.sdxl_base_value;console.log("系数",this.train_estimated.hashrate_base_value);var n="sdxl_default"==this.typeIndex||"flux_default"===this.typeIndex?parseInt(e/this.train_estimated.hashrate_base_value):parseInt(t/this.train_estimated.hashrate_base_value);return n=["sd35_default","sd35L_default","sd35M_default"].includes(this.typeIndex)?parseInt(t/this.train_estimated.hashrate_base_value*this.train_estimated.sd35_base_value):n,"flux_default"===this.typeIndex&&this.inFluxActivity&&(n=parseInt(n/2)),n}}),created:function(){var t=this;Object(r.a)().then((function(e){var n,o,l,c;if(1e4==e.status.code){t.defConfig=e.data;var d,h,m,v=t.typeIndex.startsWith("sd35")?"sd35_default":t.typeIndex;if(t.modelList=(null===(n=t.defConfig[v])||void 0===n?void 0:n.models)||[],null===(o=t.$route)||void 0===o||null===(o=o.query)||void 0===o||!o.id)t.formData.related_model_no=(null===(d=t.modelList[0])||void 0===d?void 0:d.model_no)||"",t.formData.related_model_ver_no=(null===(h=t.modelList[0])||void 0===h?void 0:h.model_ver_no)||"",t.selectModel=(null===(m=t.modelList[0])||void 0===m?void 0:m.model_no)||"";if(e.data.train_estimated){var f=e.data.train_estimated,_=f.hashrate_base_value,y=f.sd_batch_size_base_value,w=f.sdxl_batch_size_base_value,C=f.reg_image_base_value,k=f.sdxl_base_value,x=f.flux_batch_size_base_value,O=f.sd35l_batch_size_base_value,$=f.sd35_base_value,D=f.sd35m_batch_size_base_value;t.train_estimated={sd_batch_size_base_value:y||{1:2.8,2:2.5,3:1.8,4:1.5,5:1.3,6:1.1,7:.9,8:.8},sdxl_batch_size_base_value:w||{1:4.5,2:4},flux_batch_size_base_value:x||{1:5.5},sd35l_batch_size_base_value:O||{1:6,2:4},sd35m_batch_size_base_value:D||{1:18,2:12},hashrate_base_value:_||2.5,reg_image_base_value:C||2,sdxl_base_value:k||6,sd35_base_value:$||6}}if(null!==(l=t.$route)&&void 0!==l&&null!==(l=l.query)&&void 0!==l&&l.id||null!==(c=t.$route)&&void 0!==c&&null!==(c=c.query)&&void 0!==c&&c.dataSetNo){var S,I,T,L=j.d,P={id:null===(S=t.$route)||void 0===S||null===(S=S.query)||void 0===S?void 0:S.id};if(null!==(I=t.$route)&&void 0!==I&&null!==(I=I.query)&&void 0!==I&&I.dataSetNo)L=r.l,P={train_model_no:null===(T=t.$route)||void 0===T||null===(T=T.query)||void 0===T?void 0:T.dataSetNo};L(P).then((function(e){var n,o;if(1e4==e.status.code){t.formData.name=e.data.name,t.selectModel=e.data.related_model_no,6===e.data.category&&(t.selectModel="FLUX"),7===e.data.category&&(t.selectModel="SD 3.5L"),8===e.data.category&&(t.selectModel="SD 3.5M"),t.selectModelDisabled=[6,7,8].includes(e.data.category),null!==(n=t.$route)&&void 0!==n&&null!==(n=n.query)&&void 0!==n&&n.dataSetNo?t.formData.mode=1:t.formData.mode=e.data.mode,t.formData.category=e.data.category,t.formData.related_model_no=e.data.related_model_no,t.formData.related_model_ver_no=e.data.related_model_ver_no,t.formData.trigger_words=e.data.trigger_words?e.data.trigger_words:[],t.typeIndex=t.setEditTarinType(e.data.category);var r=t.typeIndex.startsWith("sd35")?"sd35_default":t.typeIndex;if(t.modelList=(null===(o=t.defConfig[r])||void 0===o?void 0:o.models)||[],e.data.model){var l=!0;t.modelList.forEach((function(t){t.model_no===e.data.model.model_no&&(l=!1)})),l&&t.modelList.push(e.data.model)}t.setformData(e.data.meta),t.$nextTick((function(){var n;t.$refs.TrainUploadImgBox&&(null!==(n=t.$route)&&void 0!==n&&null!==(n=n.query)&&void 0!==n&&n.dataSetNo?t.$refs.TrainUploadImgBox.uploadType=1:t.$refs.TrainUploadImgBox.uploadType=e.data.mode,t.$refs.TrainUploadImgBox.trigger=e.data.trigger_words?e.data.trigger_words[0]:"")}))}})).finally((function(){t.pageLaoding=!1}))}else t.setformData(),t.pageLaoding=!1;t.setDefaultTypeByUrl()}})).catch((function(){t.pageLaoding=!1}))},mounted:function(){this.isShowBanner=!(this.isCompanyAccount||sessionStorage.getItem("HideTopBanner")&&sessionStorage.getItem("HideActivityBanner")||this.isVip)},watch:{defConfig:{handler:function(t){console.log("defConfig",t)},immediate:!0,deep:!0}},methods:{goBack:function(){window.history.length>2?this.$router.back():this.$router.push(this.localePath("/"))},onSave:function(){var t,e,n,o,l=this,c=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isLoggedIn)if(this.formData.name)if(this.selectModel)if(null!==(t=this.formData)&&void 0!==t&&null!==(t=t.meta)&&void 0!==t&&t.images&&0!=(null===(e=this.formData)||void 0===e||null===(e=e.meta)||void 0===e?void 0:e.images.length)){if(c){for(var d,h=0,i=0;i<(null===(m=this.formData)||void 0===m||null===(m=m.meta)||void 0===m?void 0:m.images.length);i++){var m,v,f;((null===(v=this.formData)||void 0===v||null===(v=v.meta)||void 0===v||null===(v=v.images[i])||void 0===v||null===(v=v.tags)||void 0===v?void 0:v.length)>0||null!==(f=this.formData)&&void 0!==f&&null!==(f=f.meta)&&void 0!==f&&null!==(f=f.images[i])&&void 0!==f&&f.raw_url)&&h++}if(h<(null===(d=this.formData)||void 0===d||null===(d=d.meta)||void 0===d?void 0:d.images.length))return void this.$message.error(this.$t("newAddTagNoneTip"))}else this.$logEvent("log_actions",{operation:"click_save_dataset",behavior_info:"on_training_detail_pager"});if(!this.isLoading){var _;if(this.isLoading=!0,null!==(n=this.$route)&&void 0!==n&&null!==(n=n.query)&&void 0!==n&&n.dataSetNo)return this.formData.model_ver_no=null===(_=this.$route)||void 0===_||null===(_=_.query)||void 0===_?void 0:_.modelVerNo,void Object(r.f)(this.formData).then((function(t){1e4==t.status.code&&window.open("/loraTrainingDet?id="+t.data.id,"_blank")})).finally((function(){l.isLoading=!1}));var y,w=j.b;if(null!==(o=this.$route)&&void 0!==o&&null!==(o=o.query)&&void 0!==o&&o.id)w=j.e,this.formData.id=null===(y=this.$route)||void 0===y||null===(y=y.query)||void 0===y?void 0:y.id;w(this.formData).then((function(t){if(1e4==t.status.code)if(c){var e,n=(null===(e=l.$route)||void 0===e||null===(e=e.query)||void 0===e?void 0:e.id)||t.data.id;Object(j.B)({data_set_no:n}).then((function(t){var e;1e4==t.status.code&&(null!==(e=l.$route)&&void 0!==e&&null!==(e=e.query)&&void 0!==e&&e.id||l.$router.back(),window.open("/loraTrainingDet?id="+t.data.id,"_blank"))})).finally((function(){l.isLoading=!1}))}else l.isLoading=!1,l.$message.success(l.$t("SaveSuccess")),l.$router.back()})).catch((function(){l.isLoading=!1}))}}else this.$message.error(this.$t("pleaseUoloadImage"));else this.$message.error(this.$t("PleaseSelectBaseName"));else this.$message.error(this.$t("myNewDataset"));else this.$EventBus.$emit("openLoginDialog")},onDelete:function(){var t=this;this.$confirm(this.$t("confirmDeletion"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),customClass:"collectConfirm",type:"warning"}).then((function(){var e;Object(j.c)({ids:[null===(e=t.$route)||void 0===e||null===(e=e.query)||void 0===e?void 0:e.id]}).then((function(e){1e4==e.status.code&&t.$router.back()}))})).catch((function(){})),this.$logEvent("log_actions",{operation:"click_delete_dataset",behavior_info:"on_training_detail_page"})},getRandomSeed:function(){return Math.floor(4294967294*Math.random())+1},openAdSet:function(){this.$refs.advset.show(),this.$logEvent("log_actions",{operation:"click_advanced_setting",behavior_info:"on_training_detail_page"})},setTarinType:function(){var t=1;switch(this.typeIndex){case"default":t=1;break;case"anime_default":t=2;break;case"style_default":t=3;break;case"portrait_default":t=4;break;case"sdxl_default":t=5;break;case"flux_default":t=6;break;case"sd35L_default":t=7;break;case"sd35M_default":t=8}return t},setEditTarinType:function(t){var e="default";switch(t){case 1:e="default";break;case 2:e="anime_default";break;case 3:e="style_default";break;case 4:e="portrait_default";break;case 5:e="sdxl_default";break;case 6:e="flux_default";break;case 7:e="sd35L_default";break;case 8:e="sd35M_default"}return e},setformData:function(t){var e,n,o,r,l,c,d,h,m=this.typeIndex.startsWith("sd35")?"sd35_default":this.typeIndex,v=P({},this.defConfig[m]),f={};(t?(v=t,f=P({},this.defConfig[m])):v=P({},this.defConfig[m]),null!==(e=this.formData.meta)&&void 0!==e&&e.reg_images&&(null===(n=this.formData.meta)||void 0===n?void 0:n.reg_images.length)>0)&&(v.reg_images=null===(d=this.formData.meta)||void 0===d?void 0:d.reg_images);null!==(o=this.formData.meta)&&void 0!==o&&o.images&&(null===(r=this.formData.meta)||void 0===r?void 0:r.images.length)>0&&(v.images=null===(h=this.formData.meta)||void 0===h?void 0:h.images);var _=v,y=_.repeat,w=_.epoch,C=_.text_to_img,k=_.train_batch_size,x=_.mixed_precision,O=_.resolution,$=_.save_every_n_epochs,D=_.save_precision_as,S=_.learning_rate,I=_.unet_lr,T=_.te_lr,j=_.lr_warmup,L=_.lr_scheduler,M=_.optimizer,E=_.lr_scheduler_num_cycles,A=_.min_snr_gamma,N=_.enable_block_weights,R=_.network_dim,B=_.network_alpha,F=_.shuffle_caption,U=_.weighted_captions,V=_.keep_tokens,W=_.noise_offset,H=_.max_token_length,z=_.multires_noise_iterations,G=_.multires_noise_discount,J=_.clip_skip,K=_.reg_images,Y=_.images,Q=_.down_lr_weight,X=_.mid_lr_weight,Z=_.up_lr_weight,tt=_.block_lr_zero_threshold,et=_.enable_train_unet,it=_.enable_train_text_encoder;!C||null!=C&&C.seed||(C.seed=this.getRandomSeed()),this.formData.meta={repeat:y||f.repeat,epoch:w||f.epoch,text_to_img:C||f.text_to_img,train_batch_size:k||f.train_batch_size,mixed_precision:x||f.mixed_precision,resolution:O||f.resolution||"512*512",seed:-1,save_every_n_epochs:$||f.save_every_n_epochs,save_precision_as:D||f.save_precision_as,learning_rate:S||f.learning_rate,reg_images:K||[],images:Y||[],unet_lr:I||0==I?I:f.unet_lr,te_lr:T||0==T?T:f.te_lr,lr_warmup:j||f.lr_warmup,lr_scheduler:L||f.lr_scheduler,optimizer:M||f.optimizer,lr_scheduler_num_cycles:E||f.lr_scheduler_num_cycles,min_snr_gamma:A||f.min_snr_gamma,enable_block_weights:N||f.enable_block_weights,network_dim:R||f.network_dim,network_alpha:B||f.network_alpha,shuffle_caption:F||f.shuffle_caption,weighted_captions:U||f.weighted_captions,keep_tokens:V||f.keep_tokens,noise_offset:W||f.noise_offset,max_token_length:H||f.max_token_length,multires_noise_iterations:z||f.multires_noise_iterations,multires_noise_discount:G||f.multires_noise_discount,clip_skip:J||f.clip_skip,resolutionWidth:(null==C?void 0:C.width)||(null===(l=f.text_to_img)||void 0===l?void 0:l.width),resolutionHeight:(null==C?void 0:C.height)||(null===(c=f.text_to_img)||void 0===c?void 0:c.height),down_lr_weight:Q||f.down_lr_weight,mid_lr_weight:X||f.mid_lr_weight,up_lr_weight:Z||f.up_lr_weight,block_lr_zero_threshold:tt||f.block_lr_zero_threshold,trigger_words:[],enable_train_unet:et||f.enable_train_unet,enable_train_text_encoder:it||f.enable_train_text_encoder}},setDefaultTypeByUrl:function(){var t,e=null===(t=this.$route)||void 0===t||null===(t=t.query)||void 0===t?void 0:t.defaultType;if(e){var n=this.typeList.find((function(t){return t.name===e}));n&&this.changeType(n)}},changeType:function(t){var e,n,o,r,l=this;if("more"===t.value)return window.open("/lora_train","_blank"),void this.$logEvent("log_actions",{operation:"click_view_more",behavior_info:"on_training_detail_page"});var c=t.value.startsWith("sd35")?"sd35_default":t.value;if(console.log(c),this.defConfig[c]){t.value,"flux_default"===t.value&&this.$logEvent("log_actions",{operation:"click_train",behavior_info:"on_model_train_page",behavior_info_sub:"flux"}),this.selectModel="",this.typeIndex=t.value;var d=this.typeIndex.startsWith("sd35")?"sd35_default":this.typeIndex;switch(this.modelList=(null===(e=this.defConfig[d])||void 0===e?void 0:e.models)||[],this.formData.related_model_no=(null===(n=this.modelList[0])||void 0===n?void 0:n.model_no)||"",this.formData.related_model_ver_no=(null===(o=this.modelList[0])||void 0===o?void 0:o.model_ver_no)||"",console.log(9999,this.modelList),this.selectModel=(null===(r=this.modelList[0])||void 0===r?void 0:r.model_no)||"",console.log(t.value),t.value){case"flux_default":this.selectModel="FLUX";break;case"sd35_default":this.selectModel="SD 3.5";break;case"sd35L_default":this.selectModel="SD 3.5L";break;case"sd35M_default":this.selectModel="SD 3.5M"}var h=this.modelList.find((function(t){return l.selectModel===t.base_model_name}))||null;["SD 3.5L","SD 3.5M"].includes(this.selectModel)&&h&&(this.formData.related_model_no=h.model_no||"",this.formData.related_model_ver_no=h.model_ver_no||""),this.selectModelDisabled=["sd35_default","flux_default","sd35L_default","sd35M_default"].includes(t.value),this.formData.category=this.setTarinType(),this.setformData()}else this.$message.error("not model config")},handleSelectModel:function(t){var e=this;"MoreModel"!==t?(this.modelList.forEach((function(n){n.model_no===t&&(e.formData.related_model_no=n.model_no,e.formData.related_model_ver_no=n.model_ver_no)})),this.selectModel=t,this.$refs.styleModal.handleClose()):this.$refs.styleModal.openModal()},selectModelHandle:function(t){var e=this;if(this.$refs.styleModal.handleClose(),["",void 0,null].includes(t))this.selectModel="";else{var n=this.modelList.find((function(e){return e.model_no===t.id}));["",void 0,null].includes(n)?(this.modelList.push({name:t.name,model_no:t.id,model_ver_no:t.model_ver_no}),this.formData.related_model_no=t.id,this.formData.related_model_ver_no=t.model_ver_no,this.selectModel=t.id):(this.modelList.length&&this.modelList.forEach((function(n,o){n.model_no===t.id&&(e.modelList[o].model_ver_no=t.model_ver_no)})),this.formData.related_model_no=t.id,this.formData.related_model_ver_no=t.model_ver_no)}}}},E=M,A=(n(2473),Object(m.a)(E,(function(){var t,e,o,r=this,l=r._self._c;return l("div",{directives:[{name:"loading",rawName:"v-loading",value:r.pageLaoding,expression:"pageLaoding"}],staticClass:"loraTrainingEdit hide-scrollbar"},[l("div",{staticClass:"back",style:{top:r.isShowBanner||r.isShowActivityBanner?"150px":null},on:{click:r.goBack}},[l("i",{staticClass:"el-icon-back"})]),r._v(" "),r.formData.meta?l("div",{ref:"main",staticClass:"main"},[l("div",{staticClass:"left"},[l("div",{staticClass:"typeRow cardStyle"},r._l(r.typeList,(function(t,e){return l("div",{key:e,staticClass:"typeRowItem",class:r.typeIndex===t.value?"activateItem":"defItem",on:{click:function(e){return r.changeType(t)}}},["FLUX"===t.name&&r.inFluxActivity?[l("div",{staticClass:"discount flex justify-center items-center"},[l("span",[r._v(r._s(r.$t("disc50")))]),r._v(" "),l("img",{attrs:{src:n(623),width:"12",height:"12",alt:"fire-icon",loading:"lazy"}})])]:r._e(),r._v(" "),l("div",{staticClass:"itemCnt"},["more"!=t.value?l("div",{staticClass:"typeCnt"},[t.url?l("img",{attrs:{src:t.url,alt:""}}):"default"==t.value?l("i",{staticClass:"iconfont icon-zidingyi"}):r._e(),r._v(" "),l("div",{staticClass:"typeName"},[r._v(r._s(t.name))])]):l("span",[r._v(r._s(t.name))])])],2)})),0),r._v(" "),l("div",{staticClass:"typeParamet cardStyle"},[l("div",{staticClass:"typeParamet_tit"},[l("div",{staticClass:"typeParamet_titTxt"},[l("i",{staticClass:"iconfont icon-shezhi1"}),r._v(" "),l("span",[r._v(r._s(r.$t("parameterSetting")))])]),r._v(" "),l("div",{staticClass:"typeParamet_titBnt",on:{click:r.openAdSet}},[r._v(r._s(r.$t("AdvSet")))])]),r._v(" "),l("div",{staticClass:"allStepTip"},[l("i",{staticClass:"el-icon-warning"}),r._v(" "),l("span",[r._v(r._s(r.$t("totalSteps"))+r._s(r.steps))])]),r._v(" "),l("div",{staticClass:"formBox"},[l("div",{staticClass:"formTit"},[l("div",{staticClass:"formTitLeft"},[l("div",[r._v(r._s(r.$t("BaseModel")))])])]),r._v(" "),l("div",{staticClass:"formCnt"},[r.selectModelDisabled?l("el-input",{attrs:{disabled:""},model:{value:r.selectModel,callback:function(t){r.selectModel=t},expression:"selectModel"}}):l("el-select",{staticClass:"train-model-main-item-select",attrs:{value:r.selectModel,"popper-class":"custom-select","popper-append-to-body":!1,placeholder:r.$t("PleaseSelectBaseName")},on:{change:r.handleSelectModel}},[r._l(r.modelList,(function(t,i){return l("el-option",{key:"model_"+(t.name+i),attrs:{label:t.name,value:t.model_no}})})),r._v(" "),l("el-option",{attrs:{label:r.$t("selectMoreModel"),value:"MoreModel"}})],2)],1)]),r._v(" "),l("div",{staticClass:"formBox"},[l("div",{staticClass:"formTit"},[l("div",{staticClass:"formTitLeft"},[l("div",[r._v(r._s(r.$t("singleCount")))]),r._v(" "),l("span",[r._v("Repeat")])])]),r._v(" "),l("div",{staticClass:"formCnt"},[l("el-slider",{attrs:{"show-input":"","show-input-controls":!1,"show-tooltip":!1,min:1,max:50},model:{value:r.formData.meta.repeat,callback:function(t){r.$set(r.formData.meta,"repeat",t)},expression:"formData.meta.repeat"}})],1)]),r._v(" "),l("div",{staticClass:"formBox",staticStyle:{"margin-bottom":"18px"}},[l("div",{staticClass:"formTit"},[l("div",{staticClass:"formTitLeft"},[l("div",[r._v(r._s(r.$t("numberCycles")))]),r._v(" "),l("span",[r._v("Epoch")])])]),r._v(" "),l("div",{staticClass:"formCnt"},[l("el-slider",{attrs:{"show-input":"","show-input-controls":!1,"show-tooltip":!1,min:1,max:20},model:{value:r.formData.meta.epoch,callback:function(t){r.$set(r.formData.meta,"epoch",t)},expression:"formData.meta.epoch"}})],1)]),r._v(" "),l("div",{staticClass:"formBox"},[l("div",{staticClass:"formTit"},[l("div",{staticClass:"formTitLeft"},[l("div",[r._v(r._s(r.$t("ModelPrompt")))]),r._v(" "),l("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:r.$t("ModelPromptTip"),placement:"top"}},[l("i",{staticClass:"el-icon-warning"})])],1)]),r._v(" "),r.formData.meta.text_to_img?l("div",{staticClass:"formCnt"},[l("el-input",{attrs:{type:"textarea",rows:2,placeholder:r.$t("pleaseEnte"),resize:"none"},model:{value:r.formData.meta.text_to_img.prompt,callback:function(t){r.$set(r.formData.meta.text_to_img,"prompt",t)},expression:"formData.meta.text_to_img.prompt"}})],1):r._e()])])]),r._v(" "),l("div",{staticClass:"right cardStyle"},[l("div",{staticClass:"trainBtn"},[null!==(t=r.$route)&&void 0!==t&&null!==(t=t.query)&&void 0!==t&&t.dataSetNo?r._e():l("div",{staticClass:"tranEdit"},[null!==(e=r.$route)&&void 0!==e&&null!==(e=e.query)&&void 0!==e&&e.id?l("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:r.$t("Delete"),placement:"top"}},[l("div",{directives:[{name:"loading",rawName:"v-loading",value:r.isLoading,expression:"isLoading"}],staticClass:"tranEditBtn",on:{click:r.onDelete}},[l("i",{staticClass:"iconfont icon-shanchu3"})])]):r._e(),r._v(" "),l("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:r.$t("SaveImage"),placement:"top"}},[l("div",{directives:[{name:"loading",rawName:"v-loading",value:r.isLoading,expression:"isLoading"}],staticClass:"tranEditBtn",on:{click:function(t){return r.onSave(!1)}}},[l("i",{staticClass:"iconfont icon-baocun"})])])],1),r._v(" "),l("div",{staticClass:"formSubBox"},[l("div",{directives:[{name:"loading",rawName:"v-loading",value:r.isLoading,expression:"isLoading"}],staticClass:"formSub",on:{click:function(t){return r.onSave(!0)}}},[l("div",[r._v(r._s(r.$t("trainNow")))]),r._v(" "),l("div",[l("span",[r._v(r._s(r.$t("PhysicalExertion"))+" "+r._s(r.EtdCost))]),r._v(" "),l("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:r.$t("trainNowTip"),placement:"top"}},[l("i",{staticClass:"el-icon-warning"})])],1)]),r._v(" "),1==r.defConfig.activity_code||r.inFluxActivity&&"flux_default"===r.typeIndex?l("div",{staticClass:"logBox"},[l("img",{attrs:{src:n(745),alt:""}}),r._v(" "),l("div",[r._v(r._s(r.$t("disc50")))])]):r._e()])]),r._v(" "),l("el-tabs",{model:{value:r.activeName,callback:function(t){r.activeName=t},expression:"activeName"}},[l("el-tab-pane",{attrs:{label:r.$t("trainingDataset"),name:"training"}},[l("div",{staticClass:"trainName"},[l("div",{staticClass:"namelabel"},[r._v(r._s(r.$t("datasetName"))+"：")]),r._v(" "),l("input",{directives:[{name:"model",rawName:"v-model",value:r.formData.name,expression:"formData.name"}],attrs:{type:"text",placeholder:r.$t("datasetName")},domProps:{value:r.formData.name},on:{input:function(t){t.target.composing||r.$set(r.formData,"name",t.target.value)}}})]),r._v(" "),l("TrainUploadImgBox",{ref:"TrainUploadImgBox",attrs:{isShowActivityBanner:r.isShowActivityBanner,defConfig:null===(o=r.defConfig[r.typeIndex.startsWith("sd35")?"sd35_default":r.typeIndex])||void 0===o?void 0:o.train_model_crop_tag,type:r.typeIndex},on:{triggerChaneg:function(t){return r.formData.trigger_words=[t]},changeUploadType:function(t){return r.formData.mode=t}},model:{value:r.formData.meta.images,callback:function(t){r.$set(r.formData.meta,"images",t)},expression:"formData.meta.images"}})],1),r._v(" "),l("el-tab-pane",{attrs:{label:r.$t("regularDataset"),name:"regular"}},[l("UploadImageItem",{attrs:{category:32},on:{clearAll:function(t){r.formData.meta.reg_images=[]}},model:{value:r.formData.meta.reg_images,callback:function(t){r.$set(r.formData.meta,"reg_images",t)},expression:"formData.meta.reg_images"}})],1)],1)],1)]):r._e(),r._v(" "),l("style-modal",{ref:"styleModal",attrs:{"model-type":"Checkpoint",inTask:!0,isSDXL:"sdxl_default"==r.typeIndex,SDXLmodel:["SDXL 1.0","Pony"],SDmodel:["SD 1.5"]},on:{selectModel:r.selectModelHandle}}),r._v(" "),r.formData.meta?l("TarinAdvSet",{ref:"advset",attrs:{defData:r.defConfig[r.typeIndex],type:r.typeIndex,config:r.defConfig.config},model:{value:r.formData.meta,callback:function(t){r.$set(r.formData,"meta",t)},expression:"formData.meta"}}):r._e()],1)}),[],!1,null,"278312eb",null));e.default=A.exports},3267:function(t,e,n){"use strict";n.r(e);n(9),n(7),n(11),n(12),n(8),n(4),n(6);var o=n(3),r=n(2),l=(n(14),n(20),{data:function(){return{currentIndex:0,handleCate:!1,screenheight:"0px",dialogVisible:!1}},props:{workFlowData:{type:Object,default:function(){return{}}}},computed:{},mounted:function(){var t=this;this.$nextTick((function(){var e=document.querySelector(".work-content");t.screenheight=e.offsetHeight-160+"px",t.handleCate=t.hasScrolled(t.$refs.category)}))},methods:{changePic:function(t){this.currentIndex=t,this.$refs.carousel.setActiveItem(t)},hasScrolled:function(t){return t.scrollWidth>t.clientWidth},handleClose:function(){this.dialogVisible=!1},handleSwiper:function(t){this.currentIndex=t},goPage:function(){this.$logEvent("log_actions",{operation:"enter_comfyui",behavior_info:"on_comfyui_detail_page"}),this.$parent.goPage()},handleNode:function(){this.$logEvent("log_actions",{operation:"click_view_node",behavior_info:"on_comfyui_detail_page"}),this.dialogVisible=!0}}}),c=(n(2877),n(0)),d=Object(c.a)(l,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"WorkFlowCon"},[e("div",{staticClass:"work-content"},[e("div",{staticClass:"top"},[e("div",{staticClass:"left flex"},[e("span",{staticClass:"flex comfy",on:{click:t.goPage}},[e("i",{staticClass:"iconfont icon-jinru"}),t._v(" "),e("span",[t._v(t._s(t.$t("comfyui_enter"))+" ComfyUI")])]),t._v(" "),e("span",{staticClass:"node",on:{click:t.handleNode}},[e("i",{staticClass:"iconfont icon-icon_jiedian"}),t._v(" "),e("span",[t._v(t._s(t.$t("comfyui_node"))+" ("+t._s(t.workFlowData.node_num)+")")])])]),t._v(" "),e("div",{staticClass:"right"},[1!==t.workFlowData.type?e("span",[e("span",{staticClass:"status"}),t._v(" "),e("span",[t._v(t._s(t.$t("comfyui_status")))])]):t._e()])]),t._v(" "),e("div",{staticClass:"swiper-box"},[e("el-carousel",{ref:"carousel",attrs:{height:t.screenheight,autoplay:!1,"indicator-position":"none"},on:{change:t.handleSwiper}},t._l(t.workFlowData.samples,(function(t,n){return e("el-carousel-item",{key:n,staticClass:"swiper-item"},[2===t.type?e("video",{staticClass:"video",attrs:{src:t.url,controls:!0}}):e("img",{staticClass:"pic",attrs:{src:t.url}})])})),1)],1),t._v(" "),e("div",{ref:"category",staticClass:"workflow-category",class:{cateFlex:t.handleCate}},t._l(t.workFlowData.samples,(function(n,o){return e("div",{key:o,staticClass:"list",class:{active:t.currentIndex===o},on:{click:function(e){return t.changePic(o)}}},[2===n.type?e("video",{staticClass:"video",attrs:{src:n.url,controls:!1}}):e("img",{attrs:{src:n.url}})])})),0),t._v(" "),e("el-dialog",{attrs:{title:t.$t("comfyui_node"),visible:t.dialogVisible,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{staticClass:"node-box"},t._l(t.workFlowData.node_group,(function(n,o){return e("div",{key:o,staticStyle:{"margin-bottom":"16px"}},[e("p",{staticStyle:{"font-size":"16px"}},[t._v(t._s(n.title+"（"+n.nodes.length+"）"))]),t._v(" "),t._l(n.nodes,(function(n){return e("p",{key:n.value},[t._v("\n            "+t._s(n.value)+"\n          ")])}))],2)})),0)])],1)])}),[],!1,null,"5c39609a",null).exports,h=(n(10),n(18),n(50),n(48),n(29),n(142),n(143),n(112),n(134)),m=(n(16),n(1)),v=n(33);n(24);function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function _(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var y={name:"AuthorInfo",mixins:[v.a],props:{activeImg:{type:Object,default:function(){return{}}},type:{type:String,default:"work"}},watch:{appealShow:{handler:function(t){t||(this.appeaData={obj_no:"",obj_type:1,remark:""})}}},computed:_(_(_({},Object(m.e)("user",["userInfo"])),Object(m.c)("payment",["paymentInfo"])),{},{inviteCode:function(){return this.userInfo.invite_user_code},determineSelfWork:function(){var t,e;return(null==this||null===(t=this.activeImg)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id)==(null===(e=this.userInfo)||void 0===e?void 0:e.id)}}),data:function(){return{popovervisible:!1,appealShow:!1,appeaData:{obj_no:"",obj_type:1,remark:""}}},methods:{getPersonalInfoUrl:function(){var t,e,n=(null===(t=this.activeImg)||void 0===t||null===(t=t.author)||void 0===t?void 0:t.id)||"",o=(null===(e=this.userInfo)||void 0===e?void 0:e.id)||"",path="/user/"+encodeURIComponent(n);return o==n&&(path="/personal"),path},jumpToOtherUser:function(){var path=this.getPersonalInfoUrl();this.$router.push(this.localePath(path))},openAppealShow:function(){this.appeaData.obj_no=this.activeImg.id,this.appealShow=!0,this.popovervisible=!1},share:function(){var t,e,n={work:"/explore/detail/",model:"/models/detail/",imgGather:"/artWorkDetail/",video:"/video/"}[this.type]||"/explore/detail/",o=null===(t=this.$route)||void 0===t||null===(t=t.params)||void 0===t?void 0:t.id,r=this.localePath("".concat(n).concat(o,"?u_code=").concat(this.inviteCode)),l="".concat(window.location.origin).concat(r),c=null===(e=this.activeImg)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.url;this.$refs.inviteDialog.show(l,c)},handleMark:function(){this.isLoggedIn?this.setCollectData(this.activeImg).includes("collect_selected")&&this.setCollect(this.activeImg,"artwork"):this.$EventBus.$emit("openLoginDialog")},hidePopover:function(){this.popovervisible=!1},handleFollow:function(){var t;if(this.isLoggedIn){var e=(null===(t=this.activeImg)||void 0===t?void 0:t.type)||this.type;e="string"==typeof e?e.toUpperCase():"";var n=["CHECKPOINT","LORA"].includes(e.toUpperCase())?this.activeImg.type:this.type;this.setFollow(this.activeImg,n)}else this.$EventBus.$emit("openLoginDialog")}}},w=(n(2878),Object(c.a)(y,(function(){var t,e,n,o,r,l,c,d,h,m=this,v=m._self._c;return v("div",{staticClass:"author flex"},[null!==(t=m.activeImg)&&void 0!==t&&t.author?v("div",{staticClass:"left flex"},[v("div",{staticClass:"head",style:{"background-color":null!==(e=m.activeImg)&&void 0!==e&&null!==(e=e.author)&&void 0!==e&&e.head?"transparent":"#ADB8CD"},on:{click:m.jumpToOtherUser}},[null!==(n=m.activeImg)&&void 0!==n&&null!==(n=n.author)&&void 0!==n&&n.head?v("img",{directives:[{name:"webp",rawName:"v-webp",value:m.$imgL,expression:"$imgL"}],staticClass:"avatar",attrs:{src:null===(o=m.activeImg)||void 0===o||null===(o=o.author)||void 0===o?void 0:o.head,alt:"avatar"}}):v("div",{staticClass:"letter"},[m._v("\n          "+m._s(null!==(r=m.activeImg)&&void 0!==r&&r.author.name?null===(l=m.activeImg)||void 0===l?void 0:l.author.name[0].toUpperCase():null===(c=m.activeImg)||void 0===c?void 0:c.author.id[0].toUpperCase())+"\n        ")])]),m._v(" "),v("div",{staticClass:"name",on:{click:m.jumpToOtherUser}},[v("a",{staticClass:"personal-info-a",attrs:{href:m.getPersonalInfoUrl(),rel:"nofollow"},on:{click:function(t){t.preventDefault()}}},[m._v("\n          "+m._s((null===(d=m.activeImg)||void 0===d?void 0:d.author.name)||(null===(h=m.activeImg)||void 0===h?void 0:h.author.id))+"\n        ")])])]):m._e(),m._v(" "),v("div",{staticClass:"right"},[m.determineSelfWork?m._e():v("el-button",{staticClass:"follow",attrs:{loading:m.followLoading},on:{click:m.handleFollow}},[m._v("\n        "+m._s("followed"==m.setFollowData(m.activeImg)?m.$t("Followed"):m.$t("Follow"))+"\n      ")])],1)])}),[],!1,null,"2eb29d0b",null).exports),C=n(39),k=n(425),x=n(5),O=n(56),$=n(343),D=n(25);function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function I(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var T={data:function(){return{dotReportInfo:{category:"default",view_domain:"details_one",batch_id:""},downloadFlag:!0,isMoreDec:!1,handleMoreSize:!1,formatNumberForeign:x.i}},props:{workFlowData:{type:Object,default:function(){return{style:{background:"none"},stat:{}}}}},mixins:[v.a],watch:{workFlowData:function(t){var e=this;setTimeout((function(){var t=document.querySelector(".defDesc");e.handleMoreSize=(null==t?void 0:t.offsetHeight)>44}),500)}},components:{cmtComments:h.a,WorkFLowAuthor:w,CollectPopover:O.a,Evaluate:$.a},computed:I(I({},Object(m.c)("user",["isLoggedIn","userInfo"])),{},{filterXss:function(){return function(t){return D.default.prototype.xss(t)}},original:function(){var t;return 1===(null===(t=this.workFlowData.permission)||void 0===t?void 0:t.source)}}),mounted:function(){},methods:{followUser:function(){this.setFollow(this.workFlowData)},getExpiryTime:function(){var t;return Object(C.h)(null===(t=this.workFlowData)||void 0===t?void 0:t.update_at,"yyyy-MM-dd hh:mm:ss")},goPage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$logEvent("log_actions",{operation:"click_working",behavior_info:"on_comfyui_detail_page"}),"create"===t&&this.$logEvent("log_actions",{operation:"click_create_works",behavior_info:"on_comfyui_template_detail_page"}),this.$parent.goPage()},handleStars:function(){},handleDonwload:function(){var t=this;if(this.$logEvent("log_actions",{operation:"click_download",behavior_info:"on_comfyui_detail_page"}),this.downloadFlag){if(2===this.workFlowData.permission.download)return this.$message.warning(this.$t("isDownload"));this.downloadFlag=!1,setTimeout((function(){t.downloadFlag=!0}),2e3),Object(k.c)({template_id:this.workFlowData.id}).then((function(e){t.handleBold(e.data)}))}},handleBold:function(data){var t=new Blob([data.data],{type:"application/json"}),e=URL.createObjectURL(t),n=document.createElement("a");n.href=e,n.download=data.file_name,n.click()},handleMark:function(){this.$logEvent("log_actions",{operation:"click_collect",behavior_info:"on_comfyui_detail_page"}),this.isLoggedIn?this.setCollectData(this.workFlowData).includes("collect_selected")?(this.$refs.collectPopover.visible=!1,this.setCollect(this.workFlowData,"workflow")):this.$refs.collectPopover.visible=!0:this.$EventBus.$emit("openLoginDialog")},toggleCmt:function(){this.isMoreDec=!this.isMoreDec}}},j=T,L=(n(2879),Object(c.a)(j,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"RightParams"},[t.workFlowData.id?e("cmtComments",{ref:"cmtComments",attrs:{infos:t.workFlowData,type:13,dotReportInfo:t.dotReportInfo},scopedSlots:t._u([{key:"cmtInner",fn:function(){var n,o,r,l;return[e("div",{staticClass:"content"},[e("div",{staticClass:"line-1"},[e("h1",{staticClass:"title"},[t._v(t._s(t.workFlowData.name))]),t._v(" "),e("div",{staticClass:"work-create",on:{click:function(e){return t.goPage("create")}}},[t._v(t._s(t.$t("Remix")))])]),t._v(" "),t.workFlowData.id?e("Evaluate",{attrs:{evaluateData:t.workFlowData}}):t._e(),t._v(" "),e("div",{staticClass:"original"},[e("div",{staticClass:"type"},[e("svg-icon",{staticStyle:{"font-size":"14px"},attrs:{"icon-class":t.original?"modelOriginal":"modelReship"}}),t._v(" "),e("div",{staticClass:"txt"},[t._v(t._s(t.$t(t.original?"Original":"Reship")))])],1),t._v(" "),e("p",{staticClass:"date"},[t._v(t._s(t.getExpiryTime())+" "+t._s(t.$t("renew")))])]),t._v(" "),e("div",{staticClass:"author_box"},[e("div",{staticClass:"cell"},[e("WorkFLowAuthor",{attrs:{type:"comfy",activeImg:t.workFlowData}})],1)]),t._v(" "),e("div",{staticClass:"line-2"}),t._v(" "),e("div",{staticClass:"operate"},[e("div",{staticClass:"statBox"},[e("div",{staticClass:"stat-item",on:{click:t.goPage}},[e("div",{staticClass:"stat-item-text"},[t._v(t._s(t.$t("Runs")))]),t._v(" "),e("div",{staticClass:"stat-item-num flex justify-between"},[e("span",[t._v(t._s(t.formatNumberForeign((null===(n=t.workFlowData)||void 0===n||null===(n=n.stat)||void 0===n?void 0:n.num_of_task)||0)))]),t._v(" "),e("div",{staticClass:"stat-btn btn-create"},[e("i",{staticClass:"iconfont icon-play"})])])]),t._v(" "),e("div",{staticClass:"stat-item",on:{click:function(e){return e.stopPropagation(),t.handleMark.apply(null,arguments)}}},[e("div",{staticClass:"stat-item-text"},[t._v(t._s(t.$t("Collect")))]),t._v(" "),e("div",{staticClass:"stat-item-num flex justify-between"},[e("span",[t._v(t._s(t.formatNumberForeign((null===(o=t.workFlowData)||void 0===o||null===(o=o.stat)||void 0===o?void 0:o.num_of_collection)||0)))]),t._v(" "),e("div",{staticClass:"stat-btn btn-collect"},[e("CollectPopover",{ref:"collectPopover",attrs:{hideBtn:!0,type:"workflow",folder:t.workFlowData}},[e("div",{staticClass:"bntItem collectBnt"},[e("i",{staticClass:"iconfont",class:t.setCollectData(t.workFlowData)})])])],1)])]),t._v(" "),e("div",{staticClass:"stat-item",on:{click:t.handleDonwload}},[e("div",{staticClass:"stat-item-text"},[t._v(t._s(t.$t("Download")))]),t._v(" "),e("div",{staticClass:"stat-item-num flex justify-between"},[e("span",[t._v(t._s(t.formatNumberForeign((null===(r=t.workFlowData)||void 0===r||null===(r=r.stat)||void 0===r?void 0:r.num_of_download)||0)))]),t._v(" "),e("div",{staticClass:"stat-btn btn-download"},[e("i",{staticClass:"iconfont icon-icon_xiazai",staticStyle:{"font-size":"12px"}})])])])])]),t._v(" "),e("div",{staticClass:"tagList"},t._l(t.workFlowData.categories,(function(n,o){return e("span",{key:o,staticClass:"tag"},[t._v(t._s(n.name))])})),0),t._v(" "),t.workFlowData.desc?e("div",{staticClass:"defDesc",class:[t.isMoreDec?"moreDec":"desc"],domProps:{innerHTML:t._s(t.filterXss(null===(l=t.workFlowData)||void 0===l?void 0:l.desc))}}):t._e(),t._v(" "),t.handleMoreSize?e("div",{staticClass:"descMore",on:{click:t.toggleCmt}},[e("span",[t._v(t._s(t.isMoreDec?t.$t("PackUp"):t.$t("more")))]),t._v(" "),e("i",{staticClass:"el-icon-arrow-down"})]):t._e()],1)]},proxy:!0}],null,!1,3086656448)}):t._e()],1)}),[],!1,null,"edaede40",null)),P=L.exports,M=n(211);function E(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var A={name:"workFlowDetail",data:function(){return{workFlowData:{}}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?E(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(m.e)("user",["userInfo"])),components:{WorkFlowCon:d,RightParams:P,BackIcon:M.a},methods:{goPage:function(){var t,e,source=(null===(t=this.userInfo)||void 0===t?void 0:t.id)===(null===(e=this.workFlowData.author)||void 0===e?void 0:e.id)?3:4,path="/workflow?id="+this.workFlowData.id+"&source="+source+"&source_id="+this.workFlowData.id;this.$router.push(this.localePath({path:path}))}},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,c,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,t.app,o=t.params,r=t.error,l=o.id,e.prev=2,e.next=5,n.$post("/api/v1/creativity/square/template/detail",{template_id:l});case 5:return c=e.sent,(data=c.data).style={background:"none"},e.abrupt("return",{workFlowData:data||{}});case 11:e.prev=11,e.t0=e.catch(2),console.log("工作流详情页-> asyncData错误啦：",e.t0),r({statusCode:404,message:e.t0});case 15:case"end":return e.stop()}}),e,null,[[2,11]])})))()},head:function(){var t=this.workFlowData.name,title="".concat(t," | ComfyUI Workflow"),desc=this.$t("comfyUiDetailDesc",{name:t});return{title:title,meta:[{hid:"description",name:"description",content:desc},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:desc}]}}},N=A,R=(n(2880),Object(c.a)(N,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"workFlow"},[e("back-icon"),t._v(" "),t.workFlowData.id?e("WorkFlowCon",{attrs:{workFlowData:t.workFlowData}}):t._e(),t._v(" "),e("RightParams",{attrs:{workFlowData:t.workFlowData}})],1)}),[],!1,null,"317e17c7",null));e.default=R.exports},3268:function(t,e,n){"use strict";n.r(e);n(9),n(7),n(11),n(12),n(8),n(4),n(6);var o=n(2),r=n(1),l=(n(28),n(66)),c={name:"PhotoSelector",props:{initIndex:{type:Number,default:0}},components:{},watch:{initIndex:{handler:function(t){this.selectIndex=t}}},computed:{currentItem:function(){return this.goodsList[this.selectIndex]}},data:function(){return{goodsList:[{id:"ai_photo_20",num:20,price:19.99},{id:"ai_photo_40",num:40,price:29.99},{id:"ai_photo_80",num:80,price:39.99}],selectIndex:this.initIndex}},mounted:function(){this.getGoodsList()},methods:{getGoodsList:function(){var t=this;Object(l.d)().then((function(e){var n,o;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&(t.goodsList=null==e||null===(o=e.data)||void 0===o?void 0:o.list,t.$emit("select-item",t.currentItem.id))}))},selectItem:function(t,e){this.selectIndex=e,this.$emit("select-item",t.id)}}},d=(n(3195),n(0)),h=Object(d.a)(c,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"photo-selector"},[e("div",{staticClass:"head-title"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t("chargePhotoDltTitle")))]),t._v(" "),e("div",{staticClass:"sub-title"},[t._v(t._s(t.$t("chargePhotoDltSubTitle")))])]),t._v(" "),e("div",{staticClass:"select-container"},t._l(t.goodsList,(function(n,o){return e("div",{key:n.id+o,staticClass:"select-item",class:{active:t.selectIndex===o},on:{click:function(e){return t.selectItem(n,o)}}},[e("div",{staticClass:"indicator"},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.selectIndex===o,expression:"selectIndex === index"}],staticClass:"el-icon-check"})]),t._v(" "),e("div",{staticClass:"numbers-and-price"},[e("div",{staticClass:"numbers"},[t._v(t._s(t.$t("ImgsNumber",{num:n.num})))]),t._v(" "),e("div",{staticClass:"price"},[t._v("US$"+t._s(n.price)+" "+t._s(t.$t("payOneTime")))])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:o>0,expression:"index > 0"}],staticClass:"float-tag"},[t._v("\n        "+t._s(1===o?t.$t("mostSelect"):t.$t("bestValue"))+"\n      ")])])})),0),t._v(" "),t._t("default")],2)}),[],!1,null,"0e48b8dc",null).exports,m=(n(14),n(3)),v=(n(20),n(16),n(32),n(10),n(18),n(50),n(48),n(29),n(559)),f=n(5);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var w=n(291),C={name:"PaymentPhoto",inject:["top"],props:{initMount:{type:Boolean,default:!1},defaultThirdType:{type:[Number,String],default:9},disabledMethods:{type:Array,default:function(){return[]}},goodsId:{type:[Number,String],default:""},isFreeTry:{type:Boolean,default:!1},showFreeTry:{type:Boolean,default:!0},purchParams:{type:Object,default:function(){return{}}},upgrade:{type:[Number,Boolean],default:0},isSubscription:{type:Boolean,default:!0},btnLabel:{type:String,default:""},backToCheck:{type:Boolean,default:!1},from:{type:String,default:""},dom:{validator:function(t){return t instanceof HTMLDivElement},default:null}},components:{PaymentCheck:v.a},watch:{inPaymentForm:function(t){t&&this.$emit(t)}},computed:y(y(y({},Object(r.e)("payment",["paymentInfo","adyenFailed","adyenPaymenMethods"])),Object(r.e)("user",["userInfo"])),{},{$isChinaSite:function(){return!1},showBack:function(){return!0},allMethods:function(){var t=this,e=[{name:"Credit Card",i18n:"Credit Card",newWindow:!1,icon:"adyen-icon.png",type:9},{name:"AliPay",i18n:"alipay",newWindow:!1,icon:"alipay-icon.png",type:9},{name:"Google Pay",i18n:"Google Pay",newWindow:!1,icon:"googlepay-icon.png",type:9},{name:"PIX",i18n:"PIX",newWindow:!0,icon:"pix-icon.png",type:1},{name:"Paypal",i18n:"Paypal",newWindow:!0,icon:"paypal-icon.png",type:10}];return this.disabledMethods.length&&(e=e.filter((function(e){return!t.disabledMethods.includes(e.type)}))),this.isShowPayermax||(e=e.filter((function(t){return 1!==t.type}))),this.useTry&&(e=e.filter((function(t){return![1,10].includes(t.type)}))),this.isShowAlipay||(e=e.filter((function(t){return"AliPay"!==t.name}))),this.upgrade&&this.defaultThirdType&&(e=e.filter((function(e){return e.type===t.defaultThirdType})),8===this.defaultThirdType&&this.$message.warning(this.$t("bandStripe"))),e},creditCard:function(){return this.allMethods.find((function(t){return"Credit Card"===t.name}))},trueUpgrade:function(){var t;return 2===(null===(t=this.paymentInfo)||void 0===t?void 0:t.purchaseType)&&this.upgrade},btnTxt:function(){return this.isSubscription?"SubscribeNow":"businesSwiperBtn1"},isYahoo:function(){var t;return null===(t=this.userInfo)||void 0===t||null===(t=t.adv_platform)||void 0===t?void 0:t.includes("yahoo")},isShowBillingAddress:function(){var t,e=null===(t=this.userInfo)||void 0===t?void 0:t.current_country_code;return["US","UK","GB","CA"].includes(e)},isShowAlipay:function(){var t;return"CN"===(null===(t=this.userInfo)||void 0===t?void 0:t.current_country_code)},isShowPayermax:function(){var t;return"BR"===(null===(t=this.userInfo)||void 0===t?void 0:t.current_country_code)},isBindAdyen:function(){var t;return null===(t=this.userInfo)||void 0===t?void 0:t.bind_adyen},defaultThirdItem:function(){var t=this;if(this.defaultThirdType){if("string"==typeof this.defaultThirdType)return this.allMethods.find((function(e){return e.name===t.defaultThirdType}));if("number"==typeof this.defaultThirdType)return this.allMethods.find((function(e){return e.type===t.defaultThirdType}))}return this.creditCard||this.allMethods[0]}}),data:function(){return{AdyenCheckout:null,activeMethod:null,selectAdyenMethod:{brands:["visa","mc","cup","jcb"],name:"Credit Card",type:"scheme"},thirdOrderId:"",adyenComponent:null,adyenComponent2:null,adyenTempAction:null,adyenTempPayment:null,inPaymentForm:"in-form",qrCode:null,wechatBtnLoading:!1,wechatBtnDisabled:!1,useTry:!1,backToClose:!1,inCreating:!1,resultMethod:null}},mounted:function(){var t=this;if(this.loadAdyenCheckout(),Object(f.w)("https://cdn.jsdelivr.net/npm/@adyen/adyen-web@latest/dist/adyen.css"),this.useTry=this.isFreeTry&&"mall"!==this.from,this.adyenPaymenMethods||this.getAdyenPaymentMethod(),this.initMount){var e=this.allMethods.find((function(e){var n;return e.name===(null===(n=t.defaultThirdItem)||void 0===n?void 0:n.name)}));e||(e=this.creditCard),this.resultMethod=this.allMethods.find((function(t){return"Google Pay"===t.name})),e&&this.selectMethod(e)}},methods:y(y(y({},Object(r.b)("payment",["getPaymentInfo","setAdyenFailed","setSubThirdType","getAdyenPaymentMethod"])),Object(r.b)("user",["getAccountInfo"])),{},{loadAdyenCheckout:function(){var t=this;return Object(m.a)(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.e(22).then(n.t.bind(null,4282,7));case 3:o=e.sent,t.AdyenCheckout=o.default,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to load Adyen Checkout:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},initPayments:function(){var t=this;return Object(m.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.adyenPaymenMethods){e.next=3;break}return e.next=3,t.getAdyenPaymentMethod();case 3:case"end":return e.stop()}}),e)})))()},handleBack:function(){console.log("handleBack",this.inPaymentForm,this.backToClose),"in-waiting"===this.inPaymentForm&&(this.$refs.paymentCheck.getPaymentOnce(),this.$refs.paymentCheck.stopPoll()),this.backToCheck?this.$emit("in-pay-back"):("in-form"===this.inPaymentForm&&(this.resultMethod=this.allMethods.find((function(t){return"Google Pay"===t.name}))),"in-waiting"!==this.inPaymentForm||this.backToClose?(this.qrCode=null,this.$emit("in-pay-back"),this.$refs.paymentCheck.stopPoll()):this.inPaymentForm="in-form")},selectMethod:function(t){var e=t;"string"==typeof t&&(e=this.allMethods.find((function(i){return i.name===t})),this.resultMethod=e),console.log("selectMethod",e,this.adyenPaymenMethods),this.activeMethod=e,9===e.type&&this.startCheckout()},startCheckout:function(){var t=this;return Object(m.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("dom",t.dom),e.next=3,t.initPayments();case 3:return(o=null===(n=t.adyenPaymenMethods)||void 0===n?void 0:n.paymentMethods)&&(t.selectAdyenMethod=o.find((function(e){return e.name===t.activeMethod.name}))),console.log("this.selectAdyenMethod",t.selectAdyenMethod,t.AdyenCheckout),e.next=8,t.loadAdyenCheckout();case 8:if(t.AdyenCheckout&&t.selectAdyenMethod){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,t.createAdyenCheckout();case 12:r=e.sent,t.adyenComponent=r.create("scheme",{hasHolderName:!0,holderNameRequired:!0,billingAddressRequired:t.isShowBillingAddress}),t.adyenComponent2=r.create("googlepay",{hasHolderName:!0,holderNameRequired:!0,billingAddressRequired:t.isShowBillingAddress,buttonType:"short",buttonColor:"white",buttonLocale:t.$i18n.locale||"en"}),t.adyenComponent.mount(t.$refs["adyen".concat(t.selectAdyenMethod.type)]),t.dom&&t.adyenComponent2.mount(t.dom);case 17:case"end":return e.stop()}}),e)})))()},createAdyenCheckout:function(){var t=this;return Object(m.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={locale:t.$i18n.locale,clientKey:"production".includes("production")?"live_Q2TOAFSMXNDDZIHVMRZZ3DRK2MGQQ6OX":"test_W6R5OPPNSJG2HNO2ZJ5DNOUORIJJY53E",environment:"production".includes("production")?"production":"test",showPayButton:!0,paymentMethodsResponse:t.adyenPaymenMethods,onPaymentCompleted:function(t,component){console.log("onPaymentCompleted result: "+t)},onSubmit:function(){var e=Object(m.a)(regeneratorRuntime.mark((function e(n,component){var o,r,l,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("onSubmit:",n,component),t.adyenTempPayment=null==n||null===(o=n.data)||void 0===o?void 0:o.paymentMethod,p={adyen_payment_method:t.adyenTempPayment,browser_info:null==n||null===(r=n.data)||void 0===r?void 0:r.browserInfo,origin:null==n||null===(l=n.data)||void 0===l?void 0:l.origin},e.next=5,t.purchaseGoodsFun(9,y({},p));case 5:console.log("onSubmit: 创建完订单 adyenTempAction",t.adyenTempAction,"thirdOrderId",t.thirdOrderId),t.adyenTempAction&&component.handleAction(t.adyenTempAction);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),onAdditionalDetails:function(e,component){var n;console.log("onAdditionalDetails:",e,component);var o=(null==e||null===(n=e.data)||void 0===n||null===(n=n.details)||void 0===n?void 0:n.threeDSResult)||"";o&&t.checkThreeDResult(o)},onError:function(e,component){console.error("onError:",e.name,e.message,e.stack,component),t.reRenderAdyen()}},console.log("configuration",n),e.abrupt("return",new t.AdyenCheckout(n));case 3:case"end":return e.stop()}}),e)})))()},reRenderAdyen:function(){this.adyenComponent.unmount(),this.adyenComponent.mount(this.$refs["adyen".concat(this.selectAdyenMethod.type)])},purchaseGoodsFun:function(){var t=arguments,e=this;return Object(m.a)(regeneratorRuntime.mark((function n(){var o,r,c,d,h,m,v,f,_;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(c=t.length>0&&void 0!==t[0]?t[0]:9,d=t.length>1&&void 0!==t[1]?t[1]:{},!e.inCreating){n.next=4;break}return n.abrupt("return");case 4:if(e.$refs.paymentCheck.stopPoll(),!e.upgrade){n.next=9;break}if(!e.trueUpgrade){n.next=9;break}return e.setUpgrade(c),n.abrupt("return");case 9:if([6,8,9].includes(c)&&1!==(null===(o=e.paymentInfo)||void 0===o?void 0:o.purchaseType)&&e.isSubscription){if(m=l.n,h=y(y({cp_product_id:e.goodsId,with_trial:e.useTry,change_type:1,third_plat_type:c},e.purchParams),d),8===(null===(v=e.activeMethod)||void 0===v?void 0:v.type)){h.client_reference_id="";try{(_=Rewardful&&(null===(f=Rewardful)||void 0===f?void 0:f.referral)||"")&&(h.client_reference_id=_)}catch(t){console.log("Rewardful, error",t)}}}else m=l.m,h=y(y({cp_product_id:e.goodsId,os:"1",quantity:1,third_plat_type:c},e.purchParams),d);return(null==e||null===(r=e.top)||void 0===r?void 0:r.dotFrom)&&(h.from=e.top.dotFrom),5===c&&(e.wechatBtnLoading=!0),e.$emit("in-loading",!0),e.inCreating=!0,n.next=16,m(h).then((function(t){var n,o=t.data,r=o.PaymentUrl,l=o.ThirdOrderId,d=o.AdyenAction;if(9===(null===(n=e.activeMethod)||void 0===n?void 0:n.type)&&d){var h=JSON.parse(d),m=h.action,v=h.merchantReference;m?e.adyenTempAction=m:v?(e.thirdOrderId=v,e.$emit("check-payment-status",{type:9,order_id:v}),e.showWaitPayment()):console.log("create error, no action or merchantReference")}else if(r&&5!==c){e.thirdOrderId=l;var f=window.screen.height/2-300,_=window.screen.width/2-400;e.showWaitPayment(),window.open(r,"newWindow","height=600,width=800,top=".concat(f,",left=").concat(_))}else 5===c?(e.thirdOrderId=l,e.wechatBtnLoading=!1,e.wechatBtnDisabled=!0,setTimeout((function(){e.wechatBtnDisabled=!1}),3e5),e.appendQrCode(r)):console.log("create error, no PaymentUrl or AdyenAction")})).catch((function(t){var n;console.error("purchaseGoodsFun:",t),"Credit Card"===(null===(n=e.activeMethod)||void 0===n?void 0:n.name)&&(e.setAdyenFailed(),e.reRenderAdyen())})).finally((function(){e.inCreating=!1,e.$emit("in-loading",!1)}));case 16:case"end":return n.stop()}}),n)})))()},checkThreeDResult:function(t){var e=this,n={three_ds_result:t,adyen_payment_method:this.adyenTempPayment};Object(l.a)(n).then((function(t){var n;if(1e4===(null==t||null===(n=t.status)||void 0===n?void 0:n.code)){var o=t.data.order_id;e.thirdOrderId=o,e.$emit("check-payment-status",{type:9,order_id:o}),e.showWaitPayment()}})).catch((function(t){console.log("checkThreeDs error",t),e.reRenderAdyen()}))},setUpgrade:function(t){var e,n=this;if(8!=t){var o={change_type:1,cp_product_id:null==this?void 0:this.goodsId,third_plat_type:t};(null==this||null===(e=this.top)||void 0===e?void 0:e.dotFrom)&&(o.from=this.top.dotFrom),Object(l.o)(o).then((function(t){var e=t.data,o=e.PaymentUrl;e.ThirdOrderId;o?window.open(o):(n.$message.success(n.$t("OperateSuccess")),n.$refs.paymentCheck.paySuccess())}))}else this.$message.warning(this.$t("bandStripe"))},paymentSuccess:function(){this.saveSubType(this.activeMethod.type),this.$emit("pay-success"),this.inPaymentForm="in-form",this.isYahoo},paymentError:function(t){var e=t.type;this.inPaymentForm="in-form",9===e&&this.reRenderAdyen()},saveSubType:function(t){var e,n;1!==(null===(e=this.paymentInfo)||void 0===e?void 0:e.purchaseType)&&this.isSubscription&&this.setSubThirdType(t),"Credit Card"===(null===(n=this.activeMethod)||void 0===n?void 0:n.name)&&this.getAccountInfo()},showWaitPayment:function(){this.inPaymentForm="in-waiting"},appendQrCode:function(t){var e=this;this.$refs.QRCodeContainer[0].innerHTML="",this.$nextTick((function(){var n=e.$refs.QRCodeContainer[0];e.qrCode=new w(n,{text:t,width:85,height:85}),e.$refs.paymentCheck.pollGetPaymentStatus(5)}))}})},k=C,x=(n(3196),n(3197),Object(d.a)(k,(function(){var t,e,n,o,r=this,l=r._self._c;return l("div",{staticClass:"payment-content"},[r.$slots.default?l("div",{staticClass:"close-icon flex-center",on:{click:r.handleBack}},[l("i",{staticClass:"el-icon-close",class:{waiting:"in-waiting"===r.inPaymentForm}})]):r._e(),r._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:"in-form"===r.inPaymentForm,expression:"inPaymentForm === 'in-form'"}],staticClass:"in-payment-content w-full flex"},[l("div",{staticClass:"left"},[l("div",{directives:[{name:"show",rawName:"v-show",value:r.showBack,expression:"showBack"}],staticClass:"back-to",on:{click:r.handleBack}},[l("i",{staticClass:"el-icon-arrow-left"}),r._v(r._s(r.$slots.default?r.$t("changePlan"):r.$t("Back"))+"\n      ")]),r._v(" "),r.activeMethod&&!r.$isChinaSite?l("div",{staticClass:"payment-form flex items-center"},[l("div",{directives:[{name:"show",rawName:"v-show",value:"Credit Card"===(null===(t=r.activeMethod)||void 0===t?void 0:t.name),expression:"activeMethod?.name === 'Credit Card'"}],ref:"adyenscheme",staticClass:"adyen-payment w-full"}),r._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:"AliPay"===(null===(e=r.activeMethod)||void 0===e?void 0:e.name),expression:"activeMethod?.name === 'AliPay'"}],ref:"adyenalipay",staticClass:"alipay-payment w-full"}),r._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:"Google Pay"===(null===(n=r.activeMethod)||void 0===n?void 0:n.name),expression:"activeMethod?.name === 'Google Pay'"}],ref:"adyengooglepay",staticClass:"googlepay-payment w-full"}),r._v(" "),l("div",{directives:[{name:"show",rawName:"v-show",value:9!==(null===(o=r.activeMethod)||void 0===o?void 0:o.type),expression:"activeMethod?.type !== 9"}],staticClass:"other-payment flex items-center w-full"},[l("div",{staticClass:"other-payment-btn w-full",on:{click:function(t){var e;return r.purchaseGoodsFun(null===(e=r.activeMethod)||void 0===e?void 0:e.type)}}},[r._v("\n            "+r._s(r.btnLabel?r.$t(r.btnLabel):r.$t(r.btnTxt))+"\n          ")])])]):r._e()]),r._v(" "),r.$slots.default?l("div",{staticClass:"right"},[r._t("default")],2):r._e()]),r._v(" "),l("payment-check",{directives:[{name:"show",rawName:"v-show",value:"in-waiting"===r.inPaymentForm,expression:"inPaymentForm === 'in-waiting'"}],ref:"paymentCheck",attrs:{activeMethod:r.resultMethod,thirdOrderId:r.thirdOrderId},on:{success:r.paymentSuccess,paymentError:r.paymentError,back:r.handleBack}})],1)}),[],!1,null,"733a814c",null).exports);function O(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function $(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?O(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var D={name:"PhotoImage",props:{},computed:$($({},Object(r.e)("user",["cdnHost"])),{},{backgroundImage:function(){return{backgroundImage:"url(https://".concat(this.cdnHost,"/static/upload/20241115/07e3651b-02c5-41f5-8886-042baf706b20.jpg)")}}}),data:function(){return{}},created:function(){},mounted:function(){},methods:{}};n(3198);function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function I(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var T={name:"AiPhotoPayment",provide:function(){return{top:this}},data:function(){return{isShowDialog:!1,isNewUser:!0,step:"inGoods",goodsId:"",defaultThirdType:0,useFree:!1,btnLabel:"",dotFrom:"ai_profile_popup",taskId:"",styleNumber:0,renderDOM:null,successCallback:null}},components:{PhotoSelector:h,PaymentPhoto:x,PhotoImage:Object(d.a)(D,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"right-image",style:t.backgroundImage},[e("div",{staticClass:"container"},[e("div",{staticClass:"text"},[e("div",{staticClass:"title"},[t._v("\n        "+t._s(t.$t("payPhotoTitle"))+"\n      ")]),t._v(" "),e("ul",{staticClass:"benefit"},[e("li",[t._v(t._s(t.$t("payPhotoSub1")))]),t._v(" "),e("li",[t._v(t._s(t.$t("payPhotoSub2")))])])])])])}),[],!1,null,"76c49b54",null).exports},mounted:function(){var t=this;this.$EventBus.$on("openAIPhotoPayment",(function(e,n,o){console.log("openAIPhotoPayment",e,n),t.taskId=e,t.styleNumber=n,t.isShowDialog=!0,t.successCallback=o,t.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"on_ai_profile_generation_popup",behavior_info_sub:"pop_1"}),t.$nextTick((function(){t.renderGooglePay()}))}))},beforeDestroy:function(){this.$EventBus.$off("openAIPhotoPayment")},computed:I(I(I(I(I({},Object(r.c)("payment",["paymentInfo"])),Object(r.c)("user",["isLoggedIn","isCompanyAccount"])),Object(r.e)("user",["cdnHost"])),Object(r.e)("payment",["subThirdType"])),{},{imgUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20241115/07e3651b-02c5-41f5-8886-042baf706b20.jpg")},initIndex:function(){return this.styleNumber<=4?0:this.styleNumber<=7?1:2}}),methods:I(I({},Object(r.b)("payment",["getSubUrlAndThirdType"])),{},{renderGooglePay:function(){this.renderDOM=this.$refs.adyengooglepay,console.log("renderDOM",this.renderDOM,this.$refs.paymentPhoto),this.$refs.paymentPhoto.startCheckout(this.renderDOM)},close:function(){this.isShowDialog=!1},quitPay:function(){this.step="inGoods"},selectPayment:function(t){console.log("name",t),this.$refs.paymentPhoto.selectMethod(t),this.step="inPay",this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"on_ai_profile_generation_popup",behavior_info_sub:"pop_2"})},handleSuccess:function(){this.successCallback&&this.successCallback(),this.isShowDialog=!1,this.step="inGoods"}})},j=(n(3199),Object(d.a)(T,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"ai-photo-payment-dialog flex-center",attrs:{visible:t.isShowDialog,"destroy-on-close":!0,"append-to-body":!0,"close-on-click-modal":!1},on:{"update:visible":function(e){t.isShowDialog=e}}},[e("PhotoSelector",{directives:[{name:"show",rawName:"v-show",value:"inGoods"===t.step,expression:"step === 'inGoods'"}],attrs:{initIndex:t.initIndex},on:{"select-item":function(e){t.goodsId=e}}},[e("div",{staticClass:"payment-methods flex w-full justify-center"},[e("div",{staticClass:"credit-card btn",on:{click:function(e){return t.selectPayment("Credit Card")}}},[t._v("Credit Card")]),t._v(" "),e("div",{ref:"adyengooglepay",staticClass:"google-pay btn"})])]),t._v(" "),e("PaymentPhoto",{directives:[{name:"show",rawName:"v-show",value:"inPay"===t.step,expression:"step === 'inPay'"}],ref:"paymentPhoto",attrs:{defaultThirdType:"Credit Card",dom:t.renderDOM,disabledMethods:[1,4,5,8,10],initMount:!0,isSubscription:!1,upgrade:!1,goodsId:t.goodsId,purchParams:{task_id:t.taskId},btnLabel:t.btnLabel},on:{"in-waiting":function(e){t.step="inPay"},"in-pay-back":t.quitPay,"pay-success":t.handleSuccess}},[e("PhotoImage")],1),t._v(" "),"inGoods"===t.step?e("div",{staticClass:"left"},[e("div",{staticClass:"close-icon flex-center",on:{click:t.close}},[e("i",{staticClass:"el-icon-close"})]),t._v(" "),e("PhotoImage")],1):t._e()],1)}),[],!1,null,"023141f6",null));e.default=j.exports},3269:function(t,e,n){"use strict";n.r(e);n(9),n(7),n(11),n(12),n(8),n(4),n(6);var o=n(3),r=n(2),l=(n(20),n(16),n(23),n(37),n(71),n(335)),c=n(5),d=n(127),h={name:"ScrollWrapper",data:function(){return{scrollOffset:0,itemWidth:200,wrapperWidth:0,contentWidth:0}},computed:{isLeftDisabled:function(){return this.scrollOffset<=0},isRightDisabled:function(){return this.scrollOffset>=this.contentWidth-this.wrapperWidth}},mounted:function(){this.initContentWidth(),window.addEventListener("resize",this.initContentWidth)},unmounted:function(){window.removeEventListener("resize",this.initContentWidth)},methods:{initContentWidth:function(){this.itemWidth=this.$el.querySelector(".scroll-content > *").offsetWidth,this.wrapperWidth=this.$refs.scrollWrapper.offsetWidth;for(var t=this.$refs.scrollContent.children,e=0,i=0;i<t.length;i++)e+=t[i].offsetWidth+16;this.contentWidth=e,this.isRightDisabled&&this.contentWidth>this.wrapperWidth&&(this.scrollOffset=this.contentWidth-this.wrapperWidth)},scrollLeft:function(){this.scrollOffset-=4*(this.itemWidth+16),this.scrollOffset<0&&(this.scrollOffset=0),console.log("this.scrollLeft",this.scrollOffset)},scrollRight:function(){this.scrollOffset+=4*(this.itemWidth+16),this.scrollOffset>this.contentWidth-this.wrapperWidth&&(this.scrollOffset=this.contentWidth-this.wrapperWidth),console.log("this.scrollRight",this.scrollOffset)}}},m=(n(2389),n(0)),v=Object(m.a)(h,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"scroll"},[e("div",{ref:"scrollWrapper",staticClass:"scroll-wrapper"},[e("div",{ref:"scrollContent",staticClass:"scroll-content",style:{transform:"translateX(".concat(-t.scrollOffset,"px)")}},[t._t("default")],2)]),t._v(" "),e("button",{staticClass:"scroll-btn flex justify-center items-center scroll-btn-left",class:{disabled:t.isLeftDisabled},attrs:{disabled:t.isLeftDisabled},on:{click:t.scrollLeft}},[e("i",{staticClass:"el-icon-arrow-left"})]),t._v(" "),e("button",{staticClass:"scroll-btn flex justify-center items-center scroll-btn-right",class:{disabled:t.isRightDisabled},attrs:{disabled:t.isRightDisabled},on:{click:t.scrollRight}},[e("i",{staticClass:"el-icon-arrow-right"})])])}),[],!1,null,"19af3088",null).exports,f=n(519),_=(n(14),n(47),n(19),n(1));function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C={name:"FilterComponent",props:{top:{type:String,default:"70px"},showTitle:{type:Boolean,default:!0},title:{type:String,default:""},showTabs:{type:Boolean,default:!0},showButtons:{type:Boolean,default:!0},showModelType:{type:Boolean,default:!1},showWorkOrModel:{type:Boolean,default:!1},tabs:{type:Array,default:null},exludeTabs:{type:Array,default:function(){return[]}},defaultTab:{type:String,default:"community"},buttons:{type:Array,default:null},excludeButtons:{type:Array,default:function(){return[]}},defaultButton:{type:String,default:"Hot"},isShowHomeTypeSelect:{type:Boolean,default:!1},disable:{type:Boolean,default:!1}},computed:w(w(w({},Object(_.c)("user",["isLoggedIn"])),Object(_.c)("creation",["studioStyle","lab_styles"])),{},{studioRenderList:function(){var t=this;return(this.lab_styles||[]).filter((function(t){return!(null!=t&&t.default)})).map((function(e){var n="labStyle_".concat(e.value.replace(/\s/g,""));return{label:t.$t(n)||e.value,id:e.value}}))},renderBtns:function(){return this.buttons||this.defaultButtons},activeButton:function(){return this.defaultButtons[this.activeIndex]}}),watch:{defaultButton:function(t){this.activeIndex=this.renderBtns.findIndex((function(e){return e.name===t}))||0}},mounted:function(){},data:function(){return{activeIndex:0,defaultButtons:[{name:this.$t("Trending"),value:"trend",icon:"recommend",color:"#8E9CB1",activeColor:"#EF4444"},{name:this.$t("Hot"),value:"hot",icon:"hot",color:"#8E9CB1",activeColor:"#EF4444"},{name:this.$t("New"),value:"new",icon:"new",color:"#8E9CB1",activeColor:"#e9b942"}],selectList:[]}},methods:w(w({},Object(_.d)("app",["setHomeType"])),{},{setDefaultSelectList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.selectList=t||[]},onButtonClick:function(i){this.activeIndex=i;var button=this.defaultButtons[i],t={type:this.activeButton.value,styles:this.selectList||[]};this.$emit("paramsChange",t),this.$logEvent("log_actions",{operation:"click_studio_tags",behavior_info:button.value})},handleChange:function(){var t={type:this.activeButton.value,styles:this.selectList||[]};this.$emit("paramsChange",t)}})},k=C,x=(n(2392),n(2393),Object(m.a)(k,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-studio-filter-component"},[e("el-row",{staticClass:"filter-buttons",class:{"show-buttons":t.showButtons,"not-login":!t.isLoggedIn},attrs:{type:"flex"}},[e("div",{staticClass:"filter-buttons-box"},t._l(t.renderBtns,(function(button,i){return e("button",{key:button.value,staticClass:"filter-button",class:{active:t.activeButton.value===button.value},attrs:{disabled:t.disable},on:{click:function(e){return t.onButtonClick(i)}}},[e("i",{staticClass:"iconfont filter-button-icon",class:"icon-".concat(button.icon)}),t._v(" "),e("span",{staticStyle:{"margin-left":"5px"}},[t._v(t._s(button.name))])])})),0)])],1)}),[],!1,null,"5632d713",null).exports),O=n(24);function $(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function D(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var S={name:"StudioIndex",components:{WaterFallVue:d.a,ScrollWrapper:v,studioImageInfo:f.a,FilterComponent:x},data:function(){return{replaceImageType:c.x,isLock:!1,isReq:!1,queryParam:{page:1,page_size:60,type:"trend"},list:[],studioList:[],debounceMethod:function(){},dotReportInfo:{category:"default",view_domain:"studio",batch_id:""}}},computed:D(D(D({},Object(_.e)("user",["adminOff"])),Object(_.c)("creation",["studioStyle"])),{},{isZhLang:function(){return this.$i18n.locale.startsWith("zh")}}),beforeDestroy:function(){this.debounceMethod=null},mounted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.debounceMethod=Object(O.debounce)(t.handleFilterChange,600),null!==(n=t.$route)&&void 0!==n&&null!==(n=n.query)&&void 0!==n&&n.style_type&&(t.queryParam.styles=null!==(r=t.$route)&&void 0!==r&&null!==(r=r.query)&&void 0!==r&&r.style_type?[null===(l=t.$route)||void 0===l||null===(l=l.query)||void 0===l?void 0:l.style_type]:[],t.$router.replace({path:"/studio",query:{}})),t.getLabStyles(),null!=t&&null!==(o=t.studioStyle)&&void 0!==o&&o.length){e.next=6;break}return e.next=6,t.$store.dispatch("creation/getTaskOptionsInfo");case 6:try{t.$refs.studioFilter.setDefaultSelectList(t.queryParam.styles)}catch(t){}case 7:case"end":return e.stop()}}),e)})))()},methods:D(D({},Object(_.b)("user",["setAdminOff"])),{},{changeAdminOff:function(){-1!==this.adminOff&&this.setAdminOff(1===this.adminOff?0:1)},dialogShow:function(t,e){this.$logEvent("log_actions",{operation:"click_style_on_studio",behavior_info:t.key}),this.$refs.imageInfo.show(e)},handleFilterChange:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.queryParam.type=(null==t?void 0:t.type)||this.queryParam.type,this.queryParam.styles=(null==t?void 0:t.styles)||this.queryParam.styles||[],this.queryParam.page=1,this.isLock=!1,this.getList()},getList:function(t){var e=this;if(!this.isReq&&!this.isLock){this.isReq=!0;var param=Object.assign({},this.queryParam);Object(l.b)(param).then((function(n){var o;if(1e4===(null==n||null===(o=n.status)||void 0===o?void 0:o.code)){var r,l,c;if(e.isLock=!(null!=n&&null!==(r=n.data)&&void 0!==r&&r.has_more),t)e.list=e.list.concat((null==n||null===(l=n.data)||void 0===l?void 0:l.items)||[]);else e.list=[],e.$nextTick((function(){var t;e.list=null==n||null===(t=n.data)||void 0===t?void 0:t.items}));if(e.isReq=!1,1===e.queryParam.page)e.queryParam.time_to=null==n||null===(c=n.data)||void 0===c?void 0:c.time_ms;e.queryParam.page++}else e.isLock=!0})).catch((function(){e.isReq=!1}))}},getLabStyles:function(){var t=this;Object(l.a)().then((function(e){var n,o;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&(t.studioList=(null==e||null===(o=e.data)||void 0===o?void 0:o.items)||[],console.log("所有风格",t.studioList))}))},jumpToStyleList:function(){this.$router.push(this.localePath({path:"/studio/styleList"}))}}),head:function(){return{title:this.$t("StudioTitle"),meta:[{hid:"description",name:"description",content:this.$t("StudioDesc")},{hid:"keywords",name:"keywords",content:this.$t("StudioKeyword")},{hid:"og:title",name:"og:title",content:this.$t("StudioTitle")},{hid:"og:description",name:"og:description",content:this.$t("StudioDesc")}]}},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,t.app,t.params,o=t.error,e.prev=1,e.next=4,n.$post("/api/v1/lab/artwork/list",{page:1,page_size:60,type:"trend"});case 4:return r=e.sent,l=r.data.items,e.abrupt("return",{list:l});case 9:e.prev=9,e.t0=e.catch(1),console.log("广场页-> asyncData错误啦：",e.t0),o({statusCode:404,message:e.t0});case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))()}},I=S,T=(n(2394),Object(m.a)(I,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"studio-index"},[e("el-backtop",{attrs:{bottom:30,right:30}},[e("i",{staticClass:"el-icon-top"})]),t._v(" "),e("div",{staticClass:"content"},[e("div",{staticClass:"title",class:{"s-font":t.isZhLang}},[t._v("\n      "+t._s(t.$t("StudioWorks"))+"\n    ")]),t._v(" "),e("div",{staticClass:"title-box"},[e("filter-component",{ref:"studioFilter",on:{paramsChange:t.debounceMethod}})],1),t._v(" "),e("div",{ref:"wraper",staticClass:"wraper"},[e("WaterFallVue",{ref:"WaterFallVue",attrs:{type:"artwork",cols:5,container:"wraper",list:t.list,lazy:!0,dotReportInfo:t.dotReportInfo,alreadyNoMoreData:t.isLock},on:{load:function(e){return t.getList(!0)}}})],1),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.isReq&&!t.list.length,expression:"!isReq && !list.length"}],staticClass:"no-data-text"},[t._v(t._s(t.$t("no_data")))])]),t._v(" "),e("studioImageInfo",{ref:"imageInfo",attrs:{list:t.studioList}})],1)}),[],!1,null,"36ee6f2c",null));e.default=T.exports},3271:function(t,e,n){"use strict";n.r(e);n(16),n(9),n(11),n(12);var o=n(3),r=n(15),l=n(2),c=(n(20),n(7),n(10),n(14),n(8),n(4),n(6),n(29),n(522)),d=n(41),h=n(132),m=n(1),v=(n(32),n(23),n(79)),f=n(51),_=n(13);function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C={data:function(){var t=this;return{dialogVisible:!1,is_agency_fee:!1,sources:"Original",formData:{},loading:!1,loraSteps:1,recommendList:[],intRmdTag:[],modelName:"",selectArgumentList:[{label:"computingPower",value:1},{label:"diamond",value:2,disabled:!0}],SDList:_.p,sample:"",newRules:{model_name:[{required:!0,message:this.$t("PleaseEnterLORAName")},{validator:function(e,n,o){/^[a-zA-Z0-9\s_\u4e00-\u9fa5.\-]+$/.test(n)?o():o(new Error(t.$t("newModelNameFormatWarn")))}}],ver_name:[{required:!0,message:this.$t("PleaseEnterVer")},{validator:function(e,n,o){/^[a-zA-Z0-9_.-]+$/.test(n)?o():o(new Error(t.$t("ModelVerFormatWarn")))}}],base_model:[{required:!0,message:this.$t("PleaseSelectBaseModel")}]}}},computed:w(w(w({},Object(m.e)("payment",["paymentInfo"])),Object(m.c)("user",["isCompanyAccount"])),{},{isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)||this.isCompanyAccount},checkboxDownload:{get:function(){var t;return 1===(null===(t=this.formData.model_permission)||void 0===t?void 0:t.allow_download)},set:function(t){this.formData.model_permission.allow_download=t?1:2}},checkboxCommercial:{get:function(){var t;return 1===(null===(t=this.formData.model_permission)||void 0===t?void 0:t.allow_commercial_use)},set:function(t){this.formData.model_permission.allow_commercial_use=t?1:2}},checkboxMix:{get:function(){var t;return 1===(null===(t=this.formData.model_permission)||void 0===t?void 0:t.allow_model_mix)},set:function(t){this.formData.model_permission.allow_model_mix=t?1:2}},isCommunity:{get:function(){return 1===this.formData.allow_creation},set:function(t){this.formData.allow_creation=t?1:2}}}),watch:{dialogVisible:{handler:function(t){t||(this.formData={},this.loraSteps=1)}},is_agency_fee:{handler:function(t){t?(this.formData.model_payment.fee=1,this.formData.model_payment.way=1):(this.formData.model_payment.fee=0,this.formData.model_payment.way=0)}}},methods:{commChange:function(t){this.isVip||t||(this.$EventBus.$emit("showBreakDialog","TrainLoraTipWeb","basic"),this.formData.allow_creation=1)},updateCover:function(t){t&&t.url?(this.formData.model_cover.url=null==t?void 0:t.url,this.formData.model_cover.width=null==t?void 0:t.width,this.formData.model_cover.height=null==t?void 0:t.height):this.formData.model_cover={url:"",width:0,height:0}},onNext:function(){this.formData.model_name?this.loraSteps=2:this.$message.error(this.$t("PleaseEnterLORAName"))},setPayNum:function(){var t,e,n;(null===(t=this.formData.model_payment)||void 0===t?void 0:t.fee)<1&&(this.formData.model_payment.fee=1),(null===(e=this.formData.model_payment)||void 0===e?void 0:e.fee)>3&&(this.formData.model_payment.fee=3),this.formData.model_payment.fee=parseInt(null===(n=this.formData.model_payment)||void 0===n?void 0:n.fee)},show:function(t){var e=this;t.id?(this.formData={ver_name:"",base_model:"",model_ver_desc:"",allow_creation:1,trigger_words:[]},this.formData.bind_model_no=t.id,this.loraSteps=2):(this.formData={base_model:"",model_cover:{height:0,width:0,url:""},model_name:"",model_payment:{fee:0,way:1},model_permission:{allow_commercial_use:2,allow_download:2,allow_model_mix:2},model_tags:[],model_ver_desc:"",allow_creation:1,ver_name:"",trigger_words:[]},0==this.recommendList.length&&this.getTagRecommend()),t.base_model&&(this.formData.base_model=t.base_model),this.formData.train_no=t.no,t.trigger_words.forEach((function(t){t&&e.formData.trigger_words})),this.sample=t.cover,this.modelName=t.name,this.dialogVisible=!0},onPub:function(){var t=this;this.$refs.modelForm.validate((function(e){if(e){if(t.formData.model_tags&&t.formData.model_tags.forEach((function(e,n){"string"==typeof e&&(t.formData.model_tags[n]={title:e,id:e})})),t.loading)return;t.loading=!0,Object(h.d)(t.formData).then((function(e){1e4==e.status.code&&(t.$message.success(t.$t("PulishSuccess")),t.dialogVisible=!1,t.$emit("pubSucs"))})).finally((function(){t.loading=!1}))}}))},setIntRmdTag:function(t){var e,n=this;t&&(this.recommendList=[].concat(Object(r.a)(this.intRmdTag),Object(r.a)(null===(e=this.formData)||void 0===e?void 0:e.model_tags.filter((function(t){return!n.intRmdTag.find((function(e){return e.title===t.title}))})))))},getTagRecommend:function(){var t=this;Object(v.j)({size:1e3}).then((function(e){var n;1e4===e.status.code&&(t.intRmdTag=null==e||null===(n=e.data)||void 0===n?void 0:n.items,t.setIntRmdTag(!0))}))},remoteMethod:function(t){var e=this;t&&Object(f.f)({prefix:t,except_num:20,source_type:3}).then((function(t){var n;1e4==t.status.code&&(e.recommendList=[],null==t||null===(n=t.data)||void 0===n||n.items.forEach((function(t){e.recommendList.push({title:t.title,id:t.title})})))}))}}},k=(n(2474),n(2475),n(0));function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var $={data:function(){return{loraData:{},formData:{model_type:"LORA",order_by:"new",page:1,page_size:60,type:"user_original",time_to:0},list:[],dialogVisible:!1,noMoreData:!1,loading:!1}},components:{LoraPub:Object(k.a)(C,(function(){var t,e,o=this,r=o._self._c;return r("el-dialog",{attrs:{visible:o.dialogVisible,"custom-class":"trainDialog",fullscreen:!0},on:{"update:visible":function(t){o.dialogVisible=t}}},[r("div",{staticClass:"LoraPub"},[r("div",{staticClass:"model-edit"},[r("i",{staticClass:"el-icon-error",on:{click:function(t){o.dialogVisible=!1}}}),o._v(" "),r("div",{staticClass:"form-title"},[o._v("\n        "+o._s(1==o.loraSteps?o.$t("LORAEdit"):o.$t("Versions")+o.$t("Edit"))+"\n        "),o.formData.bind_model_no?r("div",{directives:[{name:"loading",rawName:"v-loading",value:o.loading,expression:"loading"}],staticClass:"btn-group"},[r("el-button",{staticClass:"save-btn",attrs:{type:"primary"},on:{click:o.onPub}},[o._v("\n            "+o._s(o.$t("Publish"))+"\n          ")])],1):r("div",{staticClass:"btn-group"},[2==o.loraSteps?r("el-button",{staticClass:"cancel-btn",on:{click:function(t){o.loraSteps=1}}},[o._v("\n            "+o._s(o.$t("PreNext"))+"\n          ")]):o._e(),o._v(" "),1==o.loraSteps?r("el-button",{staticClass:"save-btn",attrs:{type:"primary"},on:{click:o.onNext}},[o._v("\n            "+o._s(o.$t("NextStep"))+"\n          ")]):o._e(),o._v(" "),2==o.loraSteps?r("el-button",{staticClass:"save-btn",attrs:{type:"primary"},on:{click:o.onPub}},[o._v("\n            "+o._s(o.$t("Publish"))+"\n          ")]):o._e()],1)]),o._v(" "),o.dialogVisible?r("div",{staticClass:"edit-form",attrs:{id:"editModelForm"}},[r("el-form",{ref:"modelForm",staticClass:"custom-form",attrs:{"label-position":"top",model:o.formData,rules:o.newRules}},[o.formData.bind_model_no?o._e():r("div",{directives:[{name:"show",rawName:"v-show",value:1==o.loraSteps,expression:"loraSteps == 1"}],staticClass:"formBox"},[r("div",{staticClass:"formCnt"},[r("el-form-item",{attrs:{label:o.$t("LORAName"),required:"",prop:"model_name"}},[r("el-input",{attrs:{placeholder:o.$t("PleaseEnterLORAName"),maxlength:100},model:{value:o.formData.model_name,callback:function(t){o.$set(o.formData,"model_name",t)},expression:"formData.model_name"}})],1),o._v(" "),r("el-form-item",{attrs:{label:o.$t("Type")}},[r("div",{staticClass:"type-select"},[r("span",{class:{active:!1}},[o._v("\n                    CheckPoint\n                  ")]),o._v(" "),r("span",{class:{active:!0}},[o._v("LoRA")])])]),o._v(" "),r("el-form-item",[r("template",{slot:"label"},[o._v("\n                  "+o._s(o.$t("SetTags"))+"\n                ")]),o._v(" "),r("el-select",{staticClass:"show-tag",attrs:{"value-key":"title",multiple:"",filterable:"",remote:"","allow-create":"","popper-class":"show-tag-select","default-first-option":"",placeholder:o.$t("pleaseEnte"),"remote-method":o.remoteMethod},on:{"visible-change":o.setIntRmdTag},model:{value:o.formData.model_tags,callback:function(t){o.$set(o.formData,"model_tags",t)},expression:"formData.model_tags"}},o._l(o.recommendList,(function(t,e){return r("el-option",{key:"tag_".concat(t.id+e),attrs:{label:t.title,value:t}})})),1)],2),o._v(" "),r("el-form-item",{attrs:{label:o.$t("LORASources")}},[r("el-radio-group",{attrs:{disabled:!0},model:{value:o.sources,callback:function(t){o.sources=t},expression:"sources"}},[r("el-radio",{attrs:{label:"Original"}},[o._v(o._s(o.$t("Original")))]),o._v(" "),r("el-radio",{attrs:{label:"Reship"}},[o._v(o._s(o.$t("Reship")))])],1)],1),o._v(" "),r("el-form-item",{attrs:{prop:"cover"}},[r("template",{slot:"label"},[o._v("\n                  "+o._s(o.$t("LORACover"))+"\n                  "),r("p",{staticClass:"form-item-tips"},[o._v("\n                    "+o._s(o.$t("modelCoverDesc",{modelCover:o.$t("LORACover")}))+"\n                  ")])]),o._v(" "),r("SingleImageUpload",{on:{upload:function(t){return o.updateCover(t)}}})],2)],1),o._v(" "),r("div",{staticClass:"formCnt"},[r("el-form-item",{attrs:{label:o.$t("ModelPayment")}},[r("div",{staticClass:"type-select model-payment"},[r("span",{class:{active:!1===o.is_agency_fee},on:{click:function(t){o.is_agency_fee=!1}}},[o._v("\n                    "+o._s(o.$t("Free"))+"\n                  ")]),o._v(" "),r("span",{class:{active:!0===o.is_agency_fee},on:{click:function(t){o.is_agency_fee=!0}}},[o._v("\n                    "+o._s(o.$t("ModelEditPay"))+"\n                  ")])]),o._v(" "),!0===o.is_agency_fee?r("div",{staticClass:"payBox"},[r("div",{staticClass:"payCnt"},[r("div",{staticClass:"payTit"},[o._v(o._s(o.$t("paymentMethod")))]),o._v(" "),r("el-select",{attrs:{"popper-class":"payType"},model:{value:o.formData.model_payment.way,callback:function(t){o.$set(o.formData.model_payment,"way",t)},expression:"formData.model_payment.way"}},o._l(o.selectArgumentList,(function(t){return r("el-option",{key:t.label,attrs:{label:o.$t(t.label),value:t.value,disabled:t.disabled}})})),1)],1),o._v(" "),r("div",{staticClass:"payCnt"},[r("div",{staticClass:"payTit"},[o._v(o._s(o.$t("paymentAmount")))]),o._v(" "),r("div",{staticClass:"inputBox"},[r("input",{directives:[{name:"model",rawName:"v-model.number",value:o.formData.model_payment.fee,expression:"formData.model_payment.fee",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:o.formData.model_payment.fee},on:{blur:[function(t){return o.setPayNum()},function(t){return o.$forceUpdate()}],input:function(t){t.target.composing||o.$set(o.formData.model_payment,"fee",o._n(t.target.value))}}}),o._v(" "),1==(null===(t=o.formData.model_payment)||void 0===t?void 0:t.way)?r("img",{attrs:{src:n(121),alt:""}}):o._e(),o._v(" "),2==(null===(e=o.formData.model_payment)||void 0===e?void 0:e.way)?r("img",{attrs:{src:n(580),alt:""}}):o._e()])])]):o._e()]),o._v(" "),r("el-form-item",[r("template",{slot:"label"},[o._v("\n                  "+o._s(o.$t("ModelPermissions"))+"\n                  "),r("span",{staticClass:"item-tips"},[o._v("("+o._s(o.$t("MultipleChoice"))+")")])]),o._v(" "),r("div",{staticClass:"checkbox-container"},[r("el-checkbox",{model:{value:o.checkboxDownload,callback:function(t){o.checkboxDownload=t},expression:"checkboxDownload"}},[o._v("\n                    "+o._s(o.$t("IsModelDownload"))+"\n                  ")])],1),o._v(" "),r("div",{staticClass:"checkbox-container"},[r("el-checkbox",{model:{value:o.checkboxCommercial,callback:function(t){o.checkboxCommercial=t},expression:"checkboxCommercial"}},[o._v("\n                    "+o._s(o.$t("IsCommercialUse"))+"\n                  ")])],1),o._v(" "),r("div",{staticClass:"checkbox-container"},[r("el-checkbox",{model:{value:o.checkboxMix,callback:function(t){o.checkboxMix=t},expression:"checkboxMix"}},[o._v("\n                    "+o._s(o.$t("IsModelMerging"))+"\n                  ")])],1)],2)],1)]),o._v(" "),2==o.loraSteps?r("div",{staticClass:"formBox"},[r("div",{staticClass:"formCnt"},[r("el-form-item",{attrs:{label:o.$t("Versions")+o.$t("trainName"),required:"",prop:"ver_name"}},[r("div",{staticClass:"VnAddBox"},[r("el-input",{attrs:{value:o.formData.model_name||o.modelName,maxlength:100,disabled:""}}),o._v(" "),r("el-input",{attrs:{placeholder:o.$t("pleaseEnte"),maxlength:10},model:{value:o.formData.ver_name,callback:function(t){o.$set(o.formData,"ver_name",t)},expression:"formData.ver_name"}})],1)]),o._v(" "),r("el-form-item",{attrs:{label:o.$t("BaseModel"),prop:"base_model"}},[r("el-select",{attrs:{"popper-class":"custom-select"},model:{value:o.formData.base_model,callback:function(t){o.$set(o.formData,"base_model",t)},expression:"formData.base_model"}},o._l(o.SDList,(function(t,e){return r("el-option",{key:"SD_"+e,attrs:{label:t,value:t}})})),1)],1),o._v(" "),r("el-form-item",[r("div",{staticClass:"isCommunityBox"},[r("span",[o._v(o._s(o.$t("sameModel")))]),o._v(" "),r("el-switch",{on:{change:o.commChange},model:{value:o.isCommunity,callback:function(t){o.isCommunity=t},expression:"isCommunity"}})],1)]),o._v(" "),r("el-form-item",[r("div",{staticClass:"sample"},[r("div",[o._v(o._s(o.$t("Versions")+o.$t("Work")))]),o._v(" "),r("img",{attrs:{src:o.sample,alt:""}})])])],1),o._v(" "),r("div",{staticClass:"formCnt"},[r("el-form-item",{attrs:{prop:"trigger_words"}},[r("template",{slot:"label"},[o._v("\n                  "+o._s(o.$t("TriggerWords"))+"\n                ")]),o._v(" "),r("el-select",{attrs:{multiple:"",filterable:"","popper-class":"custom-select","allow-create":"","default-first-option":"",placeholder:o.$t("pleaseEnte")},model:{value:o.formData.trigger_words,callback:function(t){o.$set(o.formData,"trigger_words",t)},expression:"formData.trigger_words"}},o._l([],(function(t){return r("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],2),o._v(" "),r("el-form-item",{attrs:{label:o.$t("verIntroduction"),prop:"desc"}},[r("el-input",{attrs:{placeholder:o.$t("pleaseEnte"),maxlength:1e4,"show-word-limit":"",type:"textarea"},model:{value:o.formData.model_ver_desc,callback:function(t){o.$set(o.formData,"model_ver_desc",t)},expression:"formData.model_ver_desc"}})],1)],1)]):o._e()])],1):o._e()])])])}),[],!1,null,"796b0394",null).exports},watch:{dialogVisible:{handler:function(t){t?0==this.list.length&&this.getList():(this.noMoreData=!1,this.formData.page=0,this.list=[])}}},methods:{show:function(t,e,n){this.loraData=t,e&&(this.loraData.trigger_words=e),n&&(this.loraData.base_model=n),this.dialogVisible=!0},openPub:function(t){var e=O(O({},t),this.loraData);this.dialogVisible=!1,e.id?this.$router.push({path:this.localePath("/modelEditStep"),query:{id:e.id,verId:e.no,verNo:e.model_ver_no,train:"yes",base_model:this.loraData.base_model}}):this.$router.push({path:this.localePath("/modelEditStep"),query:{verId:e.no,verNo:e.model_ver_no,train:"yes",base_model:this.loraData.base_model}})},getList:function(){var t=this;this.loading||this.noMoreData||(this.loading=!0,Object(d.r)(this.formData).then((function(e){var n;1e4==e.status.code&&((n=t.list).push.apply(n,Object(r.a)(e.data.items)),t.formData.page++,t.formData.time_to=e.data.time_ms,e.data.has_more||(t.noMoreData=!0))})).finally((function(){t.loading=!1})))},checkLoadMore:function(){var t=this.$refs.list,e=t.scrollTop,n=t.scrollHeight;e+t.clientHeight>=n-300&&this.getList()}}},D=(n(2476),Object(k.a)($,(function(){var t=this,e=t._self._c;return e("div",[e("el-dialog",{attrs:{title:t.$t("releaseName"),visible:t.dialogVisible,width:"885px",top:"10vh","custom-class":"trainDialog"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"list",staticClass:"LoraDialogList",on:{scroll:t.checkLoadMore}},[e("div",{staticClass:"listItem",on:{click:t.openPub}},[e("div",{staticClass:"tipCnt"},[e("i",{staticClass:"iconfont icon-xinjianLoRA"}),t._v(" "),e("span",[t._v(t._s(t.$t("pubLora1")))])])]),t._v(" "),t._l(t.list,(function(n,o){var r;return e("div",{key:"list"+o,staticClass:"listItem",on:{click:function(e){return t.openPub(n)}}},[e("img",{attrs:{src:null===(r=n.banner)||void 0===r?void 0:r.url,alt:""}}),t._v(" "),e("div",{staticClass:"name"},[t._v(t._s(n.name))]),t._v(" "),e("div",{staticClass:"itemHover"},[e("div",{staticClass:"tipCnt"},[e("i",{staticClass:"iconfont icon-tianjiabanbenhao"}),t._v(" "),e("span",[t._v(t._s(t.$t("pubLora2")))])])])])}))],2)]),t._v(" "),e("LoraPub",{ref:"LoraPub",on:{pubSucs:function(e){return t.$emit("pubSucs")}}})],1)}),[],!1,null,"39d4ae78",null).exports),S=n(523),I=n(2477);function T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function j(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var L={components:{imgDet:c.a,LoraDialogList:D,TarinAdvSet:S.a},computed:j(j({},Object(m.c)("payment",["paymentInfo"])),{},{trainOk:function(){return 3==this.trainStatus},reverseList:function(){return Object(r.a)(this.loraList).filter((function(t){return t.cover})).reverse()},percentSteps:function(){return parseInt(this.progData.cur_steps/this.progData.steps*100)+"%"},isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)||this.isCompanyAccount},checkeAll:function(){return this.checkList.length==this.loraList.length&&3==this.trainStatus},currentVipLevel:function(){var t=["Member","ToB_beginnerPlan","StandardPlan","ToB_professionalPlan","MasterPlan"][this.paymentInfo.productLevel]||"",e="basic";return t&&(["Member","ToB_beginnerPlan","StandardPlan"].includes(t)&&(e="professional"),["ToB_professionalPlan"].includes(t)&&(e="MasterPlan")),e},isShowVipTip:function(){var t=["Member","ToB_beginnerPlan","StandardPlan","ToB_professionalPlan","MasterPlan"][this.paymentInfo.productLevel]||"";return t&&"MasterPlan"!==t}}),data:function(){return{openChart:!1,checkList:[],loraList:[],loraCharts:[],trainStatus:-1,pageLoading:!0,progTimes:null,progData:{},stopLoading:!1,saveLoading:!1,downLoading:!1,intChart:null,hashrate:0,prompt:"",triggerWords:"",dataSetNo:"",intMeta:{},baseModel:"",chartOption:{grid:{show:!0,left:"3%",right:"4%",bottom:"3%",containLabel:!0,backgroundColor:"rgba(0,0,0,0)"},title:{text:"loss/average",textStyle:{color:"#ffffff"}},tooltip:{trigger:"axis",formatter:function(t){var e=t[0].name;return"LoRA "+(t[0].dataIndex+1)+": Step: "+e+", loss: "+t[0].value}},xAxis:{type:"category",data:[]},yAxis:{type:"value"},series:[{name:"loss",data:[],type:"line",smooth:!0}]}}},mounted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(n=t.$route)&&void 0!==n&&null!==(n=n.query)&&void 0!==n&&n.id){e.next=3;break}return t.errBack(),e.abrupt("return");case 3:t.getDet();case 4:case"end":return e.stop()}}),e)})))()},beforeDestroy:function(){clearTimeout(this.progTimes)},methods:{handleOpenVip:function(){this.$logEvent("log_actions",{operation:"click_upgrade",behavior_info:"on_model_train_page"});var t;t="professional"===this.currentVipLevel?"NoExpireTimeTipWeb1":"NoExpireTimeTipWeb2";var e=this.currentVipLevel;this.$EventBus.$emit("showBreakDialog",t,e,!0)},onDownLoad:function(){var t=this;0!=this.checkList.length&&(this.downLoading||(this.downLoading=!0,Object(h.e)({train_result_no:this.checkList[0].no}).then((function(t){1e4==t.status.code&&window.open(t.data.url,"_blank")})).finally((function(){t.downLoading=!1})),this.$logEvent("log_actions",{operation:"click_download_train_lora",behavior_info:"ton_training_detail_page",behavior_info_sub:this.checkList[0].no})))},opTrainPage:function(t){var path="/loraTrainingEdit";t?this.$logEvent("log_actions",{operation:"click_new_train",behavior_info:"on_train_result_page",behavior_info_sub:"train_model_result_no"}):(path="/loraTrainingEdit?id="+this.dataSetNo,this.$logEvent("log_actions",{operation:"click_retrain",behavior_info:"on_train_result_page",behavior_info_sub:"train_model_result_no"})),window.open(path,"_blank")},loraSave:function(){var t=this;if(0!=this.checkList.length)if(this.checkList[0].is_saved)this.$message(this.$t("newTrainDet13"));else if(!this.saveLoading){this.saveLoading=!0;var e={train_result_nos:[this.checkList[0].no]};Object(h.j)(e).then((function(e){1e4==e.status.code&&(t.$message(t.$t("newTrainDet15")),t.loraList.forEach((function(n,i){t.checkList[0].no==n.no&&(t.$set(t.loraList[i],"is_saved",!0),t.$set(t.loraList[i],"result",{model_no:e.data.model_nos[0]}))})),t.checkList=[],t.loraList.forEach((function(e,n){t.$set(t.loraList[n],"isCheck",!1)})))})).finally((function(){t.saveLoading=!1})),this.$logEvent("log_actions",{operation:"click_release_train_lora",behavior_info:"ton_training_detail_page",behavior_info_sub:this.checkList[0].no})}},loraPublish:function(){var t,e;0!=this.checkList.length?this.checkList[0].is_saved?null!==(t=this.checkList[0].result)&&void 0!==t&&t.model_no?this.$router.push(this.localePath("/models/detail/"+(null===(e=this.checkList[0].result)||void 0===e?void 0:e.model_no))):this.$message(this.$t("newTrainDet13")):this.$refs.LoraDialogList.show(this.checkList[0],this.triggerWords,this.baseModel):this.$message(this.$t("newTrainDet14"))},pubSucs:function(t){var e=this;this.loraList.forEach((function(t,n){t.isCheck&&e.$set(e.loraList[n],"is_saved",!0)}))},onCheckeAll:function(){var t=this,e=!1;this.checkList.length<this.loraList.length?(this.checkList=JSON.parse(JSON.stringify(this.loraList)),e=!0):this.checkList=[],this.loraList.forEach((function(n,o){t.$set(t.loraList[o],"isCheck",e)})),console.log(this.checkList)},checkSelect:function(t){var e,n=this;this.loraList.forEach((function(e,o){o!=t&&n.$set(n.loraList[o],"isCheck",!1)})),(null===(e=this.checkList[0])||void 0===e?void 0:e.no)==this.loraList[t].no?this.checkList=[]:this.checkList=[this.loraList[t]],this.$set(this.loraList[t],"isCheck",!this.loraList[t].isCheck),console.log(this.checkList)},openChartChange:function(){var t=this;this.openChart&&this.$refs.chartBox&&this.$nextTick(Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.intChart){e.next=6;break}return console.log(t.$refs.chartBox),e.next=4,Object(I.a)();case 4:n=e.sent,t.intChart=n.init(t.$refs.chartBox);case 6:t.chartOption.xAxis.data=[],t.chartOption.series[0].data=[],t.loraCharts&&t.loraCharts.length>0&&t.loraCharts.forEach((function(e){t.chartOption.xAxis.data.push(e.step),t.chartOption.series[0].data.push(e.loss)})),t.intChart.setOption(t.chartOption);case 10:case"end":return e.stop()}}),e)}))))},formatTime:function(t){var e=Math.floor(t/3600),n=Math.floor(t%3600/60),o=t%60;return this.pad(e)+":"+this.pad(n)+":"+this.pad(o)},pad:function(t){return t<10?"0"+t:t},opStop:function(){var t;this.stopLoading||(this.stopLoading=!0,Object(h.k)({train_model_no:null===(t=this.$route)||void 0===t||null===(t=t.query)||void 0===t?void 0:t.id}).then((function(t){t.status.code})).finally((function(){})),this.$logEvent("log_actions",{operation:"click_stop_training",behavior_info:"ton_training_detail_page"}))},getDet:function(){var t,e=this;Object(h.g)({train_model_no:null===(t=this.$route)||void 0===t||null===(t=t.query)||void 0===t?void 0:t.id}).then((function(t){var n,o;1e4==t.status.code&&(e.trainStatus=t.data.status,e.prompt=t.data.prompt,t.data.meta&&(e.intMeta=t.data.meta),e.loraCharts=(null===(n=t.data)||void 0===n?void 0:n.loss_charts)||[],e.openChartChange(),e.dataSetNo=t.data.data_set_no,3==e.trainStatus?(e.loraList=(null===(o=t.data)||void 0===o?void 0:o.loras)||[],e.loraList.forEach((function(t,n){e.$set(e.loraList[n],"isCheck",!1),e.$set(e.loraList[n],"curProcess",0)})),e.hashrate=t.data.hashrate,e.triggerWords=t.data.trigger_words,e.baseModel=t.data.base_model,e.pageLoading=!1,e.stopLoading=!1):1==e.trainStatus||2==e.trainStatus?e.progTimes||e.getTrainModelProgress():(e.pageLoading=!1,e.errBack()))})).catch((function(){e.pageLoading=!1}))},getTrainModelProgress:function(){var t,e=this;clearTimeout(this.progTimes),Object(d.E)({ids:[null===(t=this.$route)||void 0===t||null===(t=t.query)||void 0===t?void 0:t.id]}).then((function(t){if(1e4==t.status.code){if(e.progData=t.data.items[0],e.trainStatus=e.progData.state,0==e.loraList.length)for(var i=1;i<=e.progData.epoch;i++)e.loraList.push({resultNo:""});e.progData.result_nos&&e.progData.result_nos.forEach((function(t,n){e.loraList[n]&&!e.loraList[n].no&&(e.loraList[n].resultNo=t)}));var n=!1;if(e.loraList.forEach((function(t,o){t.resultNo&&(n=!0,Object(h.i)({train_result_no:t.resultNo}).then((function(t){if(1e4==t.status.code){var n=j({},t.data);n.isCheck=!1,e.$set(e.loraList,o,n)}})))})),n&&e.getDet(),e.progData.estimate_hashrate&&(e.hashrate=e.progData.estimate_hashrate),e.loraList[e.progData.cur_epoch-1])e.progData.cur_process&&e.$set(e.loraList[e.progData.cur_epoch-1],"curProcess",e.progData.cur_process),e.$refs.listItem[e.progData.cur_epoch-1].scrollIntoView({behavior:"smooth",block:"center"});1==e.trainStatus||2==e.trainStatus?e.progTimes=setTimeout((function(){e.getTrainModelProgress()}),1e4):3==e.trainStatus?(clearTimeout(e.progTimes),e.getDet()):4!=e.trainStatus&&5!=e.trainStatus||(clearTimeout(e.progTimes),e.$alert(e.$t("newTrainingCompletederr"),e.$t("Tip"),Object(l.a)({confirmButtonText:e.$t("Confirm"),callback:function(t){}},"callback",(function(t){}))))}else e.progTimes=setTimeout((function(){e.getTrainModelProgress()}),1e4)})).catch((function(){e.progTimes=setTimeout((function(){e.getTrainModelProgress()}),1e4)})).finally((function(){e.pageLoading=!1}))},errBack:function(){clearTimeout(this.progTimes),this.$alert(this.$t("newTrainDet2"),this.$t("Tip"),Object(l.a)({confirmButtonText:this.$t("Confirm"),callback:function(t){}},"callback",(function(t){})))}}},P=(n(2478),n(2479),Object(k.a)(L,(function(){var t,e,o=this,r=o._self._c;return r("div",{staticClass:"loraTrainingDet"},[r("div",{staticClass:"main"},[r("div",{staticClass:"left"},[-1!==o.trainStatus?r("div",{staticClass:"progBox"},[r("div",{staticClass:"progTxt"},["waiting"===o.progData.state_desc?["waiting_push"===o.progData.state_sub_desc?[r("div",{staticClass:"progTxt-2"},[o._v(o._s(o.$t("waiteLoading")))])]:o._e(),o._v(" "),"waiting_train"===o.progData.state_sub_desc?[o.progData.queue_position?r("div",{staticClass:"progTxt-2"},[o._v(o._s(o.$t("upgradeLoading",{current:null===(t=o.progData)||void 0===t?void 0:t.queue_position,total:null===(e=o.progData)||void 0===e?void 0:e.queue_total})))]):o._e(),o._v(" "),o.isShowVipTip?r("div",{staticClass:"update-tips",on:{click:o.handleOpenVip}},[r("img",{attrs:{src:n(397),alt:"seaArtVip"}}),o._v(" "),r("p",[o._v(o._s(o.$t("upgrade")))])]):o._e()]:o._e()]:[r("div",[o._v(o._s(2===o.trainStatus?o.$t("TrainingIng"):4===o.trainStatus||5===o.trainStatus?o.$t("newTrainDet2"):o.$t("Completed")))]),o._v(" "),2===o.trainStatus?[r("span",[o._v(o._s(o.$t("newTrainDet1")))]),o._v(" "),o.progData.id?r("span",[o._v(o._s(o.formatTime(o.progData.time_left)))]):o._e()]:o._e()]],2),o._v(" "),2===o.trainStatus&&o.progData.id?r("div",{staticClass:"progBar"},[r("div",{staticClass:"progItem",style:{width:o.progData.process+"%"}}),o._v(" "),r("div",{staticClass:"progBarInfo"},[o._v("\n            "+o._s("steps: ".concat(o.progData.cur_steps,"/").concat(o.progData.steps," (").concat(o.percentSteps,")   loss : ").concat(o.progData.loss,"  epoch: ").concat(o.progData.cur_epoch,"/").concat(o.progData.epoch))+"\n          ")])]):o._e()]):o._e(),o._v(" "),r("div",{staticClass:"trainDet"},[r("div",{staticClass:"detTop"},[o.progData.id?r("div",{staticClass:"detTopLeft"},[r("span",[o._v("LoRA")]),o._v(" "),r("span",[o._v(o._s("".concat(o.progData.cur_epoch,"/").concat(o.progData.epoch)))])]):r("div"),o._v(" "),r("div",{staticClass:"detTopRight"},[r("div",{staticClass:"topItem",staticStyle:{cursor:"pointer"},on:{click:function(t){return o.$refs.advset.show()}}},[r("i",{staticClass:"iconfont icon-eye"}),o._v(" "),r("span",[o._v(o._s(o.$t("trainParamete")))])]),o._v(" "),r("div",{staticClass:"topLine"}),o._v(" "),r("div",{staticClass:"topItem"},[r("span",[o._v(o._s(o.$t("newTrainDet3")))]),o._v(" "),r("el-switch",{on:{change:o.openChartChange},model:{value:o.openChart,callback:function(t){o.openChart=t},expression:"openChart"}})],1)])]),o._v(" "),r("div",{staticClass:"detCnt"},[r("div",{directives:[{name:"loading",rawName:"v-loading",value:o.pageLoading,expression:"pageLoading"},{name:"show",rawName:"v-show",value:!o.openChart,expression:"!openChart"}],staticClass:"detList"},o._l(o.loraList,(function(t,e){return r("div",{key:"imgs"+e,ref:"listItem",refInFor:!0,staticClass:"listItem"},[t.cover?r("div",{staticClass:"loraBox",on:{click:function(t){return o.checkSelect(e)}}},[r("img",{attrs:{src:t.cover,alt:""}}),o._v(" "),r("div",{staticClass:"loraCheck"},[r("el-checkbox",{model:{value:t.isCheck,callback:function(e){o.$set(t,"isCheck",e)},expression:"item.isCheck"}})],1),o._v(" "),r("div",{staticClass:"loraNmae"},[o._v("LoRA "+o._s(t.num))]),o._v(" "),r("div",{staticClass:"loraZG"})]):r("div",{staticClass:"listProgBox"},[r("div",{staticClass:"listProg"},[r("div",{staticClass:"progLine"}),o._v(" "),r("el-progress",{attrs:{type:"circle",percentage:t.curProcess,width:52,"stroke-width":2,"text-color":"#FFFFFF","define-back-color":"rgba(155, 155, 155, 0)"}})],1)])])})),0),o._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:o.openChart,expression:"openChart"}]},[r("div",{ref:"chartBox",staticClass:"chartBox"}),o._v(" "),r("div",{staticClass:"minLoraList"},o._l(o.loraList,(function(t,e){return r("div",{key:"imgs"+e,staticClass:"minLoraItem",class:{minLoraItemActivate:t.isCheck},on:{click:function(t){return o.checkSelect(e)}}},[o._m(0,!0),o._v(" "),r("span",[o._v("LoRA "+o._s(t.num))])])})),0)])]),o._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:o.isVip,expression:"isVip"}],staticClass:"detBottom",style:{opacity:o.trainOk?1:.5}},[o.trainOk?o._e():r("div",{staticClass:"detBottomZg"}),o._v(" "),r("div",{staticClass:"detBottomLeft"}),o._v(" "),r("div",{staticClass:"detBottomRight"},[r("div",{directives:[{name:"loading",rawName:"v-loading",value:o.downLoading,expression:"downLoading"}],staticClass:"detBottomBtn",style:{opacity:0==o.checkList.length?.5:1},on:{click:o.onDownLoad}},[r("i",{staticClass:"iconfont icon-icon_xiazai"}),o._v(" "),r("span",[o._v(o._s(o.$t("Download")))])]),o._v(" "),r("div",{directives:[{name:"loading",rawName:"v-loading",value:o.saveLoading,expression:"saveLoading"}],staticClass:"detBottomBtn",style:{opacity:0==o.checkList.length?.5:1},on:{click:o.loraSave}},[r("i",{staticClass:"iconfont icon-baocun"}),o._v(" "),r("span",[o._v(o._s(o.$t("Save")))])])])])])]),o._v(" "),r("div",{staticClass:"right"},[r("div",{staticClass:"rifhtTop"},[r("div",{staticClass:"rifhtTopBtn",attrs:{slot:"reference"},slot:"reference"},[r("span",[o._v(o._s("".concat(o.$t("newTrainDet4"),": ").concat(o.hashrate)))])]),o._v(" "),1==o.trainStatus||2==o.trainStatus?r("div",{directives:[{name:"loading",rawName:"v-loading",value:o.stopLoading,expression:"stopLoading"}],staticClass:"rifhtTopBtn",on:{click:o.opStop}},[o._v(o._s(o.stopLoading?o.$t("newTrainDet7"):o.$t("newTrainDet6")))]):o._e()]),o._v(" "),r("div",{staticClass:"imgDet"},[r("div",[r("div",{staticClass:"imgDetTop"},[o._v(o._s(o.$t("newTrainDet8")))]),o._v(" "),o.reverseList.length>0?r("div",{staticClass:"imgInfo"},[r("el-carousel",{attrs:{"indicator-position":"outside",autoplay:!1,trigger:"click"}},o._l(o.reverseList,(function(t,e){return r("el-carousel-item",{key:t.cover+","+e},[r("div",{staticClass:"imgCnt"},[r("img",{attrs:{src:t.cover,alt:""},on:{click:function(t){return o.$refs.imgDet.show(e)}}}),o._v(" "),r("div",{staticClass:"imgTips"},[r("div",[o._v(o._s("LoRA ".concat(t.num," step: ").concat(t.step," loss: ").concat(t.loss)))]),o._v(" "),r("div",[o._v(o._s(o.prompt))])])])])})),1)],1):r("div",{staticClass:"imgDef"},[r("img",{attrs:{src:n(759),alt:""}}),o._v(" "),r("span",[o._v(o._s(2==o.trainStatus?o.$t("newTrainDet10"):o.$t("newTrainDet9")))])])]),o._v(" "),r("div",{staticClass:"btnBox"},[r("el-button",{staticClass:"onPub",style:{opacity:o.trainOk?1:.5},attrs:{disabled:!o.trainOk},on:{click:o.loraPublish}},[o._v(o._s(o.$t("releaseName")))]),o._v(" "),1!=o.trainStatus&&2!=o.trainStatus?r("div",{staticClass:"btnItem"},[r("div",{on:{click:function(t){return o.opTrainPage(!1)}}},[r("i",{staticClass:"iconfont icon-shuaxin1"}),o._v(" "),r("span",[o._v(o._s(o.$t("newTrainDet11")))])]),o._v(" "),r("div",{on:{click:function(t){return o.opTrainPage(!0)}}},[r("i",{staticClass:"iconfont icon-xinjianLoRA"}),o._v(" "),r("span",[o._v(o._s(o.$t("newTrainDet12")))])])]):o._e()],1)])])]),o._v(" "),o.reverseList.length>0?r("imgDet",{ref:"imgDet",model:{value:o.reverseList,callback:function(t){o.reverseList=t},expression:"reverseList"}}):o._e(),o._v(" "),r("LoraDialogList",{ref:"LoraDialogList",on:{pubSucs:o.pubSucs}}),o._v(" "),r("TarinAdvSet",{ref:"advset",attrs:{isView:!0},model:{value:o.intMeta,callback:function(t){o.intMeta=t},expression:"intMeta"}})],1)}),[function(){var t=this._self._c;return t("div",[t("i",{staticClass:"el-icon-check"})])}],!1,null,"72da5690",null));e.default=P.exports},3272:function(t,e,n){"use strict";n.r(e);var o=n(2);n(9),n(7),n(36),n(11),n(12),n(8),n(4),n(6),n(14);function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var c=n(3),d=n(15),h=(n(20),n(16),n(32),n(10),n(70),n(19),n(23),n(49),n(18),n(50),n(118),n(37),n(71),n(48),n(142),n(143),n(112),n(5)),m=n(1),v=n(33),f=n(24),_=n(188),y=n(39),w=n(134),C=n(265),k=n(114),x=n(56),O=n(82),$=n(264),D=n(525),S=n(64),I=n(266),T={name:"LoraTrainInfo",props:{trainInfo:{type:Object,default:function(){return{}}}},computed:{infoItems:function(){var t=this,e=[];return this.infos.forEach((function(n){var o=n.i18key,map=n.map;n.value=0===t.trainInfo[map]?0:t.trainInfo[map]||"-","double"===t.learnType&&["trainDesc4","trainDesc5"].includes(o)||"single"===t.learnType&&"learningRate"===o?e.push(n):["trainDesc4","trainDesc5","learningRate"].includes(o)||e.push(n)})),e},learnType:function(){return this.trainInfo.unet_lr&&this.trainInfo.te_lr?"double":"single"}},data:function(){return{infos:[{i18key:"Category",map:"category",value:""},{i18key:"BaseModel",map:"model_name",value:""},{i18key:"Steps",map:"step",value:""},{i18key:"learningRate",map:"learning_rate",value:""},{i18key:"trainDesc4",map:"unet_lr",value:""},{i18key:"trainDesc5",map:"te_lr",value:""},{i18key:"learningRateScheduler",map:"min_snr_gamma",value:""},{i18key:"Optimizer",map:"optimizer",value:""},{i18key:"networkSize",map:"network_dim",value:""},{i18key:"netWorkAlpha",map:"network_alpha",value:""}],typeMap:{1:"Customization",2:"AnimGen",3:"style",4:"photography8",5:"createModeType5"}}},mounted:function(){},methods:{handleClick:function(){this.$emit("showAll")}}},j=(n(2509),n(0)),L=Object(j.a)(T,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"lora-train-info flex flex-col"},[t._l(t.infoItems,(function(n,o){return e("div",{key:o,staticClass:"lora-train-info-item flex"},[[e("div",{staticClass:"lora-train-info-item-key"},[t._v(t._s(t.$t(n.i18key))+":")]),t._v(" "),"Category"===n.i18key?e("div",{staticClass:"lora-train-info-item-value"},[t._v(t._s(t.typeMap[n.value]?t.$t(t.typeMap[n.value]):"-"))]):e("div",{staticClass:"lora-train-info-item-value"},[t._v(t._s(n.value))])]],2)})),t._v(" "),e("div",{staticClass:"show-all-btn",on:{click:t.handleClick}},[t._v("\n    "+t._s(t.$t("ShowALL"))+"\n  ")])],2)}),[],!1,null,"289deed8",null).exports,P=n(30),M=n(105),E=n(21),A=n(41),N=(n(40),n(25)),R=n(343),B=n(55),F={components:{SwipeableList:S.a},props:{info:{type:Object,default:function(){return{}}}},data:function(){return{selectItem:0,itemScroll:null,getTimeDiff2:y.d}},methods:{selectVn:function(t,e){var n=this;this.selectItem=t,this.$nextTick((function(){n.$refs.listItem.forEach((function(t,e){t.classList.contains("vnActivate")&&(n.itemScroll={value:t.getBoundingClientRect().left,idx:e})}))})),this.$emit("onChange",{index:t,item:e})}}},U=(n(2511),Object(j.a)(F,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex_c max-box"},[e("div",{staticClass:"tabs-nav-box"},[e("h1",{staticClass:"title"},[t._v(t._s(t.info.name))]),t._v(" "),e("div",{staticClass:"flex_m tab-version"},[e("div",{staticClass:"left"},[e("SwipeableList",{staticClass:"w-full",attrs:{scrollChange:t.itemScroll,iconBntWidth:20,top:"15px"}},[e("div",{staticClass:"vnList"},t._l(t.info.model_ver_nos,(function(n,o){return e("div",{key:o,ref:"listItem",refInFor:!0,staticClass:"vnItem",class:{vnActivate:t.selectItem==o},on:{click:function(e){return t.selectVn(o,n)}}},[e("span",[t._v(t._s(n.version_name))])])})),0)])],1),t._v(" "),e("div",{staticClass:"right"},[t._v("\n        "+t._s(t.$t("LastUpdate"))+"："+t._s(t.getTimeDiff2(t.info.update_at))+"\n      ")])])])])}),[],!1,null,"4f94fd5a",null).exports);n(13);function V(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function W(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?V(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var H={name:"ModelDetail",mixins:[v.a],components:{FrameDtl:C.a,Author:_.a,cmtComments:w.a,homeList:B.a,CollectPopover:x.a,modelPayNum:O.a,AppealDialog:$.a,modelDownload:D.a,SwipeableList:S.a,modelExistDialog:I.a,LoraTrainInfo:L,Evaluate:R.a,TabsNav:U},filters:{formatNumber:function(t){return Object(h.i)(t)}},data:function(){return{parseTime:y.e,copyTextToClipboard:h.d,saveImg:h.z,isNewPage:!1,dotReportInfo:{category:"default",view_domain:"details_model",batch_id:"",action:"",obj_no:"",obj_type:1,negative_ids:[]},commentsHeight:60,tempHeight:60,showMoreCommnets:!1,debounceImgPGScroll:function(){},existObj:{name:"",url:"",open:!1},getTimeDiff2:y.d,replaceImageType:h.x,modelInfo:{stat:{},samples:[],tags:[]},queryParam:{page:1,page_size:20,model_no:""},initId:"",intCover:"",relatedImages:[],dialogVisible:!1,isLock:!1,isReq:!1,isCollecting:!1,isUnavailable:!1,isDeleteLoading:!1,morePop:!1,downLoading:!1,formatNumberForeign:h.i,appealShow:!1,appealData:{obj_no:"",obj_type:2,remark:"",order_by:"recommend"},selectItem:0,itemScroll:null,showImg:{url:"",id:""},imgScroll:null,getLoading:!1,defShow:-1,followLoading:!1,followText:this.$t("userFollowing"),itemShow:!1,itemShowId:"",trainSameInfo:{},trainSameInfoAll:{},trainSameLoading:!1,samplesIsNull:!1,timeName:"All",timeTypeOption:[{name:"All",startTime:null,endTime:null},{name:"days",startTime:Object(h.p)().startTimestamp,endTime:Object(h.p)().endTimestamp},{name:"week",startTime:Object(h.r)().startTimestamp,endTime:Object(h.r)().endTimestamp},{name:"months",startTime:Object(h.o)().startTimestamp,endTime:Object(h.o)().endTimestamp}],typeOption:[{name:"Hot",id:"hot",icon:"hot"},{name:"New",id:"new",icon:"new1"}],openModelParam:!1,openLicense:!0}},watch:{$route:{handler:function(t,e){("ModelDetail"==t.name&&e.name==t.name||"ModelEdit"==e.name)&&(this.initId=this.$route.params.id,this.initDada())}},"modelInfo.desc":{handler:function(t){var e=this;t&&this.$nextTick((function(){e.getCmtHeight()}))},immediate:!0}},computed:W(W(W({},Object(m.e)("user",["userInfo","accountData","adminOff"])),Object(m.c)("user",["isLoggedIn","userInfo","isCompanyAccount"])),{},{filterXss:function(){return function(t){return N.default.prototype.xss(t)}},imgWidth:function(){var t,e,n=window.innerHeight-90;if(null!==(t=this.modelInfo)&&void 0!==t&&t.samples&&null!==(e=this.modelInfo)&&void 0!==e&&e.samples[0]){var o,r,l,c=null===(o=this.modelInfo)||void 0===o?void 0:o.samples[0];if(null!=c&&null!==(r=c.banner)&&void 0!==r&&r.width&&null!=c&&null!==(l=c.banner)&&void 0!==l&&l.height){var d,h,m=n*(null==c||null===(d=c.banner)||void 0===d?void 0:d.width)/(null==c||null===(h=c.banner)||void 0===h?void 0:h.height);return m>792?792:m<700?700:m}}return 700},isOwner:function(){var t,e=this.modelInfo.author;return(null===(t=this.userInfo)||void 0===t?void 0:t.id)===(null==e?void 0:e.id)},noCoverText:function(){return this.isOwner?this.isCompanyAccount?this.$t("PleaseSetCover"):this.$t("EmptyBannerModelText"):this.$t("EmptyBannerText")},toolsMenu:function(){var t,e=this.modelInfo,n=e.author,o=e.status,r=e.publish_status,l=[];1===r&&(l.push({key:"REPORT",label:"Report"}),this.userInfo.id==(null===(t=this.modelInfo.author)||void 0===t?void 0:t.id)&&l.push({key:"OFFSHELF",label:"offShelf"}));return this.userInfo.id!==n.id?l.push({key:"CLAIM",label:"ClaimModel"}):(3!==o&&(this.isCompanyAccount||(l=[{key:"EDIT",label:"Edit"}].concat(Object(d.a)(l))),2===r&&l.push({key:"DELETE",label:"Delete"})),2===o&&l.push({key:"APPEAL",label:"appeal"})),l},getDynamicHref:function(){return function(t){var e="Terms"===t,n=this.$i18n.locale?this.$i18n.locale:"en";return Object(k.a)(n,e,this.$isChinaSite)}},coverShowNothing:function(){return function(t){return(null==t?void 0:t.url)&&!(null!=t&&t.meta)}},showTrainSameId:function(){var t,e,n=this;if(null!==(t=this.modelInfo)&&void 0!==t&&t.model_ver_no&&null!==(e=this.modelInfo)&&void 0!==e&&e.model_ver_nos){var o,r,l,c=null===(o=this.modelInfo)||void 0===o?void 0:o.model_ver_nos.find((function(t){var e;return t.id===(null===(e=n.modelInfo)||void 0===e?void 0:e.model_ver_no)}));return console.log("item",c),!(!c||2!==(null==c||null===(r=c.same)||void 0===r?void 0:r.primary))&&(null==c||null===(l=c.same)||void 0===l?void 0:l.train_model_no)}return!1}}),created:function(){this.initId=this.$route.params.id},mounted:function(){this.debounceImgPGScroll=Object(f.debounce)(this.getList,500),this.initDada(!0),this.initList()},activated:function(){this.initId!=this.$route.params.id&&(this.initId=this.$route.params.id,this.initDada())},beforeRouteEnter:function(t,e,n){n((function(t){t.fromPath=e.name,t.setImagePageFromPath(e.path)}))},beforeDestroy:function(){this.debounceImgPGScroll=null,document.body.style.overflow=""},methods:W(W({},Object(m.d)("app",["setImagePageFromPath"])),{},{initList:function(){var t=this.relatedImages;null!=t&&t.length&&(this.relatedImages=t.map((function(t){var e=t.banner;return null==e||!e.url||null!=e&&e.replaceUrl||(t.banner.replaceUrl=Object(h.x)(e.url,"low")),t})))},toVerPage:function(t){var e=this.modelInfo,n=e.id,o=e.name,path="/models/verEdit/".concat(n,"/?VnId=").concat(t,"&name=").concat(o);this.$router.push(this.localePath(path))},handleDetail:function(t,e){"IMG"!==t.target.tagName&&"cltpop"!==t.target.className||this.coverShowNothing(e)||1===e.nsfw||(Object(P.g)({items:[W(W({},this.dotReportInfo),{},{action:"view",obj_no:e.id})]}),this.$router.push(this.localePath("/explore/detail/"+e.id)))},changeItemShow:function(t){this.itemShow=t.show,this.itemShowId=t.id},setFollow:function(t){var e=this;this.followLoading||(this.followLoading=!0,t?Object(E.v)({follow_account_no:this.modelInfo.author.id}).then((function(t){1e4==t.status.code&&(e.modelInfo.author.is_follow=!0)})).finally((function(){e.followLoading=!1})):Object(E.w)({follow_account_no:this.modelInfo.author.id}).then((function(t){1e4==t.status.code&&(e.modelInfo.author.is_follow=!1)})).finally((function(){e.followLoading=!1})))},selectImg:function(t,e,n){this.showImg.url=t.url,this.showImg.id=t.id,n||this.$refs.carousel.setActiveItem(e)},pcion:function(t){var e=t||2;return[1===e?"el-icon-check":"el-icon-close",1===e?"succ":"err"]},selectVn:function(t){var e,n=this,o=t.index;this.getLoading||this.selectItem==o||(this.getLoading=!0,this.selectItem=o,Object(A.F)({id:this.$route.params.id,version_id:null===(e=this.modelInfo)||void 0===e?void 0:e.model_ver_nos[o].id}).then((function(t){var e,r,l,c,d;1e4==t.status.code&&(n.modelInfo.model_ver_no=null===(e=t.data)||void 0===e?void 0:e.model_ver_no,n.modelInfo.version_name=null===(r=t.data)||void 0===r?void 0:r.version_name,n.modelInfo.base_model=null===(l=t.data)||void 0===l?void 0:l.base_model,n.modelInfo.desc=null===(c=t.data)||void 0===c?void 0:c.desc,n.modelInfo.trained_words=null===(d=t.data)||void 0===d?void 0:d.trained_words,n.modelInfo.samples=[],n.modelInfo.cover=0==o?n.intCover:"",n.$nextTick((function(){var e;n.modelInfo.samples=null===(e=t.data)||void 0===e?void 0:e.samples,n.setImg()})))})).finally((function(){n.getLoading=!1})))},toolsEvent:function(t){switch(t){case"CLAIM":this.claimModel();break;case"EDIT":this.onEdit();break;case"DELETE":this.deleteModel();break;case"APPEAL":this.openAppeal();break;case"OFFSHELF":this.offShelf();break;default:this.reportModel()}this.morePop=!1},claimModel:function(){console.log("认领模型",this.$i18n.locale);var t="https://aihelp.net/questionnaire/#/?formId=78dea50f5cbb426cb136748154c029aa";this.$i18n.locale.startsWith("zh")&&(t="https://aihelp.net/questionnaire/#/?formId=bffe7a2307454e859f559913e28d4f19"),window.open(t,"_blank")},offShelf:function(){var t=this;this.$confirm(this.$t("modelDelistTip"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(e){Object(A.q)({id:t.modelInfo.id}).then((function(e){if(1e4==e.status.code)t.$message.success(t.$t("modelDelistSuccess")),t.initDada();else if(10500==e.status.code){var n="https://aihelp.net/questionnaire/#/?formId=291ecf705dee4ceaa97af1bcc0d017b8";t.$i18n.locale.startsWith("zh")&&(n="https://aihelp.net/questionnaire/#/?formId=d9483db10f694841ba66414325fefbb6"),window.open(n,"_blank")}}))}))},openAppeal:function(){console.log("申诉模型id",this.modelInfo.id),this.appealData.obj_no=this.modelInfo.id,this.appealShow=!0},deleteModel:function(){var t=this;this.$confirm(this.$t("newDeleteModelDesc"),this.$t("Tip"),{confirmButtonText:this.$t("Delete"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(e){t.onDelete()}))},reportModel:function(){var t=this;Object(M.e)({id:this.initId}).then((function(e){t.$message.success(t.$t("ReportSuccess"))}))},otherUser:function(t){var path="/user/"+encodeURIComponent(t.author.id);this.userInfo.id==t.author.id&&(path="/personal"),this.$router.push(this.localePath(path))},handleMark:function(){this.isLoggedIn?(1===this.modelInfo.publish_status||this.isCompanyAccount)&&(this.setCollectData(this.modelInfo).includes("icon-collect_selected")?(this.$refs.collectPopover.visible=!1,this.setCollect(this.modelInfo,"model")):this.$refs.collectPopover.visible=!0):this.$EventBus.$emit("openLoginDialog")},initials:function(t){return t.split(" ").map((function(t){return t[0]})).join("").toUpperCase()},backTo:function(){this.$refs.frameDtl?this.$refs.frameDtl.backTo():this.$router.back()},initDada:function(t){var e;this.initId?(this.isLock=!1,this.isReq=!1,t||(this.queryParam={page:1,page_size:20,model_no:""},this.relatedImages=[]),this.modelInfo={stat:{},samples:[],tags:[],name:(null===(e=this.modelInfo)||void 0===e?void 0:e.name)||""},this.getModelDetail()):this.$router.push(this.localePath("/"))},setImg:function(){var t,e=this.modelInfo,o=e.samples,r=e.cover;this.defShow=o.length||r?1:2,o.length>0?(this.showImg.url=o[0].url,this.showImg.id=o[0].id,o.forEach((function(element){1!=element.nsfw&&element.url||(element.url=n(171))}))):null!==(t=this.modelInfo)&&void 0!==t&&t.cover?(this.setCover(),this.samplesIsNull=!0):this.defShow=2},setCover:function(){if(this.modelInfo.cover){if(!this.modelInfo.cover)return;this.modelInfo.samples[0]={url:this.modelInfo.cover,id:this.modelInfo.cover}}},getImgId:function(t){return t?t.split("/").pop():""},getModelDetail:function(){var t=this;if(!this.getLoading){this.getLoading=!0,this.defShow=-1;var e=M.b;this.selectItem=0,"other"==this.$route.query.type&&(e=M.d),e({id:this.$route.params.id}).then((function(e){t.handleData(e)})).finally((function(){t.getLoading=!1}))}},handleData:function(t){var e=this;1e4===t.status.code?(this.modelInfo=t.data,["none","-"].includes(this.modelInfo.refer)&&(this.modelInfo.refer=""),this.$nextTick((function(){e.setImg()})),this.modelInfo.diffDate=Object(y.c)(t.data.create_at,Date.now()),this.modelInfo.timeStamp=Object(y.g)(t.data.update_at),this.intCover=t.data.cover,this.queryParam.model_no=t.data.id):(10404!==t.status.code&&30034!==t.status.code||this.$router.push("/404"),500401===t.status.code&&(this.modelInfo=t.data,this.isUnavailable=!0),30037===t.status.code&&(this.$message.warning(this.$t("unavailable")),this.backTo()))},onEdit:function(){this.$router.push({path:this.localePath("/modelEditStep"),query:{id:this.modelInfo.id}})},deleteModelVer:function(t){var e=this;this.$confirm(this.$t("deleteModelVer"),this.$t("Tip"),{confirmButtonText:this.$t("Delete"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(n){e.verId=t.id,e.onVerDelete()}))},onVerDelete:function(){var t=this;this.isDeleteLoading=!0,Object(A.x)({model_id:this.modelInfo.id,model_ver_no:this.verId}).then((function(e){var n;1e4==e.status.code&&((null===(n=t.modelInfo)||void 0===n?void 0:n.model_ver_nos.length)>1?(t.selectItem=0,t.getModelDetail()):t.$router.back())})).finally((function(){t.isDeleteLoading=!1}))},onDelete:function(){var t=this;this.isDeleteLoading=!0,Object(A.x)({model_id:this.modelInfo.id}).then((function(e){1e4==e.status.code&&(t.setWaterFallDeleteLits(t.modelInfo.id),t.$router.back())})).finally((function(){t.isDeleteLoading=!1}))},imgHandleClick:function(t,e){var n;if(["Checkpoint","LORA","TextualInversion"].includes(this.modelInfo.type))if(this.isLoggedIn)switch(e){case"创作":Object(P.g)({items:[W(W({},this.dotReportInfo),{},{obj_no:t.id,action:"task"})]});var o=Object.assign({},t,{art_work_no:t.id,taskSource:2,base_model:(null==this||null===(n=this.modelInfo)||void 0===n?void 0:n.base_model)||""});this.$EventBus.$emit("openGenerate",{action:1,data:{source:o}});break;case"收藏":this.setCollect(t,"artwork")}else this.$EventBus.$emit("openLoginDialog");else this.$message("theTypeNocreate")},handleClick:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(["Checkpoint","LORA","TextualInversion"].includes(this.modelInfo.type))if(this.isLoggedIn)switch(t){case"创作":var n={action:"task",obj_no:this.modelInfo.id,obj_type:2,category:"default",batch_id:"",negative_ids:[],view_domain:"details_model"};Object(P.g)({items:[n]}),this.$logEvent("log_actions",{operation:"click_create_same_image",behavior_info:"on_model_detail_page",behavior_info_sub:e});var o=Object.assign({},this.modelInfo,{taskSource:2});this.$EventBus.$emit("openGenerate",{action:1,data:{source:o}});break;case"收藏":this.setCollect(this.modelInfo,"model");break;case"PUBLISH":this.publish()}else this.$EventBus.$emit("openLoginDialog");else this.$message("theTypeNocreate")},dotDownload:function(){var t;["Checkpoint","LORA","TextualInversion"].includes(this.modelInfo.type)?this.isLoggedIn?(this.$logEvent("log_actions",{operation:"download_model",behavior_info:"LORA"===(null===(t=this.modelInfo)||void 0===t?void 0:t.type)?"风格详情页":"模型详情页"}),this.$refs.modelDownload&&this.$refs.modelDownload.getDownLoadUrl()):this.$EventBus.$emit("openLoginDialog"):this.$message(this.$t("theTypeNocreate"))},noDownload:function(){2===this.modelInfo.download&&this.$message(this.$t("noUseDownload"))},publish:function(){var t=this.modelInfo.samples;this.$logEvent("log_actions",{action:"LORA"===this.modelInfo.type?"click_publish_style":"click_publish_model",action_info:this.modelInfo.id}),t.length&&!this.samplesIsNull?this.publishModel():this.$router.push({path:this.localePath("/modelEditStep"),query:{id:this.modelInfo.id}})},publishModel:function(){var t=this;Object(A.u)({model_no:this.modelInfo.id}).then((function(e){var n;if(1e4==e.status.code)if(null!==(n=e.data)&&void 0!==n&&n.model_id){var o=e.data,r=o.model_id,l=o.model_name,c=void 0===l?"Model":l,d=o.model_status,h=void 0===d?2:d;t.existObj.url="".concat(window.location.origin,"/")+"models/detail/"+r,t.existObj.name=c,t.existObj.open=1===h,t.$refs.modelExist.modelExistDialog=!0}else t.$message.success(t.$t("PulishSuccess")),t.getModelDetail();else 10403==e.status.code&&t.$router.push({path:t.localePath("/modelEditStep"),query:{id:t.modelInfo.id}})}))},handleTimeCommand:function(t){this.timeName=t.name,this.queryParam.time_from=t.startTime,this.queryParam.time_to=t.endTime,this.intList(),this.$logEvent("log_actions",{operation:"click_time_select",behavior_info:"on_model_detail_page",behavior_info_sub:t.name})},handleCommand:function(t){this.queryParam.order_by=t,this.intList(),this.$logEvent("log_actions",{operation:"click_type_select",behavior_info:"on_model_detail_page",behavior_info_sub:t})},setIcon:function(){var t=this,e="homeIcon1";return this.typeOption.forEach((function(n){t.queryParam.order_by==n.id&&(e=n.icon)})),e},intList:function(){this.relatedImages=[],this.isReq=!1,this.isLock=!1,this.queryParam.page=1,this.queryParam.offset=0,this.getList()},getList:function(){var t=this;if(this.queryParam.model_no&&!this.isReq&&!this.isLock)return this.isReq=!0,new Promise((function(e){Object(A.p)(t.queryParam).then((function(n){1e4===n.status.code&&(n.data.has_more?t.isLock=!1:t.isLock=!0,t.relatedImages=t.relatedImages.concat(n.data.items),t.isReq=!1,1===t.queryParam.page&&(t.queryParam.offset=n.data.offset),t.queryParam.page++,e())}))}))},isLink:function(t){try{return new URL(t),/^(https?|ftp):\/\/[^\s/$.?#].[^\s]*$/i.test(t)}catch(t){return!1}},showLink:function(t){var e=t;if(e){var n=e.match(/([^:/?#]+)(?:\.[^:/?#]+)+(?:[/?#]|$)/i);if(n){var o=n[1];return o=(o=o.replace(/^www\./i,"")).replace(/\.(com|cn|org|net|edu|gov|jp|uk|au|de|fr|kr)$/i,"")}return e}return"-"},getCmtHeight:function(){var t;if(null!==(t=this.modelInfo)&&void 0!==t&&t.id&&this.modelInfo.desc)if(this.$refs.cmtComments){var e=this.$refs.cmtComments.$el.querySelector(".commMain"),n=e.querySelector(".up-content"),o=e.querySelector(".model-intro-desc-content").getBoundingClientRect().height,r=e.getBoundingClientRect().height,l=n.getBoundingClientRect().height,c=parseInt(r-l-113);this.showMoreCommnets=o>c,this.showMoreCommnets?(this.commentsHeight=c>0?c:60,this.tempHeight=c>0?c:60):(this.commentsHeight="auto",this.tempHeight="auto")}else this.commentsHeight=60,this.tempHeight=60;else this.commentsHeight=60,this.tempHeight=60},toggleCmt:function(){this.commentsHeight="auto"!==this.commentsHeight?"auto":this.tempHeight},goTagDtl:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"model";t.id&&(this.$logEvent("log_actions",{operation:"click_tags",behavior_info:t,behavior_info_sub:e}),this.$router.push(this.localePath("/tagInfo/model/".concat(t.id))))},toTrian:function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"train_same_model";["Checkpoint","LORA","TextualInversion"].includes(this.modelInfo.type)?this.isLoggedIn?(this.$logEvent("log_actions",{operation:"click_".concat(n),behavior_info:"on_train_page",behavior_info_sub:(null===(t=this.modelInfo)||void 0===t?void 0:t.id)||this.initId}),this.$router.push(this.localePath({path:"/loraTrainingEdit",query:{dataSetNo:this.showTrainSameId,modelVerNo:null===(e=this.modelInfo)||void 0===e?void 0:e.model_ver_no}}))):this.$EventBus.$emit("openLoginDialog"):this.$message(this.$t("theTypeNocreate"))},getTrainInfo:function(){var t=this;if(this.showTrainSameId){if(this.trainSameInfoAll[this.showTrainSameId])return void(this.trainSameInfo=this.trainSameInfoAll[this.showTrainSameId]);var e=this.showTrainSameId;this.trainSameLoading=!0,Object(M.a)({train_model_no:e}).then((function(e){1e4===e.status.code&&(t.trainSameInfo=Object.assign({},e.data,e.data.meta),t.trainSameInfoAll[t.showTrainSameId]=t.trainSameInfo)})).finally((function(){t.trainSameLoading=!1}))}}}),asyncData:function(t){return Object(c.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,c,d,h,data,m,v,f,_,y,w,C;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params,o=t.query,r=t.$axios,l=t.error,c=null==n?void 0:n.id,d="/api/v1/model/detail","other"==(null==o?void 0:o.type)&&(d="/api/v1/model/auditDetail"),e.prev=4,e.next=7,r.$post(d,{id:c});case 7:return h=e.sent,data=h.data,m={page:1,page_size:50,model_no:c,order_by:"hot"},e.next=12,r.$post("/api/v1/square/model/artwork/related",m);case 12:return v=e.sent,f=v.data,y=(_=f||{}).items,w=_.offset,m.page++,m.offset=w,C={relatedImages:y,queryParam:m},data&&(C.modelInfo=data,["none","-"].includes(data.refer)&&(C.modelInfo.refer="")),e.abrupt("return",C);case 22:e.prev=22,e.t0=e.catch(4),console.log("模型详情页-> asyncData错误啦：",e.t0),l({statusCode:404,message:e.t0});case 26:case"end":return e.stop()}}),e,null,[[4,22]])})))()},head:function(){var t,e=this.modelInfo||{},n=e.name,desc=e.desc,o=e.tags,r=e.author,l=e.stat,c=e.samples,d=e.cover;desc=desc&&desc.replace(/<[^>]*>/g,"");var h=o?o.map((function(t){return t.title})).toString():"",title=this.$t(n?"ModelDetailsTitle":"DisabledModel",{name:n});return{title:title,meta:[{hid:"description",name:"description",content:this.$t("modelDetailDesc",{name:n})},{hid:"keywords",name:"keywords",content:n,tag:h},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:this.$t("modelDetailDesc",{name:n})},{hid:"og:image",name:"og:image",content:c&&(null===(t=c[0])||void 0===t?void 0:t.url)||d}],script:[{type:"application/ld+json",json:{"@context":"https://schema.org","@type":"SoftwareApplication",name:n||title,offers:{"@type":"Offer",price:"0"},aggregateRating:{"@type":"AggregateRating",ratingValue:"4.9",ratingCount:(null==l?void 0:l.num_of_task)||1e3},creator:{name:(null==r?void 0:r.name)||"SeaArt","@type":"Person"}}}],__dangerouslyDisableSanitizers:["script"]}}},z=H,G=(n(2512),n(2513),Object(j.a)(z,(function(){var t,e,n,o,r,c,d=this,h=d._self._c;return h("div",{ref:"model-detail",staticClass:"model-detail"},[h("el-backtop",{attrs:{bottom:30,right:30}},[h("i",{staticClass:"el-icon-top"})]),d._v(" "),null===(t=d.modelInfo)||void 0===t||null===(t=t.audit_status)||void 0===t||!t.desc||2!=d.modelInfo.status&&5!=d.modelInfo.status?d._e():h("div",{staticClass:"auditStatus"},[h("i",{staticClass:"el-icon-warning-outline"}),d._v(" "),h("span",[d._v(d._s(d.modelInfo.audit_status.desc))])]),d._v(" "),h("div",{staticClass:"imgpage-content flex flex-col"},[h("div",{ref:"imagepageInner",staticClass:"imgpage-inner"},[h("tabs-nav",{attrs:{info:d.modelInfo},on:{onChange:d.selectVn}}),d._v(" "),h("FrameDtl",{ref:"frameDtl",attrs:{imgIsHide:d.isUnavailable,unableTxt:"unavailable"}},[h("div",{staticClass:"imgpage-image flex",style:{width:d.imgWidth+"px"}},[h("div",{staticClass:"image-container"},[h("div",{directives:[{name:"loading",rawName:"v-loading",value:d.getLoading,expression:"getLoading"}],staticClass:"imgMain"},[2==d.defShow?h("div",{staticClass:"imgDef"},[d._v("\n                "+d._s(d.noCoverText)+"\n              ")]):d._e(),d._v(" "),1==d.defShow?h("el-carousel",{ref:"carousel",staticClass:"imgMain-carousel",attrs:{height:"100%",autoplay:!1},on:{change:function(t){var e;return d.selectImg(null===(e=d.modelInfo)||void 0===e?void 0:e.samples[t],t,!0)}}},d._l(null===(e=d.modelInfo)||void 0===e?void 0:e.samples,(function(t,e){return h("el-carousel-item",{key:t.url+e},[null!=t&&t.url?h("div",{staticClass:"imgBox"},[h("div",{staticClass:"imgBg",style:{backgroundImage:"url("+d.replaceImageType(t.url,"low")+")"}}),d._v(" "),h("a",{staticClass:"elimg",attrs:{href:"/explore/detail/".concat(t.id)},on:{click:function(e){return e.preventDefault(),d.handleDetail(e,t)}}},[h("img",{attrs:{src:d.replaceImageType(t.url,"high"),alt:""}}),d._v(" "),h("div",{staticClass:"from"},[h("div",{staticClass:"modelType",class:{org:!d.modelInfo.refer}},[h("svg-icon",{attrs:{"icon-class":d.modelInfo.refer?"modelReship":"modelOriginal"}}),d._v(" "),h("span",[d._v(d._s(d.modelInfo.refer?d.$t("Reship"):d.$t("Original")))])],1)]),d._v(" "),d.coverShowNothing(t)?d._e():h("CollectPopover",{staticClass:"CollectPop",attrs:{triggerMode:"click",type:"artwork",folder:t,dotReportInfo:d.dotReportInfo},on:{click:function(t){t.stopPropagation()},showChaneg:d.changeItemShow}}),d._v(" "),d.isLoggedIn&&!d.coverShowNothing(t)?h("div",{staticClass:"cltpop",style:{opacity:d.itemShow&&d.itemShowId==t.id?1:0}}):d._e(),d._v(" "),d.modelInfo.author&&d.modelInfo.author.id&&!d.coverShowNothing(t)?h("div",{staticClass:"waterfall-hover-model"},[h("div",{staticClass:"hoverTop"},[h("span",[d._v("/upscale")])]),d._v(" "),h("div",{staticClass:"hoverMiddle"},[d._v("\n                          "+d._s(t.meta.prompt)+"\n                        ")]),d._v(" "),h("div",{staticClass:"hoverBottom"},[h("div",{staticClass:"personal-info",on:{click:function(t){return d.otherUser(d.modelInfo)}}},[d.modelInfo.author.head?h("img",{staticClass:"avatorClass",attrs:{decoding:"async",loading:"lazy",src:d.modelInfo.author.head,alt:""}}):h("div",{staticClass:"avatorClass"},[d._v("\n                              "+d._s(d.initials(d.modelInfo.author.name||d.modelInfo.author.id))+"\n                            ")]),d._v(" "),h("span",[d._v(d._s(d.modelInfo.author.name||d.modelInfo.author.id))])]),d._v(" "),h("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"center"}},[t.id&&1==d.modelInfo.status?h("div",{staticClass:"login-waterFall-btn-icon",on:{click:function(e){return d.imgHandleClick(t,"收藏")}}},[h("i",{staticClass:"iconfont",class:d.setCollectData(t)})]):d._e(),d._v(" "),t.id&&1==d.modelInfo.status?h("div",{staticClass:"login-waterFall-btn-icon",on:{click:function(e){return d.imgHandleClick(t,"创作")}}},[h("i",{staticClass:"iconfont icon-play"})]):d._e()])])]):d._e()],1)]):d._e()])})),1):d._e()],1)])]),d._v(" "),h("div",{staticClass:"imgpage-info"},[h("Author",{attrs:{type:"model",activeImg:d.modelInfo}},[d.isOwner&&2===d.modelInfo.publish_status&&!d.isCompanyAccount?h("button",{staticClass:"publish-btn",class:d.isLoggedIn?"":"disabled",on:{click:function(t){return d.handleClick("PUBLISH")}}},[d._v("\n              "+d._s(d.$t("Publish"))+"\n            ")]):d._e(),d._v(" "),d.showTrainSameId?h("button",{staticClass:"likewise-lora flex items-center"},[h("span",{staticClass:"txt",on:{click:function(t){return d.toTrian("train_same_model")}}},[d._v(d._s(d.$t("trainSame")))]),d._v(" "),h("el-popover",{staticStyle:{padding:"0"},attrs:{"popper-class":"loraInfoPoper",placement:"bottom-end",width:"320","visible-arrow":!1,trigger:"hover"},on:{show:d.getTrainInfo,click:function(t){t.stopPropagation(),t.preventDefault()}}},[h("LoraTrainInfo",{directives:[{name:"loading",rawName:"v-loading",value:d.trainSameLoading,expression:"trainSameLoading"}],attrs:{trainInfo:d.trainSameInfo},on:{showAll:function(t){return d.toTrian("view_all_info")}}}),d._v(" "),h("span",{staticClass:"tip-icon",attrs:{slot:"reference"},slot:"reference"},[h("i",{staticClass:"el-icon-warning"})])],1)],1):h("button",{staticClass:"waterfall-hover-try",on:{click:function(t){return d.handleClick("创作","Remix_btn")}}},[d._v("\n              "+d._s("TextualInversion"!==(null===(n=d.modelInfo)||void 0===n?void 0:n.type)?d.$t("Remix"):d.$t("workFlow46"))+"\n            ")])]),d._v(" "),null!==(o=d.modelInfo)&&void 0!==o&&o.id?h("cmtComments",{ref:"cmtComments",attrs:{infos:d.modelInfo,type:2,dotReportInfo:d.dotReportInfo},scopedSlots:d._u([{key:"cmtInner",fn:function(){var t,e,n,o,r,l;return[h("div",{staticClass:"line"}),d._v(" "),h("div",{staticClass:"up-content"},[h("div",{staticClass:"statBox"},[h("div",{staticClass:"stat-item",on:{click:function(t){return d.handleClick("创作","create_card")}}},[h("div",{staticClass:"stat-item-text"},[d._v(d._s(d.$t("creativeList")))]),d._v(" "),h("div",{staticClass:"stat-item-num flex justify-between"},[h("span",[d._v(d._s(d.formatNumberForeign((null===(t=d.modelInfo)||void 0===t||null===(t=t.stat)||void 0===t?void 0:t.num_of_task)||0)))]),d._v(" "),h("div",{directives:[{name:"loading",rawName:"v-loading",value:d.getLoading,expression:"getLoading"}],staticClass:"stat-btn btn-create"},[h("i",{staticClass:"iconfont icon-play"})])])]),d._v(" "),h("div",{staticClass:"stat-item",on:{click:function(t){return t.stopPropagation(),d.handleMark.apply(null,arguments)}}},[h("div",{staticClass:"stat-item-text"},[d._v(d._s(d.$t("Collect")))]),d._v(" "),h("div",{staticClass:"stat-item-num flex justify-between"},[h("span",[d._v(d._s(d.formatNumberForeign((null===(e=d.modelInfo)||void 0===e||null===(e=e.stat)||void 0===e?void 0:e.num_of_collection)||0)))]),d._v(" "),1===d.modelInfo.publish_status||d.isCompanyAccount?h("div",{staticClass:"stat-btn btn-collect"},[h("CollectPopover",{ref:"collectPopover",attrs:{hideBtn:!0,type:"model",folder:d.modelInfo,dotReportInfo:d.dotReportInfo}},[h("div",{staticClass:"bntItem collectBnt"},[h("i",{staticClass:"iconfont",class:d.setCollectData(d.modelInfo)})])])],1):d._e()])]),d._v(" "),h("div",{staticClass:"stat-item",on:{click:d.dotDownload}},[h("div",{staticClass:"stat-item-text"},[d._v(d._s(d.$t("Download")))]),d._v(" "),h("div",{staticClass:"stat-item-num flex justify-between"},[h("span",[d._v(d._s(d.formatNumberForeign((null===(n=d.modelInfo)||void 0===n||null===(n=n.stat)||void 0===n?void 0:n.num_of_download)||0)))]),d._v(" "),1===d.modelInfo.download?h("div",{staticClass:"stat-btn btn-download"},[h("modelDownload",{ref:"modelDownload",attrs:{modelInfo:d.modelInfo}})],1):d._e(),d._v(" "),2===d.modelInfo.download?h("div",{staticClass:"stat-btn btn-download",on:{click:d.noDownload}},[h("i",{staticClass:"iconfont icon-modelDownload"})]):d._e()])])]),d._v(" "),h("div",{staticClass:"line"}),d._v(" "),h("div",{ref:"modelInfos",staticClass:"modelInfos"},[h("div",{staticClass:"infoItem"},[h("div",{staticClass:"keys"},[d._v(d._s(d.$t("ModelSource"))+":")]),d._v(" "),h("div",{staticClass:"vals"},[d.isLink(d.modelInfo.refer)?h("a",{staticClass:"link",attrs:{href:d.modelInfo.refer,target:"_blank",rel:"nofollow"}},[d._v("\n                        "+d._s(d.showLink(d.modelInfo.refer))+"\n                      ")]):h("span",[d._v(d._s(d.modelInfo.refer||"-"))])])]),d._v(" "),h("div",{staticClass:"infoItem"},[h("div",{staticClass:"keys"},[d._v(d._s(d.$t("Type"))+":")]),d._v(" "),h("div",{staticClass:"vals"},[d.modelInfo.type?h("span",{staticClass:"model-type",class:{isLora:"Checkpoint"!==(null===(o=d.modelInfo)||void 0===o?void 0:o.type)}},[d._v("\n                        "+d._s("TextualInversion"!==(null===(r=d.modelInfo)||void 0===r?void 0:r.type)?d.modelInfo.type:d.$t("embedding1"))+"\n                      ")]):d._e()])]),d._v(" "),h("div",{staticClass:"infoItem"},[h("div",{staticClass:"keys"},[d._v(d._s(d.$t("BaseModel"))+":")]),d._v(" "),h("div",{staticClass:"vals"},[d._v(d._s(d.modelInfo.base_model))])]),d._v(" "),h("div",{staticClass:"infoItem"},[h("div",{staticClass:"keys"},[d._v(d._s(d.$t("Tags"))+":")]),d._v(" "),h("div",{staticClass:"vals"},d._l(d.modelInfo.tags,(function(t,e){return h("span",{key:"tag_".concat(e),staticClass:"tag-item cursor"},[t.id?[h("a",{attrs:{target:"_self",href:d.localePath("/tagInfo/model/"+t.id)},on:{click:function(e){return e.preventDefault(),d.goTagDtl(t,"model")}}},[d._v("#"+d._s(null==t?void 0:t.title))])]:d._e()],2)})),0)]),d._v(" "),h("div",{staticClass:"infoItem"},[h("div",{staticClass:"keys"},[d._v(d._s(d.$t("TriggerWords"))+":")]),d._v(" "),h("div",{staticClass:"vals"},d._l(d.modelInfo.trained_words,(function(t,e){return h("span",{key:e,staticClass:"tag-item"},[d._v(d._s(t))])})),0)]),d._v(" "),h("div",{staticClass:"infoItem openrule-box"},[h("div",{staticClass:"keys"},[d._v(d._s(d.$t("licenseScopeInit"))+":")]),d._v(" "),h("div",{staticClass:"vals"},[h("i",{class:d.openLicense?"el-icon-arrow-up":"el-icon-arrow-down",on:{click:function(t){d.openLicense=!d.openLicense}}})]),d._v(" "),h("div",{directives:[{name:"show",rawName:"v-show",value:d.openLicense,expression:"openLicense"}],staticClass:"item-bard"},[h("div",{staticClass:"cell flex"},[h("div",{staticClass:"left"},[d._v(d._s(d.$t("createLicenseScope")))]),d._v(" "),h("div",{staticClass:"right flex"},[h("div",{staticClass:"text"},[h("i",{class:d.pcion(d.modelInfo.allow_use_in_haiyi)}),d._v(" "),h("span",[d._v(d._s(d.$t("onlineMapping")))])]),d._v(" "),h("div",{staticClass:"text"},[h("i",{class:d.pcion(d.modelInfo.mix)}),d._v(" "),h("span",[d._v(d._s(d.$t("performFusion")))])]),d._v(" "),h("div",{staticClass:"text"},[h("i",{class:d.pcion(d.modelInfo.download)}),d._v(" "),h("span",[d._v(d._s(d.$t("comfyUpLoad9")))])])])]),d._v(" "),h("div",{staticClass:"cell flex"},[h("div",{staticClass:"left"},[d._v("\n                          "+d._s(d.$t("businessLicenseScope"))+"\n                        ")]),d._v(" "),h("div",{staticClass:"right flex"},[h("div",{staticClass:"text"},[h("i",{class:d.pcion(d.modelInfo.commercial)}),d._v(" "),h("span",[d._v(d._s(d.$t("commercialYesImg")))])]),d._v(" "),h("div",{staticClass:"text"},[h("i",{class:d.pcion(d.modelInfo.allow_resell)}),d._v(" "),h("span",[d._v(d._s(d.$t("modelSellYes")))])])])])])]),d._v(" "),h("div",{staticClass:"infoItem openrule-box"},[h("div",{staticClass:"keys"},[d._v(d._s(d.$t("ModelParameters"))+":")]),d._v(" "),h("div",{staticClass:"vals"},[h("i",{class:d.openModelParam?"el-icon-arrow-up":"el-icon-arrow-down",on:{click:function(t){d.openModelParam=!d.openModelParam}}})]),d._v(" "),h("div",{directives:[{name:"show",rawName:"v-show",value:d.openModelParam,expression:"openModelParam"}],staticClass:"item-bard"},[h("div",{staticClass:"cell flex"},[h("div",{staticClass:"left"},[d._v(d._s(d.$t("BaseModel"))+":")]),d._v(" "),h("div",{staticClass:"right flex"},[h("span",[d._v(d._s(d.modelInfo.base_model))])])]),d._v(" "),h("div",{staticClass:"cell flex"},[h("div",{staticClass:"left"},[d._v(d._s(d.$t("epochForNum"))+":")]),d._v(" "),h("div",{staticClass:"right flex"},[h("span",[d._v(d._s(d.modelInfo.train_param.epoch))])])]),d._v(" "),h("div",{staticClass:"cell flex"},[h("div",{staticClass:"left"},[d._v(d._s(d.$t("stepsIterationNum"))+":")]),d._v(" "),h("div",{staticClass:"right flex"},[h("span",[d._v(d._s(d.modelInfo.train_param.step))])])]),d._v(" "),h("div",{staticClass:"cell flex"},[h("div",{staticClass:"left"},[d._v(d._s(d.$t("clipSkipClip"))+":")]),d._v(" "),h("div",{staticClass:"right flex"},[h("span",[d._v(d._s(d.modelInfo.train_param.clip_skip))])])])])]),d._v(" "),d._e(),d._v(" "),h("div",{staticClass:"infoItem",staticStyle:{"margin-top":"15px"}},[h("div",{staticClass:"keys"},[d._v(d._s(d.$t("comfyui_evaluate"))+":")]),d._v(" "),h("div",{staticClass:"vals"},[h("Evaluate",{attrs:{evaluateData:d.modelInfo,obj_type:2}})],1)])]),d._v(" "),h("div",{staticClass:"line"})]),d._v(" "),h("div",{staticClass:"model-intro flex flex-col"},[h("div",{staticClass:"model-intro-title flex items-center"},[d.modelInfo.is_agency_fee?h("span",{staticClass:"payNum"},[h("modelPayNum",{attrs:{number:d.modelInfo.agency_fee}})],1):d._e()]),d._v(" "),d.modelInfo.desc?h("div",{ref:"descDiv",staticClass:"model-intro-desc",style:{height:"auto"===d.commentsHeight?d.commentsHeight:d.commentsHeight+"px"}},[h("div",{ref:"descChild",staticClass:"model-intro-desc-content",domProps:{innerHTML:d._s(d.filterXss(d.modelInfo.desc))}})]):d._e()]),d._v(" "),null!==(l=d.modelInfo)&&void 0!==l&&l.desc?h("div",{staticClass:"time-more flex justify-between"},[h("div",{staticClass:"time"}),d._v(" "),d.showMoreCommnets?h("div",{staticClass:"more",on:{click:d.toggleCmt}},[h("span",[d._v(d._s(d.commentsHeight===d.tempHeight?d.$t("more"):d.$t("PackUp")))]),d._v(" "),h("i",{staticClass:"el-icon-arrow-down"})]):d._e()]):d._e()]},proxy:!0},{key:"cmtMore",fn:function(){return[h("div",{staticClass:"commFunNum"},[d.modelInfo.author&&d.modelInfo.author.id?h("el-popover",{attrs:{placement:"top-start","popper-class":"my-popover","visible-arrow":!1,width:"100"},model:{value:d.morePop,callback:function(t){d.morePop=t},expression:"morePop"}},[h("div",{staticClass:"popBox"},d._l(d.toolsMenu,(function(t,i){return h("div",{key:"tools_"+i,on:{click:function(e){return d.toolsEvent(t.key)}}},[d._v("\n                      "+d._s(d.$t(t.label))+"\n                    ")])})),0),d._v(" "),h("div",{staticClass:"edit",attrs:{slot:"reference"},slot:"reference"},[h("i",{staticClass:"el-icon-more"})])]):d._e()],1)]},proxy:!0}],null,!1,3452447175)}):d._e()],1)])],1),d._v(" "),h("div",{staticClass:"imgpage-related"},[h("div",{staticClass:"title-div"},[h("span",{staticClass:"title"},[d._v(d._s(d.$t("ExploreRelated")))]),d._v(" "),h("div",{staticClass:"Screening"},[h("el-dropdown",{attrs:{trigger:"hover"},on:{command:d.handleTimeCommand}},[h("div",{staticClass:"el-dropdown-link selectTime"},[h("div",[h("i",{staticClass:"el-icon-time"}),d._v(" "),h("span",[d._v(d._s(d.$t(d.timeName)))])]),d._v(" "),h("i",{staticClass:"el-icon-arrow-down"})]),d._v(" "),h("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},d._l(d.timeTypeOption,(function(t,e){return h("el-dropdown-item",{key:e,attrs:{command:t}},[h("div",{staticClass:"el-dropdown-item el-dropdown-item-time"},[h("span",[d._v(d._s(d.$t(t.name)))])])])})),1)],1),d._v(" "),h("el-dropdown",{attrs:{trigger:"hover"},on:{command:d.handleCommand}},[h("div",{staticClass:"el-dropdown-link"},[h("div",[h("i",{staticClass:"iconfont",class:"icon-".concat(d.setIcon())}),d._v(" "),h("span",[d._v(d._s(d.$t((null===(r=d.queryParam)||void 0===r||null===(r=r.order_by)||void 0===r?void 0:r.charAt(0).toUpperCase())+(null===(c=d.queryParam)||void 0===c||null===(c=c.order_by)||void 0===c?void 0:c.slice(1)))))])]),d._v(" "),h("i",{staticClass:"el-icon-arrow-down"})]),d._v(" "),h("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},d._l(d.typeOption,(function(t,e){return h("el-dropdown-item",{key:e,attrs:{command:t.id}},[h("div",{staticClass:"el-dropdown-item"},[h("i",{staticClass:"iconfont",class:"icon-".concat(t.icon)}),d._v(" "),h("span",[d._v(d._s(d.$t(t.name)))])])])})),1)],1)],1)]),d._v(" "),h("div",{ref:"relatewraper",staticClass:"related-images"},[h("homeList",{ref:"WaterFallVue",attrs:{type:"artwork",container:"relatewraper",list:d.relatedImages,lazy:!0,cols:7,gap:16,dotReportInfo:l(l({},d.dotReportInfo),{},{view_domain:"details"})},on:{load:d.debounceImgPGScroll}})],1)])]),d._v(" "),h("el-dialog",{attrs:{visible:d.dialogVisible,top:"40vh",width:"508px","custom-class":"SaDialog","append-to-body":""},on:{"update:visible":function(t){d.dialogVisible=t}}},[h("div",{staticClass:"sure"},[d._v(d._s(d.$t("DeleteModelSure")))]),d._v(" "),h("div",{staticClass:"sureDesc"},[d._v(d._s(d.$t("newDeleteModelDesc")))]),d._v(" "),h("div",{staticClass:"bntitem",attrs:{slot:"footer"},slot:"footer"},[h("el-button",{on:{click:function(t){d.dialogVisible=!1}}},[d._v(d._s(d.$t("Cancel")))]),d._v(" "),h("el-button",{attrs:{loading:d.isDeleteLoading},on:{click:d.onDelete}},[d._v(d._s(d.$t("Delete")))])],1)]),d._v(" "),h("div",{staticClass:"mobile-back-to",on:{click:function(t){return t.stopPropagation(),d.backTo.apply(null,arguments)}}},[h("i",{staticClass:"el-icon-back"})]),d._v(" "),d.appealShow?h("AppealDialog",{attrs:{"appeal-data":d.appealData,"is-appealing":d.isAppealLoading,"submit-callback":d.setResourceAppeal,"dialog-visible":d.appealShow},on:{"update:dialogVisible":function(t){d.appealShow=t},"update:dialog-visible":function(t){d.appealShow=t}}}):d._e(),d._v(" "),h("modelExistDialog",{ref:"modelExist",attrs:{existObj:d.existObj}})],1)}),[],!1,null,"9c6821fa",null));e.default=G.exports},3275:function(t,e,n){"use strict";n.r(e);n(16),n(10),n(14),n(9),n(11),n(12);var o=n(15),r=n(31),l=n(3),c=n(2),d=(n(20),n(7),n(47),n(19),n(287),n(8),n(4),n(23),n(49),n(18),n(37),n(71),n(6),n(212)),h=n(535),m=n(81),v=n(13),f=n(213),_={props:{tabList:{type:Array,default:function(){return[]}},step:{type:String,default:"visualize"}},data:function(){return{}},methods:{handleNextStep:function(code){this.$emit("handleNextStep",code)}},computed:{activeComputed:function(){var t=this;return function(e){return t.step===e}}}},y=(n(2667),n(0)),w=Object(y.a)(_,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"new-character-tabs"},t._l(t.tabList,(function(n){return e("div",{key:n.code,staticClass:"tavern-tabs-item",class:{"new-character-tabs-item-active":t.activeComputed(n.code)},on:{click:function(e){return e.stopPropagation(),t.handleNextStep(n.code)}}},[e("div",{staticClass:"tavern-tabs-item-text"},[t._v("\n        "+t._s(t.$t(n.i18nKey)||n.name)+"\n      ")]),t._v(" "),e("div",{staticClass:"tavern-tabs-item-line"})])})),0)}),[],!1,null,"3056978f",null).exports,C=n(38),k=n(126),x=n(1),O=n(45),$=n(26),D={name:"creaCharacterConfirmModal",data:function(){return{visible:!1,options:null,resolve:null,reject:null}},methods:{show:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.resetData(),this.options=e,this.visible=!0,new Promise((function(e,n){t.resolve=e,t.reject=n}))},resetData:function(){this.options=null,this.resolve=null,this.reject=null},handleClose:function(){if(this.visible=!1,this.reject)return this.reject(!1)},handleConfirm:function(){if(this.visible=!1,this.resolve)return this.resolve(!0)}}},S=D,I=(n(2668),Object(y.a)(S,(function(){var t,e,n=this,o=n._self._c;return o("el-dialog",{attrs:{"close-on-press-escape":!1,"close-on-click-modal":!1,visible:n.visible,"custom-class":"easy-common-confirm-modal custom-dialog","destroy-on-close":!1,modal:!1,"modal-append-to-body":"","append-to-body":"",width:"407px"},on:{"update:visible":function(t){n.visible=t}}},[o("div",{staticClass:"easy-select-model-confirm-modal-header"},[o("div",{staticClass:"modal-header-title"},[n._v(n._s(n.$t("Tip")))]),n._v(" "),o("span",{staticClass:"modal-header-close",on:{click:function(t){return t.stopPropagation(),n.handleClose()}}},[o("i",{staticClass:"el-icon-close"})])]),n._v(" "),o("div",{staticClass:"easy-select-model-confirm-modal-content"},[o("div",{staticClass:"modal-content-left"},[o("div",{staticClass:"warning-icon-box"},[o("i",{staticClass:"iconfont icon-warn"})])]),n._v(" "),o("div",{staticClass:"modal-content-right"},[o("div",{staticClass:"modal-content-right-title"},[n._v(n._s(n.$t("createCharacterTip")))]),n._v(" "),null!==(t=n.options)&&void 0!==t&&t.subTitle?[Array.isArray(n.options.subTitle)?n._l(n.options.subTitle,(function(t,e){return o("div",{key:e,staticClass:"modal-content-right-sub-title",domProps:{innerHTML:n._s(t)}})})):[o("div",{staticClass:"modal-content-right-sub-title"},[n._v("\n            "+n._s(null===(e=n.options)||void 0===e?void 0:e.subTitle)+"\n          ")])]]:n._e()],2)]),n._v(" "),o("div",{staticClass:"easy-select-model-confirm-modal-footer"},[o("span",{staticClass:"modal-footer-btn modal-footer-btn-confirm",on:{click:function(t){return t.stopPropagation(),n.handleConfirm()}}},[n._v(n._s(n.$t("Confirm")))])])])}),[],!1,null,null,null).exports);function T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function j(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(Object(n),!0).forEach((function(e){Object(c.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var L={name:"newCharacter",components:{TabBar:w,pickWorkModal:f.a,AiChatSoundItem:h.a,selectSoundModel:d.a,CreaCharacterConfirmModal:I},data:function(){return{errorSubTitle:null,isSupportSoundSelect:!0,value1:!1,sameModel:!1,autoModel:!1,createdLoading:!1,isShowUpload2:!0,createBtnDisabled:!1,accept:".jpg,.jpeg,.png,.webp",labelPosition:"top",createdByIntro:"",formData:{timbre_id:"",cover:{cover:"",cover_width:0,cover_height:0},name:"",intro:"",first_msg:"",evaluation:"",personal:"",dialog_example:"",scene:"",categories:[],publish_status:1,vision:{bg:{cover:"",cover_width:0,cover_height:0},character:{cover:"",cover_width:0,cover_height:0},mode:"normal"},same:1,gender:"other"},introLimit:3500,personalLimit:5500,firstMsgLimit:3e3,evaluationLimit:1500,sceneLimit:1500,dialogExampleLimit:2500,rules:{name:[{required:!0,message:this.$t("pleaseEnte"),trigger:["change","blur"]}],intro:[{required:!0,message:this.$t("pleaseEnte"),trigger:["change","blur"]}],first_msg:[{required:!0,message:this.$t("pleaseEnte"),trigger:["change","blur"]}],personal:[{required:!0,message:this.$t("pleaseEnte"),trigger:["change","blur"]}],evaluation:[{required:!0,message:this.$t("pleaseEnte"),trigger:["change","blur"]}],categories:[{required:!0,message:this.$t("tavern55",{number:1}),trigger:["change","blur"]}]},tagList:[],step:"visualize",tabList:[{name:"基础形象",i18nKey:"digitalHumanVisualize",code:"visualize"},{name:"人物信息",i18nKey:"digitalHumanInfo",code:"info"},{name:"预览",i18nKey:"tavern30",code:"preview"}],isPostingBackground:!1,isBackgroundLoading:!1,isPostingCharacter:!1,isCharacterLoading:!1,UPLOAD:new C.a({type:24}),showImage:!1,isCoverLoading:!1,coverImageLoading:!1,popoverWidth:300,popoverTrigger:"hover",configurationFileUrl:"https://oobabooga.github.io/character-creator.html",importJsonError:[],isPostingForm:!1,detailInfo:null,detailInfoAuto:null,pageLoading:!1,base64RoleUrl:"",voiceObj:null}},watch:{formData:{handler:function(){},deep:!0,immediate:!0},"formData.cover.cover":{handler:function(t){this.isShowUpload2=!t},immediate:!0}},computed:j(j(j(j({},Object(x.e)("payment",["activeState","liteActiveState","paymentInfo"])),Object(x.e)("user",["userInfo"])),Object(x.c)("user",["isLoggedIn","isCompanyAccount"])),{},{showVoiceIcon:function(){var t,e=(null===(t=this.userInfo)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.lang_code)||this.$i18n.locale;return["zhCN","zhTW","ja","en"].includes(e)&&this.isSupportSoundSelect},isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)||this.isCompanyAccount},checkShowTab:function(){return!["",null,void 0].includes(this.formData.cover.cover)},tagLabel:function(){var t=this,e=[];return this.formData.categories&&this.formData.categories.length&&this.tagList.length&&this.tagList.forEach((function(n){t.formData.categories.forEach((function(t){n.id===t&&e.push(n.title)}))})),e}}),beforeRouteEnter:function(t,e,n){console.log("beforeRouteEnter11  to ---- from",t.name,e.name),n((function(t){}))},beforeRouteLeave:function(t,e,n){var o;null!=t&&null!==(o=t.name)&&void 0!==o&&o.startsWith("AIAudioTrain")?(console.log("执行缓存操作"),localStorage.setItem("tavernNewCharacterInfo",JSON.stringify(this.formData)),localStorage.setItem("cacheStep",this.step)):(console.log("执行清除缓存操作"),localStorage.removeItem("tavernNewCharacterInfo"),localStorage.removeItem("cacheStep")),n()},mounted:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.getTagList(),1==t.$route.query.sameStyle&&(t.sameModel=!0),null===(n=t.$route)||void 0===n||null===(n=n.query)||void 0===n||!n.id){e.next=7;break}return e.next=5,t.getDetailInfo(null===(o=t.$route)||void 0===o||null===(o=o.query)||void 0===o?void 0:o.id);case 5:e.next=8;break;case 7:t.initData();case 8:case"end":return e.stop()}}),e)})))()},methods:{setSymbol:function(t,e){return t>1?e===t-1?"。":";":"。"},handleCreate:function(){this.checkNeedSaveToLocal(),this.$router.push(this.localePath("/ai-audio/train"))},handleDelTimObj:function(){this.voiceObj={},this.formData.timbre_id=""},getVoiceDetail:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,o,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("+"!==t.formData.timbre_id&&t.formData.timbre_id){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,Object($.v)({id:t.formData.timbre_id});case 4:n=e.sent,o=n.status,data=n.data,1e4===o.code&&(t.voiceObj=data,t.voiceObj.cover=t.voiceObj.cover.url);case 7:case"end":return e.stop()}}),e)})))()},selectModel:function(t){this.voiceObj=t.timbre,this.voiceObj.cover=t.cover||"",this.formData.timbre_id=t.id,this.$refs.selectSoundModel.handleClose()},handleSelectSound:function(){this.$refs.selectSoundModel.openModal()},handleSelectArtWork:function(t){var e,n,o;t&&t.length&&(this.formData.cover.cover=(null===(e=t[0])||void 0===e?void 0:e.url)||"",this.formData.cover.cover_width=(null===(n=t[0])||void 0===n||null===(n=n.info)||void 0===n?void 0:n.waterWidth)||0,this.formData.cover.cover_height=(null===(o=t[0])||void 0===o||null===(o=o.info)||void 0===o?void 0:o.waterHeight)||0)},openPickWorkModal:function(){this.$refs.pickWorkModal.openModal()},handleAiCreate:function(){var t=this;if(this.autoModel=!0,this.sameModel=!1,this.createBtnDisabled)this.$message.warning(this.$t("digitalHumanLoading"));else{if(!["",null,void 0].includes(this.formData.cover.cover)&&/^(http|https):\/\//.test(this.formData.cover.cover)){var e=["name","first_msg","evaluation","personal"].some((function(e){return""!==t.formData[e]}));this.formData.categories.length||e?this.$confirm(this.$t("digitalHumanTip"),this.$t("Tip"),{confirmButtonText:this.$t("digitalHumanConfirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){t.getDetailInfoByAuto()})).catch((function(t){console.log("err",t)})):this.getDetailInfoByAuto()}else this.$message.warning(this.$t("digitalHumanTost"))}},getDetailInfoByAuto:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.formData.cover.cover||"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.createdByIntro||"",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.tagList.length?this.tagList.map((function(t){return t.id})):[];if(e){var r={url:e,intro:n,tag_ids:o};this.createBtnDisabled=!0,this.createdLoading=!0,this.getTagList(),Object(k.g)(r).then((function(e){var n,o,r,l;return 1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)?(t.detailInfoAuto=null!=e&&e.data?e.data:null,t.voiceObj=(null==e||null===(r=e.data)||void 0===r?void 0:r.timbre)||null,t.errorSubTitle=null,t.handleDetailData("aiAuto"),void t.handleNextStep("info")):10618===(null==e||null===(o=e.status)||void 0===o?void 0:o.code)?(t.errorSubTitle=t.handleChangeString(null==e||null===(l=e.status)||void 0===l?void 0:l.msg),void t.$refs.CreaCharacterConfirmModal.show({subTitle:t.errorSubTitle})):void 0})).finally((function(){t.createBtnDisabled=!1,t.createdLoading=!1}))}},handleChangeString:function(t){var e=this,n=t.split(",");return n.map((function(t,o){var l=t.split(":"),c=Object(r.a)(l,2),d=c[0],h=c[1];return"<p>".concat(e.$t("createCharacterTip2",{paramsKey:e.$t(v.C[d])||d,content:h})).concat(e.setSymbol(n.length,o),"</p>")}))},getDetailInfo:function(){var t=this,e={id:arguments.length>0&&void 0!==arguments[0]?arguments[0]:""};this.pageLoading=!0,Object(k.f)(e).then((function(e){var n,o;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&(t.detailInfo=null!=e&&e.data?e.data:null,t.isSupportSoundSelect=1===(null==e||null===(o=e.data)||void 0===o?void 0:o.support_voice),t.handleDetailData())})).finally((function(){t.pageLoading=!1}))},handleDetailData:function(){var t,e,n,o,data={};(data="aiAuto"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"edit")?this.handleAiAutoData():this.handleData(),Object.assign(this.formData,data),null!==(t=this.formData)&&void 0!==t&&null!==(t=t.vision)&&void 0!==t&&null!==(t=t.bg)&&void 0!==t&&t.cover)&&this.$emit("updateTavernBg",{backgroundUrl:(null===(e=this.formData)||void 0===e||null===(e=e.vision)||void 0===e||null===(e=e.bg)||void 0===e?void 0:e.cover)||"",width:(null===(n=this.formData)||void 0===n||null===(n=n.vision)||void 0===n||null===(n=n.bg)||void 0===n?void 0:n.cover_width)||0,height:(null===(o=this.formData)||void 0===o||null===(o=o.vision)||void 0===o||null===(o=o.bg)||void 0===o?void 0:o.cover_height)||0});this.formData.timbre_id&&this.getVoiceDetail()},handleAiAutoData:function(){var t,e={},n=this.detailInfoAuto||{},o=n.allow_same,r=void 0===o?1:o,l=n.name,c=void 0===l?"":l,d=n.gender,h=void 0===d?"other":d,m=n.id,v=void 0===m?"":m,f=n.tag_ids,_=void 0===f?[]:f,y=n.evaluation,w=void 0===y?{title:""}:y,C=n.scene,k=void 0===C?{title:""}:C,x=n.intro,O=void 0===x?{title:""}:x,$=n.first_msg,D=void 0===$?{title:""}:$,S=n.dialog_example,I=void 0===S?{title:""}:S,T=n.personal,j=void 0===T?{title:""}:T;return e.scene=this.handleTitle(k.title),e.evaluation=this.handleTitle(w.title),e.intro=this.handleTitle(O.title),e.first_msg=this.handleTitle(D.title),e.dialog_example=this.handleTitle(I.title),e.personal=this.handleTitle(j.title),e.categories=_,e.id=v,e.gender=h||"",e.name=c||"",e.same=r||1,e.timbre_id=(null===(t=this.detailInfoAuto)||void 0===t||null===(t=t.timbre)||void 0===t?void 0:t.id)||"",e},handleTitle:function(t){return t?t.replace(/\n/g,""):""},handleData:function(){var t,e,n,r,l,c,d,h,m={},v=this.detailInfo||{},f=v.allow_same,_=void 0===f?1:f,y=v.gender,w=void 0===y?"other":y,C=v.categories,k=void 0===C?[]:C,x=v.cover,O=void 0===x?{}:x,$=v.evaluation,D=void 0===$?"":$,S=v.name,I=void 0===S?"":S,T=v.scene,j=void 0===T?"":T,L=v.vision,P=void 0===L?{}:L,M=v.intro,E=void 0===M?"":M,A=v.first_msg,N=void 0===A?"":A,R=v.dialog_example,B=void 0===R?"":R,F=v.personal,U=void 0===F?"":F,V=v.id,W=void 0===V?"":V,H=v.publish_status,z=void 0===H?1:H;m.name=I,m.cover={cover:(null==O?void 0:O.url)||"",cover_width:(null==O?void 0:O.width)||0,cover_height:(null==O?void 0:O.height)||0},m.vision={bg:{cover:(null==P||null===(t=P.bg)||void 0===t?void 0:t.url)||"",cover_width:(null==P||null===(e=P.bg)||void 0===e?void 0:e.width)||0,cover_height:(null==P||null===(n=P.bg)||void 0===n?void 0:n.height)||0},character:{cover:(null==P||null===(r=P.character)||void 0===r?void 0:r.url)||"",cover_width:(null==P||null===(l=P.character)||void 0===l?void 0:l.width)||0,cover_height:(null==P||null===(c=P.character)||void 0===c?void 0:c.height)||0},mode:null==P?void 0:P.mode},"normal"!==(null==P?void 0:P.mode)||["",null,void 0].includes(null==P||null===(d=P.character)||void 0===d?void 0:d.cover)||(m.vision.mode="advanced"),m.scene=this.handleTitle(j),m.evaluation=this.handleTitle(D),m.intro=this.handleTitle(E),m.first_msg=this.handleTitle(N),m.dialog_example=this.handleTitle(B),m.personal=this.handleTitle(U),m.categories=(k||[]).map((function(t){return t.id})),m.timbre_id=null===(h=this.detailInfo)||void 0===h?void 0:h.timbre_id;var G=(k||[]).map((function(t){return{id:t.id,title:t.name}})),J=[].concat(Object(o.a)(this.tagList),Object(o.a)(G));return J=J.filter((function(t,e,n){return e===n.findIndex((function(e){return e.id===t.id}))})),this.tagList=J,m.publish_status=2===z?2:1,m.id=W,m.gender=w||"",m.same=_||1,m},handleUploadJson:function(t){return"application/json"===t.type?(this.readFileContent(t),!1):(this.$message.error("Please upload a JSON file"),!1)},readFileContent:function(t){var e=this,n=new FileReader;n.onload=function(t){var content=t.target.result;e.parseJsonContent(content)},n.readAsText(t)},parseJsonContent:function(content){try{var t=JSON.parse(content);console.log(t),this.handleImportConfig(t)}catch(t){this.$message.error("Invalid JSON file")}},handleImportConfig:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=["dialog_example","scene"];this.importJsonError=[];for(var o=function(){var o=Object(r.a)(c[l],2),d=o[0],h=o[1],m="";(h||[]).some((function(n){return!["",void 0,null].includes(e[n])&&"[object String]"===Object.prototype.toString.call(e[n])&&(t.$set(t.formData,d,e[n]),m=e[n],!0)}))?t.$set(t.formData,d,m):!n.includes(d)&&t.importJsonError.push(h[0])},l=0,c=Object.entries({name:["name","char_name"],intro:["description"],personal:["char_persona"],evaluation:["creator_notes"],first_msg:["first_mes"],dialog_example:["mes_example","example_dialogue"],scene:["scenario","world_scenario"]});l<c.length;l++)o()},getTagList:function(){var t=this;Object(m.a)({show_area:"cyber_bar"}).then((function(e){var n=(null==e?void 0:e.data)||[];n.length&&n.forEach((function(e){e.title=e[v.l[t.$i18n.locale]]})),t.tagList=n||[]})).finally((function(){}))},initData:function(){this.step=localStorage.getItem("cacheStep")||"visualize";var t=this.getCacheInfo()||{};this.$set(this,"formData",Object.assign(this.formData,t)),this.$refs.infoForm.clearValidate(),this.getVoiceDetail()},clearFormFields:function(){var t=this;this.$confirm(this.$t("tavern4"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){var e;null!=t&&null!==(e=t.formData)&&void 0!==e&&e.id?t.handleDetailData():(t.formData.name="",t.formData.intro="",t.formData.first_msg="",t.formData.evaluation="",t.formData.personal="",t.formData.dialog_example="",t.formData.scene="",t.formData.categories=[],t.formData.cover.cover="",t.formData.cover.cover_width=0,t.formData.cover.cover_height=0,t.importJsonError=[],t.base64RoleUrl="")}))},handleCharacterLoad:function(){this.showImage=!0},handleCharacterLoadError:function(){this.showImage=!1},handleRoleCoverBeforeUpload:function(t){var e=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,r,l,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.UPLOAD,r=["image/jpeg","image/png","image/jpg","image/gif","image/webp"],!e.isCoverLoading){n.next=4;break}return n.abrupt("return");case 4:if(r.includes(t.type)){n.next=7;break}return e.$message.error(e.$t("AllowImageFiles")),n.abrupt("return",!1);case 7:if(!(l=t)||l.size){n.next=10;break}return n.abrupt("return",!1);case 10:if(!(t.size/1024/1024>10)){n.next=21;break}return n.prev=11,n.next=14,Object(O.a)(t,10485760);case 14:l=n.sent,n.next=21;break;case 17:return n.prev=17,n.t0=n.catch(11),console.error("Compression failed:",n.t0),n.abrupt("return");case 21:return n.next=23,e.checkImageSize(l);case 23:if(c=n.sent,e.formData.cover.cover=c.url||"",e.formData.cover.cover_width=c.realWidth||0,e.formData.cover.cover_height=c.realHeight||0,!e.isCoverLoading){n.next=29;break}return n.abrupt("return");case 29:return e.isCoverLoading=!0,o.startUpload(l).then((function(t){e.isCoverLoading=!1,e.coverImageLoading=!0,e.formData.cover.cover=t||""})).catch((function(t){e.isCoverLoading=!1,e.coverImageLoading=!1,e.formData.cover.cover="",e.formData.cover.cover_width=0,e.formData.cover.cover_height=0,e.$message.error(e.$t("uploadError"))})),n.abrupt("return",!1);case 32:case"end":return n.stop()}}),n,null,[[11,17]])})))()},checkImageSize:function(t){return new Promise((function(e,n){var o=new FileReader;o.onload=function(t){var img=new Image;img.onload=function(){var t={width:img.width,height:img.height,realWidth:img.naturalWidth,realHeight:img.naturalHeight};t.url=img.src,e(t)},img.onerror=function(){n(!1)},img.src=t.target.result},o.readAsDataURL(t)}))},handleNextStep:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.errorSubTitle=null,this.step=t||"visualize"},updateSelectList:function(t){var e=t.type,n=void 0===e?"":e,o=t.url,r=void 0===o?"":o,l=t.width,c=void 0===l?0:l,d=t.height,h=void 0===d?0:d;if("background"===n)return this.isBackgroundLoading=!0,this.formData.vision.bg.cover=r||"",void this.$emit("updateBg",{backgroundUrl:r,width:c,height:h});"character"===n&&(this.isCharacterLoading=!0,this.showImage=!1,this.base64RoleUrl="",this.formData.vision.character.cover=r)},removeImage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return["cover"].includes(t)?(this.formData.cover.cover="",this.formData.cover.cover_width=0,this.formData.cover.cover_height=0,void(this.coverImageLoading=!1)):["background"].includes(t)?(this.formData.vision.bg.cover="",this.formData.vision.bg.cover_width=0,this.formData.vision.bg.cover_height=0,this.isBackgroundLoading=!1,void this.$emit("updateBg",{backgroundUrl:"",type:1})):void(["character"].includes(t)&&(this.formData.vision.character.cover="",this.formData.vision.character.cover_width=0,this.formData.vision.character.cover_height=0,this.isCharacterLoading=!1,this.showImage=!1,this.base64RoleUrl=""))},handleImageLoad:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0,o=0;try{n=t.target.naturalWidth,o=t.target.naturalHeight}catch(t){}if(["background"].includes(e))return this.formData.vision.bg.cover_width=n||0,this.formData.vision.bg.cover_height=o||0,void(this.isBackgroundLoading=!1);["character"].includes(e)&&(this.formData.vision.character.cover_width=n||0,this.formData.vision.character.cover_height=o||0,this.isCharacterLoading=!1)},handleImageLoadError:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";["background"].includes(t)?this.isBackgroundLoading=!1:["character"].includes(t)&&(this.isCharacterLoading=!1)},changeClass:function(t){if(2===t&&!this.isVip)return this.formData.publish_status=1,void this.$EventBus.$emit("showBreakDialog","AIPersonTipWeb","basic");this.formData.publish_status=t},confirmPublish:function(){var t=this;if(!this.isPostingForm){var e=!0;if(this.$refs.nameForm2.validate((function(t){e=t})),e&&this.checkShowTab){this.checkNeedSaveToLocal(),this.isPostingForm=!0,this.createdLoading=!0;var n=this.handleParams(this.sameModel?"create":this.formData.id&&!this.autoModel?"edit":"aiAuto")||{};(this.sameModel?k.a:null!=n&&n.id&&!this.autoModel?k.e:k.b)(n).then((function(e){var n,o,r;return 1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)?(t.errorSubTitle=null,t.$emit("updateBg",{backgroundUrl:"",width:0,height:0}),void t.$router.push(t.localePath("/cyberPubPage/my-characters"))):10618===(null==e||null===(o=e.status)||void 0===o?void 0:o.code)?(t.errorSubTitle=t.handleChangeString(null==e||null===(r=e.status)||void 0===r?void 0:r.msg),void t.$refs.CreaCharacterConfirmModal.show({subTitle:t.errorSubTitle,hideClose:!0})):void 0})).finally((function(){t.createdLoading=!1,t.isPostingForm=!1}))}else this.$message.warning(this.$t("tavern33"))}},getCacheInfo:function(){var t=localStorage.getItem("tavernNewCharacterInfo")||null;try{t=t?JSON.parse(t):null}catch(t){}return t},checkNeedSaveToLocal:function(){this.detailInfo||(localStorage.setItem("tavernNewCharacterInfo",JSON.stringify(this.formData)),localStorage.setItem("cacheStep",this.step))},handleParams:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"edit",e=JSON.parse(JSON.stringify(this.formData));return e.permission={same:e.same,publish:e.publish_status},delete e.same,delete e.publish_status,"aiAuto"===t&&(e.tag_ids=e.categories,e.cover={url:this.formData.cover.cover,width:this.formData.cover.cover_width,height:this.formData.cover.cover_height}),"create"===t&&(e.cover={cover:this.formData.cover.cover,cover_width:this.formData.cover.cover_width,cover_height:this.formData.cover.cover_height}),e},goToInfo:function(){!["",null,void 0].includes(this.formData.cover.cover)&&/^(http|https):\/\//.test(this.formData.cover.cover)?this.handleNextStep("info"):this.$message.warning(this.$t("digitalHumanTost"))},goToPreview:function(){if(this.formData.evaluation.length>this.evaluationLimit)this.$message.warning(this.$t("createLimitTip",{key:this.$t("tavern12")}));else if(this.formData.scene.length>this.sceneLimit)this.$message.warning(this.$t("createLimitTip",{key:this.$t("tavern14")}));else if(this.formData.personal.length>this.personalLimit)this.$message.warning(this.$t("createLimitTip",{key:this.$t("tavern8")}));else{var t=!0;this.$refs.infoForm.validate((function(e){t=e})),t?(this.checkNeedSaveToLocal(),this.handleNextStep("preview")):this.$message.warning(this.$t("tavern33"))}}}},P=L,M=(n(2669),n(2670),Object(y.a)(P,(function(){var t,e,n,o=this,r=o._self._c;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:o.pageLoading,expression:"pageLoading"}],staticClass:"p-tavern-new-character"},[r("div",{staticClass:"p-tavern-new-character-container"},[o.checkShowTab?r("TabBar",{attrs:{tabList:o.tabList,step:o.step},on:{handleNextStep:o.handleNextStep}}):o._e(),o._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:["visualize"].includes(o.step),expression:"['visualize'].includes(step)"}],staticClass:"visualize-box"},[r("div",{staticClass:"tavern-new-character-scroll tavern-new-character-scroll-1"},[r("div",{staticClass:"step-box"},[r("div",{staticClass:"tips"},[r("div",{staticClass:"label"},[r("span",[o._v("*")]),o._v(o._s(o.$t("digitalHumanReference")))]),o._v(" "),r("div",{staticClass:"tip"},[o._v(o._s(o.$t("digitalHumanSizeTip")))])]),o._v(" "),r("div",{staticClass:"form-item"},[r("div",{directives:[{name:"loading",rawName:"v-loading",value:o.isCoverLoading||o.coverImageLoading,expression:"isCoverLoading || coverImageLoading"}],staticClass:"add-role-avatar add-role-avatar-1"},[o.formData.cover.cover?[r("img",{attrs:{src:o.formData.cover.cover,alt:""},on:{load:function(t){o.coverImageLoading=!1},error:function(t){o.coverImageLoading=!1}}}),o._v(" "),r("span",{directives:[{name:"show",rawName:"v-show",value:o.formData.cover.cover&&!o.isCoverLoading,expression:"formData.cover.cover && !isCoverLoading"}],staticClass:"el-image-viewer__close",on:{click:function(t){return t.stopPropagation(),o.removeImage("cover")}}},[r("i",{staticClass:"el-icon-close"})])]:r("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:o.isCoverLoading,expression:"isCoverLoading"}],key:"add-role-avatar",ref:"addRoleAvatar",staticClass:"image-upload",attrs:{action:"#","before-upload":o.handleRoleCoverBeforeUpload,disabled:o.isCoverLoading,accept:o.accept,"http-request":function(){},"show-file-list":!1}},[r("div",{staticClass:"image-upload-trigger",attrs:{slot:"trigger"},slot:"trigger"},[r("i",{staticClass:"iconfont icon-add-icon"}),o._v(" "),r("span",[o._v(o._s(o.$t("localUploda")))])])])],2),o._v(" "),o.isShowUpload2?r("div",{directives:[{name:"loading",rawName:"v-loading",value:o.isCoverLoading||o.coverImageLoading,expression:"isCoverLoading || coverImageLoading"}],staticClass:"add-role-avatar add-role-avatar-1"},[o.formData.cover.cover?[r("img",{attrs:{src:o.formData.cover.cover,alt:""},on:{load:function(t){o.coverImageLoading=!1},error:function(t){o.coverImageLoading=!1}}}),o._v(" "),r("span",{directives:[{name:"show",rawName:"v-show",value:o.formData.cover.cover&&!o.isCoverLoading,expression:"formData.cover.cover && !isCoverLoading"}],staticClass:"el-image-viewer__close",on:{click:function(t){return t.stopPropagation(),o.removeImage("cover")}}},[r("i",{staticClass:"el-icon-close"})])]:r("div",{staticClass:"image-upload",on:{click:function(t){return t.stopPropagation(),o.openPickWorkModal.apply(null,arguments)}}},[r("div",{staticClass:"image-upload-trigger"},[r("i",{staticClass:"iconfont icon-add-icon"}),o._v(" "),r("span",[o._v(o._s(o.$t("personlCenterUploda")))])])])],2):o._e()]),o._v(" "),r("el-form",{staticClass:"custom-form custom-form-character",attrs:{"label-position":"top",model:o.formData}},[r("el-form-item",{attrs:{label:o.$t("roleGeneralization"),prop:"intro"}},[r("el-input",{staticClass:"text-area-min-height",attrs:{placeholder:o.$t("generalizationTip"),type:"textarea",autosize:{minRows:2,maxRows:6},"show-word-limit":"",maxlength:o.introLimit},model:{value:o.createdByIntro,callback:function(t){o.createdByIntro=t},expression:"createdByIntro"}})],1)],1)],1),o._v(" "),r("div",{staticClass:"bottom-btn-box"},[r("div",{staticClass:"auto-create-btn",on:{click:function(t){return t.stopPropagation(),o.handleAiCreate.apply(null,arguments)}}},[r("svg-icon",{attrs:{"icon-class":"frame"}}),o._v("\n            "+o._s(o.$t("digitalHumanAiCreated"))+"\n          ")],1),o._v(" "),r("el-button",{staticClass:"bottom-btn-box-btn bottom-btn-box-bg",on:{click:function(t){return t.stopPropagation(),o.goToInfo.apply(null,arguments)}}},[o._v(o._s(o.$t("NextStep")))])],1)])]),o._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:["info"].includes(o.step),expression:"['info'].includes(step)"}],staticClass:"info-box"},[r("div",{staticClass:"tavern-new-character-scroll"},[r("el-form",{ref:"infoForm",staticClass:"custom-form custom-form-character",attrs:{"label-position":"top",model:o.formData,rules:o.rules}},[r("el-form-item",{staticClass:"custom-name-form-item",attrs:{label:o.$t("AI_person_name"),prop:"name"}},[r("el-input",{staticClass:"custom-name-form-item-input",attrs:{maxlength:40,"show-word-limit":""},model:{value:o.formData.name,callback:function(t){o.$set(o.formData,"name",t)},expression:"formData.name"}}),o._v(" "),r("span",{staticClass:"name-tip",on:{click:function(t){return t.stopPropagation(),o.clearFormFields.apply(null,arguments)}}},[o._v(o._s(o.$t(o.formData.id?"tavern53":"tavern52")))])],1),o._v(" "),r("el-form-item",{attrs:{label:o.$t("tavern7")}},[r("template",{slot:"label"},[r("div",{staticClass:"custom-label"},[r("span",[o._v(o._s(o.$t("tavern7")))]),o._v(" "),r("el-popover",{attrs:{placement:"top-start",title:"",width:o.popoverWidth,trigger:o.popoverTrigger,"popper-class":"new-character-popover","visible-arrow":!1}},[r("div",{staticClass:"content"},[o._v("\n                    "+o._s(o.$t("tavern20"))),r("a",{staticClass:"text-purchaseBg",attrs:{href:o.configurationFileUrl,target:"_blank","data-tabindex":"",tabindex:"-1"}},[o._v(o._s(o.$t("tavern21")))]),o._v(o._s(o.$t("tavern22"))+"\n                  ")]),o._v(" "),r("span",{staticClass:"el-icon-warning custom-tips",attrs:{slot:"reference"},slot:"reference"})])],1)]),o._v(" "),r("div",{staticClass:"upload-config-box"},[r("el-upload",{staticClass:"upload-demo",attrs:{action:"/",limit:1,"show-file-list":!1,"before-upload":o.handleUploadJson,accept:"application/json"}},[r("div",{staticClass:"upload-config-icon-box",attrs:{slot:"trigger"},slot:"trigger"},[r("i",{staticClass:"iconfont icon-upload-icon"})])])],1),o._v(" "),r("div",{staticClass:"import-json-error"},o._l(o.importJsonError,(function(t){return r("p",{key:t},[o._v("\n                "+o._s("".concat(t," ").concat(o.$t("tavern32")))+"\n              ")])})),0)],2),o._v(" "),r("el-form-item",{attrs:{label:o.$t("tavern6"),prop:"intro"}},[r("template",{slot:"label"},[r("div",{staticClass:"custom-label"},[r("span",[o._v(o._s(o.$t("tavern6")))]),o._v(" "),r("el-popover",{attrs:{placement:"top-start",title:"",width:o.popoverWidth,trigger:o.popoverTrigger,"popper-class":"new-character-popover","visible-arrow":!1}},[r("div",{staticClass:"content"},[o._v("\n                    "+o._s(o.$t("tavern5"))+"\n                  ")]),o._v(" "),r("span",{staticClass:"el-icon-warning custom-tips",attrs:{slot:"reference"},slot:"reference"})])],1)]),o._v(" "),r("el-input",{staticClass:"text-area-min-height",attrs:{placeholder:o.$t("pleaseEnte"),type:"textarea","show-word-limit":"",autosize:{minRows:2},maxlength:o.personalLimit},model:{value:o.formData.intro,callback:function(t){o.$set(o.formData,"intro",t)},expression:"formData.intro"}})],2),o._v(" "),r("el-form-item",{attrs:{label:o.$t("tavern8"),prop:"personal"}},[r("template",{slot:"label"},[r("div",{staticClass:"custom-label"},[r("span",[o._v(o._s(o.$t("tavern8")))]),o._v(" "),r("el-popover",{attrs:{placement:"top-start",title:"",width:o.popoverWidth,trigger:o.popoverTrigger,"popper-class":"new-character-popover","visible-arrow":!1}},[r("div",{staticClass:"content"},[o._v("\n                    "+o._s(o.$t("tavern9"))+"\n                  ")]),o._v(" "),r("span",{staticClass:"el-icon-warning custom-tips",attrs:{slot:"reference"},slot:"reference"})])],1)]),o._v(" "),r("el-input",{staticClass:"text-area-min-height",attrs:{placeholder:o.$t("pleaseEnte"),type:"textarea","show-word-limit":"",autosize:{minRows:2},maxlength:o.personalLimit},model:{value:o.formData.personal,callback:function(t){o.$set(o.formData,"personal",t)},expression:"formData.personal"}})],2),o._v(" "),o.showVoiceIcon?r("el-form-item",{staticClass:"sound-form-item",attrs:{label:"",prop:"sound"}},[r("template",{slot:"label"},[r("div",{staticClass:"custom-label"},[r("span",{staticClass:"label"},[o._v(o._s(o.$t("sound")))]),o._v(" "),r("span",{staticClass:"btn",on:{click:o.handleCreate}},[o._v(o._s(o.$t("customCreated")))])])]),o._v(" "),r("div",{staticClass:"sound-select-item",on:{click:o.handleSelectSound}},[r("div",{staticClass:"sound-input"},[o._v(o._s((null===(t=o.voiceObj)||void 0===t?void 0:t.name)||o.$t("Pls_select")))]),o._v(" "),r("div",{staticClass:"btn-box"},[r("i",{staticClass:"sound-input-btn el-icon-circle-plus-outline"})])])],2):o._e(),o._v(" "),r("AiChatSoundItem",{directives:[{name:"show",rawName:"v-show",value:(null===(e=o.voiceObj)||void 0===e?void 0:e.id)&&o.showVoiceIcon,expression:"voiceObj?.id && showVoiceIcon"}],staticClass:"custom-sound-item",attrs:{showHandle:!1,item:o.voiceObj}},[r("div",{staticClass:"cancel-box"},[r("i",{staticClass:"iconfont el-icon-close",on:{click:o.handleDelTimObj}})])]),o._v(" "),r("el-form-item",{staticClass:"first-msg",attrs:{label:o.$t("tavern10"),prop:"first_msg"}},[r("template",{slot:"label"},[r("div",{staticClass:"custom-label"},[r("span",[o._v(o._s(o.$t("tavern10")))]),o._v(" "),r("el-popover",{attrs:{placement:"top-start",title:"",width:o.popoverWidth,trigger:o.popoverTrigger,"popper-class":"new-character-popover","visible-arrow":!1}},[r("div",{staticClass:"content"},[o._v("\n                    "+o._s(o.$t("tavern11"))+"\n                  ")]),o._v(" "),r("span",{staticClass:"el-icon-warning custom-tips",attrs:{slot:"reference"},slot:"reference"})]),o._v(" "),o._e()],1)]),o._v(" "),r("el-input",{staticClass:"text-area-min-height",attrs:{placeholder:o.$t("pleaseEnte"),type:"textarea","show-word-limit":"",maxlength:o.firstMsgLimit,autosize:{minRows:2}},model:{value:o.formData.first_msg,callback:function(t){o.$set(o.formData,"first_msg",t)},expression:"formData.first_msg"}})],2),o._v(" "),r("el-form-item",{attrs:{label:o.$t("tavern12"),prop:"evaluation"}},[r("template",{slot:"label"},[r("div",{staticClass:"custom-label"},[r("span",[o._v(o._s(o.$t("tavern12")))]),o._v(" "),r("el-popover",{attrs:{placement:"top-start",title:"",width:o.popoverWidth,trigger:o.popoverTrigger,"popper-class":"new-character-popover","visible-arrow":!1}},[r("div",{staticClass:"content"},[o._v("\n                    "+o._s(o.$t("tavern13"))+"\n                  ")]),o._v(" "),r("span",{staticClass:"el-icon-warning custom-tips",attrs:{slot:"reference"},slot:"reference"})])],1)]),o._v(" "),r("el-input",{staticClass:"text-area-min-height",attrs:{placeholder:o.$t("pleaseEnte"),type:"textarea","show-word-limit":"",maxlength:o.evaluationLimit,autosize:{minRows:2}},model:{value:o.formData.evaluation,callback:function(t){o.$set(o.formData,"evaluation",t)},expression:"formData.evaluation"}})],2),o._v(" "),r("el-form-item",{attrs:{label:o.$t("tavern14")}},[r("template",{slot:"label"},[r("div",{staticClass:"custom-label"},[r("span",[o._v(o._s(o.$t("tavern14")))]),o._v(" "),r("el-popover",{attrs:{placement:"top-start",title:"",width:o.popoverWidth,trigger:o.popoverTrigger,"popper-class":"new-character-popover","visible-arrow":!1}},[r("div",{staticClass:"content"},[o._v("\n                    "+o._s(o.$t("tavern15"))+"\n                  ")]),o._v(" "),r("span",{staticClass:"el-icon-warning custom-tips",attrs:{slot:"reference"},slot:"reference"})])],1)]),o._v(" "),r("el-input",{staticClass:"text-area-min-height",attrs:{placeholder:o.$t("pleaseEnte"),type:"textarea","show-word-limit":"",maxlength:o.sceneLimit,autosize:{minRows:2}},model:{value:o.formData.scene,callback:function(t){o.$set(o.formData,"scene",t)},expression:"formData.scene"}})],2),o._v(" "),r("el-form-item",{attrs:{label:o.$t("tavern16")}},[r("template",{slot:"label"},[r("div",{staticClass:"custom-label"},[r("span",[o._v(o._s(o.$t("tavern16")))]),o._v(" "),r("el-popover",{attrs:{placement:"top-start",title:"",width:o.popoverWidth,trigger:o.popoverTrigger,"popper-class":"new-character-popover","visible-arrow":!1}},[r("div",{staticClass:"content"},[o._v("\n                    "+o._s(o.$t("tavern17"))+"\n                  ")]),o._v(" "),r("span",{staticClass:"el-icon-warning custom-tips",attrs:{slot:"reference"},slot:"reference"})])],1)]),o._v(" "),r("el-input",{staticClass:"text-area-min-height",attrs:{placeholder:o.$t("pleaseEnte"),type:"textarea","show-word-limit":"",maxlength:o.dialogExampleLimit,autosize:{minRows:2}},model:{value:o.formData.dialog_example,callback:function(t){o.$set(o.formData,"dialog_example",t)},expression:"formData.dialog_example"}})],2),o._v(" "),r("el-form-item",{attrs:{label:o.$t("tavern18"),prop:"categories"}},[r("template",{slot:"label"},[r("div",{staticClass:"custom-label"},[r("span",[o._v(o._s(o.$t("tavern18")))]),o._v(" "),r("el-popover",{attrs:{placement:"top-start",title:"",width:o.popoverWidth,trigger:o.popoverTrigger,"popper-class":"new-character-popover","visible-arrow":!1}},[r("div",{staticClass:"content"},[o._v("\n                    "+o._s(o.$t("tavern19"))+"\n                  ")]),o._v(" "),r("span",{staticClass:"el-icon-warning custom-tips",attrs:{slot:"reference"},slot:"reference"})])],1)]),o._v(" "),r("client-only",[r("div",{staticClass:"category-box"},[r("el-checkbox-group",{staticClass:"category-box-grid",attrs:{min:0,max:7},model:{value:o.formData.categories,callback:function(t){o.$set(o.formData,"categories",t)},expression:"formData.categories"}},o._l(o.tagList,(function(t){return r("el-checkbox",{key:t.id,attrs:{label:t.id}},[o._v(o._s(t.title))])})),1),o._v(" "),r("div",{staticClass:"category-box-item"})],1)])],2)],1),o._v(" "),r("div",{staticClass:"bottom-btn-box"},[r("span",{staticClass:"bottom-btn-box-btn",on:{click:function(t){return t.stopPropagation(),o.handleNextStep("visualize")}}},[o._v(o._s(o.$t("PreNext")))]),o._v(" "),r("span",{staticClass:"bottom-btn-box-btn bottom-btn-box-bg",on:{click:function(t){return t.stopPropagation(),o.goToPreview.apply(null,arguments)}}},[o._v(o._s(o.$t("tavern30")))])])],1)]),o._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:["preview"].includes(o.step),expression:"['preview'].includes(step)"}],staticClass:"preview-box"},[r("div",{staticClass:"tavern-new-character-scroll"},[r("div",{staticClass:"step-box"},[r("div",{staticClass:"form-item"},[r("div",{staticClass:"add-role-avatar"},[r("img",{attrs:{src:o.formData.cover.cover,alt:""}})]),o._v(" "),r("div",{staticClass:"form-item-content"},[r("el-form",{ref:"nameForm2",staticClass:"custom-form custom-form-character",attrs:{"label-position":"top",model:o.formData,inline:"",rules:o.rules}},[r("el-form-item",{attrs:{label:o.$t("AI_person_name"),prop:"name"}},[r("el-input",{staticStyle:{width:"524px"},attrs:{maxlength:40,"show-word-limit":""},model:{value:o.formData.name,callback:function(t){o.$set(o.formData,"name",t)},expression:"formData.name"}})],1)],1)],1)]),o._v(" "),r("div",{staticClass:"is-same-style"},[r("span",[o._v(o._s(o.$t("digitalHumanIsSame")))]),o._v(" "),r("el-switch",{attrs:{"active-value":1,"inactive-value":2},model:{value:o.formData.same,callback:function(t){o.$set(o.formData,"same",t)},expression:"formData.same"}})],1),o._v(" "),r("div",{staticClass:"form-label-item"},[r("div",{staticClass:"form-label-item-title"},[o._v(o._s(o.$t("tavern31")))]),o._v(" "),r("div",{staticClass:"form-label-item-content"},[r("div",{staticClass:"class-tab"},[r("div",{staticClass:"flex-center",class:{active:1==o.formData.publish_status},on:{click:function(t){return o.changeClass(1)}}},[r("i",{staticClass:"iconfont icon-eye"}),o._v(o._s(o.$t("createSetting1"))+"\n                ")]),o._v(" "),r("div",{staticClass:"flex-center",class:{active:2==o.formData.publish_status},on:{click:function(t){return o.changeClass(2)}}},[r("i",{staticClass:"iconfont icon-eye-disable"}),o._v(o._s(o.$t("createSetting2"))),r("span")])])])]),o._v(" "),r("div",{staticClass:"form-label-item form-label-item-2"},[r("div",{staticClass:"category-box"},[r("div",{staticClass:"form-label-item-title"},[o._v(o._s(o.$t("Category")))]),o._v(" "),r("div",{staticClass:"form-label-item-content2"},o._l(o.tagLabel,(function(t){return r("div",{key:t,staticClass:"select-tag-item"},[o._v(o._s(t))])})),0)]),o._v(" "),o._e()]),o._v(" "),r("div",{staticClass:"other-form-params"},[r("div",{staticClass:"other-form-params-item"},[r("p",{staticClass:"other-form-params-item-title m-b-10"},[o._v("\n                "+o._s(o.$t("Desc"))+"\n              ")]),o._v(" "),r("p",{staticClass:"other-form-params-item-sub-title"},[o._v("\n                "+o._s(o.formData.intro)+"\n              ")])]),o._v(" "),r("div",{staticClass:"other-form-params-item"},[r("p",{staticClass:"other-form-params-item-title m-b-10"},[o._v("\n                "+o._s(o.$t("tavern8"))+"\n              ")]),o._v(" "),r("p",{staticClass:"other-form-params-item-sub-title"},[o._v("\n                "+o._s(o.formData.personal)+"\n              ")])]),o._v(" "),r("div",{staticClass:"other-form-params-item"},[r("p",{staticClass:"other-form-params-item-title m-b-10"},[o._v("\n                "+o._s(o.$t("tavern10"))+"\n              ")]),o._v(" "),r("p",{staticClass:"other-form-params-item-sub-title"},[o._v("\n                "+o._s(o.formData.first_msg)+"\n              ")])]),o._v(" "),r("div",{staticClass:"other-form-params-item"},[r("p",{staticClass:"other-form-params-item-title m-b-10"},[o._v("\n                "+o._s(o.$t("tavern12"))+"\n              ")]),o._v(" "),r("p",{staticClass:"other-form-params-item-sub-title"},[o._v("\n                "+o._s(o.formData.evaluation)+"\n              ")])]),o._v(" "),r("div",{staticClass:"other-form-params-item"},[r("p",{staticClass:"other-form-params-item-title m-b-10"},[o._v("\n                "+o._s(o.$t("tavern14"))+"\n              ")]),o._v(" "),r("p",{staticClass:"other-form-params-item-sub-title"},[o._v("\n                "+o._s(o.formData.scene||o.$t("tavern39"))+"\n              ")])]),o._v(" "),r("div",{staticClass:"other-form-params-item"},[r("p",{staticClass:"other-form-params-item-title m-b-10"},[o._v("\n                "+o._s(o.$t("tavern16"))+"\n              ")]),o._v(" "),r("p",{staticClass:"other-form-params-item-sub-title"},[o._v("\n                "+o._s(o.formData.dialog_example||o.$t("tavern39"))+"\n              ")])])]),o._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:o.showVoiceIcon&&(null===(n=o.voiceObj)||void 0===n?void 0:n.id),expression:"showVoiceIcon && voiceObj?.id"}],staticClass:"voice-preview"},[r("div",{staticClass:"voice-preview-title"},[o._v(o._s(o.$t("sound")))]),o._v(" "),r("AiChatSoundItem",{attrs:{"dom-id":"preview",showHandle:!1,pageType:"edit",item:o.voiceObj}})],1)]),o._v(" "),r("div",{staticClass:"bottom-btn-box"},[r("span",{staticClass:"bottom-btn-box-btn",on:{click:function(t){return t.stopPropagation(),o.handleNextStep("info")}}},[o._v(o._s(o.$t("PreNext")))]),o._v(" "),r("span",{staticClass:"bottom-btn-box-btn bottom-btn-box-bg",on:{click:function(t){return t.stopPropagation(),o.confirmPublish.apply(null,arguments)}}},[o._v(o._s(o.$t("releaseName")))])])])]),o._v(" "),r("pick-work-modal",{ref:"pickWorkModal",attrs:{type:"character",maxNum:1},on:{confirm:o.handleSelectArtWork}}),o._v(" "),o.createdLoading?r("div",{staticClass:"loading-overlay"},[r("div",{staticClass:"loading-content"},[r("i",{staticClass:"el-icon-loading loading-icon"}),o._v(" "),o.isPostingForm?o._e():r("span",[o._v("\n          "+o._s(o.$t("digitalHumanLoading"))+"\n        ")])])]):o._e()],1),o._v(" "),r("selectSoundModel",{ref:"selectSoundModel",attrs:{selectList:o.formData.timbre_id?[o.formData.timbre_id]:[],item:o.voiceObj},on:{selectModel:o.selectModel}}),o._v(" "),r("CreaCharacterConfirmModal",{ref:"CreaCharacterConfirmModal"})],1)}),[],!1,null,"1ccdc9b8",null));e.default=M.exports},3277:function(t,e,n){"use strict";n.r(e);var o=n(31),r=n(3),l=(n(20),n(4),n(50),n(48),n(543)),c=n(176),d={props:{bList:{type:Array,default:function(){return[]}}},data:function(){return{bannerList:this.bList||[]}},mounted:function(){},methods:{getList:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(c.a)();case 3:n=e.sent,o=n.data.items,r=void 0===o?[]:o,t.bannerList=r;case 7:return e.prev=7,t.loading=!1,e.finish(7);case 10:case"end":return e.stop()}}),e,null,[[0,,7,10]])})))()},goDetail:function(t){this.$router.push(this.localePath("/news/".concat(t.id)))}}},h=(n(2913),n(0)),m=Object(h.a)(d,(function(){var t=this,e=t._self._c;return e("el-carousel",{attrs:{"indicator-position":"outside",height:"420px",arrow:"never"}},t._l(t.bannerList,(function(n){return e("el-carousel-item",{key:n.id},[e("a",{staticClass:"banner",attrs:{href:t.localePath("/news/".concat(n.seo_url))}},[e("div",{staticClass:"banner-left"},[e("img",{attrs:{src:n.cover,alt:n.title}})]),t._v(" "),e("div",{staticClass:"banner-right"},[e("span",{staticClass:"banner-right-top"},[t._v("\n          "+t._s(n.post_title)+"\n        ")]),t._v(" "),e("span",{staticClass:"banner-right-content"},[t._v("\n          "+t._s(n.meta_desc)+"\n        ")]),t._v(" "),e("div",{staticClass:"banner-right-bottom"},[e("div",[e("span",[t._v(t._s(n.author))])]),t._v(" "),e("div",[e("i",{staticClass:"el-icon-time"}),t._v(" "),e("span",[t._v(t._s(n.reading_duration)+" "+t._s(t.$t("blog_read")))])])])])])])})),1)}),[],!1,null,"b54c44ec",null).exports,v={components:{SwipeableList:n(64).a},props:{bList:{type:Array,default:function(){return[]}},cList:{type:Array,default:function(){return[]}}},data:function(){return{blogList:this.bList||[],categroyList:this.cList||[],tagList:[{icon:"icon-icon_All_",label:"All",value:"all",i18nKey:"news_all"},{icon:"icon-a-icon_AIArtGuide_",label:"专家见解",value:"newsExpertInsights",i18nKey:"news_newsExpertInsights"},{icon:"icon-a-icon_AIVideoGuide_",label:"AI基础指南",value:"newsAIFundamentals",i18nKey:"news_newsAIFundamentals"},{icon:"icon-a-icon_TrainingGuide_",label:"行业动态",value:"newsIndustryTrends",i18nKey:"news_newsIndustryTrends"},{icon:"icon-icon_news_",label:"产品解读",value:"newsProductAnalysis",i18nKey:"news_newsProductAnalysis"},{icon:"icon-a-icon_AITools_",label:"技术分享",value:"newsTechnicalSharing",i18nKey:"news_newsTechnicalSharing"}],currentIndex:0,paramsData:{keyword:"",category:"",page:1,page_size:30,type:"aiNews"},loading:!1,itemScrollLeft:null}},watch:{"paramsData.keyword":{handler:function(t){t&&!this.loading&&this.getBlogList()}}},mounted:function(){},methods:{getList:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(c.b)({page:1,page_size:30,type:"aiNews"});case 3:n=e.sent,o=n.data.categories,r=void 0===o?[]:o,t.categroyList=r;case 7:return e.prev=7,t.loading=!1,e.finish(7);case 10:case"end":return e.stop()}}),e,null,[[0,,7,10]])})))()},getBlogList:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,Object(c.d)(t.paramsData);case 4:n=e.sent,o=n.data.items,r=void 0===o?[]:o,t.blogList=r;case 8:return e.prev=8,t.loading=!1,e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[0,,8,11]])})))()},chooseTag:function(t,e){this.currentIndex=e,this.paramsData.category=t,this.getBlogList(),this.$logEvent("log_actions",{operation:"click_news_tab",behavior_info:"on_news_detail_page",behavior_info_sub:t})},goDetail:function(t){this.$router.push(this.localePath("/news/".concat(t.id)))}}},f=(n(2914),Object(h.a)(v,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"categroy"},[e("div",{staticClass:"categroy-title"},[e("div",{staticClass:"categroy-title-content"},[t._v("\n      "+t._s(t.$t("news_recent"))+"\n      "),e("el-input",{staticStyle:{width:"320px"},attrs:{placeholder:t.$t("Search"),"suffix-icon":"el-icon-search"},model:{value:t.paramsData.keyword,callback:function(e){t.$set(t.paramsData,"keyword",e)},expression:"paramsData.keyword"}})],1)]),t._v(" "),e("div",{staticClass:"tag-list"},[e("SwipeableList",{attrs:{top:"0px",height:"50px",bntTop:"0px",listAlignItems:"flex-end",listGap:"14px",scrollLeftnum:t.itemScrollLeft}},t._l(t.tagList,(function(n,o){return e("div",{key:n.value,staticClass:"tag-list-item",class:{active:t.currentIndex===o},on:{click:function(e){return t.chooseTag(n.value,o)}}},[e("i",{staticClass:"iconfont",class:t.currentIndex===o?"".concat(null==n?void 0:n.icon,"selected"):"".concat(null==n?void 0:n.icon,"default")}),t._v(" "),e("span",[t._v(t._s(t.$t("".concat(n.i18nKey))))])])})),0)],1),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"categroy-list"},t._l(t.blogList,(function(n,o){return e("a",{key:o,staticClass:"categroy-list-item",attrs:{href:t.localePath("/news/".concat(n.seo_url))}},[e("img",{staticClass:"categroy-list-item-img",attrs:{src:n.cover,alt:n.title}}),t._v(" "),e("span",{staticClass:"categroy-list-item-top"},[t._v("\n        "+t._s(t.$t("news_".concat(n.category)))+"\n      ")]),t._v(" "),e("span",{staticClass:"categroy-list-item-content"},[t._v("\n        "+t._s(n.post_title)+"\n      ")]),t._v(" "),e("div",{staticClass:"categroy-list-item-bottom"},[e("div",[e("span",[t._v(t._s(n.author))])]),t._v(" "),e("div",[e("i",{staticClass:"el-icon-time"}),t._v(" "),e("span",[t._v(t._s(n.reading_duration)+" "+t._s(t.$t("blog_read")))])])])])})),0),t._v(" "),0!==t.blogList.length||t.loading?t._e():e("div",{staticClass:"defBox"},[e("img",{attrs:{src:n(450),alt:""}}),t._v(" "),e("span",[t._v(t._s(t.$t("no_data")))])])])}),[],!1,null,"94b8eb7a",null).exports),_={components:{BlogHeader:l.a,FeaturedPosts:m,RecentPosts:f},data:function(){return{blogList:[],categroyList:[],bannerList:[]}},methods:{},head:function(){var title=this.$t("news_tag_title"),desc=this.$t("news_tag_desc");return{title:title,meta:[{hid:"description",name:"description",content:desc},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:desc}]}},asyncData:function(t){return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r,l,c,d,data,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,t.app,t.params,r=t.error,e.prev=1,e.next=4,Promise.all([n.$post("/api/v1/blog/category",{page:1,page_size:100,type:"aiNews"}),n.$post("/api/v1/blog/home",{keyword:"",category:"",page:1,page_size:100,type:"aiNews"}),n.$post("/api/v1/blog/banner",{type:"aiNews"})]);case 4:return l=e.sent,c=Object(o.a)(l,3),d=c[0].data,data=c[1].data,h=c[2].data,e.abrupt("return",{categroyList:(null==d?void 0:d.categories)||[],blogList:(null==data?void 0:data.items)||[],bannerList:(null==h?void 0:h.items)||[]});case 12:e.prev=12,e.t0=e.catch(1),console.log("blog -> asyncData错误啦：",e.t0),r({statusCode:404,message:e.t0});case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))()}},y=(n(2915),Object(h.a)(_,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"blog"},[e("BlogHeader"),t._v(" "),e("div",{staticClass:"blog-title"},[e("span",{staticClass:"blog-title-content"},[t._v(t._s(t.$t("news_recommend_article")))])]),t._v(" "),e("FeaturedPosts",{attrs:{bList:t.bannerList}}),t._v(" "),e("RecentPosts",{attrs:{bList:t.blogList,cList:t.categroyList}})],1)}),[],!1,null,"481301bc",null));e.default=y.exports},3281:function(t,e,n){"use strict";n.r(e);var o=n(3),r=(n(20),n(7),n(4),n(23),n(765),n(110),n(41)),l=(n(16),n(113),n(6),n(390)),c={props:{},data:function(){return{handleInitHelp:l.a,dialogVisible:!1,link:"https://starunion.aihelp.net/questionnaire/#/?formId=bffe7a2307454e859f559913e28d4f19",repeatLinks:""}},computed:{repeatLinksHtml:function(){return this.$t("ImportModelFailed",{repeatLinks:this.repeatLinks})}},mounted:function(){},methods:{open:function(t){var e=this;this.dialogVisible=!0,t.forEach((function(t,n){var o=n>0?"、":"";e.repeatLinks+="".concat(o,'<a class="text-blue" href="/models/detail/').concat(t.model_id,'" target="_blank">').concat(t.model_name,"</a>")})),this.$logEvent("log_actions",{operation:"go_to_claim_popup",behavior_info:"on_import_project_page"})},handleClose:function(t){this.dialogVisible=!1,this.repeatLinks=""},goLink:function(){window.open(this.link,"_blank"),this.handleClose(),this.$logEvent("log_actions",{operation:"click_go_to_claim",behavior_info:"on_import_project_page"})}}},d=(n(2461),n(2462),n(0)),component=Object(d.a)(c,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"repeat-model-pop",attrs:{title:t.$t("ImportModelTips"),visible:t.dialogVisible,"before-close":t.handleClose,width:"462px","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{staticClass:"dialog-text"},[e("span",{staticClass:"dialog-html",domProps:{innerHTML:t._s(t.repeatLinksHtml)}}),t._v(" "),e("span",{staticClass:"text-blue help",on:{click:function(e){return e.preventDefault(),t.handleInitHelp.apply(null,arguments)}}},[t._v(t._s(t.$t("Contact_customer")))])]),t._v(" "),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:t.goLink}},[t._v("\n      "+t._s(t.$t("GoClaimModel"))+"\n    ")])],1)])}),[],!1,null,"9c9a548e",null),h={name:"ModelImport",components:{RepeatModelPop:component.exports},data:function(){return{form:{textarea:""},loading:!1,rules:{textarea:[{required:!0,message:this.$t("ImportModelRule"),trigger:"blur"}]}}},mounted:function(){},methods:{goBack:function(){this.$router.go(-1)},resetForm:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"form";this.$refs[t].resetFields()},submitForm:function(t){var e=this;this.$refs[t].validate((function(t){if(!t)return!1;e.submit()}))},submit:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,l,data,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.form.textarea.trim()){e.next=3;break}return e.abrupt("return");case 3:return t.loading=!0,o=t.form.textarea.split(/\r?\n/).filter((function(t){return""!=t})),e.next=7,Object(r.n)({urls:o});case 7:l=e.sent,data=l.data,1e4===(c=l.status).code?t.$message.success(t.$t("ImportModelSuccess")):30047===c.code&&null!=data&&null!==(n=data.exist_models)&&void 0!==n&&n.length&&t.$refs.repeatModelPop.open(data.exist_models),t.$logEvent("log_actions",{operation:"click_submit",behavior_info:"on_import_project_page"}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),t.loading=!1;case 17:return e.prev=17,t.loading=!1,e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[0,14,17,20]])})))()}}},m=h,v=(n(2463),Object(d.a)(m,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"model-import-content"},[e("div",{staticClass:"model-import-back",on:{click:t.goBack}},[e("i",{staticClass:"el-icon-back"})]),t._v(" "),e("div",{staticClass:"model-import"},[e("div",{staticClass:"model-import-title"},[t._v(t._s(t.$t("ImportModel")))]),t._v(" "),e("div",{staticClass:"model-import-subtitle"},[e("span",{staticClass:"text-red"},[t._v("*")]),t._v(" "+t._s(t.$t("SynchronousLink"))+"\n    ")]),t._v(" "),e("div",{staticClass:"model-import-subtitle-tips"},[t._v("\n      "+t._s(t.$t("SynchronousLinkTips"))+"\n    ")]),t._v(" "),e("div",{staticClass:"model-import-input custom-form"},[e("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"form",attrs:{rules:t.rules,model:t.form}},[e("el-form-item",{attrs:{label:"",prop:"textarea"}},[e("el-input",{staticStyle:{width:"650px"},attrs:{placeholder:t.$t("ImportModelPlaceholder"),maxlength:"100"},model:{value:t.form.textarea,callback:function(e){t.$set(t.form,"textarea",e)},expression:"form.textarea"}})],1),t._v(" "),e("div",{staticClass:"model-import-tips"},[e("span",[t._v(t._s(t.$t("ImportModelTips")))]),t._v(" "),e("span",[t._v(t._s(t.$t("ImportModelTips1")))]),t._v(" "),e("span",[t._v(t._s(t.$t("ImportModelTips2")))]),t._v(" "),e("span",[t._v(t._s(t.$t("ImportModelTips3")))])]),t._v(" "),e("el-form-item",{staticClass:"flex-center"},[e("div",{staticClass:"model-import-btn",on:{click:function(e){return t.submitForm("form")}}},[t._v("\n            "+t._s(t.$t("Submit"))+"\n          ")])])],1)],1)]),t._v(" "),e("RepeatModelPop",{ref:"repeatModelPop"})],1)}),[],!1,null,"dd44011e",null));e.default=v.exports},3288:function(t,e,n){"use strict";n.r(e);n(10),n(14),n(18),n(9),n(7),n(11),n(12),n(8),n(4),n(6);var o=n(2),r=(n(36),n(23),n(37),n(70),n(19),n(5)),l=n(1),c=n(26);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m={name:"tavernTopBar",data:function(){return{formatNumberForeign:r.i,logoUrl:n(124),vipIconUrl:n(319),coins:[{name:"credit",icon:n(279),type:"calculateCoins",desc:"new_credit_desc"},{name:"stamina",icon:n(280),type:"tempCoins",desc:"new_stamina_desc"}],characterInfo:null}},computed:h(h(h(h({},Object(l.e)("payment",["paymentInfo","activeState","liteActiveState"])),Object(l.e)("user",["userInfo"])),Object(l.c)("user",["isLoggedIn"])),{},{isVip:function(){return this.activeState||this.liteActiveState},auto_tts:function(){var t;return(null===(t=this.userInfo)||void 0===t||null===(t=t.character_setting)||void 0===t?void 0:t.auto_tts)||0},getCoinTitle:function(){var t=this;return function(e){return t.$t(e.type)+"："+t.$t("balance")+" "+(t.paymentInfo[e.type]||0)+", "+t.$t(e.desc)}}}),mounted:function(){var t=this;this.$EventBus.$on("characterDetailInfo",(function(data){console.log(data,"收到数字人数据-----"),t.$set(t,"characterInfo",data)}))},beforeDestroy:function(){this.$EventBus.$off("characterDetailInfo")},methods:h(h(h({},Object(l.b)("user",["getAccountInfo"])),Object(l.d)("user",["SET_USER_INFO"])),{},{toHome:function(){this.$router.push(this.localePath("/"))},goCreatedSame:function(t){if(t){var e=this.localePath("/cyberPubPage/new-character?id=".concat(t,"&sameStyle=1"));this.isLoggedIn?(this.$logEvent("log_actions",{operation:"click_create_the_same",behavior_info:"on_tavern_detail_page"}),this.$router.push(e)):this.$EventBus.$emit("openLoginDialog",{redirect:e})}},setAutoTts:function(t){var e=this,n=1===this.auto_tts?0:1;Object(c.I)({gpt_model:"",auto_tts:n}).then((function(o){var r=JSON.parse(JSON.stringify(e.userInfo));r.character_setting.gpt_model=t,r.character_setting.auto_tts=n,e.SET_USER_INFO(r)}))},handleClickVoice:function(){this.setAutoTts()},openLogin:function(){this.$EventBus.$emit("openLoginDialog")},toMall:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$logEvent("log_actions",{operation:"subscription_page_show",behavior_info:null!=t&&t.name?t.name:location.href}),window.open("".concat(location.origin,"/mall"),"_blank")},initials:function(t){return(t||"").split(" ").map((function(t){return t[0]})).join("")},toggleMenu:function(){this.$EventBus.$emit("$_toggleLeftMenu")}})},v=m,f=(n(2661),n(0)),component=Object(f.a)(v,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"c-tavern-top-bar"},[n("div",{staticClass:"flex"},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.isLoggedIn,expression:"isLoggedIn"}],staticClass:"detail-menu-icon flex_c_m",on:{click:e.toggleMenu}},[n("i",{staticClass:"iconfont icon-menu"})]),e._v(" "),n("a",{staticClass:"tavern-top-bar-logo",attrs:{href:e.localePath("/")},on:{click:function(t){return t.preventDefault(),e.toHome.apply(null,arguments)}}},[n("div",{staticClass:"tavern-top-bar-logo-img"},[n("img",{attrs:{src:e.logoUrl,alt:""}})]),e._v(" "),n("div",{staticClass:"tavern-top-bar-logo-text"},[e._v(e._s(e.$t("SeaArt")))])])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isLoggedIn,expression:"isLoggedIn"}],staticClass:"tavern-top-bar-info"},[e.characterInfo&&1===(null===(t=e.characterInfo)||void 0===t?void 0:t.allow_same)?n("div",{staticClass:"same-style",on:{click:function(t){var n;return t.stopPropagation(),t.preventDefault(),e.goCreatedSame(null===(n=e.characterInfo)||void 0===n?void 0:n.id)}}},[e._v(e._s(e.$t("Remix")))]):e._e(),e._v(" "),e._e(),e._v(" "),n("div",{staticClass:"vip-info"},[e._l(e.coins,(function(t){return[n("div",{key:t.name,staticClass:"item-coin",class:t.name,attrs:{title:e.getCoinTitle(t)},on:{click:function(n){return e.toMall(t)}}},[n("img",{staticClass:"icon",attrs:{src:t.icon,alt:t.name}}),e._v(" "),n("div",{staticClass:"number"},[e._v("\n            "+e._s(e.formatNumberForeign(e.paymentInfo[t.type])||0)+"\n          ")])])]})),e._v(" "),n("img",{directives:[{name:"show",rawName:"v-show",value:e.isVip,expression:"isVip"}],staticClass:"vip-icon",attrs:{src:e.vipIconUrl,alt:"vip-icon"},on:{click:function(t){return t.stopPropagation(),e.toMall.apply(null,arguments)}}})],2),e._v(" "),n("div",{staticClass:"user-info"},[n("client-only",[n("div",{staticClass:"avatar",class:[e.userInfo.head?"":"avatar-color"]},[e.userInfo.head?n("img",{attrs:{src:e.userInfo.head,alt:"avatar"}}):n("div",[e._v("\n            "+e._s(e.initials(e.userInfo.name?e.userInfo.name:e.userInfo.id))+"\n          ")])])])],1)]),e._v(" "),n("client-only",[e.isLoggedIn?e._e():n("div",{staticClass:"log-btn",on:{click:function(t){return t.stopPropagation(),e.openLogin()}}},[e._v(e._s(e.$t("Login")))])])],1)}),[],!1,null,"ec2ab044",null);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var w={name:"tavern",components:{tavernTopBar:component.exports},data:function(){return{tabs:[{path:"/cyberPubPage/new-character",name:"newCharacter",i18nKey:"tavern45",text:"Character",showSubscript:!1,leftIcon:"icon-add-icon",showTips:!0,logType:"click_character_tab"},{path:"/cyberPubPage/my-characters",name:"myCharacters",i18nKey:"tavern46",text:"My Characters",showSubscript:!1,showTips:!1,logType:"click_my_character_tab"}],activeTab:"tavernList",backgroundInfo:{url:"",width:0,height:0},discardUrl:"https://discord.com/invite/gUHDU644vU",isHideAiChat:!1}},computed:y(y(y({},Object(l.e)("payment",["activeState","liteActiveState"])),Object(l.c)("user",["isLoggedIn"])),{},{isShowTabs:function(){var t;return!((null===(t=this.$route)||void 0===t?void 0:t.name)||"").includes("tavernCover")},roleGuideHref1:function(){return"ja"!==this.$i18n.locale?"https://docs.seaart.ai/guide-1/2-seaart-ai-basic-function/2-8-cyberpub/how-to-create-your-own-character":"https://docs.seaart.ai/guide-1/ri-ben-yu/2-ji-ben-ji-neng/2-8-saibpabu/nokyarakutwosuru"},roleGuideHref2:function(){return"ja"!==this.$i18n.locale?"https://docs.seaart.ai/guide-1/2-seaart-ai-basic-function/2-8-cyberpub/character-description-writing-tips":"https://docs.seaart.ai/guide-1/ri-ben-yu/2-ji-ben-ji-neng/2-8-saibpabu/kyarakutnowokutamenohinto"},isVip:function(){return this.activeState||this.liteActiveState},dynamicBackground:function(){var t={};return this.backgroundInfo.url&&(t.backgroundImage="url('".concat(this.backgroundInfo.url,"')"),t.backgroundSize=(this.backgroundInfo.width,this.backgroundInfo.height,"contain")),t},dynamicBackgroundType2:function(){var t={};return this.backgroundInfo.url&&(t.backgroundImage="url('".concat(this.backgroundInfo.url,"')"),t.backgroundSize=(this.backgroundInfo.width,this.backgroundInfo.height,"cover")),t}}),watch:{$route:function(t,e){var n,o=this.getRouteBaseName();if(this.activeTab=["tavernList","tavernSearch"].includes(o)?"tavernList":o,e.name===t.name&&null!==(n=t.query)&&void 0!==n&&n.quickChat)return t.query.redirect?this.$router.replace(t.query.redirect):this.$router.replace(this.localePath("/")),!1;this.updateTavernBg()}},mounted:function(){this.activeTab=this.getElementsBefore(this.$route.name,"__"),this.isHideAiChat=location.origin.includes(".me"),this.isHideAiChat&&this.$router.replace(this.localePath("/"))},beforeDestroy:function(){this.backgroundInfo={url:"",width:0,height:0}},methods:{getElementsBefore:function(t,e){var n=t.indexOf(e);return-1===n?t:t.slice(0,n)},updateTavernBg:function(t){console.log("updateTavernBg: ",t);var e=t||{},n=e.backgroundUrl,o=void 0===n?"":n,r=e.width,l=void 0===r?0:r,c=e.height,d=void 0===c?0:c;this.$set(this.backgroundInfo,"url",o||""),this.$set(this.backgroundInfo,"width",l||0),this.$set(this.backgroundInfo,"height",d||0)},handClickTab:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"/cyberPubPage"===t.path||this.isLoggedIn?(this.$logEvent("log_actions",{operation:"tavern_on_square",behavior_info:t.logType}),this.$set(this,"backgroundInfo",{url:"",width:0,height:0}),this.$router.push(this.localePath(t.path))):this.$EventBus.$emit("openLoginDialog")},goback:function(){this.$router.back()}}},C=w,k=(n(2662),n(2663),Object(f.a)(C,(function(){var t=this,e=t._self._c;return t.isHideAiChat?t._e():e("div",{staticClass:"p-tavern"},[e("div",{staticClass:"bg-container1",staticStyle:{opacity:"1",transform:"none"},style:t.dynamicBackgroundType2}),t._v(" "),e("div",{staticClass:"bg-container2 bg-tavern",staticStyle:{opacity:"1",transform:"none"},style:t.dynamicBackground}),t._v(" "),e("div",{staticClass:"tavern-top-bar container"},[e("tavern-top-bar")],1),t._v(" "),e("div",{staticClass:"main-container container"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowTabs,expression:"isShowTabs"}],staticClass:"tavern-tabs"},[e("i",{staticClass:"el-icon-back",on:{click:function(e){return e.stopPropagation(),t.goback.apply(null,arguments)}}}),t._v(" "),t._l(t.tabs,(function(n){return e("div",{key:n.path,staticClass:"tavern-tabs-item",class:[t.activeTab.includes(n.name)?"tavern-tabs-item-active":""],on:{click:function(e){return e.stopPropagation(),t.handClickTab(n)}}},[e("div",{staticClass:"tavern-tabs-item-text"},[n.leftIcon?e("i",{staticClass:"iconfont tavern-tabs-item-left-icon",class:n.leftIcon}):t._e(),t._v(" "),"tavern"!==n.name||t.$route.params.id?[t._v("\n            "+t._s(t.$t(n.i18nKey))+"\n          ")]:e("h1",[t._v(t._s(t.$t(n.i18nKey)))]),t._v(" "),e("sup",{directives:[{name:"show",rawName:"v-show",value:n.showSubscript,expression:"tab.showSubscript"}],staticClass:"tavern-tabs-item-text-sub"},[t._v("beta")]),t._v(" "),n.showTips?e("el-popover",{attrs:{placement:"top-start",title:"",width:300,trigger:"hover","popper-class":"tavern-tab-popover","visible-arrow":!1}},[e("div",{staticClass:"content"},[e("p",{staticClass:"mb-2"},[t._v(t._s(t.$t("tavern40")))]),t._v(" "),e("ul",{staticClass:"mb-2 list-outside list-disc",staticStyle:{"padding-left":"20px"}},[e("li",[e("i18n",{attrs:{path:"tavern41",tag:!1}},[e("template",{slot:"name"},[e("a",{staticClass:"content-color",attrs:{href:t.roleGuideHref1,target:"_blank"}},[t._v(t._s(t.$t("tavern42")))])])],2)],1),t._v(" "),e("li",[e("a",{staticClass:"content-color",attrs:{href:t.roleGuideHref2,target:"_blank"}},[t._v(t._s(t.$t("tavern43")))])])]),t._v(" "),e("p",{staticClass:"mb-2"},[e("i18n",{attrs:{path:"tavern44",tag:!1}},[e("template",{slot:"name"},[e("a",{staticClass:"content-color",attrs:{href:t.discardUrl,target:"_blank"}},[t._v("Discord")])])],2)],1)]),t._v(" "),e("div",{staticClass:"tips-box",attrs:{slot:"reference"},slot:"reference"},[e("i",{staticClass:"iconfont icon-tagTips tips-box-icon"})])]):t._e()],2),t._v(" "),e("div",{staticClass:"tavern-tabs-item-line"})])}))],2),t._v(" "),e("div",{staticClass:"tavern-main-content"},[e("div",{staticClass:"tavern-main-content-inner"},[e("keep-alive",{attrs:{include:["tavernList"]}},[e("router-view",{on:{updateBg:t.updateTavernBg}})],1)],1)])])])}),[],!1,null,"5cdf2d64",null));e.default=k.exports},3290:function(t,e,n){"use strict";n.r(e);n(9),n(7),n(11),n(12),n(8),n(4),n(6);var o=n(2),r=(n(23),n(37),n(211)),l=(n(19),{props:["links"],data:function(){return{}},computed:{motivatingResultInfo:function(){var t=this.$t("motivatingResultInfo"),e=this.links.map((function(t){return t.path}));return this.$isChinaSite&&(t=t.replace(/<a [^>]*?>.*?<\/a>、/,"")),this.setLink(t,e)}},methods:{setLink:function(t,e){var n=t;return e.forEach((function(t,i){n=n.replace("{ATTR".concat(i+1,"}"),'href="'.concat(t||"/",'" target="_blank"'))})),n},backPage:function(){this.$router.back()}}}),c=(n(2870),n(0)),d=Object(c.a)(l,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"result-success"},[e("img",{attrs:{src:n(617),alt:""}}),t._v(" "),e("p",{staticClass:"result-info"},[t._v(t._s(t.$t("motivatingResultSuccess")))]),t._v(" "),e("p",{staticClass:"result-tips",domProps:{innerHTML:t._s(t.motivatingResultInfo)}}),t._v(" "),e("el-button",{staticClass:"confirm-btn",attrs:{type:"primary"},on:{click:t.backPage}},[t._v(t._s(t.$t("Confirm")))])],1)}),[],!1,null,"b1633f50",null).exports,h=n(169),m=n(1);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var _={components:{JoinSuccess:d,BackIcon:r.a},data:function(){return{panelList:[{img:"https://image.cdn2.seaart.ai/static/upload/20240226/6d65cddf-c6ab-4c51-bc5b-98a22deeaece.png",path:"/cyberPubPage",isHide:this.$isChinaSite},{img:"https://image.cdn2.seaart.ai/static/upload/20240226/8191e010-883e-4ba6-96fe-74b53a521753.png",path:"/?type=model"},{img:"https://image.cdn2.seaart.ai/static/upload/20240226/08e7c7b4-f24f-4593-ab7b-f77f361e77a8.png",path:"/?type=loraTmp"},{img:"https://image.cdn2.seaart.ai/static/upload/20240226/bd780534-a45c-4a4b-bf15-9359858aa07c.png",path:"/?type=palette"},{img:"https://image.cdn2.seaart.ai/static/upload/20240226/eb384efc-8fd7-466d-ac4c-bb7781987cf9.png",path:"/comfyUIList"}],isShowSuccess:!1,isAgree:!0,loading:!1}},computed:f(f(f({},Object(m.e)("user",["userInfo"])),Object(m.b)("user",["getAccountInfo"])),{},{agreeLink:function(){var t="ja"!==this.$i18n.locale?"https://docs.seaart.ai/guide-1/6-permanent-events/seaart.ai-creator-incentive-program":"https://docs.seaart.ai/guide-1/ri-ben-yu/6-naibento/seaartaikuritpuroguramu";return this.$t("motivatingContent3").replace("{ATTR}",'href="'.concat(t,'" target="_blank"'))},btnAgreeLink:function(){var t=this.$isChinaSite?"https://image.cdn2.seaart.ai/private/creator_bonus_cn.html":"https://image.cdn2.seaart.ai/private/creator_bonus.html";return this.$t("motivatingBtnAgree").replace("{ATTR}",'href="'.concat(t,'" target="_blank"'))}}),methods:{joinPlan:function(){var t=this;this.isAgree?(this.loading=!0,Object(h.h)().then((function(e){t.isShowSuccess=!0,t.loading=!1,t.getAccountInfo(),t.$message.success(t.$t("JoinSuccess"))})),this.$logEvent("log_actions",{operation:"click_join_Incentive_program"})):this.$message.warning(this.$t("JoinPlanAgreeTips"))},goPage:function(path){path?this.$router.push(this.localePath(path)):this.$message.warning(this.$t("gpt_waiting"))}}},y=(n(2871),Object(c.a)(_,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"motivating-task"},[n("back-icon"),e._v(" "),e.isShowSuccess?n("join-success",{attrs:{links:e.panelList}}):[n("div",{staticClass:"title"},[e._v("\n      "+e._s(e.$t("motivatingTitle"))+"\n    ")]),e._v(" "),n("div",{staticClass:"content"},[n("p",[e._v(e._s(e.$t("motivatingContent1")))]),e._v(" "),n("p",[e._v("\n        "+e._s(e.$t("motivatingContent2"))+"\n      ")]),e._v(" "),n("p",{staticClass:"tips",domProps:{innerHTML:e._s(e.agreeLink)}})]),e._v(" "),n("div",{staticClass:"panel-list"},[e._l(e.panelList,(function(t,i){return n("div",{directives:[{name:"show",rawName:"v-show",value:!t.isHide,expression:"!panel.isHide"}],key:"panel_"+i,staticClass:"panel-item",on:{click:function(n){return e.goPage(t.path)}}},[n("img",{attrs:{src:t.img,alt:""}}),e._v(" "),n("p",[e._v(e._s(e.$t("motivatingTitle"+i)))])])})),e._v(" "),n("div",{staticClass:"panel-item wait"},[e._v("\n        "+e._s(e.$t("motivatingWait"))+"\n      ")])],2),e._v(" "),n("div",{staticClass:"join-btn"},[n("el-button",{attrs:{type:"primary",loading:e.loading,disabled:null===(t=e.userInfo)||void 0===t?void 0:t.join_stimulate},on:{click:e.joinPlan}},[e._v("\n        "+e._s(e.$t("motivatingBtn"))+"\n      ")]),e._v(" "),n("div",[n("el-checkbox",{model:{value:e.isAgree,callback:function(t){e.isAgree=t},expression:"isAgree"}},[n("p",{domProps:{innerHTML:e._s(e.btnAgreeLink)}})])],1)],1)]],2)}),[],!1,null,"20b5d6c8",null));e.default=y.exports},3294:function(t,e,n){"use strict";n.r(e);n(9),n(7),n(11),n(12),n(8),n(4),n(6);var o=n(2),r=n(1),l=(n(89),n(32),n(19),n(561)),c=n(66);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m={name:"UserBreak",inject:["top"],props:{isTrain:Boolean,reason:{type:String,default:""},selectedLevel:{type:String,default:"basic"}},components:{BreakInfo:l.a},data:function(){return{activeTab:"yearly",levelArr:[]}},mounted:function(){this.getGoodsData()},computed:h(h({},Object(r.e)("user",["cdnHost"])),{},{getBg:function(){return{backgroundImage:"url(https://".concat(this.cdnHost,"/static/upload/20241123/3294f806-3035-48e7-8317-b151096b09af.webp)")}},getDiscount:function(){var t="save20",e=this.levelArr.filter((function(i){return"black_sale"==(null==i?void 0:i.activity)}));return null!=e&&e.length&&(t="save50"),this.$t(t)},isMonthly:function(){return"monthly"===this.activeTab},isYearly:function(){return"yearly"===this.activeTab},getGif:function(){return"https://".concat(this.cdnHost,"/static/upload/20240428/45f27cdd-f248-4681-a3d0-e8d9e17b91d5.gif")},getLabel:function(){var t=this;return function(e){return t.$t({basic:"ToB_beginnerPlan",standard:"StandardPlan",professional:"ToB_professionalPlan",MasterPlan:"MasterPlan"}[e])}},getBtnLabel:function(){var t=this,e=this.isYearly?"Upgrade20off":"SubscribeNow",n=this.levelArr.find((function(i){return i.label==t.selectedLevel}));return"black_sale"===(null==n?void 0:n.activity)&&this.isYearly&&(e="Upgrade50off"),this.$t(e)}}),methods:{handleClose:function(){this.top.close()},getGoodsData:function(){this.updateGoodsData()},updateGoodsData:function(){var t=this;Object(c.l)().then((function(e){var n=e.data,data=void 0===n?{}:n;localStorage.setItem("goodsInfo",JSON.stringify(data)),t.handleData(data)}))},handleData:function(data){var t=this,e=data||{},n=e.month,o=void 0===n?[]:n,r=e.year,l=(void 0===r?[]:r).map((function(t,e){return h(h({},t),{},{monthly_id:o[e].id,original_price:o[e].price,original_price_cn:o[e].price_cn})}));this.isTrain||l.pop(),this.levelArr=l.reduce((function(e,n){var map=t.isTrain?{sub_yearly3:"professional",sub_yearly4:"MasterPlan"}:{sub_yearly1:"basic",sub_yearly2:"standard",sub_yearly3:"professional",sub_yearly4:"MasterPlan"},o=n.id,r=n.monthly_id,l=n.price_month,c=n.original_price,d=n.price_month_cn,h=n.original_price_cn,m=n.price,v=n.price_cn,f=n.local_price_web,_=n.activity,y={label:map[o],monthly_id:r,yearly_id:o,original_m_p_en:c,now_m_p_en:l,original_m_p_zh:h,now_m_p_zh:d,now_total_price_en:m,now_total_price_cn:v,now_m_p:null==f?void 0:f.price,original_m_p:null==f?void 0:f.price_old,monetaryUnit:null==f?void 0:f.currency,activity:_};return t.isTrain?map.hasOwnProperty(o)&&("MasterPlan"===t.selectedLevel&&"professional"===map[o]||e.push(y)):e.push(y),e}),[])},changeMethods:function(t){this.activeTab=t},toMall:function(){window.open(this.localePath("/mall"),"_blank")},subscriptionNow:function(){var t=this,e=this.levelArr.find((function(i){return i.label==t.selectedLevel}))||{},n=e.monthly_id,o=void 0===n?"":n,r=e.yearly_id,l=void 0===r?"":r;this.$emit("subscriptionNow",this.isMonthly?o:l,this.getBtnLabel)},changeLevel:function(t){this.$emit("changeLevel",t)}}},v=(n(3183),n(0)),f=Object(v.a)(m,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"user-break"},[e("div",{staticClass:"user-break-close flex-center",on:{click:t.handleClose}},[e("i",{staticClass:"el-icon-close"})]),t._v(" "),e("div",{staticClass:"left",class:t.selectedLevel},[e("div",{staticClass:"left-title words-wrap"},[t._v("\n        "+t._s(t.$t("break_title"))+"\n      ")]),t._v(" "),e("div",{staticClass:"left-methods"},[e("div",{staticClass:"left-methods-monthly",class:{active:t.isMonthly},on:{click:function(e){return t.changeMethods("monthly")}}},[t._v("\n          "+t._s(t.$t("PayMonthly"))+"\n        ")]),t._v(" "),e("div",{staticClass:"left-methods-yearly",class:{active:t.isYearly},on:{click:function(e){return t.changeMethods("yearly")}}},[t._v("\n          "+t._s(t.$t("PayYearly"))+"\n          "),e("img",{directives:[{name:"show",rawName:"v-show",value:t.isMonthly,expression:"isMonthly"}],staticClass:"icon",attrs:{src:t.getGif,alt:"icon"}}),t._v(" "),e("span",{staticClass:"discount"},[t._v("\n\t\t\t\t\t\t"+t._s(t.getDiscount)+"\n\t\t\t\t\t")])])]),t._v(" "),e("div",{staticClass:"left-level"},t._l(t.levelArr,(function(n){return e("div",{key:n.label,staticClass:"item-level",class:{active:t.selectedLevel===n.label},on:{click:function(e){return t.changeLevel(n.label)}}},["black_sale"==(null==n?void 0:n.activity)&&t.isYearly?e("div",{staticClass:"black-friday-discount flex-center",style:t.getBg},[t._v("50% OFF")]):t._e(),t._v(" "),"black_sale"!=(null==n?void 0:n.activity)&&t.isYearly?e("div",{staticClass:"item-level-icon flex-center"},[e("i",{staticClass:"iconfont icon-sale"}),t._v(" "),e("span",[t._v(t._s(t.$t("MallTabTips1")))])]):t._e(),t._v(" "),e("div",{staticClass:"item-level-label"},[t._v("\n            "+t._s(t.getLabel(n.label))+"\n          ")]),t._v(" "),t.isMonthly?e("div",{staticClass:"item-level-price item-level-monthly"},[e("span",{staticClass:"sign"},[t._v("\n\t\t\t\t\t\t\t"+t._s(null==n?void 0:n.monetaryUnit)+"\n\t\t\t\t\t\t")]),t._v(" "),e("span",{staticClass:"price"},[t._v("\n\t\t\t\t\t\t\t"+t._s(n.original_m_p)+"\n\t\t\t\t\t\t")]),t._v(" "),e("span",[t._v("/")]),t._v(" "),e("span",{staticClass:"type"},[t._v("\n\t\t\t\t\t\t\t"+t._s(t.$t("Month"))+"\n\t\t\t\t\t\t")])]):e("div",{staticClass:"item-level-price item-level-yearly"},[e("div",{staticClass:"top"},[e("span",{staticClass:"sign"},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(null==n?void 0:n.monetaryUnit)+"\n\t\t\t\t\t\t\t")]),t._v(" "),e("span",{staticClass:"price"},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(n.now_m_p)+"\n\t\t\t\t\t\t\t")]),t._v(" "),e("span",[t._v("/")]),t._v(" "),e("span",{staticClass:"type"},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(t.$t("Month"))+"\n\t\t\t\t\t\t\t")])]),t._v(" "),e("div",{staticClass:"bottom"},[e("div",{staticClass:"now-price"},[e("span",{staticClass:"sign"},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(null==n?void 0:n.monetaryUnit)+"\n\t\t\t\t\t\t\t\t")]),t._v(" "),e("span",{staticClass:"price"},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s((12*n.now_m_p).toFixed(2))+"\n\t\t\t\t\t\t\t\t")]),t._v(" "),e("span",[t._v("/")]),t._v(" "),e("span",{staticClass:"type"},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(t.$t("year"))+"\n\t\t\t\t\t\t\t\t")])]),t._v(" "),e("div",{staticClass:"original-price"},[e("span",{staticClass:"sign"},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(null==n?void 0:n.monetaryUnit)+"\n\t\t\t\t\t\t\t\t")]),t._v(" "),e("span",{staticClass:"price"},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s((12*n.original_m_p).toFixed(2))+"\n\t\t\t\t\t\t\t\t")]),t._v(" "),e("span",[t._v("/")]),t._v(" "),e("span",{staticClass:"type"},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(t.$t("year"))+"\n\t\t\t\t\t\t\t\t")])])])])])})),0),t._v(" "),e("div",{staticClass:"left-more",on:{click:t.toMall}},[t._v("\n        "+t._s(t.$t("viewMore"))+"\n        "),e("i",{staticClass:"el-icon-arrow-right"})]),t._v(" "),e("el-button",{staticClass:"left-btn",on:{click:t.subscriptionNow}},[t._v("\n        "+t._s(t.getBtnLabel)+"\n      ")])],1),t._v(" "),e("div",{staticClass:"right"},[e("BreakInfo",{attrs:{reason:t.reason}})],1)])}),[],!1,null,"099bf90d",null).exports,_=n(138),y=n(137);function w(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function C(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?w(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var k={name:"BreakDialog",provide:function(){return{top:this}},data:function(){return{isTrain:!1,isShowDialog:!1,reason:"VipTip",selectedLevel:"basic",step:"inGoods",goodsId:"",defaultThirdType:0,btnLabel:"",dotFrom:"",logMap:{FastQueueTipWeb:"SpecificPop_FastQueue",Queue5TipWeb:"SpecificPop_TaskFull",UnlimitedQueueTipWeb:"SpecificPop_UnlimitedQueue",PrivateWorkTipWeb:"SpecificPop_PrivateWork",DownloadLimitTipWeb:"SpecificPop_DownloadLimit",ExpireTimeTipWeb:"SpecificPop_ExpireTime",AddCanvasTipWeb:"SpecificPop_AddCanvas",CreateModeTypeTipWeb:"SpecificPop_CreateModeType",LoRALimit5TipWeb:"SpecificPop_LoRALimit5",SimpleLoRALimit5TipWeb:"SpecificPop_SimpleLoRALimit5",TrainLoraTipWeb:"SpecificPop_TrainLora",LoRATrainTipWeb:"SpecificPop_LoRATrain",AIPersonTipWeb:"SpecificPop_AIPerson",AiChatSendNotCoin:"SpecificPop_AIChat",PrivacyPortfolioTipWeb:"SpecificPop_PrivacyPortfolio",VipTip:"SpecificPop_Vip"}}},components:{UserBreak:f,PaymentForm:_.a,RightPart:y.a},mounted:function(){var t=this;this.$EventBus.$on("showBreakDialog",(function(e,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.isTrain=o,t.dotFrom=t.logMap[e]||"",t.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:t.logMap[e]||"SpecificPop_BreakDialog",behavior_info_sub:"pop_1"}),t.reason=e,t.selectedLevel=n,t.open()}))},destroyed:function(){this.$EventBus.$off("showBreakDialog")},computed:C({},Object(r.e)("payment",["subThirdType"])),methods:C(C({},Object(r.b)("payment",["getSubUrlAndThirdType"])),{},{open:function(){this.isShowDialog=!0},close:function(){this.isShowDialog=!1},changeLevel:function(t){this.selectedLevel=t,this.isTrain&&(this.reason="MasterPlan"===this.selectedLevel?"NoExpireTimeTipWeb2":"NoExpireTimeTipWeb1")},quitPay:function(){this.step="inGoods"},subscriptionNow:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:this.logMap[this.reason]||"SpecificPop_BreakDialog",behavior_info_sub:"pop_2"}),this.btnLabel=n,this.subThirdType?(this.defaultThirdType=this.subThirdType,this.goodsId=t,this.step="inPay"):this.getSubUrlAndThirdType().then((function(n){var o;if(1e4===(null==n||null===(o=n.status)||void 0===o?void 0:o.code)){var data=n.data;e.defaultThirdType=null==data?void 0:data.third_type,e.goodsId=t,e.step="inPay"}}))}})},x=k,O=(n(3184),Object(v.a)(x,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"break-dialog flex-center",attrs:{visible:t.isShowDialog,"destroy-on-close":!0,"append-to-body":!0,"close-on-click-modal":!1},on:{"update:visible":function(e){t.isShowDialog=e},closed:function(e){t.selectedLevel="basic"}}},["inGoods"===t.step?e("UserBreak",{attrs:{reason:t.reason,isTrain:t.isTrain,selectedLevel:t.selectedLevel},on:{subscriptionNow:t.subscriptionNow,changeLevel:t.changeLevel}}):t._e(),t._v(" "),"inPay"===t.step?e("PaymentForm",{attrs:{defaultThirdType:t.defaultThirdType,initMount:!0,upgrade:!1,goodsId:t.goodsId,purchParams:{},btnLabel:t.btnLabel},on:{"in-pay-back":t.quitPay,"pay-success":function(e){t.isShowDialog=!1,t.step="inGoods"}}},[e("right-part",{attrs:{showBg:!0,showText:!0,showStep:!1,showAvatar:!0}})],1):t._e()],1)}),[],!1,null,"3f2cc0b2",null));e.default=O.exports},3295:function(t,e,n){"use strict";n.r(e);n(9),n(7),n(11),n(12),n(8),n(4),n(6);var o=n(2),r=n(1),l=(n(89),n(32),n(19),n(561)),c=n(66);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m={name:"UserUpgrade",inject:["top"],props:{reason:{type:String,default:""},selectedLevel:{type:String,default:"standard"},defaultLevel:{type:String,default:"standard"}},components:{BreakInfo:l.a},data:function(){return{levelArr:[]}},mounted:function(){this.getGoodsData()},computed:h(h(h(h({},Object(r.e)("user",["cdnHost"])),Object(r.c)("user",["isCompanyAccount"])),Object(r.e)("payment",["paymentInfo"])),{},{getBg:function(){return{backgroundImage:"url(https://".concat(this.cdnHost,"/static/upload/20241123/3294f806-3035-48e7-8317-b151096b09af.webp)")}},isSubscription:function(){var t=this.paymentInfo,e=t.svipActiveState,n=t.purchaseType;return e&&2===n},isMonthly:function(){return 2===this.paymentInfo.payRange},isYearly:function(){return 3===this.paymentInfo.payRange||this.isOnlyVipLite||this.isOnlyVipCard},isOnlyVipLite:function(){var t=this.paymentInfo||{},e=t.activeState,n=t.liteActiveState;return!e&&!this.isCompanyAccount&&n},isOnlyVipCard:function(){var t=this.paymentInfo||{},e=t.activeState,n=t.liteActiveState,o=t.svipActiveState;return e&&!o&&!this.isCompanyAccount&&!n},getGif:function(){return"https://".concat(this.cdnHost,"/static/upload/20240428/45f27cdd-f248-4681-a3d0-e8d9e17b91d5.gif")},getLabel:function(){var t=this;return function(e){return t.$t({standard:"StandardPlan",professional:"ToB_professionalPlan"}[e])}},getBtnLabel:function(){var t=this,e=this.isYearly?"Upgrade20off":"UpgradeNow",n=this.levelArr.find((function(i){return i.label==t.selectedLevel}));return"black_sale"===(null==n?void 0:n.activity)&&this.isYearly&&(e="Upgrade50off"),this.$t(e)}}),methods:{handleClose:function(){this.top.close()},getGoodsData:function(){this.updateGoodsData()},updateGoodsData:function(){var t=this;Object(c.l)().then((function(e){var n=e.data,data=void 0===n?{}:n;localStorage.setItem("goodsInfo",JSON.stringify(data)),t.handleData(data)}))},handleData:function(data){var t=data||{},e=t.month,n=void 0===e?[]:e,o=t.year,r=(void 0===o?[]:o).map((function(t,e){return h(h({},t),{},{monthly_id:n[e].id,original_price:n[e].price,original_price_cn:n[e].price_cn})}));r.shift(),r.pop(),this.levelArr=r.map((function(t){var e=t.id,n=t.monthly_id,o=t.price_month,r=t.original_price,l=t.price_month_cn,c=t.original_price_cn,d=t.price,h=t.price_cn,m=t.local_price_web;return{activity:t.activity,label:{sub_yearly2:"standard",sub_yearly3:"professional"}[e],monthly_id:n,yearly_id:e,original_m_p_en:r,now_m_p_en:o,original_m_p_zh:c,now_m_p_zh:l,now_total_price_en:d,now_total_price_cn:h,now_m_p:null==m?void 0:m.price,original_m_p:null==m?void 0:m.price_old,monetaryUnit:null==m?void 0:m.currency}}))},toMall:function(){window.open(this.localePath("/mall"),"_blank")},subscriptionNow:function(){var t=this,e=this.levelArr.find((function(i){return i.label==t.selectedLevel}))||{},n=e.monthly_id,o=void 0===n?"":n,r=e.yearly_id,l=void 0===r?"":r;this.$emit("subscriptionNow",this.isMonthly?o:l,this.getBtnLabel)},changeLevel:function(t){this.$emit("changeLevel",t)}}},v=(n(3185),n(0)),f=Object(v.a)(m,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"user-upgrade"},[e("div",{staticClass:"user-upgrade-close flex-center",on:{click:t.handleClose}},[e("i",{staticClass:"el-icon-close"})]),t._v(" "),e("div",{staticClass:"left",class:t.selectedLevel},[e("div",{staticClass:"left-title"},[t._v("\n\t\t\t"+t._s(t.$t("break_title"))+"\n\t\t")]),t._v(" "),e("div",{staticClass:"left-level"},t._l(t.levelArr,(function(n){return e("div",{directives:[{name:"show",rawName:"v-show",value:"professional"!=t.defaultLevel||"professional"==n.label,expression:"\n\t\t\t\t\tdefaultLevel == 'professional' ? item.label == 'professional' : true\n\t\t\t\t"}],key:n.label,staticClass:"item-level",class:{active:t.selectedLevel==n.label},on:{click:function(e){return t.changeLevel(n.label)}}},["black_sale"==(null==n?void 0:n.activity)&&t.isYearly?e("div",{staticClass:"black-friday-discount flex-center",style:t.getBg},[t._v("50% OFF")]):t._e(),t._v(" "),"black_sale"!=(null==n?void 0:n.activity)&&t.isYearly?e("div",{staticClass:"item-level-icon flex-center"},[e("i",{staticClass:"iconfont icon-sale"}),t._v(" "),e("span",[t._v(t._s(t.$t("MallTabTips1")))])]):t._e(),t._v(" "),e("div",{staticClass:"item-level-label"},[t._v("\n\t\t\t\t\t"+t._s(t.getLabel(n.label))+"\n\t\t\t\t")]),t._v(" "),t.isMonthly?e("div",{staticClass:"item-level-price item-level-monthly"},[e("span",{staticClass:"sign"},[t._v("\n\t\t\t\t\t\t"+t._s(null==n?void 0:n.monetaryUnit)+"\n\t\t\t\t\t")]),t._v(" "),e("span",{staticClass:"price"},[t._v("\n\t\t\t\t\t\t"+t._s(n.original_m_p)+"\n\t\t\t\t\t")]),t._v(" "),e("span",[t._v("/")]),t._v(" "),e("span",{staticClass:"type"},[t._v("\n\t\t\t\t\t\t"+t._s(t.$t("Month"))+"\n\t\t\t\t\t")])]):e("div",{staticClass:"item-level-price item-level-yearly"},[e("div",{staticClass:"top"},[e("span",{staticClass:"sign"},[t._v("\n\t\t\t\t\t\t\t"+t._s(null==n?void 0:n.monetaryUnit)+"\n\t\t\t\t\t\t")]),t._v(" "),e("span",{staticClass:"price"},[t._v("\n\t\t\t\t\t\t\t"+t._s(n.now_m_p)+"\n\t\t\t\t\t\t")]),t._v(" "),e("span",[t._v("/")]),t._v(" "),e("span",{staticClass:"type"},[t._v("\n\t\t\t\t\t\t\t"+t._s(t.$t("Month"))+"\n\t\t\t\t\t\t")])]),t._v(" "),e("div",{staticClass:"bottom"},[e("div",{staticClass:"now-price"},[e("span",{staticClass:"sign"},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(null==n?void 0:n.monetaryUnit)+"\n\t\t\t\t\t\t\t")]),t._v(" "),e("span",{staticClass:"price"},[t._v("\n\t\t\t\t\t\t\t\t"+t._s((12*n.now_m_p).toFixed(2))+"\n\t\t\t\t\t\t\t")]),t._v(" "),e("span",[t._v("/")]),t._v(" "),e("span",{staticClass:"type"},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(t.$t("year"))+"\n\t\t\t\t\t\t\t")])]),t._v(" "),e("div",{staticClass:"original-price"},[e("span",{staticClass:"sign"},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(null==n?void 0:n.monetaryUnit)+"\n\t\t\t\t\t\t\t")]),t._v(" "),e("span",{staticClass:"price"},[t._v("\n\t\t\t\t\t\t\t\t"+t._s((12*n.original_m_p).toFixed(2))+"\n\t\t\t\t\t\t\t")]),t._v(" "),e("span",[t._v("/")]),t._v(" "),e("span",{staticClass:"type"},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(t.$t("year"))+"\n\t\t\t\t\t\t\t")])])])])])})),0),t._v(" "),e("div",{staticClass:"left-more",on:{click:t.toMall}},[t._v("\n\t\t\t"+t._s(t.$t("viewMore"))+"\n\t\t\t"),e("i",{staticClass:"el-icon-arrow-right"})]),t._v(" "),e("el-button",{staticClass:"left-btn",on:{click:t.subscriptionNow}},[t._v("\n\t\t\t"+t._s(t.getBtnLabel)+"\n\t\t")])],1),t._v(" "),e("div",{staticClass:"right"},[e("BreakInfo",{attrs:{reason:t.reason}})],1)])}),[],!1,null,"927c39a0",null).exports,_=n(138),y=n(137);function w(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function C(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?w(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var k={name:"UpgradeDialog",provide:function(){return{top:this}},data:function(){return{isShowDialog:!1,reason:"VipTip",selectedLevel:"standard",defaultLevel:"standard",step:"inGoods",goodsId:"",defaultThirdType:0,btnLabel:"",dotFrom:"",logMap:{NoExpireTimeTipWeb:"VipSpecificPop_ExpireTime",UnlimitedQueueTipWeb:"VipSpecificPop_UnlimitedQueue",LoRATrainQueVipTipWeb:"VipSpecificPop_LoRATrain",Queue10TipWeb:"VipSpecificPop_TaskFull",AddCanvas5TipWeb:"VipSpecificPop_AddCanvas5",AddCanvas10TipWeb:"VipSpecificPop_AddCanvas10",VipTip:"VipSpecificPop_Vip"}}},components:{UserUpgrade:f,PaymentForm:_.a,RightPart:y.a},mounted:function(){var t=this;this.$EventBus.$on("showUpgradeDialog",(function(e,n){t.dotFrom=t.logMap[e],t.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:t.logMap[e]||"VipSpecificPop_Upgrade",behavior_info_sub:"pop_1"}),t.reason=e,t.selectedLevel=n,t.defaultLevel=n,t.open()}))},beforeDestroy:function(){this.$EventBus.$off("showUpgradeDialog")},computed:C({},Object(r.e)("payment",["subThirdType"])),methods:C(C({},Object(r.b)("payment",["getSubUrlAndThirdType"])),{},{open:function(){this.isShowDialog=!0},close:function(){this.isShowDialog=!1},changeLevel:function(t){this.selectedLevel=t},quitPay:function(){this.step="inGoods"},subscriptionNow:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:this.logMap[this.reason]||"VipSpecificPop_Upgrade",behavior_info_sub:"pop_2"}),this.btnLabel=n,this.subThirdType?(this.defaultThirdType=this.subThirdType,this.goodsId=t,this.step="inPay"):this.getSubUrlAndThirdType().then((function(n){var o;if(1e4===(null==n||null===(o=n.status)||void 0===o?void 0:o.code)){var data=n.data;e.defaultThirdType=null==data?void 0:data.third_type,e.goodsId=t,e.step="inPay"}}))}})},x=k,O=(n(3186),Object(v.a)(x,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"upgrade-dialog flex-center",attrs:{visible:t.isShowDialog,"destroy-on-close":!0,"append-to-body":!0,"close-on-click-modal":!1},on:{"update:visible":function(e){t.isShowDialog=e}}},["inGoods"===t.step?e("UserUpgrade",{attrs:{reason:t.reason,defaultLevel:t.defaultLevel,selectedLevel:t.selectedLevel},on:{changeLevel:t.changeLevel,subscriptionNow:t.subscriptionNow}}):t._e(),t._v(" "),"inPay"===t.step?e("PaymentForm",{attrs:{defaultThirdType:t.defaultThirdType,initMount:!0,upgrade:!0,goodsId:t.goodsId,purchParams:{},btnLabel:t.btnLabel},on:{"in-pay-back":t.quitPay,"pay-success":function(e){t.isShowDialog=!1,t.step="inGoods"}}},[e("right-part",{attrs:{showBg:!0,showText:!0,showStep:!1,showAvatar:!0}})],1):t._e()],1)}),[],!1,null,"766dac76",null));e.default=O.exports},3300:function(t,e,n){"use strict";n.r(e);n(23),n(37),n(71);var o=n(335),r=n(5),l=n(519),c=n(24),d={name:"studioStyleList",components:{studioImageInfo:l.a},data:function(){return{list:[],baseShowNum:6}},computed:{isZhLang:function(){return this.$i18n.locale.startsWith("zh")},getBackground:function(){return function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{backgroundImage:"url(".concat(Object(r.x)(null==e||null===(t=e.cover)||void 0===t?void 0:t.url,"high"),")")}}}},mounted:function(){var t=this;this.getLabStyles(),this.debounceResize=Object(c.debounce)(this.handleResize,500),window.addEventListener("resize",this.debounceResize),this.$nextTick((function(){t.handleResize()}))},beforeDestroy:function(){window.removeEventListener("resize",this.debounceResize),this.debounceResize=null},methods:{handleResize:function(){try{var t=this.$refs.studioList.offsetWidth;console.log("实验室页面实际宽度变为：",t),this.computedBaseNum(t)}catch(t){}},computedBaseNum:function(t){try{var e=Math.floor((t-16)/278);t>=1534&&(e=6),t>1300&&t<1534&&(e=5),t>=1120&&t<=1300&&(e=5),t<1120&&(e=5),t<900&&(e=4),this.baseShowNum=isNaN(e)||e>=6?6:e}catch(t){}},getLabStyles:function(){var t=this;Object(o.a)().then((function(e){var n,o;1e4===(null==e||null===(n=e.status)||void 0===n?void 0:n.code)&&(t.list=(null==e||null===(o=e.data)||void 0===o?void 0:o.items)||[],console.log("所有风格",t.list))}))},dialogShow:function(t,e){this.$logEvent("log_actions",{operation:"click_style_on_studio",behavior_info:t.key}),this.$refs.imageInfo.show(e)},backTo:function(){history.length>1&&"/"!=this.fromPath?this.$router.back():this.$router.push(this.localePath("/studio"))}}},h=d,m=(n(2395),n(0)),component=Object(m.a)(h,(function(){var t=this,e=t._self._c;return e("div",{ref:"studioList",staticClass:"p-studio-style-list"},[e("el-backtop",{attrs:{bottom:30,right:30}},[e("i",{staticClass:"el-icon-top"})]),t._v(" "),e("div",{staticClass:"mobile-back-to",on:{click:function(e){return e.stopPropagation(),t.backTo.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-back"})]),t._v(" "),e("div",{staticClass:"studio-style-list-title"},[e("span",{staticClass:"studio-style-list-title-text"},[t._v(t._s(t.$t("AllStyle")))])]),t._v(" "),e("div",{staticClass:"studio-style-list",style:{gridTemplateColumns:"repeat(".concat(t.baseShowNum,", 1fr)")}},t._l(t.list,(function(n,o){var r;return e("div",{key:"".concat((null==n?void 0:n.art_id)+o),staticClass:"lab-item flex flex-col",on:{click:function(e){return t.dialogShow(n,o)}}},[1===(null==n||null===(r=n.cover)||void 0===r?void 0:r.nsfw)?e("div",{staticClass:"lab-img-content bg-nsfw"}):e("div",{staticClass:"lab-img-content",style:t.getBackground(n)}),t._v(" "),e("div",{staticClass:"lab-type flex flex-col"},[e("div",{staticClass:"lab-type-title"},[t._v(t._s(t.$t("labStyleType_".concat(null==n?void 0:n.key.replace(/\s/g,"")))))]),t._v(" "),e("div",{staticClass:"lab-type-text"},[t._v("\n          "+t._s(t.$t("labStyleTypeText_".concat(null==n?void 0:n.key.replace(/\s/g,""))))+"\n        ")])])])})),0),t._v(" "),e("studio-image-info",{ref:"imageInfo",attrs:{list:t.list}})],1)}),[],!1,null,"34779b3a",null);e.default=component.exports},3301:function(t,e,n){"use strict";n.r(e);var o=n(2),r=n(3),l=(n(20),n(9),n(7),n(10),n(11),n(12),n(8),n(4),n(6),n(19),n(14),n(18),n(503)),c=n(5),d=n(13);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={name:"TagInfo",components:{PageView:l.a},data:function(){return{tagInfoDetail:null,list:[],queryParam:{page:1,page_size:50,tag:"",order_by:"hot",run_available:0},activeName:"artwork",tagIndex:"hot",timeName:"All",weekHotTab:[],needRotate:!1}},asyncData:function(t){return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,h,v,f,_,y,w,C,k,x,O,$,D,S,I,T,j,data,L,P,M,E,A,N;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,o=t.app,r=t.params,l=t.error,v=(h=r||{}).tag,f=h.type,_=void 0===f?"artwork":f,o.$cookies.get("T"),y=Object(c.r)(),w=y.startTimestamp,C=y.endTimestamp,e.prev=4,k=d.u[_],x=k.url,O=k.params,$=["post","artwork"],D=(null==O?void 0:O.order_by)||"hot",S=$.includes(_)?w:null,I=$.includes(_)?C:null,T=m(m({tag:v,page:1,page_size:50},O),{},{order_by:D,time_from:S,time_to:I}),e.next=13,n.$post("/api/v1/tag/detail",{id:v||"landscape"});case 13:return j=e.sent,data=j.data,e.next=17,n.$post(x,T);case 17:return L=e.sent,P=L.data,E=(M=P||{}).items,A=M.offset,data&&(data.style={},data.style.url=data.cover||"",data.name=data.title||data.id),N=(E||[]).map((function(t){return t.banner={},t.banner.url=t.cover||"",t.banner.nsfw=t.nsfw,t.banner.width=t.cover_width,t.banner.height=t.cover_height,t.banner.replaceUrl=Object(c.x)(t.cover,"low"),t})),T.page++,T.offset=A,e.abrupt("return",{tagInfoDetail:data,list:N||[],queryParam:T,activeName:_,tagIndex:T.order_by,timeName:$.includes(_)?"week":"All",weekHotTab:$,needRotate:["ai lookbook"].includes(v)});case 27:e.prev=27,e.t0=e.catch(4),console.log("标签详情页-> asyncData错误啦：",e.t0),l({statusCode:404,message:e.t0});case 31:case"end":return e.stop()}}),e,null,[[4,27]])})))()}},f=n(0),component=Object(f.a)(v,(function(){var t=this,e=t._self._c;return e("div",[e("PageView",{attrs:{obj:{tagInfoDetail:t.tagInfoDetail,list:t.list,queryParam:t.queryParam,activeName:t.activeName,tagIndex:t.tagIndex,timeName:t.timeName,weekHotTab:t.weekHotTab,needRotate:t.needRotate}}})],1)}),[],!1,null,"1fa76986",null);e.default=component.exports},3302:function(t,e,n){"use strict";n.r(e);var o=n(2),r=n(3),l=(n(20),n(9),n(7),n(10),n(11),n(12),n(8),n(4),n(6),n(19),n(14),n(18),n(503)),c=n(5),d=n(13);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={name:"TagDetail",components:{PageView:l.a},data:function(){return{tagInfoDetail:null,list:[],queryParam:{page:1,page_size:50,tag:"",order_by:"hot",run_available:0},activeName:"artwork",tagIndex:"hot",timeName:"All",weekHotTab:[],needRotate:!1}},asyncData:function(t){return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,h,v,f,_,y,w,C,k,x,O,$,D,S,I,T,j,data,L,P,M,E,A,N;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,o=t.app,r=t.params,l=t.error,v=(h=r||{}).tag,f=h.type,_=void 0===f?"artwork":f,o.$cookies.get("T"),y=Object(c.r)(),w=y.startTimestamp,C=y.endTimestamp,e.prev=4,k=d.u[_],x=k.url,O=k.params,$=["post","artwork"],D=(null==O?void 0:O.order_by)||"hot",S=$.includes(_)?w:null,I=$.includes(_)?C:null,T=m(m({tag:v,page:1,page_size:50},O),{},{order_by:D,time_from:S,time_to:I}),e.next=13,n.$post("/api/v1/tag/detail",{id:v||"landscape"});case 13:return j=e.sent,data=j.data,e.next=17,n.$post(x,T);case 17:return L=e.sent,P=L.data,E=(M=P||{}).items,A=M.offset,data&&(data.style={},data.style.url=data.cover||"",data.name=data.title||data.id),N=(E||[]).map((function(t){return t.banner={},t.banner.url=t.cover||"",t.banner.nsfw=t.nsfw,t.banner.width=t.cover_width,t.banner.height=t.cover_height,t.banner.replaceUrl=Object(c.x)(t.cover,"low"),t})),T.page++,T.offset=A,e.abrupt("return",{tagInfoDetail:data,list:N||[],queryParam:T,activeName:_,tagIndex:T.order_by,timeName:$.includes(_)?"week":"All",weekHotTab:$,needRotate:["ai lookbook"].includes(v)});case 27:e.prev=27,e.t0=e.catch(4),console.log("标签详情页-> asyncData错误啦：",e.t0),l({statusCode:404,message:e.t0});case 31:case"end":return e.stop()}}),e,null,[[4,27]])})))()}},f=n(0),component=Object(f.a)(v,(function(){var t=this,e=t._self._c;return e("div",[e("PageView",{attrs:{obj:{tagInfoDetail:t.tagInfoDetail,list:t.list,queryParam:t.queryParam,activeName:t.activeName,tagIndex:t.tagIndex,timeName:t.timeName,weekHotTab:t.weekHotTab,needRotate:t.needRotate}}})],1)}),[],!1,null,"26279aea",null);e.default=component.exports},3307:function(t,e,n){"use strict";n.r(e);n(14),n(9),n(11),n(12);var o=n(15),r=n(2),l=(n(16),n(7),n(32),n(10),n(43),n(8),n(4),n(23),n(37),n(71),n(6),n(1)),c=n(13),d=n(342),h=n(504),m=n(105),v=n(41),f=n(526),_=n(79),y=n(51),w=n(35),C=n.n(w);function k(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function x(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?k(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var O={name:"ModelEdit",components:{ModelFileUpload:d.a,ModelWorkItem:h.a,SingleImageUpload:f.a},data:function(){var t=this;return{formData:{id:this.$route.params.id,name:"",type:"Checkpoint",tags:[],cover:{url:"",cover_width:0,cover_height:0},categories:[],permission:{allow_commercial_use:1,allow_download:1,allow_model_mix:1},is_agency_fee:!1,payment:{fee:"",way:1},refer:""},recommendList:[],intRmdTag:[],sources:"",modelData:null,loading:!1,checkboxDisabled:!1,SDList:c.p,rules:{name:[{required:!0,message:this.$t("PleaseEnterModelName")},{validator:function(e,n,o){/^[a-zA-Z0-9\s_\u4e00-\u9fa5.\-]+$/.test(n)?o():o(new Error(t.$t("newModelNameFormatWarn")))}}],categories:[{required:!0,message:this.$t("PleaseEnterModelCategoryTags")}],refer:[{required:!0,message:this.$t("PleaseEnterLink")}]},selectArgumentList:[{label:"computingPower",value:1},{label:"diamond",value:2,disabled:!0}]}},watch:{sources:{handler:function(t){"Original"==t?this.rules.refer=[]:(this.formData.is_agency_fee=!1,this.formData.payment.fee=0,this.rules.refer=[{required:!0,message:this.$t("PleaseEnterLink")}])}}},computed:x(x({},Object(l.e)("user",["userInfo"])),{},{modelType:function(){return"Checkpoint"===this.formData.type?1:2},checkboxDownload:{get:function(){var t;return 1===(null===(t=this.formData.permission)||void 0===t?void 0:t.allow_download)},set:function(t){this.formData.permission.allow_download=t?1:2}},checkboxCommercial:{get:function(){var t;return 1===(null===(t=this.formData.permission)||void 0===t?void 0:t.allow_commercial_use)},set:function(t){this.formData.permission.allow_commercial_use=t?1:2}},checkboxMix:{get:function(){var t;return 1===(null===(t=this.formData.permission)||void 0===t?void 0:t.allow_model_mix)},set:function(t){this.formData.permission.allow_model_mix=t?1:2}}}),mounted:function(){this.getModelData()},methods:{setCategories:function(){this.formData.categories.length>6&&this.formData.categories.splice(0,1)},setIntRmdTag:function(t){var e,n=this;t&&(this.recommendList=[].concat(Object(o.a)(this.intRmdTag),Object(o.a)(null===(e=this.formData)||void 0===e?void 0:e.tags.filter((function(t){return!n.intRmdTag.find((function(e){return e.title===t.title}))})))))},getTagRecommend:function(){var t=this;Object(_.j)({size:1e3}).then((function(e){var n;1e4===e.status.code&&(t.intRmdTag=null==e||null===(n=e.data)||void 0===n?void 0:n.items,t.setIntRmdTag(!0))}))},remoteMethod:function(t){var e=this;t&&Object(y.f)({prefix:t,except_num:20,source_type:3}).then((function(t){var n;1e4==t.status.code&&(e.recommendList=[],null==t||null===(n=t.data)||void 0===n||n.items.forEach((function(t){e.recommendList.push({title:t.title,id:t.title})})))}))},claimModel:function(){var t="https://aihelp.net/questionnaire/#/?formId=78dea50f5cbb426cb136748154c029aa";this.$i18n.locale.startsWith("zh")&&(t="https://aihelp.net/questionnaire/#/?formId=bffe7a2307454e859f559913e28d4f19"),window.open(t,"_blank")},getModelData:function(){var t=this;if(!this.loading){this.loading=!0;var e={id:this.$route.params.id};Object(m.b)(e).then((function(e){if(1e4==e.status.code){var n=e.data,o=n.type,r=n.name,l=n.download,c=n.commercial,d=n.mix,h=n.payment_way,m=n.agency_fee,v=n.publish_status,f=n.categories,_=n.refer,y=n.tags,w=n.cover,C=n.cover_width;n.cover_height;t.modelData=e.data,t.formData=x(x({},t.formData),{},{name:r,type:o,categories:f,permission:{allow_commercial_use:c,allow_download:l,allow_model_mix:d},payment:{fee:m,way:h||1},refer:_&&"none"!=_?_:"",tags:y||[],cover:{url:w,cover_width:C,cover_height:C}}),t.sources=t.formData.refer?"Reship":"Original",m>0&&(t.formData.is_agency_fee=!0),t.checkboxDisabled=1===v,t.recommendList=t.formData.tags,t.getTagRecommend(),t.$set(t,"formData",t.formData),t.$set(t,"modelData",t.modelData),t.loading=!1}})).catch((function(e){t.loading=!1}))}},submit:function(){var t=this;this.$refs.modelForm.validate((function(e){e&&t.submiData()}))},submiData:function(){var t=this;if(1!=this.loading){var e=this.getParams();this.loading=!0,e.refer="Original"==this.sources?"":e.refer,Object(v.y)(e).then((function(e){if(1e4==e.status.code)if(t.$route.query.VnId){var n=t.formData,o=n.id,r=n.name,l=t.modelData.model_ver_no;t.$router.replace(t.localePath("/models/verEdit/".concat(o,"?VnId=").concat(l,"&name=").concat(r)))}else t.$message.success(t.$t("editSuccess")),t.closePage(!0)})).finally((function(){t.loading=!1}))}},closePage:function(t){var e=this;t?this.$router.back():this.$confirm(this.$t("ModelCancelTips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){e.$router.back()}))},getParams:function(){var t,e,n=this.formData.is_agency_fee,o=C()(this.formData);n||(null===(t=o.payment)||void 0===t||delete t.fee,null===(e=o.payment)||void 0===e||delete e.way);return o.tags.forEach((function(t,i){t.title||(o.tags[i]={title:t});var e=Object.keys(t);2===e.length&&e.every((function(t){return["title","id"].includes(t)}))&&delete o.tags[i].id})),o},getTranslationKey:function(t){return"Checkpoint"===this.formData.type?t:t.replace("Model","LORA")},setPayNum:function(){var t,e,n;(null===(t=this.formData.payment)||void 0===t?void 0:t.fee)<1&&(this.formData.payment.fee=1),(null===(e=this.formData.payment)||void 0===e?void 0:e.fee)>3&&(this.formData.payment.fee=3),this.formData.payment.fee=parseInt(null===(n=this.formData.payment)||void 0===n?void 0:n.fee)},updateCover:function(t){console.log("emit imgObj",t),t&&t.url?(this.formData.cover.url=null==t?void 0:t.url,this.formData.cover.cover_width=null==t?void 0:t.width,this.formData.cover.cover_height=null==t?void 0:t.height):this.formData.cover={url:"",cover_width:0,cover_height:0}}}},$=(n(2523),n(2524),n(0)),component=Object($.a)(O,(function(){var t,e,o,r=this,l=r._self._c;return l("div",{directives:[{name:"loading",rawName:"v-loading",value:r.loading,expression:"loading"}],staticClass:"model-edit"},[l("i",{staticClass:"el-icon-error",on:{click:r.closePage}}),r._v(" "),l("div",{staticClass:"form-title"},[r._v("\n    "+r._s(r.$t(r.getTranslationKey("ModelEdit")))+"\n    "),l("div",{staticClass:"btn-group"},[l("el-button",{staticClass:"cancel-btn",on:{click:function(t){return r.closePage()}}},[r._v("\n        "+r._s(r.$t("Cancel"))+"\n      ")]),r._v(" "),l("el-button",{staticClass:"save-btn",attrs:{type:"primary",loading:r.loading},on:{click:r.submit}},[r._v("\n        "+r._s(r.$route.query.VnId?r.$t("NextStep"):r.$t("Save"))+"\n      ")])],1)]),r._v(" "),l("div",{staticClass:"edit-form",attrs:{id:"editModelForm"}},[l("el-form",{ref:"modelForm",staticClass:"custom-form",attrs:{"label-position":"top",model:r.formData,rules:r.rules}},[l("div",{staticClass:"formBox"},[l("div",{staticClass:"formCnt"},[l("el-form-item",{attrs:{label:r.$t(r.getTranslationKey("ModelName")),required:"",prop:"name"}},[l("el-input",{attrs:{placeholder:r.$t(r.getTranslationKey("PleaseEnterModelName")),maxlength:100},model:{value:r.formData.name,callback:function(t){r.$set(r.formData,"name",t)},expression:"formData.name"}})],1),r._v(" "),l("el-form-item",{attrs:{label:r.$t("Type")}},[l("div",{staticClass:"type-select"},[l("span",{class:{active:"Checkpoint"===r.formData.type}},[r._v("\n                CheckPoint\n              ")]),r._v(" "),l("span",{class:{active:"LORA"===r.formData.type}},[r._v("LoRA")])])]),r._v(" "),l("el-form-item",[l("template",{slot:"label"},[r._v("\n              "+r._s(r.$t("SetTags"))+"\n            ")]),r._v(" "),l("el-select",{staticClass:"show-tag",attrs:{"value-key":"title",multiple:"",filterable:"",remote:"","allow-create":"","popper-class":"show-tag-select","default-first-option":"",placeholder:r.$t("pleaseEnte"),"remote-method":r.remoteMethod},on:{"visible-change":r.setIntRmdTag},model:{value:r.formData.tags,callback:function(t){r.$set(r.formData,"tags",t)},expression:"formData.tags"}},r._l(r.recommendList,(function(t,e){return l("el-option",{key:"tag_".concat(t.id+e),attrs:{label:t.title,value:t}})})),1)],2),r._v(" "),l("el-form-item",{attrs:{label:r.$t(r.getTranslationKey("ModelSources")),required:"",prop:"name"}},[l("el-radio-group",{attrs:{disabled:1===(null===(t=r.modelData)||void 0===t?void 0:t.channel)},model:{value:r.sources,callback:function(t){r.sources=t},expression:"sources"}},[l("el-radio",{attrs:{label:"Original"}},[r._v(r._s(r.$t("Original")))]),r._v(" "),l("el-radio",{attrs:{label:"Reship"}},[r._v(r._s(r.$t("Reship")))])],1)],1)],1),r._v(" "),l("div",{staticClass:"formCnt"},[l("el-form-item",{attrs:{label:r.$t("ModelPayment"),required:""}},[l("div",{staticClass:"type-select model-payment"},[l("span",{class:{active:!1===r.formData.is_agency_fee},on:{click:function(t){"Original"==r.sources&&(r.formData.is_agency_fee=!1)}}},[r._v("\n                "+r._s(r.$t("Free"))+"\n              ")]),r._v(" "),l("span",{class:{active:!0===r.formData.is_agency_fee},on:{click:function(t){"Original"==r.sources&&(r.formData.is_agency_fee=!0)}}},[r._v("\n                "+r._s(r.$t("ModelEditPay"))+"\n              ")])]),r._v(" "),!0===r.formData.is_agency_fee?l("div",{staticClass:"payBox"},[l("div",{staticClass:"payCnt"},[l("div",{staticClass:"payTit"},[r._v(r._s(r.$t("paymentMethod")))]),r._v(" "),l("el-select",{attrs:{"popper-class":"payType"},model:{value:r.formData.payment.way,callback:function(t){r.$set(r.formData.payment,"way",t)},expression:"formData.payment.way"}},r._l(r.selectArgumentList,(function(t){return l("el-option",{key:t.label,attrs:{label:r.$t(t.label),value:t.value,disabled:t.disabled}})})),1)],1),r._v(" "),l("div",{staticClass:"payCnt"},[l("div",{staticClass:"payTit"},[r._v(r._s(r.$t("paymentAmount")))]),r._v(" "),l("div",{staticClass:"inputBox"},[l("input",{directives:[{name:"model",rawName:"v-model.number",value:r.formData.payment.fee,expression:"formData.payment.fee",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:r.formData.payment.fee},on:{blur:[function(t){return r.setPayNum()},function(t){return r.$forceUpdate()}],input:function(t){t.target.composing||r.$set(r.formData.payment,"fee",r._n(t.target.value))}}}),r._v(" "),1==(null===(e=r.formData.payment)||void 0===e?void 0:e.way)?l("img",{attrs:{src:n(121),alt:""}}):r._e(),r._v(" "),2==(null===(o=r.formData.payment)||void 0===o?void 0:o.way)?l("img",{attrs:{src:n(580),alt:""}}):r._e()])])]):r._e()]),r._v(" "),l("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"Original"==r.sources,expression:"sources == 'Original'"}],attrs:{required:""}},[l("template",{slot:"label"},[r._v("\n              "+r._s(r.$t("ModelPermissions"))+"\n              "),l("span",{staticClass:"item-tips"},[r._v("("+r._s(r.$t("MultipleChoice"))+")")])]),r._v(" "),l("div",{staticClass:"checkbox-container"},[l("el-checkbox",{model:{value:r.checkboxDownload,callback:function(t){r.checkboxDownload=t},expression:"checkboxDownload"}},[r._v("\n                "+r._s(r.$t("IsModelDownload"))+"\n              ")])],1),r._v(" "),l("div",{staticClass:"checkbox-container"},[l("el-checkbox",{model:{value:r.checkboxCommercial,callback:function(t){r.checkboxCommercial=t},expression:"checkboxCommercial"}},[r._v("\n                "+r._s(r.$t("IsCommercialUse"))+"\n              ")])],1),r._v(" "),l("div",{staticClass:"checkbox-container"},[l("el-checkbox",{model:{value:r.checkboxMix,callback:function(t){r.checkboxMix=t},expression:"checkboxMix"}},[r._v("\n                "+r._s(r.$t("IsModelMerging"))+"\n              ")])],1)],2),r._v(" "),l("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"Reship"==r.sources,expression:"sources == 'Reship'"}],attrs:{label:r.$t("originalLink"),prop:"refer"}},[l("el-input",{attrs:{placeholder:r.$t("pleaseEnte")},model:{value:r.formData.refer,callback:function(t){r.$set(r.formData,"refer",t)},expression:"formData.refer"}})],1)],1)]),r._v(" "),l("el-form-item",{attrs:{prop:"cover"}},[l("template",{slot:"label"},[r._v("\n          "+r._s(r.$t(1===r.modelType?"CheckpointCover":"LORACover"))+"\n          "),l("p",{staticClass:"form-item-tips"},[r._v("\n            "+r._s(r.$t("modelCoverDesc",{modelCover:r.$t(1===r.modelType?"CheckpointCover":"LORACover")}))+"\n          ")])]),r._v(" "),l("SingleImageUpload",{attrs:{defaultImageUrl:r.formData.cover.url,maxSize:2},on:{upload:function(t){return r.updateCover(t)}}})],2)],1)],1)])}),[],!1,null,"6b20bab2",null);e.default=component.exports},3308:function(t,e,n){"use strict";n.r(e);n(14),n(9),n(7),n(11),n(12),n(8);var o=n(2),r=(n(32),n(19),n(4),n(23),n(37),n(6),n(1)),l=n(13),c=n(342),d=n(504),h=n(105),m=n(41),v=n(526),f=n(266);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var w={name:"ModelEdit",components:{ModelFileUpload:c.a,ModelWorkItem:d.a,SingleImageUpload:v.a,modelExistDialog:f.a},data:function(){var t=this;return{formData:{model_id:this.$route.params.id,base_model:"",type:"Checkpoint",file_id:"",sample_ids:[],desc:"",trigger_words:[],allow_creation:1},ModelName:"",existObj:{name:"",url:"",open:!1},modelData:null,loading:!1,checkboxDisabled:!1,isNext:!1,SDList:l.p,versionId:"",fromName:"",rules:{sample_ids:[{validator:function(e,n,o){var r=n.length;(0===r||r>10)&&o(new Error(t.$t("PleaseUploadExampleImages"))),o()}}],name:[{required:!0,message:this.$t("PleaseEnterVer")},{validator:function(e,n,o){/^[a-zA-Z0-9_.-]+$/.test(n)?o():o(new Error(t.$t("ModelVerFormatWarn")))}}],base_model:[{required:!0,message:this.$t("PleaseSelectBaseModel")}],file_id:[{required:!0,message:this.$t("PleaseUploadFodelFile")}]},selectArgumentList:[{label:"computingPower",value:1},{label:"diamond",value:2,disabled:!0}]}},computed:y(y(y(y({},Object(r.e)("user",["userInfo"])),Object(r.e)("payment",["paymentInfo"])),Object(r.c)("user",["isCompanyAccount"])),{},{isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)||this.isCompanyAccount},modelType:function(){return"Checkpoint"===this.formData.type?1:2},isCommunity:{get:function(){return 1===this.formData.allow_creation},set:function(t){this.formData.allow_creation=t?1:2}}}),beforeRouteEnter:function(t,e,n){n((function(t){t.fromName=e.name}))},mounted:function(){this.$route.query.name&&(this.ModelName=this.$route.query.name),"VnAdd"==this.$route.query.VnId?this.isNext=!0:this.versionId=this.$route.query.VnId,this.getModelData()},methods:{commChange:function(t){this.isVip||t||(this.$EventBus.$emit("showBreakDialog","TrainLoraTipWeb","basic"),this.formData.allow_creation=1)},getModelData:function(){var t=this;if(!this.loading){this.loading=!0;var e=h.b,n={id:this.$route.params.id};this.$route.query.VnId&&!this.isNext&&(e=m.F,n={id:this.$route.params.id,version_id:this.$route.query.VnId}),e(n).then((function(e){if(1e4==e.status.code){var n=e.data,o=n.type,r=n.file_id,l=n.samples,c=n.base_model,desc=n.desc,d=n.version_name,h=n.trained_words,m=n.allow_creation;t.modelData=e.data,t.isNext?t.formData=y(y({},t.formData),{},{type:o}):t.formData=y(y({},t.formData),{},{type:o,name:d,file_id:r,base_model:c,desc:(desc||"").replace(/<br>/g,"\r\n"),trigger_words:h,allow_creation:m,sample_ids:l.map((function(t){return y(y({},t),{},{banner:{url:t.url}})}))}),t.$set(t,"formData",t.formData),t.$set(t,"modelData",t.modelData)}})).finally((function(){t.loading=!1}))}},submit:function(){var t=this,e=this.formData.sample_ids.length;(0===e||e>10)&&this.$message.warning(this.$t("PleaseUploadExampleImages")),this.$refs.modelForm.validate((function(e){e&&t.submiData()}))},addVer:function(){var t=this;this.$refs.modelForm.validate((function(e){if(e){if(1==t.loading)return;t.loading=!0;var n=y({},t.formData);n.file_id=n.file_id.split("/")[0],Object(m.a)(n).then((function(e){1e4==e.status.code&&(t.versionId=e.data.id,Object(m.F)({id:t.$route.params.id,version_id:t.versionId}).then((function(e){1e4==e.status.code&&(t.modelData=e.data,t.isNext=!1,t.$nextTick((function(){var e=t.$refs.sample_ids.$el.offsetTop-90;t.$refs["edit-form"].scrollBy({top:e,behavior:"smooth"})})))})).finally((function(){t.loading=!1})))}))}}))},publishModel:function(){var t=this;Object(m.u)({model_no:this.formData.model_id}).then((function(e){var n;if(1e4==e.status.code)if(null!==(n=e.data)&&void 0!==n&&n.model_id){var o=e.data,r=o.model_id,l=o.model_name,c=void 0===l?"Model":l,d=o.model_status,h=void 0===d?2:d;t.existObj.url="".concat(window.location.origin,"/")+"models/detail/"+r,t.existObj.name=c,t.existObj.open=1===h,t.$refs.modelExist.modelExistDialog=!0}else t.$message.success(t.$t("PulishSuccess")),t.closePage(!0);else e.status.code})).finally((function(){t.loading=!1}))},submiData:function(){var t=this;if(1!=this.loading){var e=y({},this.formData);e.desc=(e.desc||"").replace(/\n/g,"<br>"),this.loading=!0,e.file_id=e.file_id.split("/")[0],this.$route.query.VnId&&!this.isNext?e.id=this.versionId:delete e.id,delete e.type,e.sample_ids.forEach((function(t,n){t.id&&(e.sample_ids[n]=t.id)})),Object(m.z)(e).then((function(e){if(1e4==e.status.code){if(t.$route.query.VnId&&!t.isNext){var n;if(null!==(n=e.data)&&void 0!==n&&n.model_id){var o=e.data,r=o.model_id,l=o.model_name,c=void 0===l?"Model":l,d=o.model_status,h=void 0===d?2:d;return t.existObj.url="".concat(window.location.origin,"/")+"models/detail/"+r,t.existObj.name=c,t.existObj.open=1===h,void(t.$refs.modelExist.modelExistDialog=!0)}"ModelEdit"==t.fromName?t.publishModel():t.$message.success(t.$t("editSuccess"))}else"ModelEdit"==t.fromName?t.publishModel():t.$message.success(t.$t("CreateSuccess"));"ModelEdit"!=t.fromName&&t.closePage(!0)}})).finally((function(){"ModelEdit"!=t.fromName&&(t.loading=!1)}))}},closePage:function(t){var e=this;t?this.$router.back():this.$confirm(this.$t("ModelCancelTips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){e.$router.back()}))},getEditStatus:function(){var t=this.formData.sample_ids,e=this.modelData,n=e.name,o=e.samples,r=o.every((function(e){return t.find((function(t){return t.id===e.id}))}));return this.ModelName!=n||!(r&&o.length===t.length)},getTranslationKey:function(t){return"Checkpoint"===this.formData.type?t:t.replace("Model","LORA")}}},C=(n(2525),n(2526),n(0)),component=Object(C.a)(w,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"model-edit"},[e("i",{staticClass:"el-icon-error",on:{click:t.closePage}}),t._v(" "),e("div",{staticClass:"form-title"},[t._v("\n      "+t._s(t.$t("Versions")+t.$t("Edit"))+"\n      "),e("div",{staticClass:"btn-group"},[t.isNext?e("el-button",{staticClass:"save-btn",attrs:{type:"primary",loading:t.loading},on:{click:t.addVer}},[t._v("\n          "+t._s(t.$t("NextStep"))+"\n        ")]):"ModelEdit"==t.fromName?e("el-button",{staticClass:"save-btn",attrs:{type:"primary",loading:t.loading},on:{click:t.submit}},[t._v("\n          "+t._s(t.$t("Publish"))+"\n        ")]):e("el-button",{staticClass:"save-btn",attrs:{type:"primary",loading:t.loading},on:{click:t.submit}},[t._v("\n          "+t._s(t.$t("Save"))+"\n        ")])],1)]),t._v(" "),e("div",{ref:"edit-form",staticClass:"edit-form",attrs:{id:"editModelForm"}},[e("el-form",{ref:"modelForm",staticClass:"custom-form",attrs:{"label-position":"top",model:t.formData,rules:t.rules}},[e("div",{staticClass:"formBox"},[e("div",{staticClass:"formCnt"},[e("el-form-item",{attrs:{label:t.$t("Versions")+t.$t("trainName"),required:"",prop:"name"}},[e("div",{staticClass:"VnAddBox"},[e("el-input",{attrs:{maxlength:100,disabled:""},model:{value:t.ModelName,callback:function(e){t.ModelName=e},expression:"ModelName"}}),t._v(" "),e("el-input",{attrs:{placeholder:t.$t("pleaseEnte"),maxlength:10},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1)]),t._v(" "),e("el-form-item",{attrs:{label:t.$t("BaseModel"),prop:"base_model"}},[e("el-select",{attrs:{"popper-class":"custom-select"},model:{value:t.formData.base_model,callback:function(e){t.$set(t.formData,"base_model",e)},expression:"formData.base_model"}},t._l(t.SDList,(function(t,n){return e("el-option",{key:"SD_"+n,attrs:{label:t,value:t}})})),1)],1),t._v(" "),0!=t.formData.allow_creation?e("el-form-item",[e("div",{staticClass:"isCommunityBox"},[e("span",[t._v(t._s(t.$t("sameModel")))]),t._v(" "),e("el-switch",{on:{change:t.commChange},model:{value:t.isCommunity,callback:function(e){t.isCommunity=e},expression:"isCommunity"}})],1)]):t._e(),t._v(" "),e("el-form-item",{attrs:{label:t.$t("CheckpointFile"),prop:"file_id"}},[e("model-file-upload",{ref:"modelsFileUpload",attrs:{createId:t.formData.model_id,modelType:t.modelType,disabled:!t.isNext},model:{value:t.formData.file_id,callback:function(e){t.$set(t.formData,"file_id",e)},expression:"formData.file_id"}})],1)],1),t._v(" "),e("div",{staticClass:"formCnt"},[e("el-form-item",{attrs:{prop:"trigger_words"}},[e("template",{slot:"label"},[t._v("\n                "+t._s(t.$t("TriggerWords"))+"\n              ")]),t._v(" "),e("el-select",{attrs:{multiple:"",filterable:"","popper-class":"custom-select","allow-create":"","default-first-option":"",placeholder:t.$t("pleaseEnte")},model:{value:t.formData.trigger_words,callback:function(e){t.$set(t.formData,"trigger_words",e)},expression:"formData.trigger_words"}},t._l([],(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],2),t._v(" "),e("el-form-item",{attrs:{label:t.$t("verIntroduction"),prop:"desc"}},[e("el-input",{attrs:{placeholder:t.$t("pleaseEnte"),maxlength:1e4,"show-word-limit":"",type:"textarea"},model:{value:t.formData.desc,callback:function(e){t.$set(t.formData,"desc",e)},expression:"formData.desc"}})],1)],1)]),t._v(" "),t.isNext?t._e():e("el-form-item",{ref:"sample_ids",attrs:{required:"",prop:"sample_ids"}},[e("template",{slot:"label"},[t._v("\n            "+t._s(t.$t("Versions")+t.$t("Work"))+"\n            "),e("span",{staticClass:"item-tips"},[t._v(t._s(t.$t("ModelEditWorkTips")))]),t._v(" "),e("p",{staticClass:"form-item-tips"},[t._v("\n              "+t._s(t.$t("ModelWorkTips",{modelType:t.$t(1===t.modelType?"Checkpoint":"LoRA")}))+"\n            ")])]),t._v(" "),e("model-work-item",{ref:"modelsWork",attrs:{modelData:t.modelData},model:{value:t.formData.sample_ids,callback:function(e){t.$set(t.formData,"sample_ids",e)},expression:"formData.sample_ids"}})],2)],1)],1),t._v(" "),e("modelExistDialog",{ref:"modelExist",attrs:{existObj:t.existObj}})],1)}),[],!1,null,"2cb7aaba",null);e.default=component.exports},3319:function(t,e,n){"use strict";n.r(e);n(9),n(7),n(11),n(12),n(8),n(6);var o=n(15),r=n(2),l=(n(16),n(47),n(10),n(19),n(43),n(14),n(300),n(4),n(50),n(301),n(302),n(303),n(304),n(305),n(306),n(307),n(308),n(309),n(310),n(311),n(312),n(313),n(48),n(536)),c=n(1890),d=n(537),h=n(126),m=n(1),v=n(24);function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function _(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var y={components:{tagList:l.a,RoleCardItem:d.a,recCyberBarItem:c.a},data:function(){return{loading:!1,list:[],queryParams:{order_by:"new",categories:[],page:1,page_size:30,offset:0,publish_status:1},noMore:!1,debounceHandleScroll:null,showEmpty:!1,debounceSearch:null}},created:function(){this.debounceSearch=Object(v.debounce)(this.handleSearch,600)},mounted:function(){this.debounceHandleScroll=Object(v.debounce)(this.handleScroll,600),this.getList()},beforeDestroy:function(){this.debounceHandleScroll=null,this.debounceSearch=null},computed:_(_({},Object(m.c)("user",["isLoggedIn"])),Object(m.e)("user",["userInfo"])),methods:{handleDelete:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$confirm(this.$t("DelAiChatDesc"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){t.removeRole(e)}))},removeRole:function(t){var e=this;Object(h.c)({id:t.id}).then((function(n){var o;if(1e4===(null==n||null===(o=n.status)||void 0===o?void 0:o.code)){e.handleSearch();var r=e.list.findIndex((function(e){return e.id===t.id}));-1!==r&&e.list.splice(r,1),e.$message.success(e.$t("deleteSuccess"))}}))},handleSearch:function(){this.queryParams.page=1,this.queryParams.offset=0,this.list=[],this.noMore=!1,this.getList()},handleScroll:function(){try{var t=this.$refs.scrollBar;try{if(0===t.scrollTop&&0===t.scrollHeight)return;var e=t.offsetHeight||0,n=t.scrollHeight-t.scrollTop-e;!this.loading&&!this.noMore&&this.queryParams.page>1&&t&&n<=200&&this.getList(!0)}catch(t){}}catch(t){}},getList:function(t){var e=this;if(this.isLoggedIn){var n=Object.assign({},this.queryParams);[null,void 0,""].includes(this.queryParams.offset)||(n.offset=this.queryParams.offset),this.loading=!0,Object(h.h)(n).then((function(n){var o,r,l,c=(null==n?void 0:n.data).items,d=void 0===c?[]:c;if(e.noMore=!(null!==(o=n.data)&&void 0!==o&&o.has_more),d.length>0&&(d=d.map((function(t){return _(_({},t),e.initItems(t))}))),t){var h=e.unionMerge(e.list,d,"id");e.list=e.list.concat(h)}else e.list=d;1===e.queryParams.page&&null!==(r=n.data)&&void 0!==r&&r.offset&&(e.queryParams.offset=(null===(l=n.data)||void 0===l?void 0:l.offset)||0);e.queryParams.page++})).finally((function(){e.loading=!1,e.showEmpty=!0}))}else this.$EventBus.$emit("openLoginDialog")},initItems:function(t){var e,n,o;return{character:{evaluation:t.evaluation,categories:t.categories,name:t.name},cover:null===(e=t.cover)||void 0===e?void 0:e.url,cover_height:null===(n=t.cover)||void 0===n?void 0:n.height,cover_width:null===(o=t.cover)||void 0===o?void 0:o.width,nsfw:2}},unionMerge:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",map=new Map(t.map((function(t){return[t[n],!0]})));return e.reduce((function(t,e){return map.has(e[n])?t:[].concat(Object(o.a)(t),[e])}),[])},changeClass:function(t){this.queryParams.publish_status!==t&&(this.queryParams.publish_status=t,this.debounceSearch&&this.debounceSearch())},updateSelectList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.queryParams.categories=t,this.debounceSearch&&this.debounceSearch()}}},w=y,C=(n(2675),n(0)),component=Object(C.a)(w,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-character no-scrollbar"},[e("el-backtop",{attrs:{bottom:30,right:30,target:".my-character .aichat-list"}},[e("i",{staticClass:"el-icon-top"})]),t._v(" "),e("div",{staticClass:"class-tab"},[e("div",{staticClass:"flex-center",class:{active:1===t.queryParams.publish_status},on:{click:function(e){return t.changeClass(1)}}},[e("i",{staticClass:"iconfont icon-eye"}),t._v(t._s(t.$t("createSetting1"))+"\n    ")]),t._v(" "),e("div",{staticClass:"flex-center",class:{active:2===t.queryParams.publish_status},on:{click:function(e){return t.changeClass(2)}}},[e("i",{staticClass:"iconfont icon-eye-disable"}),t._v(t._s(t.$t("createSetting2"))),e("span")])]),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"aichat-tags"},[e("tag-list",{on:{selectList:t.updateSelectList}})],1),t._v(" "),e("div",{ref:"scrollBar",staticClass:"aichat-list hide-scrollbar",attrs:{id:"myAiChat"},on:{scroll:t.debounceHandleScroll}},[t._l(t.list,(function(n){return e("recCyberBarItem",{key:null==n?void 0:n.id,attrs:{item:n,outerClass:"myAiChat"},on:{delete:t.handleDelete}})})),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showEmpty&&!t.loading&&!t.list.length,expression:"showEmpty && !loading && !list.length"}],staticClass:"list-empty-content"},[e("p",{staticClass:"list-empty-content-main-title"},[t._v(t._s(t.$t("tavern47")))]),t._v(" "),e("p",{staticClass:"list-empty-content-subtitle"},[t._v(t._s(t.$t("tavern48")))])])],2)],1)}),[],!1,null,"0256ae96",null);e.default=component.exports},3320:function(t,e,n){"use strict";n.r(e);n(14);var o=n(3),r=n(15),l=n(2),c=(n(20),n(16),n(32),n(47),n(9),n(7),n(10),n(19),n(43),n(300),n(4),n(11),n(12),n(8),n(23),n(18),n(50),n(37),n(6),n(301),n(302),n(303),n(304),n(305),n(306),n(307),n(308),n(309),n(310),n(311),n(312),n(313),n(48),n(64)),d=n(126),h=n(536),m=n(537),v=n(24),f=n(5);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var y={name:"tavernList",components:{tagList:h.a,roleCardItem:m.a,SwipeableList:c.a},data:function(){return{replaceImageType:f.x,loading:!1,roleList:[],lastChatParams:{page:1,page_size:100,with_latest_msg:1},hasMoreChat:!1,recentChatLoading:!1,showChatRoleEdit:!1,pageInfo:{page:1,pageSize:20,total:0},queryParams:{keyword:"",order_by:"hot",categories:[],page:1,page_size:30,offset:0},orderList:[{name:"最热",value:"hot",i18nKey:"Hot",iconClass:"hot",behavior_info:"click_hot"},{name:"最近",value:"new",i18nKey:"New",iconClass:"new",behavior_info:"click_new"}],timeName:"All",timeInit:[{name:"All",startTime:null,endTime:null},{name:"days",startTime:Object(f.p)().startTimestamp,endTime:Object(f.p)().endTimestamp},{name:"week",startTime:Object(f.r)().startTimestamp,endTime:Object(f.r)().endTimestamp},{name:"months",startTime:Object(f.o)().startTimestamp,endTime:Object(f.o)().endTimestamp}],list:[],enableNsfw:!1,inputBorderShow:!1,vipIconUrl:n(162),noMore:!1,debounceHandleScroll:function(){},debounceSearch:function(){},showEmpty:!1,defaultImageUrl:"https://image.cdn2.seaart.ai/static/upload/20231207/39b3e881-ae85-415d-b7aa-74182b3b6267.webp",scroll:0}},computed:{renderChatRoleList:function(){return this.roleList}},watch:{$route:{handler:function(t,e){var n=t.name,o=t.params.keyword;n.includes("tavernSearch")&&(this.queryParams.keyword=o.replace(/\-/g," "),this.handleSearch())}}},mounted:function(){this.debounceSearch=Object(v.debounce)(this.handleSearch,600),this.debounceHandleScroll=Object(v.debounce)(this.handleScroll,600),this.getRecentChatList()},activated:function(){this.restoreScroll()},beforeDestroy:function(){this.debounceHandleScroll=null,this.debounceSearch=null},methods:{getIconFn:function(){return this.showChatRoleEdit?"icon-tick":"icon-icon-edit1"},imgError:function(t,e,n){e?n&&(t.target.src=n):t.target.src=this.defaultImageUrl},restoreScroll:function(){var t=this;this.$nextTick((function(){t.$refs.scrollBar&&(t.$refs.scrollBar.scrollTop=t.scroll)}))},handleCheckBoxSearch:function(){this.$logEvent("log_actions",{operation:"tavern_on_square",behavior_info:"click_nsfw"}),this.debounceSearch&&this.debounceSearch()},handleInputSearch:function(){this.$logEvent("log_actions",{operation:"tavern_on_square",behavior_info:"click_search"}),this.debounceSearch&&this.debounceSearch()},handleQueryByTag:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{this.$refs.tagList.handleSelect({id:t})}catch(t){}},handleSearchChange:function(t){["",null,void 0].includes(t)&&this.debounceSearch&&this.debounceSearch()},getRecentChatList:function(){var t=this,e=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},this.lastChatParams);this.recentChatLoading=!0,Object(d.i)(e).then((function(n){var o;if(t.hasMoreChat=null===(o=n.data)||void 0===o?void 0:o.has_more,e.page>1){var r,l=t.unionMerge(t.roleList,(null==n||null===(r=n.data)||void 0===r?void 0:r.items)||[],"session_id");t.roleList.concat(l)}else{var c;t.roleList=(null==n||null===(c=n.data)||void 0===c?void 0:c.items)||[]}})).finally((function(){t.recentChatLoading=!1}))},loadMoreChat:function(){this.lastChatParams.page++,this.getRecentChatList()},handleScroll:function(){try{var t=this.$refs.scrollBar;try{if(0===t.scrollTop&&0===t.scrollHeight)return;this.scroll=t.scrollTop;var e=t.offsetHeight||0,n=t.scrollHeight-t.scrollTop-e;!this.loading&&!this.noMore&&this.queryParams.page>1&&t&&n<=200&&this.getList(!0)}catch(t){}}catch(t){}},updateSelectList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.queryParams.categories=t,this.handleSearch()},handleDeleteRole:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$confirm(this.$t("tavern1"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning",customClass:"custom-confirm"}).then((function(){t.removeRole(e),localStorage.removeItem("translate_".concat(e.session_id))}))},removeRole:function(t){var e=this;Object(d.d)({id:t.session_id}).then((function(n){var o;if(1e4===(null==n||null===(o=n.status)||void 0===o?void 0:o.code)){var r=e.roleList.findIndex((function(e){return e.cover===t.cover}));-1!==r&&e.roleList.splice(r,1),e.$message.success(e.$t("deleteSuccess"))}}))},toggleEditStatus:function(){this.showChatRoleEdit=!this.showChatRoleEdit},getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n={page:this.queryParams.page,page_size:this.queryParams.page_size,categories:this.queryParams.categories,order_by:this.queryParams.order_by,keyword:this.queryParams.keyword,time_from:this.queryParams.time_from,time_to:this.queryParams.time_to};1===n.page||[null,void 0,""].includes(this.queryParams.offset)||(n.offset=this.queryParams.offset),this.loading=!0,Object(d.j)(n).then((function(n){var o,r,l;if(t.noMore=!(null!==(o=n.data)&&void 0!==o&&o.has_more),e){var c,d=t.unionMerge(t.list,(null==n||null===(c=n.data)||void 0===c?void 0:c.items)||[],"id");t.list=t.list.concat(d)}else{var h;t.list=(null==n||null===(h=n.data)||void 0===h?void 0:h.items)||[]}1===t.queryParams.page&&null!==(r=n.data)&&void 0!==r&&r.offset&&(t.queryParams.offset=(null===(l=n.data)||void 0===l?void 0:l.offset)||0);t.queryParams.page++})).finally((function(){t.loading=!1,t.showEmpty=!0}))},unionMerge:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",map=new Map(t.map((function(t){return[t[n],!0]})));return e.reduce((function(t,e){return map.has(e[n])?t:[].concat(Object(r.a)(t),[e])}),[])},handleSelectChange:function(t){var e=this.orderList.find((function(e){return e.value===t}));e&&null!=e&&e.behavior_info&&this.$logEvent("log_actions",{operation:"tavern_on_square",behavior_info:null==e?void 0:e.behavior_info}),this.debounceSearch&&this.debounceSearch()},handleTimeCommand:function(t){var e={All:"click_all_time_filter",days:"click_day_filter",week:"click_week_filter",months:"click_month_filter"}[t.name];this.$logEvent("log_actions",{operation:e,behavior_info:"on_tavern_page"}),this.timeUpdate(),this.timeName=t.name,this.queryParams.time_from=t.startTime,this.queryParams.time_to=t.endTime,this.debounceSearch&&this.debounceSearch()},timeUpdate:function(){this.timeInit=[{name:"All",startTime:null,endTime:null},{name:"days",startTime:Object(f.p)().startTimestamp,endTime:Object(f.p)().endTimestamp},{name:"week",startTime:Object(f.r)().startTimestamp,endTime:Object(f.r)().endTimestamp},{name:"months",startTime:Object(f.o)().startTimestamp,endTime:Object(f.o)().endTimestamp}]},handleSearch:function(){this.queryParams.page=1,this.queryParams.offset=0,this.list=[],this.noMore=!1,this.getList()},clearKeyword:function(){this.queryParams.keyword="",this.debounceSearch&&this.debounceSearch()},toMall:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$logEvent("log_actions",{operation:"subscription_page_show",behavior_info:null!=t&&t.name?t.name:location.href}),this.$router.push(this.localePath("/mall"))},toChat:function(t){var e=t.character_id,n=t.session_id;this.$router.replace(this.localePath("/aiChat/".concat(e,"?s_id=").concat(n)))}},head:function(){var title=this.$t("cyberPubHomeTitle"),t=this.$t("cyberPubHomeDesc");return{title:title,meta:[{hid:"description",name:"description",content:t},{hid:"keywords",name:"keywords",content:this.$t("CyberPubKeyword")},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:t}]}},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,c,d,data,h,m,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,t.app,o=t.params,r=t.error,l=o.keyword,e.prev=2,c={order_by:"hot",page:1,page_size:30,categories:[],keyword:l?null==l?void 0:l.replace(/\-/g," "):""},e.next=6,n.$post("/api/v1/character/list",c);case 6:return d=e.sent,data=d.data,m=(h=data||{items:[],offset:0}).items,v=h.offset,c.page++,c.offset=v,console.log(c),e.abrupt("return",{list:m||[],queryParams:c});case 15:e.prev=15,e.t0=e.catch(2),console.log("数字人-> asyncData错误啦：",e.t0),r({statusCode:404,message:e.t0});case 19:case"end":return e.stop()}}),e,null,[[2,15]])})))()}},w=y,C=(n(2676),n(0)),component=Object(C.a)(w,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"c-tavern-list"},[n("el-backtop",{attrs:{bottom:30,right:30,target:".c-tavern-list .tavern-list-box"}},[n("i",{staticClass:"el-icon-top"})]),e._v(" "),n("div",{ref:"scrollBar",staticClass:"tavern-list-box no-scrollbar",on:{scroll:e.debounceHandleScroll}},[n("div",{directives:[{name:"show",rawName:"v-show",value:null===(t=e.roleList)||void 0===t?void 0:t.length,expression:"roleList?.length"}],staticClass:"tavern-last-chat-list"},[n("div",{staticClass:"tavern-list-title"},[e._v(e._s(e.$t("tavern50")))]),e._v(" "),n("div",{staticClass:"btn-box"},[n("div",{staticClass:"edit-btn",on:{click:function(t){return t.stopPropagation(),e.toggleEditStatus.apply(null,arguments)}}},[n("i",{staticClass:"iconfont edit-btn-icon",class:[e.getIconFn(),e.showChatRoleEdit?"edit-btn-icon-active":""]}),e._v(" "),n("span",{staticClass:"edit-btn-text",class:[e.showChatRoleEdit?"edit-btn-text-active":""]},[e._v(e._s(e.showChatRoleEdit?e.$t("Done"):e.$t("Edit")))])])]),e._v(" "),n("div",{staticClass:"tavern-last-chat-list-content"},[n("div",{staticClass:"last-chat-role-list-wrap"},[n("SwipeableList",{attrs:{top:"10px",height:"136px",listGap:"10px",bntTop:"-40px"}},[n("div",{staticClass:"last-chat-role-list-content"},e._l(e.renderChatRoleList,(function(t,o){var r,l;return n("div",{key:o,staticClass:"role-item-wrap"},[n("div",{staticClass:"role-item-content",on:{click:function(n){return e.toChat(t)}}},[n("div",{staticClass:"role-item-content-img"},[n("img",{staticClass:"art-work-card-image",attrs:{src:null!=t&&null!==(r=t.cover)&&void 0!==r&&r.cover?e.replaceImageType(null==t||null===(l=t.cover)||void 0===l?void 0:l.cover,"low"):e.defaultImageUrl,alt:"",onError:"{(e)=>imgError(e)}"}})]),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:e.showChatRoleEdit,expression:"showChatRoleEdit"}],staticClass:"role-item-delete-btn",on:{click:function(n){return n.stopPropagation(),e.handleDeleteRole(t)}}},[n("i",{staticClass:"el-icon-close"})])]),e._v(" "),n("div",{staticClass:"role-item-title"},[e._v(e._s(t.name))])])})),0)])],1)])]),e._v(" "),n("div",{staticClass:"tavern-role-list"},[n("div",{staticClass:"tavern-list-title tavern-list-title-2"},[e._v(e._s(e.$t("tavern51")))]),e._v(" "),n("div",{staticClass:"tavern-list-search-box",class:{"justify-end":e.queryParams.keyword}},[n("div",{directives:[{name:"show",rawName:"v-show",value:""===e.queryParams.keyword,expression:"queryParams.keyword === ''"}],staticClass:"tavern-list-search-box-left"},[n("el-select",{staticClass:"custom-select",staticStyle:{width:"110px"},attrs:{"popper-class":"custom-select",placeholder:e.$t("All")},on:{change:e.handleSelectChange},model:{value:e.queryParams.order_by,callback:function(t){e.$set(e.queryParams,"order_by",t)},expression:"queryParams.order_by"}},e._l(e.orderList,(function(t){return n("el-option",{key:t.value,attrs:{label:e.$t(t.i18nKey),value:t.value}})})),1),e._v(" "),n("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleTimeCommand}},[n("div",{staticClass:"el-dropdown-link selectTime"},[n("div",[n("i",{staticClass:"el-icon-time"}),e._v(" "),n("span",[e._v(e._s(e.$t(e.timeName)))])]),e._v(" "),n("i",{staticClass:"el-icon-arrow-down"})]),e._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.timeInit,(function(t,o){return n("el-dropdown-item",{key:o,attrs:{command:t}},[n("div",{staticClass:"el-dropdown-item el-dropdown-item-time"},[n("span",[e._v(e._s(e.$t(t.name)))])])])})),1)],1)],1),e._v(" "),n("div",{staticClass:"tavern-list-search-input",class:{inputBorder:e.inputBorderShow}},[n("i",{staticClass:"iconfont icon-min-search"}),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.queryParams.keyword,expression:"queryParams.keyword"}],attrs:{type:"text",placeholder:e.$t("tavern57")},domProps:{value:e.queryParams.keyword},on:{change:e.handleSearchChange,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputSearch.apply(null,arguments)},focus:function(t){e.inputBorderShow=!0},blur:function(t){e.inputBorderShow=!1},input:function(t){t.target.composing||e.$set(e.queryParams,"keyword",t.target.value)}}}),e._v(" "),e.queryParams.keyword?n("i",{staticClass:"el-icon-close",on:{click:e.clearKeyword}}):e._e()])]),e._v(" "),n("div",{staticClass:"tavern-list-tag-box"},[n("tag-list",{ref:"tagList",on:{selectList:e.updateSelectList}})],1),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"tavern-list-content-wrap"},[n("div",{staticClass:"tavern-list-content"},[e._l(e.list,(function(t,i){return n("role-card-item",{key:i+t.id,attrs:{"card-info":t},on:{queryByTag:e.handleQueryByTag}})})),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showEmpty&&!e.loading&&!e.list.length,expression:"showEmpty && !loading && !list.length"}],staticClass:"list-empty-content"},[n("p",{staticClass:"list-empty-content-subtitle"},[e._v(e._s(e.$t("tavern49")))])])],2)])])]),e._v(" "),n("div",{staticClass:"tavern-list-box-bottom-mask"})],1)}),[],!1,null,"51e9992b",null);e.default=component.exports},3331:function(t,e,n){"use strict";n.r(e);var o=n(3),r=(n(1561),n(44),n(678)),l=n.n(r),c=(n(1562),n(679)),d=n.n(c),h=(n(20),n(543)),m=n(176),v=n(39),f={components:{BlogHeader:h.a,ElBreadcrumb:d.a,ElBreadcrumbItem:l.a},data:function(){return{detailData:{}}},computed:{time:function(){var t;return Object(v.g)(null===(t=this.detailData)||void 0===t?void 0:t.update_at)}},mounted:function(){this.$logEvent("log_actions",{operation:"enter_news_detail_page",behavior_info:"on_news_detail_page"}),this.$route.params.id&&this.getData(this.$route.params.id)},methods:{getData:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,data;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(o={}).seo_url=t,o.type="aiNews",n.next=5,Object(m.c)(o);case 5:r=n.sent,data=r.data,e.detailData=data||{};case 8:case"end":return n.stop()}}),n)})))()}},head:function(){var t=this.detailData,e=t.title,title=void 0===e?"":e,n=t.meta_desc,o=void 0===n?"":n,r=t.author,l=void 0===r?"":r,c=t.cover,d=void 0===c?"":c,h=t.create_at,m=void 0===h?0:h,v=t.update_at,f=void 0===v?0:v;return{title:title,meta:[{hid:"description",name:"description",content:o},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:o}],script:[{type:"application/ld+json",json:{"@context":"https://schema.org","@type":"NewsArticle",headline:title,image:[d],datePublished:new Date(m).toISOString(),dateModified:new Date(f).toISOString(),author:[{"@type":"Person",name:l}]}}],__dangerouslyDisableSanitizers:["script"]}},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r,l,c,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$axios,t.app,o=t.params,r=t.error,e.prev=1,l={seo_url:o.id,type:"aiNews"},e.next=5,n.$post("/api/v1/blog/detail",l);case 5:if(c=e.sent,data=c.data){e.next=9;break}throw new Error("获取数据失败");case 9:return e.abrupt("return",{detailData:data||{}});case 12:e.prev=12,e.t0=e.catch(1),console.log("blog -> asyncData错误啦：",e.t0),r({statusCode:404,message:e.t0});case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))()}},_=(n(2916),n(0)),component=Object(_.a)(f,(function(){var t,e,n,o,r,l=this,c=l._self._c;return c("div",{staticClass:"blog-detail"},[c("BlogHeader",{attrs:{isDetail:""}}),l._v(" "),c("div",{staticClass:"blog-detail-content"},[c("el-breadcrumb",{staticClass:"breadcrumb",attrs:{"separator-class":"el-icon-arrow-right"}},[c("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[l._v("\n        "+l._s(l.$t("blog_home"))+"\n      ")]),l._v(" "),c("el-breadcrumb-item",{attrs:{to:{path:"/news"}}},[l._v("\n        "+l._s(l.$t("blog_news"))+"\n      ")]),l._v(" "),null!==(t=l.detailData)&&void 0!==t&&t.category?c("el-breadcrumb-item",[l._v("\n        "+l._s(l.$t("news_".concat(l.detailData.category)))+"\n      ")]):l._e()],1),l._v(" "),null!==(e=l.detailData)&&void 0!==e&&e.post_title?c("h1",[l._v(l._s(l.detailData.post_title))]):l._e(),l._v(" "),null!==(n=l.detailData)&&void 0!==n&&n.author?c("div",{staticClass:"tips"},[c("div",[c("span",{staticClass:"author"},[l._v(l._s(l.detailData.author))]),l._v(" "),c("time",{staticClass:"time",attrs:{datetime:l.time}},[l._v("\n          "+l._s(l.$t("blog_updated"))+" "+l._s(l.time)+"\n        ")])]),l._v(" "),c("div",{staticClass:"time"},[c("i",{staticClass:"el-icon-time"}),l._v(" "),c("span",[l._v(l._s(l.detailData.reading_duration)+" "+l._s(l.$t("blog_read")))])])]):l._e(),l._v(" "),null!==(o=l.detailData)&&void 0!==o&&o.meta_desc?c("div",{staticClass:"meta"},[l._v("\n      "+l._s(l.detailData.meta_desc)+"\n    ")]):l._e(),l._v(" "),null!==(r=l.detailData)&&void 0!==r&&r.content?c("div",{staticClass:"blog-detail-content-html",domProps:{innerHTML:l._s(l.detailData.content)}}):l._e()],1)],1)}),[],!1,null,"b1d41418",null);e.default=component.exports},3343:function(t,e,n){"use strict";n.r(e);n(9),n(7),n(11),n(12),n(6);var o=n(2),r=(n(10),n(8),n(4),n(18),n(29),n(1)),l=n(339),c=n(138),d=n(137),h=n(30);function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={name:"DailyDialog",provide:function(){return{top:this}},data:function(){return{isShowDialog:!1,isNewUser:!0,step:"inGoods",goodsId:"",defaultThirdType:0,useFree:!1,btnLabel:"",dotFrom:"daily_pop"}},components:{UserDaily:l.a,PaymentForm:c.a,RightPart:d.a},mounted:function(){var t=this;this.$EventBus.$on("checkDailyDialog",this.isOpen),this.$EventBus.$on("openDailyDialog",(function(e){var n="createBanner"==e?"banner_task_daily_pop":"banner_home_daily_pop";t.dotFrom=n,t.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:n,behavior_info_sub:"pop_1"}),t.isShowDialog=!0}))},beforeDestroy:function(){this.$EventBus.$off("checkDailyDialog",this.isOpen),this.$EventBus.$off("openDailyDialog")},computed:v(v(v(v({},Object(r.c)("payment",["paymentInfo"])),Object(r.c)("user",["isLoggedIn","isCompanyAccount"])),Object(r.e)("user",["userInfo"])),Object(r.e)("payment",["subThirdType"])),watch:{$route:{handler:function(t,e){var n=this;["cyberPub","ai-tools","workFlowAppDetail","loraTrainingEdit","workflow?id","editBoard"].some((function(e){return t.fullPath.includes(e)}))&&setTimeout((function(){n.isOpen()}),1500)},immediate:!0},userInfo:{handler:function(t){var e;if(null!==(e=Object.keys(t))&&void 0!==e&&e.length){var n=(new Date).getTime()-(null==t?void 0:t.create_at)<1728e5;this.isNewUser=n}else this.isNewUser=!1},immediate:!0,deep:!0}},methods:v(v({},Object(r.b)("payment",["getSubUrlAndThirdType"])),{},{isOpen:function(){var t,e,n=this;!((null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)||this.isCompanyAccount)&&this.isLoggedIn&&Object(h.f)({type:0}).then((function(t){(null==t?void 0:t.data)&&(n.isShowDialog=!0,n.dotFrom="daily_pop",n.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"daily_pop",behavior_info_sub:"pop_1"}))}))},close:function(){this.isShowDialog=!1,Object(h.f)({type:1})},quitPay:function(){this.step="inGoods"},subscriptionNow:function(t){var e=this,n=t.goods_id,o=void 0===n?"":n,r=t.useFree,l=void 0!==r&&r,c=t.btnLabel,d=void 0===c?"":c;this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:this.dotFrom||"daily_pop",behavior_info_sub:"pop_2"}),this.useFree=l,this.btnLabel=d,this.subThirdType?(this.defaultThirdType=this.subThirdType,this.goodsId=o,this.step="inPay"):this.getSubUrlAndThirdType().then((function(t){var n;if(1e4===(null==t||null===(n=t.status)||void 0===n?void 0:n.code)){var data=t.data;e.defaultThirdType=null==data?void 0:data.third_type,e.goodsId=o,e.step="inPay"}}))}})},_=(n(3181),n(0)),component=Object(_.a)(f,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"daily-dialog flex-center",attrs:{visible:t.isShowDialog,"destroy-on-close":!0,"append-to-body":!0,"close-on-click-modal":!1},on:{"update:visible":function(e){t.isShowDialog=e}}},["inGoods"===t.step?e("UserDaily",{attrs:{isNewUser:t.isNewUser},on:{subscriptionNow:t.subscriptionNow}}):t._e(),t._v(" "),"inPay"===t.step?e("PaymentForm",{attrs:{defaultThirdType:t.defaultThirdType,disabledMethods:t.useFree?[1,10]:[],isFreeTry:t.useFree,initMount:!0,upgrade:!1,goodsId:t.goodsId,purchParams:{},btnLabel:t.btnLabel},on:{"in-pay-back":t.quitPay,"pay-success":function(e){t.isShowDialog=!1,t.step="inGoods"}}},[t.useFree?[e("right-part",{attrs:{showBg:!1,showText:!1,showStep:!0,activation:!1,showAvatar:!0}})]:[e("right-part",{attrs:{showBg:!0,showText:!0,showStep:!1,showAvatar:!0}})]],2):t._e()],1)}),[],!1,null,"7d01947e",null);e.default=component.exports},3344:function(t,e,n){"use strict";n.r(e);n(9),n(7),n(11),n(12),n(4),n(6);var o=n(2),r=(n(8),n(1)),l=n(339),c=n(138),d=n(137);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={name:"RenewalDialog",provide:function(){return{top:this}},data:function(){return{isShowDialog:!1,isNewUser:!0,step:"inGoods",goodsId:"",defaultThirdType:0,defaultSelected:"basic",btnLabel:"",dotFrom:"vip_renewal"}},components:{UserDaily:l.a,PaymentForm:c.a,RightPart:d.a},mounted:function(){this.$EventBus.$on("showRenewalDialog",this.open)},beforeDestroy:function(){this.$EventBus.$off("showRenewalDialog",this.open)},computed:m(m(m({},Object(r.e)("payment",["subThirdType","paymentInfo"])),Object(r.c)("user",["isCompanyAccount"])),{},{isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)}}),watch:{paymentInfo:{handler:function(t){var e;if(null!==(e=Object.keys(t))&&void 0!==e&&e.length){var n=t.expiryTime,o=t.liteExpiryTime,r=t.activeState,l=t.liteActiveState,c=t.svipActiveState,d="vip_day_1"==t.vipType;if((r||l)&&!c&&!this.isCompanyAccount&&!d){var h=Math.max(n,o),m=(new Date).getTime(),v=864e5,f=h<m+2592e5,_=localStorage.getItem("renewalTime");if(f&&(!_||m-_>v))this.isShowDialog=!0,r&&!c&&!this.isCompanyAccount&&!l&&(this.defaultSelected="standard"),localStorage.setItem("renewalTime",m)}}},immediate:!0,deep:!0}},methods:m(m({},Object(r.b)("payment",["getSubUrlAndThirdType"])),{},{open:function(){this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"vip_renewal",behavior_info_sub:"pop_1"}),this.isShowDialog=!0},close:function(){this.isShowDialog=!1},quitPay:function(){this.step="inGoods"},subscriptionNow:function(t){var e=this,n=t.goods_id,o=t.btnLabel,r=void 0===o?"":o;this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"vip_renewal",behavior_info_sub:"pop_2"}),this.btnLabel=r,this.subThirdType?(this.defaultThirdType=this.subThirdType,this.goodsId=n,this.step="inPay"):this.getSubUrlAndThirdType().then((function(t){var o;if(1e4===(null==t||null===(o=t.status)||void 0===o?void 0:o.code)){var data=t.data;e.defaultThirdType=null==data?void 0:data.third_type,e.goodsId=n,e.step="inPay"}}))}})},f=(n(3187),n(0)),component=Object(f.a)(v,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"renewal-dialog flex-center",attrs:{visible:t.isShowDialog,"destroy-on-close":!0,"append-to-body":!0,"close-on-click-modal":!1},on:{"update:visible":function(e){t.isShowDialog=e}}},["inGoods"===t.step?e("UserDaily",{attrs:{title:"RenewalTitle",defaultSelected:t.defaultSelected},on:{subscriptionNow:t.subscriptionNow}}):t._e(),t._v(" "),"inPay"===t.step?e("PaymentForm",{attrs:{defaultThirdType:t.defaultThirdType,initMount:!0,upgrade:!1,goodsId:t.goodsId,purchParams:{},btnLabel:t.btnLabel},on:{"in-pay-back":t.quitPay,"pay-success":function(e){t.isShowDialog=!1,t.step="inGoods"}}},[e("right-part",{attrs:{showBg:!0,showText:!0,showStep:!1,showAvatar:!0}})],1):t._e()],1)}),[],!1,null,"3718e6ce",null);e.default=component.exports},3345:function(t,e,n){"use strict";n.r(e);n(9),n(11),n(12),n(8),n(6);var o=n(2),r=(n(7),n(32),n(19),n(4),n(1)),l=n(138),c=n(137),d=n(66);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={name:"VipComputingDialog",provide:function(){return{top:this}},components:{PaymentForm:l.a,RightPart:c.a},data:function(){return{isShowDialog:!1,step:"inGoods",goodsId:"",defaultThirdType:0,goodsData:{data:[{cp_product_id:"calculate1",btnLoad:!1,bgUrl:"mall/mall_credit_1.webp"},{cp_product_id:"calculate4",btnLoad:!1,bgUrl:"mall/mall_credit_2.webp"},{cp_product_id:"calculate5",btnLoad:!1,bgUrl:"mall/mall_credit_3.webp"}]},dotFrom:"vip_buy_calculate",title:this.$t("vipDialogComputedTit"),loading:!1}},mounted:function(){this.$EventBus.$on("showVipComputingDialog",this.open)},destroyed:function(){this.$EventBus.$off("showVipComputingDialog",this.open)},computed:m(m(m(m({},Object(r.e)("payment",["subThirdType","paymentInfo"])),Object(r.c)("user",["userInfo"])),Object(r.e)("user",["cdnHost"])),{},{isVip:function(){var t,e;return(null===(t=this.paymentInfo)||void 0===t?void 0:t.activeState)||(null===(e=this.paymentInfo)||void 0===e?void 0:e.liteActiveState)},getItemGoodsStyle:function(){return{backgroundImage:"url(https://".concat(this.cdnHost,"/static/upload/20241127/ec23c4e7-9957-4159-a99e-36aac1e2016a.webp)")}}}),methods:m(m({},Object(r.b)("payment",["getSubUrlAndThirdType"])),{},{getGoodsList:function(){var t=this;this.loading=!0,Object(d.f)().then((function(e){var n=e.data,o=(n.day,n.calculate),r=(n.paid_coins,n.can_sign,(t.goodsData.data||[]).map((function(t){var e=(o||[]).find((function(e){return(null==e?void 0:e.cp_product_id)===(null==t?void 0:t.cp_product_id)}));return e?Object.assign(t,e||{}):""})).filter((function(t){return!!t})));console.log(r),t.goodsData.data=r,sessionStorage.setItem("computingDialogGoodsInfo",JSON.stringify(r)),t.loading=!1})).catch((function(e){t.loading=!1}))},getPrice:function(t){var e,n;return(null==t||null===(e=t.local_price_web)||void 0===e?void 0:e.currency)+(null==t||null===(n=t.local_price_web)||void 0===n?void 0:n.price)||""},checkGoodsInfo:function(){this.getGoodsList()},open:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.title=t?this.$t(t):this.$t("vipDialogComputedTit"),this.checkGoodsInfo(),this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:this.isVip?"vip_buy_calculate":"not_vip_buy_calculate",behavior_info_sub:"pop_1"}),this.isShowDialog=!0},close:function(){this.isShowDialog=!1},quitPay:function(){this.step="inGoods"},subscriptionNow:function(t){var e=this,n=this.isVip?"vip_buy_calculate":"not_vip_buy_calculate";this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:n,behavior_info_sub:"pop_2"}),this.dotFrom=n,this.subThirdType?(this.defaultThirdType=this.subThirdType,this.goodsId=t,this.step="inPay"):this.getSubUrlAndThirdType().then((function(n){var o;if(1e4===(null==n||null===(o=n.status)||void 0===o?void 0:o.code)){var data=n.data;e.defaultThirdType=null==data?void 0:data.third_type,e.goodsId=t,e.step="inPay"}}))}})},f=v,_=(n(3188),n(0)),component=Object(_.a)(f,(function(){var t,e=this,o=e._self._c;return o("el-dialog",{staticClass:"vip-computing-dialog flex-center",attrs:{visible:e.isShowDialog,"destroy-on-close":!0,"append-to-body":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.isShowDialog=t}}},["inGoods"===e.step?o("div",{staticClass:"goods-content"},[o("div",{staticClass:"close-icon flex-center",on:{click:e.close}},[o("i",{staticClass:"el-icon-close"})]),e._v(" "),o("div",{staticClass:"goods-head"},[o("div",{staticClass:"title"},[e._v(e._s(e.title))]),e._v(" "),o("div",{staticClass:"title-sub words-wrap"},[e._v("\n          "+e._s(e.$t("vipDialogComputedTitSub"))+"\n        ")])]),e._v(" "),o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"goods"},[o("div",{staticClass:"text words-wrap"},[o("i",{staticClass:"iconfont icon-mall-desc"}),e._v("\n          "+e._s(e.$t("credit_recharge_desc")))]),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"goods-all"},[e._l(null===(t=e.goodsData)||void 0===t?void 0:t.data,(function(t){return[o("div",{key:t.id,staticClass:"item-goods item-goods-gray",style:e.getItemGoodsStyle,on:{click:function(n){return e.subscriptionNow(t.cp_product_id)}}},[o("client-only",[[t.give_calculate_coins||null!=t&&t.web_give_ratio?o("div",{staticClass:"discount-spacial"},[e._v("\n                    +"+e._s(null==t?void 0:t.web_give_ratio)+"%\n                  ")]):e._e()]],2),e._v(" "),o("div",{staticClass:"goods-info"},[o("div",{staticClass:"goods-info-top flex-center"},[o("img",{staticClass:"icon",attrs:{src:n(258)("./".concat(t.bgUrl)),alt:"Credit"}}),e._v(" "),o("div",{staticClass:"num-detail flex-center"},[o("span",{staticClass:"num-1"},[e._v(e._s(t.calculate_coins-t.give_calculate_coins))]),e._v(" "),o("span",[e._v("+")]),e._v(" "),o("span",{staticClass:"num-2"},[e._v(e._s(t.give_calculate_coins))])])]),e._v(" "),o("div",{staticClass:"mall-Credit"},[o("span",{staticClass:"words"},[e._v("\n                    "+e._s(t.calculate_coins)+"\n                  ")]),e._v(" "),o("img",{staticClass:"icon",attrs:{src:n(121),alt:"Credit"}})])]),e._v(" "),o("el-button",{staticClass:"purchase-btn",attrs:{loading:t.btnLoad}},[e._v("\n                "+e._s(e.getPrice(t))+"\n              ")])],1)]}))],2)])]):e._e(),e._v(" "),"inPay"===e.step?o("PaymentForm",{attrs:{defaultThirdType:e.defaultThirdType,initMount:!0,upgrade:!1,goodsId:e.goodsId,purchParams:{},isSubscription:!1},on:{"in-pay-back":e.quitPay,"pay-success":function(t){e.isShowDialog=!1,e.step="inGoods"}}},[o("right-part",{attrs:{showBg:!0,showText:!0,showStep:!1,showAvatar:!0}})],1):e._e()],1)}),[],!1,null,"7bea8b3c",null);e.default=component.exports},3346:function(t,e,n){"use strict";n.r(e);n(9),n(7),n(11),n(12),n(8),n(4),n(6);var o=n(2),r=n(1),l=n(339),c=n(138),d=n(137);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={name:"NotVipComputingDialog",provide:function(){return{top:this}},data:function(){return{isShowDialog:!1,isNewUser:!0,step:"inGoods",goodsId:"",defaultThirdType:0,btnLabel:"",dotFrom:"not_vip_calculate"}},components:{UserDaily:l.a,PaymentForm:c.a,RightPart:d.a},mounted:function(){this.$EventBus.$on("showNotVipComputingDialog",this.open)},beforeDestroy:function(){this.$EventBus.$off("showNotVipComputingDialog",this.open)},computed:m({},Object(r.e)("payment",["subThirdType"])),methods:m(m({},Object(r.b)("payment",["getSubUrlAndThirdType"])),{},{open:function(){this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"not_vip_calculate",behavior_info_sub:"pop_1"}),this.isShowDialog=!0},close:function(){this.isShowDialog=!1},quitPay:function(){this.step="inGoods"},subscriptionNow:function(t){var e=this,n=t.goods_id,o=t.btnLabel,r=void 0===o?"":o;this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"not_vip_calculate",behavior_info_sub:"pop_2"}),this.btnLabel=r,this.subThirdType?(this.defaultThirdType=this.subThirdType,this.goodsId=n,this.step="inPay"):this.getSubUrlAndThirdType().then((function(t){var o;if(1e4===(null==t||null===(o=t.status)||void 0===o?void 0:o.code)){var data=t.data;e.defaultThirdType=null==data?void 0:data.third_type,e.goodsId=n,e.step="inPay"}}))}})},f=(n(3189),n(0)),component=Object(f.a)(v,(function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"not-vip-computing-dialog flex-center",attrs:{visible:t.isShowDialog,"destroy-on-close":!0,"append-to-body":!0,"close-on-click-modal":!1},on:{"update:visible":function(e){t.isShowDialog=e}}},["inGoods"===t.step?e("UserDaily",{attrs:{title:"NotVipComputingTitle"},on:{subscriptionNow:t.subscriptionNow}}):t._e(),t._v(" "),"inPay"===t.step?e("PaymentForm",{attrs:{defaultThirdType:t.defaultThirdType,initMount:!0,upgrade:!1,goodsId:t.goodsId,purchParams:{},btnLabel:t.btnLabel},on:{"in-pay-back":t.quitPay,"pay-success":function(e){t.isShowDialog=!1,t.step="inGoods"}}},[e("right-part",{attrs:{showBg:!0,showText:!0,showStep:!1,showAvatar:!0}})],1):t._e()],1)}),[],!1,null,"b254317c",null);e.default=component.exports},3347:function(t,e,n){"use strict";n.r(e);n(32),n(89),n(4),n(29);var o=n(138),r=n(137),l=n(30),c=n(13),d=n(66),h={name:"ActivationDialog",provide:function(){return{top:this}},computed:{yearlyFeeOld:function(){var t,e;return(null===(t=this.goodsInfoCurrent)||void 0===t||null===(t=t.local_price_web)||void 0===t?void 0:t.currency)+(12*(null===(e=this.goodsInfoCurrent)||void 0===e||null===(e=e.local_price_web)||void 0===e?void 0:e.price_old)).toFixed(2)},mounthFeeOld:function(){var t,e;return(null===(t=this.goodsInfoCurrent)||void 0===t||null===(t=t.local_price_web)||void 0===t?void 0:t.currency)+(null===(e=this.goodsInfoCurrent)||void 0===e||null===(e=e.local_price_web)||void 0===e?void 0:e.price_old).toFixed(2)}},data:function(){return{isShowDialog:!1,isShowClose:!1,terms:["ActivationTerms1","ActivationTerms2","ActivationTerms3","ActivationTerms4"],step:"inGoods",goodsId:"sub_yearly1",goodsInfoCurrent:{},unit:"",defaultThirdType:0,showRightPart:!0,dotFrom:"new_user_free_try",popupParam:c.L}},components:{PaymentForm:o.a,RightPart:r.a},mounted:function(){this.$EventBus.$on("showActivationDialog",this.open)},destroyed:function(){this.$EventBus.$off("showActivationDialog",this.open)},watch:{isShowDialog:{handler:function(t){var e=this;t?setTimeout((function(){e.isShowClose=!0}),3e3):this.isShowClose=!1},immediate:!0}},methods:{open:function(){this.isShowDialog=!0,this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"new_user_free_try",behavior_info_sub:"pop_1"}),this.getGoodsData()},getGoodsData:function(){this.updateGoodsData()},updateGoodsData:function(){var t=this;Object(d.l)().then((function(e){var n=e.data,data=void 0===n?{}:n;localStorage.setItem("goodsInfo",JSON.stringify(data)),t.handleYearlySub(data)}))},handleYearlySub:function(t){var e,n=this,o=null==t?void 0:t.year;o&&(this.goodsInfoCurrent=o.find((function(t){return(null==t?void 0:t.id)===n.goodsId})),this.unit=null===(e=this.goodsInfoCurrent)||void 0===e||null===(e=e.local_price_web)||void 0===e?void 0:e.currency,console.log("this.goodsInfoCurrent",this.goodsInfoCurrent))},close:function(){Object(l.f)({type:1}),this.showRightPart?this.isShowDialog=!1:this.$refs.PaymentFormRef.handleBack()},tryNow:function(){this.step="inPay",this.$logEvent("log_actions",{operation:"to_pay_pop_show",behavior_info:"new_user_free_try",behavior_info_sub:"pop_2"})}}},m=(n(3190),n(0)),component=Object(m.a)(h,(function(){var t,e=this,n=e._self._c;return n("el-dialog",{staticClass:"activation-dialog flex-center",attrs:{visible:e.isShowDialog,"destroy-on-close":!0,"append-to-body":!0,"z-index":e.popupParam.activation.z,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.isShowDialog=t}}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowClose,expression:"isShowClose"}],staticClass:"activation-dialog-close flex-center",on:{click:e.close}},[n("i",{staticClass:"el-icon-close"})]),e._v(" "),"inGoods"===e.step?n("div",{staticClass:"left"},[n("div",{staticClass:"left-header"},[n("span",{staticClass:"left-header-free flex-center"},[n("i",{staticClass:"iconfont icon-icon-free"}),e._v(" "),n("span",[e._v(e._s(e.$t("Free")))])]),e._v(" "),n("span",{staticClass:"left-header-try"},[e._v(e._s(e.$t("TryBasic")))])]),e._v(" "),n("div",{staticClass:"left-desc"},e._l(e.terms,(function(t,o){return n("div",{key:"terms_".concat(o),staticClass:"item-terms"},[n("i",{staticClass:"el-icon-check"}),e._v(" "),n("span",[e._v(e._s(e.$t(t)))])])})),0),e._v(" "),null!==(t=e.goodsInfoCurrent)&&void 0!==t&&t.local_price_web?n("div",{staticClass:"left-tips"},[n("div",{staticClass:"item-tip"},[e._v(e._s(e.$t("ActivationTip1")))]),e._v(" "),n("div",{staticClass:"item-tip"},[e._v("\n          "+e._s(e.$t("ActivationTip2",{unitYear:e.yearlyFeeOld,unitMonth:e.mounthFeeOld}))+"\n        ")])]):e._e(),e._v(" "),n("el-button",{staticClass:"left-btn",on:{click:e.tryNow}},[e._v("\n\t\t\t\t"+e._s(e.$t("StartFreeTrial"))+"\n\t\t\t")])],1):e._e(),e._v(" "),"inPay"===e.step?n("PaymentForm",{ref:"PaymentFormRef",attrs:{defaultThirdType:e.defaultThirdType,disabledMethods:[1,10],initMount:!0,upgrade:!1,isFreeTry:!0,showFreeTry:!1,goodsId:e.goodsId,purchParams:{},btnLabel:"StartFreeTrial"},on:{"in-pay-back":function(t){e.step="inGoods"},"in-waiting":function(t){e.showRightPart=!1},"in-form":function(t){e.showRightPart=!0},"pay-success":function(t){e.isShowDialog=!1,e.step="inGoods"}}}):e._e(),e._v(" "),e.showRightPart?n("right-part",{attrs:{currency:e.unit,showBg:!1,showText:!1,showStep:!0,activation:"inGoods"===e.step,showAvatar:"inPay"===e.step}}):e._e()],1)}),[],!1,null,"a1faacaa",null);e.default=component.exports},3348:function(t,e,n){"use strict";n.r(e);n(9),n(7),n(11),n(12),n(4),n(6),n(288),n(44);var o=n(153),r=n.n(o),l=n(2),c=(n(10),n(8),n(18),n(1)),d=n(21),h=n(24),m=n(13);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var f=null,_={name:"GetSpecies",data:function(){return{dialogVisible:!1,getAwardTask:null,hasTaskBtn:!1,debounceGranted:Object(h.debounce)(this.rewardedSlot,500),popupParam:m.L,isNotStrength:!1}},mounted:function(){var t=this;document.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState&&t.hasCanRewardsFn()})),this.hasCanRewardsFn(),this.$EventBus.$on("hasCanRewards",this.hasCanRewardsFn),this.$EventBus.$on("userHasCanRewards",this.userHasCanRewards),this.$EventBus.$on("showRewardsModel",this.showRewardsModel)},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(c.c)("user",["isLoggedIn"])),methods:{hasCanRewardsFn:function(){},userHasCanRewards:function(){},showRewardsModel:function(t){t.call},getZeroTime:function(){return(new Date).getTime()+3e5},initAdVideo:function(){var param={pop1:"/29746187,23160701115/TW_seaart.ai_res_reward_reward",pop2:(f=window.googletag||{cmd:[]}).enums.OutOfPageFormat.REWARDED},t=f.defineOutOfPageSlot(param.pop1,param.pop2).addService(f.pubads());t.setForceSafeFrame(!0),f.pubads().enableAsyncRendering(),f.enableServices(),f.display(t)},rewardedSlot:function(){var t=this,param={from:this.$route.path.includes("incentiveTesk")?"video_task":"video_pop"};Object(d.eb)(param).then((function(e){var n=t.hasTaskBtn?"ClaimSucceess":"getDoubleReward";t.getAwardTask&&t.getAwardTask(),t.$message.success(t.$t(n)),f.destroySlots()})),this.isNotStrength&&this.$logEvent("log_actions",{operation:"finish_watch_award_vedio",behavior_info:"on_low_energy_pop"})},openAdVideo:function(){var t=this,e=r.a.service(),n=this.$route.path.includes("incentiveTesk");this.initAdVideo(),f.cmd.push((function(){var o=f.pubads();o.addEventListener("rewardedSlotReady",(function r(l){o.removeEventListener("rewardedSlotReady",r),l.makeRewardedVisible(),t.$nextTick((function(){e.close()})),t.$logEvent("log_actions",{operation:"daily_award_vedio_play_success",behavior_info:n?"on_task_vedio_page":"on_all_daily_award_page"})})),o.addEventListener("rewardedSlotGranted",(function(e){t.debounceGranted();var n=t.$route.path.includes("incentiveTask");t.$logEvent("log_actions",{operation:"finish_watch_daily_award_vedio",behavior_info:"on_daily_award_pop",behavior_info_sub:n?"task_page":"homepage_pop"})}));o.addEventListener("rewardedSlotClosed",(function t(){o.removeEventListener("rewardedSlotClosed",t),f.destroySlots()}));o.addEventListener("slotRenderEnded",(function r(l){o.removeEventListener("slotRenderEnded",r),l.isEmpty&&t.$nextTick((function(){e.close(),t.$logEvent("log_actions",{operation:"daily_award_vedio_play_fail",behavior_info:n?"on_task_vedio_page":"on_all_daily_award_page"})}))}))}))},doubleRewards:function(){this.dialogVisible=!1;var t={message:this.$t("adloadinHome"),duration:5e3,type:"info"};this.$message(t),this.openAdVideo(),this.$logEvent("log_actions",{operation:"click_double_award",behavior_info:"on_daily_award_pop"}),this.isNotStrength&&this.$logEvent("log_actions",{operation:"click_get_award",behavior_info:"on_low_energy_pop"})},getRewardsOne:function(){this.dialogVisible=!1,this.$message.success(this.$t("ClaimSucceess")),this.$logEvent("log_actions",{operation:"click_get_award",behavior_info:"on_daily_award_pop"})}}},y=_,w=(n(3191),n(0)),component=Object(w.a)(y,(function(){var t=this,e=t._self._c;return e("div",[e("el-dialog",{staticClass:"my-trick-dialog",attrs:{visible:t.dialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,"z-index":t.popupParam.advert.z,top:"0",width:"367px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{staticClass:"title-box flex_c"},[e("span",[t._v(t._s(t.isNotStrength?t.$t("notStrength"):t.$t("dayRewards")))])]),t._v(" "),e("div",{staticClass:"content-box",class:t.isNotStrength&&"not-rewards-con"},[t.isNotStrength?e("div",{staticClass:"look-adstrength"},[t._v("\n        "+t._s(t.$t("lookStrength",{num:100}))+"\n      ")]):t._e(),t._v(" "),t.isNotStrength?e("div",{staticClass:"close-btn flex_c_m",on:{click:function(e){t.dialogVisible=!1}}},[e("i",{staticClass:"iconfont icon-close"})]):t._e(),t._v(" "),e("div",{staticClass:"money-num flex_c_m"},[t._v("X100")]),t._v(" "),e("div",{staticClass:"move-btn flex_c_m",attrs:{id:"watchAdBtn"},on:{click:t.doubleRewards}},[e("i",{staticClass:"iconfont icon-a-icon_AIVideoGuide_selected"}),t._v(" "),e("span",[t._v(t._s(t.isNotStrength?t.$t("claimRewards"):t.$t("doubleRewards")))])]),t._v(" "),t.isNotStrength?t._e():e("div",{staticClass:"claim",on:{click:t.getRewardsOne}},[e("span",[t._v(t._s(t.$t("Claim")))])])])])],1)}),[],!1,null,"7d3e9aba",null);e.default=component.exports},3351:function(t,e,n){"use strict";n.r(e);n(10),n(16),n(36),n(18);var o=n(39),r=n(275),l={name:"PaymentStatusDialog2",data:function(){return{isShowDialog:!1,paymentData:{},defaultOptions:{animationData:r}}},mounted:function(){var t=this;this.$EventBus.$on("openPaymentStatusDialog2",(function(e){var data=e.data;t.isShowDialog=!0,t.paymentData=data}))},beforeDestroy:function(){this.$EventBus.$off("openPaymentStatusDialog2")},computed:{getExpiryTime:function(){return Object(o.h)(this.paymentData.payment_at,"yyyy-MM-dd hh:mm:ss")},getVIPCardName:function(){var t;return this.$t(this.isLite?"vip_lite_card_name":"vip_card_name",{number:null===(t=this.paymentData)||void 0===t||null===(t=t.Product)||void 0===t?void 0:t.day_num})},getSVIPCardName:function(){var t=this;return function(e){var n=e.Product,o=n.level,r=n.type;return"".concat(t.$t(["ToB_beginnerPlan","StandardPlan","ToB_professionalPlan","MasterPlan"][o-1])," /\n\t\t\t\t").concat(t.$t(2===r?"months":"years"))}},getPhotoName:function(){if(this.isPhoto){var t,e=((null==this||null===(t=this.paymentData)||void 0===t||null===(t=t.Product)||void 0===t?void 0:t.cp_product_id)||"").slice(-2);return this.$t("aiAvatarNumber",{num:e})}return""},isLite:function(){var t;return null===(t=this.paymentData)||void 0===t||null===(t=t.Product)||void 0===t||null===(t=t.cp_product_id)||void 0===t?void 0:t.includes("lite")},isPhoto:function(){var t;return null==this||null===(t=this.paymentData)||void 0===t||null===(t=t.Product)||void 0===t?void 0:t.cp_product_id.includes("ai_photo")},getPrice:function(){var t;if(null!==(t=this.paymentData)&&void 0!==t&&null!==(t=t.Product)&&void 0!==t&&t.local_price_web){var e,n,o,r=null===(e=this.paymentData)||void 0===e?void 0:e.Product;return(null==r||null===(n=r.local_price_web)||void 0===n?void 0:n.currency)+(null==r||null===(o=r.local_price_web)||void 0===o?void 0:o.price)}return""}},methods:{close:function(){this.isShowDialog=!1,this.paymentData={}},handleDone:function(){this.isShowDialog=!1}}},c=(n(3194),n(0)),component=Object(c.a)(l,(function(){var t,e=this,o=e._self._c;return o("el-dialog",{staticClass:"payment-status-dialog2",attrs:{top:"calc(50vh - 168px)",width:"416px",visible:e.isShowDialog,"destroy-on-close":!0,"close-on-click-modal":!1,modal:!1},on:{"update:visible":function(t){e.isShowDialog=t},closed:e.close}},[o("div",{staticClass:"container"},[null!==(t=e.paymentData)&&void 0!==t&&t.Product?o("div",{staticClass:"finish"},[o("div",{staticClass:"tip"},[e._v(e._s(e.$t("PaymentSuccessful"))+" !")]),e._v(" "),o("div",{staticClass:"amount"},[e._v("\n\t\t\t\t\t"+e._s(e.getPrice)+"\n\t\t\t\t")]),e._v(" "),o("div",{staticClass:"content"},[o("div",{staticClass:"item-content purchase-detail"},[o("div",{staticClass:"label"},[e._v(e._s(e.$t("PurchaseDetail"))+":")]),e._v(" "),o("div",{staticClass:"detail"},[5===e.paymentData.Product.type?o("div",{staticClass:"vipcard detail-div"},[e._v("\n\t\t\t\t\t\t\t\t"+e._s(e.getVIPCardName)+"\n\t\t\t\t\t\t\t\t"),o("img",{staticClass:"icon",attrs:{src:n(478),alt:"vip icon"}})]):[2,3].includes(e.paymentData.Product.type)?o("div",{staticClass:"words"},[e._v("\n\t\t\t\t\t\t\t\t"+e._s(e.getSVIPCardName(e.paymentData))+"\n\t\t\t\t\t\t\t")]):e.isPhoto?o("div",{staticClass:"photo"},[e._v("\n                "+e._s(e.getPhotoName)+"\n              ")]):o("div",{staticClass:"credits detail-div"},[e._v("\n\t\t\t\t\t\t\t\t"+e._s(e.paymentData.Product.calculate_coins)+"\n\t\t\t\t\t\t\t\t"),o("img",{staticClass:"icon",attrs:{src:n(121),alt:"credits icon"}})])])]),e._v(" "),o("div",{staticClass:"item-content order-number"},[o("div",{staticClass:"label"},[e._v(e._s(e.$t("OrderNumber"))+":")]),e._v(" "),o("div",{staticClass:"detail"},[e._v("\n\t\t\t\t\t\t\t"+e._s(e.paymentData.order_no)+"\n\t\t\t\t\t\t")])]),e._v(" "),o("div",{staticClass:"item-content payment-time"},[o("div",{staticClass:"label"},[e._v(e._s(e.$t("PaymentTime"))+":")]),e._v(" "),o("div",{staticClass:"detail"},[e._v("\n\t\t\t\t\t\t\t"+e._s(e.getExpiryTime)+"\n\t\t\t\t\t\t")])])]),e._v(" "),o("el-button",{staticClass:"done-btn",on:{click:e.handleDone}},[e._v("\n\t\t\t\t\t"+e._s(e.$t("Done"))+"\n\t\t\t\t")])],1):e._e()])])}),[],!1,null,null,null);e.default=component.exports},339:function(t,e,n){"use strict";n(89),n(9),n(11),n(12),n(8),n(6);var o=n(2),r=(n(7),n(32),n(19),n(4),n(1)),l=(n(16),n(492)),c=n(1924);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m={name:"RightsComponent",props:{selectedLevel:{type:String,default:"basic"}},components:{CTooltip:c.a},data:function(){return{rightsTitleArr:l.c,basicRights:l.a,standardRights:l.d,professionalRights:l.b,isBottom:!1}},mounted:function(){},computed:h(h({},Object(r.e)("user",["cdnHost"])),{},{getBgUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20240425/18511a73-81df-4971-8ee9-328fb99b14ab.webp")},getArrowClasses:function(){return{reverse:this.isBottom,basic:"basic"===this.selectedLevel,standard:"standard"===this.selectedLevel,professional:"professional"===this.selectedLevel}},handleLabel:function(){var t=this;return function(label,e,n){var o=label;return 0==e&&(o="".concat(o,"/").concat(t.$t("Day"))),7==e&&(o="".concat(o).concat(t.$t("Day")),"professional"==n&&(o=t.$t("NeverExpires"))),o}}}),methods:{handleClose:function(){this.top.close()},scrollWatch:function(){var t=this.$refs.contents,e=t.scrollHeight-t.scrollTop===t.clientHeight;this.isBottom=e},arrowClick:function(){var t=this.$refs.contents;if(this.isBottom)t.scrollTo({top:0,behavior:"smooth"});else{var e=t.scrollHeight-t.clientHeight;t.scrollTo({top:e,behavior:"smooth"})}}}},v=(n(3179),n(0)),f=Object(v.a)(m,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"rights-components"},[e("img",{staticClass:"rights-components-bg",attrs:{src:t.getBgUrl,alt:"bg"}}),t._v(" "),e("div",{ref:"contents",staticClass:"rights-components-contents",class:t.selectedLevel,on:{scroll:t.scrollWatch}},[e("div",{staticClass:"rights-desc"},[e("div",{staticClass:"label"},[t._v(t._s(t.$t("Feature")))]),t._v(" "),t._l(t.rightsTitleArr,(function(n,i){return e("div",{key:"right_".concat(i),staticClass:"value"},[e("span",[t._v(t._s(t.$t(n.label)))]),t._v(" "),null!=n&&n.tip?e("CTooltip",{staticStyle:{"margin-left":"5px"},attrs:{font:16,content:n.tip}}):t._e()],1)}))],2),t._v(" "),e("div",{staticClass:"basic-version"},[e("div",{staticClass:"label"},[t._v(t._s(t.$t("ToB_beginnerPlan")))]),t._v(" "),t._l(t.basicRights,(function(n,i){return e("div",{key:"right_".concat(i),staticClass:"value"},["boolean"==typeof n.label?e("span",{staticClass:"icon"},[e("i",{class:n.label?"el-icon-check":"el-icon-close"})]):e("span",[t._v(t._s(t.handleLabel(n.label,i,"basic")))])])}))],2),t._v(" "),e("div",{staticClass:"standard-version"},[e("div",{staticClass:"label"},[t._v(t._s(t.$t("StandardPlan")))]),t._v(" "),t._l(t.standardRights,(function(n,i){return e("div",{key:"right_".concat(i),staticClass:"value"},["boolean"==typeof n.label?e("span",{staticClass:"icon"},[e("i",{class:n.label?"el-icon-check":"el-icon-close"})]):e("span",[t._v(t._s(t.handleLabel(n.label,i,"standard")))])])}))],2),t._v(" "),e("div",{staticClass:"professional-version"},[e("div",{staticClass:"label"},[t._v(t._s(t.$t("ToB_professionalPlan")))]),t._v(" "),t._l(t.professionalRights,(function(n,i){return e("div",{key:"right_".concat(i),staticClass:"value"},["boolean"==typeof n.label?e("span",{staticClass:"icon"},[e("i",{class:n.label?"el-icon-check":"el-icon-close"})]):e("span",[t._v(t._s(t.handleLabel(n.label,i,"professional")))])])}))],2)]),t._v(" "),e("i",{staticClass:"iconfont icon-icon-arrows-under",class:t.getArrowClasses,on:{click:t.arrowClick}})])}),[],!1,null,"1807ebc3",null).exports,_=n(66);function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C={name:"UserDaily",inject:["top"],props:{title:{type:String,default:""},isNewUser:{type:Boolean,default:!0},defaultSelected:{type:String,default:""}},components:{RightsComponent:f},data:function(){return{activeTab:"yearly",selectedLevel:"basic",levelArr:[],apiMonetaryUnit:""}},mounted:function(){this.getGoodsData()},computed:w(w(w({},Object(r.e)("user",["cdnHost"])),Object(r.e)("payment",["paymentInfo"])),{},{getBg:function(){return{backgroundImage:"url(https://".concat(this.cdnHost,"/static/upload/20241123/3294f806-3035-48e7-8317-b151096b09af.webp)")}},getDiscount:function(){var t="save20",e=this.levelArr.filter((function(i){return"black_sale"==(null==i?void 0:i.activity)}));return null!=e&&e.length&&(t="save50"),this.$t(t)},isMonthly:function(){return"monthly"===this.activeTab},isYearly:function(){return"yearly"===this.activeTab},getGif:function(){return"https://".concat(this.cdnHost,"/static/upload/20240428/45f27cdd-f248-4681-a3d0-e8d9e17b91d5.gif")},getLabel:function(){var t=this;return function(e){return t.$t({basic:"ToB_beginnerPlan",standard:"StandardPlan",professional:"ToB_professionalPlan"}[e])}},isProfessional:function(){return"professional"==this.selectedLevel},isFreeTry:function(){var t,e=this,n=this.levelArr.find((function(i){return i.label==e.selectedLevel}));return this.isYearly&&this.isNewUser&&!this.isProfessional&&!(null!==(t=this.paymentInfo)&&void 0!==t&&t.svipExpiryTime)&&!("black_sale"===(null==n?void 0:n.activity)&&this.isYearly)},getBtnLabel:function(){var t=this,label="SubscribeNow";this.isYearly&&(label="Upgrade20off"),this.isFreeTry&&!this.title&&(label="StartFreeTrial");var e=this.levelArr.find((function(i){return i.label==t.selectedLevel}));return"black_sale"===(null==e?void 0:e.activity)&&this.isYearly&&(label="Upgrade50off"),this.$t(label)},getMarginTop:function(){return{marginTop:this.isNewUser?"33px":"52px"}}}),watch:{defaultSelected:{handler:function(t){t&&(this.selectedLevel=t)},immediate:!0}},methods:{handleClose:function(){this.top.close(),"NotVipComputingTitle"===this.title&&this.$EventBus.$emit("userHasCanRewards")},getGoodsData:function(){this.updateGoodsData()},updateGoodsData:function(){var t=this;Object(_.l)().then((function(e){var n=e.data,data=void 0===n?{}:n;localStorage.setItem("goodsInfo",JSON.stringify(data)),t.handleData(data)}))},handleData:function(data){var t=this,e=data||{},n=e.month,o=void 0===n?[]:n,r=e.year,l=(void 0===r?[]:r).map((function(t,e){return w(w({},t),{},{monthly_id:o[e].id,original_price:o[e].price,original_price_cn:o[e].price_cn})}));l.pop(),this.levelArr=l.map((function(e){var n=e.id,o=e.monthly_id,r=e.price_month,l=e.original_price,c=e.price_month_cn,d=e.original_price_cn,h=e.price,m=e.price_cn,v=e.local_price_web,f=e.activity;return t.apiMonetaryUnit||(t.apiMonetaryUnit=null==v?void 0:v.currency),{activity:f,label:{sub_yearly1:"basic",sub_yearly2:"standard",sub_yearly3:"professional"}[n],monthly_id:o,yearly_id:n,original_m_p_en:l,now_m_p_en:r,original_m_p_zh:d,now_m_p_zh:c,now_total_price_en:h,now_total_price_cn:m,now_m_p:null==v?void 0:v.price,original_m_p:null==v?void 0:v.price_old,monetaryUnit:null==v?void 0:v.currency}}))},changeMethods:function(t){this.activeTab=t},toMall:function(){window.open(this.localePath("/mall"),"_blank")},subscriptionNow:function(){var t=this,e=this.levelArr.find((function(i){return i.label==t.selectedLevel}))||{},n=e.monthly_id,o=void 0===n?"":n,r=e.yearly_id,l=void 0===r?"":r;this.$emit("subscriptionNow",{goods_id:this.isMonthly?o:l,useFree:this.isFreeTry,btnLabel:this.getBtnLabel})}}},k=(n(3180),Object(v.a)(C,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"user-daily"},[n("div",{staticClass:"user-daily-close flex-center",on:{click:e.handleClose}},[n("i",{staticClass:"el-icon-close"})]),e._v(" "),n("div",{staticClass:"left",class:e.selectedLevel},[n("div",{staticClass:"left-title"},[e._v("\n\t\t\t"+e._s(e.$t(e.title?e.title:!e.isNewUser||null!==(t=e.paymentInfo)&&void 0!==t&&t.svipExpiryTime?"old_daily_title":"new_daily_title"))+"\n\t\t")]),e._v(" "),n("div",{staticClass:"left-methods"},[n("div",{staticClass:"left-methods-monthly",class:{active:e.isMonthly},on:{click:function(t){return e.changeMethods("monthly")}}},[e._v("\n\t\t\t\t"+e._s(e.$t("PayMonthly"))+"\n\t\t\t")]),e._v(" "),n("div",{staticClass:"left-methods-yearly",class:{active:e.isYearly},on:{click:function(t){return e.changeMethods("yearly")}}},[e._v("\n\t\t\t\t"+e._s(e.$t("PayYearly"))+"\n\t\t\t\t"),n("img",{directives:[{name:"show",rawName:"v-show",value:e.isMonthly,expression:"isMonthly"}],staticClass:"icon",attrs:{src:e.getGif,alt:"icon"}}),e._v(" "),n("span",{staticClass:"discount"},[e._v("\n\t\t\t\t\t"+e._s(e.getDiscount)+"\n\t\t\t\t")])])]),e._v(" "),n("div",{staticClass:"left-level"},e._l(e.levelArr,(function(t){return n("div",{key:t.label,staticClass:"item-level",class:{active:e.selectedLevel==t.label},on:{click:function(n){e.selectedLevel=t.label}}},["black_sale"==(null==t?void 0:t.activity)&&e.isYearly?n("div",{staticClass:"black-friday-discount flex-center",style:e.getBg},[e._v("50% OFF")]):e._e(),e._v(" "),n("div",{staticClass:"item-level-label"},[e._v("\n\t\t\t\t\t"+e._s(e.getLabel(t.label))+"\n\t\t\t\t")]),e._v(" "),e.isMonthly?n("div",{staticClass:"item-level-price item-level-monthly"},[n("span",{staticClass:"sign"},[e._v("\n\t\t\t\t\t\t"+e._s(null==t?void 0:t.monetaryUnit)+"\n\t\t\t\t\t")]),e._v(" "),n("span",{staticClass:"price"},[e._v("\n\t\t\t\t\t\t"+e._s(t.original_m_p)+"\n\t\t\t\t\t")]),e._v(" "),n("span",[e._v("/")]),e._v(" "),n("span",{staticClass:"type"},[e._v("\n\t\t\t\t\t\t"+e._s(e.$t("Month"))+"\n\t\t\t\t\t")])]):n("div",{staticClass:"item-level-price item-level-yearly"},[n("div",{staticClass:"top"},[n("span",{staticClass:"sign"},[e._v("\n\t\t\t\t\t\t\t"+e._s(null==t?void 0:t.monetaryUnit)+"\n\t\t\t\t\t\t")]),e._v(" "),n("span",{staticClass:"price"},[e._v("\n\t\t\t\t\t\t\t"+e._s(t.now_m_p)+"\n\t\t\t\t\t\t")]),e._v(" "),n("span",[e._v("/")]),e._v(" "),n("span",{staticClass:"type"},[e._v("\n\t\t\t\t\t\t\t"+e._s(e.$t("Month"))+"\n\t\t\t\t\t\t")])]),e._v(" "),n("div",{staticClass:"bottom"},[n("div",{staticClass:"now-price"},[n("span",{staticClass:"sign"},[e._v("\n\t\t\t\t\t\t\t\t"+e._s(null==t?void 0:t.monetaryUnit)+"\n\t\t\t\t\t\t\t")]),e._v(" "),n("span",{staticClass:"price"},[e._v("\n\t\t\t\t\t\t\t\t"+e._s((12*t.now_m_p).toFixed(2))+"\n\t\t\t\t\t\t\t")]),e._v(" "),n("span",[e._v("/")]),e._v(" "),n("span",{staticClass:"type"},[e._v("\n\t\t\t\t\t\t\t\t"+e._s(e.$t("year"))+"\n\t\t\t\t\t\t\t")])]),e._v(" "),n("div",{staticClass:"original-price"},[n("span",{staticClass:"sign"},[e._v("\n\t\t\t\t\t\t\t\t"+e._s(null==t?void 0:t.monetaryUnit)+"\n\t\t\t\t\t\t\t")]),e._v(" "),n("span",{staticClass:"price"},[e._v("\n\t\t\t\t\t\t\t\t"+e._s((12*t.original_m_p).toFixed(2))+"\n\t\t\t\t\t\t\t")]),e._v(" "),n("span",[e._v("/")]),e._v(" "),n("span",{staticClass:"type"},[e._v("\n\t\t\t\t\t\t\t\t"+e._s(e.$t("year"))+"\n\t\t\t\t\t\t\t")])])])])])})),0),e._v(" "),n("div",{staticClass:"left-more",style:e.getMarginTop,on:{click:e.toMall}},[e._v("\n\t\t\t"+e._s(e.$t("viewMore"))+"\n\t\t\t"),n("i",{staticClass:"el-icon-arrow-right"})]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isFreeTry&&!e.title,expression:"isFreeTry && !title"}],staticClass:"left-pay"},[n("div",{staticClass:"left-pay-desc"},[n("div",{staticClass:"left-pay-desc-top"},[n("span",[e._v(e._s(e.$t("PayableToday")))]),e._v(" "),n("span",[e._v("("+e._s(e.$t("ThreeDayTrial"))+")")])]),e._v(" "),n("div",{staticClass:"left-pay-desc-bottom"},[e._v(e._s(e.$t("UCanCancleTrial")))])]),e._v(" "),n("span",{staticClass:"left-pay-amount"},[e._v(e._s(e.apiMonetaryUnit)+"0")])]),e._v(" "),n("el-button",{staticClass:"left-btn",style:e.getMarginTop,on:{click:e.subscriptionNow}},[e._v("\n\t\t\t"+e._s(e.getBtnLabel)+"\n\t\t")])],1),e._v(" "),n("div",{staticClass:"right"},[n("RightsComponent",{attrs:{selectedLevel:e.selectedLevel}})],1)])}),[],!1,null,"e6a58c3a",null));e.a=k.exports},342:function(t,e,n){"use strict";n(9),n(11),n(12),n(8);var o=n(2),r=(n(7),n(10),n(19),n(36),n(43),n(14),n(28),n(89),n(4),n(6),n(29),n(216));function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var d={props:["value","createId","modelType","disabled"],components:{modelExistDialog:n(266).a},data:function(){return{uploadStatusIcon:{init:"",pending:"el-icon-loading",complete:"el-icon-circle-check",fail:"el-icon-refresh-left",error:"el-icon-close"},uploadingStatus:"init",uploadConfig:"",fileChunk:[],worker:null,progress:0,errNum:3,waitUploadIndex:[],existObj:{name:"",url:"",open:!1}}},computed:{isDisabled:function(){return"pending"===this.uploadingStatus||this.disabled}},methods:{startUpload:function(t){var e=this,n=t.size,o=t.name;if(!this.isDisabled)if(this.validFileSize(n)){var l=1===this.modelType?"Model":"LORA";this.$message.warning(this.$t(l+"FileSizeError"))}else{var d={file_size:n,file_name:o,content_type:"application/octet-stream",category:1,model_type:this.modelType,create_id:this.createId};this.uploadingStatus="pending",Object(r.c)(d).then((function(r){e.uploadConfig=c(c({},r.data),{},{file_size:n,file_name:o}),e.cutFile(t,r.data.chunk_size,e.uploadConfig.presigned.length)}))}},cutFile:function(t,e,n){var o=this;this.worker=this.$worker.run((function(t,e,n){for(var o=[],r=0;r<t.size;)0===--n&&(e=t.size-r),o.push({file:t.slice(r,r+e)}),r+=e;return o.map((function(t,e){return{uploadStatus:!1,file:t,index:e,progress:0}}))}),[t,e,n]).then((function(t){o.fileChunk=t,o.$set(o,"fileChunk",t),o.uploadFile()}))},uploadFile:function(){console.log("开始上传~， 文件块总数："+this.fileChunk.length,this.fileChunk),this.waitUploadIndex=this.getWaitUplaodChunkIndex(),this.uploadChunk()},reduceQueue:function(){this.waitUploadIndex.splice(0,1),this.uploadChunk()},uploadChunk:function(){var t=this;if(0!=this.waitUploadIndex.length){var e=this.waitUploadIndex[0],n=this.fileChunk[e],o=this.uploadConfig.presigned,r=new XMLHttpRequest;r.open("PUT",o[e]),r.setRequestHeader("Content-Type","application/octet-stream"),r.onerror=function(e){if(t.errNum--,console.log("上传失败error：",e,"失败重试次数："+t.errNum),t.errNum<0)return t.uploadingStatus="fail",void console.log("this.uploadingStatus: "+t.uploadingStatus);setTimeout((function(){t.uploadChunk()}),3e3)},r.upload.onprogress=function(e){var n=e.loaded,o=e.total,r=Math.floor(n/o*1e4),l=t.fileChunk.length,c=Math.floor(1/l*1e4);t.updateProgress(c*r/1e4)},r.onreadystatechange=function(){if(4===r.readyState&&200===r.status){if(t.errNum=3,!t.fileChunk[e])return;t.fileChunk[e].uploadStatus=!0,t.reduceQueue()}else 4===r.readyState&&200!==r.status&&0===t.errNum&&t.$message.error(t.$t("uploadError"))},r.send(n.file.file)}else this.chunkUploadCheck()},updateProgress:function(t){var e=this.fileChunk.filter((function(t){return t.uploadStatus})).length,n=this.fileChunk.length;if(n){var o=parseFloat((e/n*1e4).toFixed(2));o+=t,this.progress=parseFloat((o/100).toFixed(2))}},chunkUploadCheck:function(){var t=this,e=this.uploadConfig.file_id;console.log("开始校验"),Object(r.a)({create_id:this.createId,file_id:e}).then((function(e){if(e.data.model_id){var n=e.data,o=n.model_id,r=n.model_name,l=void 0===r?"Model":r,c=n.model_status,d=void 0===c?2:c;t.existObj.url="".concat(window.location.origin,"/")+"models/detail/"+o,t.existObj.name=l,t.existObj.open=1===d,t.$refs.modelExist.modelExistDialog=!0}var h=e.data.unconfirmed;h.length?(h.forEach((function(e){t.fileChunk[Number(e)-1].progress=0,t.fileChunk[Number(e)-1].uploadStatus=!1})),t.waitUploadIndex=h.map((function(t){return Number(t)})),t.uploadingStatus="pending",t.uploadFile()):(t.progress=100,t.uploadingStatus="complete",console.log(t.uploadConfig),t.$emit("input",t.uploadConfig.file_id+"/"+t.uploadConfig.file_size))})).catch((function(e){t.uploadingStatus="error"}))},getWaitUplaodChunkIndex:function(){return this.fileChunk.filter((function(t){return!t.uploadStatus})).map((function(t){return t.index}))},curstomUpload:function(t){this.startUpload(t.file)},refresh:function(){["fail","error"].includes(this.uploadingStatus)&&("error"!==this.uploadingStatus?(this.uploadingStatus="pending",this.errNum=3,this.uploadChunk()):this.clear())},clear:function(){this.errNum=3,this.fileChunk=[],this.uploadConfig="",this.waitUploadIndex=[],this.progress=0,this.uploadingStatus="init"},validFileSize:function(t){var e=parseFloat((t/1e9).toFixed(2));return console.log(e),1===this.modelType?e<1:e>1}}},h=(n(2433),n(0)),component=Object(h.a)(d,(function(){var t=this,e=t._self._c;return e("div",[e("el-upload",{staticClass:"upload-file-item",attrs:{action:"/","http-request":t.curstomUpload,"show-file-list":!1,disabled:t.isDisabled,accept:".ckpt,.safetensors"}},[e("div",{staticClass:"upload-btn"},[e("div",[e("i",{staticClass:"el-icon-upload2"}),t._v(" "),e("span",{staticClass:"file-name"},[t._v(t._s(t.uploadConfig?t.uploadConfig.file_name:t.value?t.value:t.$t("PickFile")))])]),t._v(" "),e("i",{class:t.uploadStatusIcon[t.uploadingStatus],on:{click:t.refresh}})]),t._v(" "),e("el-progress",{directives:[{name:"show",rawName:"v-show",value:t.uploadConfig,expression:"uploadConfig"}],attrs:{percentage:t.progress,color:"#0d9488"}})],1),t._v(" "),e("modelExistDialog",{ref:"modelExist",attrs:{existObj:t.existObj}})],1)}),[],!1,null,"67644d98",null);e.a=component.exports},359:function(t,e,n){"use strict";n(9),n(7),n(11),n(12),n(8),n(6);var o=n(3),r=n(2),l=(n(20),n(10),n(4),n(18),n(1)),c=n(179),d=n(209),h=n(281);n(45),n(78);function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f={name:"videoField",inject:["top"],props:{itemData:{type:Object,default:function(){return{}}}},components:{CollapseComponent:c.a,pickWorkModal:d.a},data:function(){return{uploading:!1,accept:"video/mp4"}},computed:v(v({},Object(l.c)("user",["isLoggedIn"])),{},{idsObj:function(){var t=this.itemData;return{field:t.field,node_id:t.node_id,node_type:t.node_type}}}),mounted:function(){},beforeDestroy:function(){},methods:{handleBeforeUpload:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(["video/mp4"].includes(t.type)){n.next=4;break}return e.$message.error(e.$t("OnlySupportVideo")),n.abrupt("return");case 4:if(!(t.size/1024/1024>100)){n.next=8;break}return e.$message.error(e.$t("UploadImageExceedCustomMB",{number:100})),n.abrupt("return");case 8:return n.next=10,e.handleUploadVideo(t);case 10:case"end":return n.stop()}}),n)})))()},handleUploadVideo:function(t){var e=this;return this.uploading=!0,new h.a({file:t,category:20,maxSize:104857600}).beforeUpload().then((function(t){var n=t.url,o=void 0===n?"":n;e.top.changeVal(v(v({},e.idsObj),{},{val:o})),e.uploading=!1})).catch((function(t){e.uploading=!1})).finally((function(){e.uploading=!1}))},handleDelete:function(){this.top.changeVal(v(v({},this.idsObj),{},{val:""}))}}},_=(n(2367),n(0)),component=Object(_.a)(f,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"video-field"},[n("CollapseComponent",{attrs:{title:e.itemData.title}},[e.itemData.val?n("div",{staticClass:"video-field-display"},[n("video",{ref:"mainVideo",staticClass:"video width-height-hundred",attrs:{autoplay:"",muted:"",loop:"",src:null===(t=e.itemData)||void 0===t?void 0:t.val},domProps:{muted:!0}}),e._v(" "),n("i",{staticClass:"iconfont delete-icon icon-shanchu",on:{click:e.handleDelete}})]):n("div",{staticClass:"video-field-upload-box"},[n("el-upload",{attrs:{action:"#","before-upload":e.handleBeforeUpload,"show-file-list":!1,accept:e.accept,"http-request":function(){}}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.uploading,expression:"uploading"}],staticClass:"uploader"},[n("i",{staticClass:"el-icon-plus"})])])],1)])],1)}),[],!1,null,"5c0ac578",null);e.a=component.exports},489:function(t,e,n){"use strict";(function(t){var o=n(3),r=(n(665),n(44),n(422)),l=n.n(r),c=(n(666),n(423)),d=n.n(c),h=(n(10),n(4),n(20),n(94)),m=n.n(h);e.a={name:"workflowVersionInfoModal",components:{ElCollapse:d.a,ElCollapseItem:l.a},data:function(){return{visible:!1,loading:!1,retryCount:0,templateData:"",activeNames:""}},methods:{openModal:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.visible=!0,null===(o=t)||void 0===o){n.next=7;break}return e.loading=!0,l=(null===(r=window.workflowConfig)||void 0===r?void 0:r.package_node_url)||"",n.next=6,e.loadJsonFile(l);case 6:e.loading=!1;case 7:case"end":return n.stop()}}),n)})))()},openFeedBack:function(){try{window.open("https://aihelp.net/questionnaire/#/?formId=c747d6af4c8c4e2b9e74d9bf606ac48f","_blank")}catch(t){}},loadJsonFile:function(){var t=arguments,e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var r,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!["",null,void 0].includes(r=t.length>0&&void 0!==t[0]?t[0]:"")){n.next=4;break}return e.loading=!1,n.abrupt("return");case 4:return n.next=6,m.a.getItem(r);case 6:if(!(l=n.sent)){n.next=11;break}return e.templateData=l||[],e.loading=!1,n.abrupt("return");case 11:return n.abrupt("return",fetch(r).then((function(t){return t.ok||e.$message.error(e.$t("ServerError")),t.json()})).then(function(){var t=Object(o.a)(regeneratorRuntime.mark((function t(data){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.templateData=data||[],!e.templateData){t.next=4;break}return t.next=4,m.a.setItem(r,e.templateData);case 4:e.loading=!1;case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){0===e.retryCount?(e.loadJsonFile(r),e.retryCount++):e.$message.error(e.$t("ServerError"))})));case 12:case"end":return n.stop()}}),n)})))()},handleClose:function(){this.visible=!1},handleChange:function(){}}}}).call(this,n(195))},501:function(t,e,n){"use strict";n(9),n(7),n(11),n(12),n(6);var o=n(3),r=n(2),l=(n(20),n(32),n(19),n(14),n(28),n(8),n(4),n(29),n(1)),c=n(109),d=(n(10),n(89),n(49),n(18),n(179));function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={inject:["top"],props:{itemData:{type:Object,default:function(){}}},components:{CollapseComponent:d.a},data:function(){return{}},mounted:function(){},computed:{idsObj:function(){var t=this.itemData;return{field:t.field,node_id:t.node_id,node_type:t.node_type}},getClass:function(){return{"input-field":!0,"number-input":1!=this.itemData.value_type}}},methods:{changeValue:function(t){this.top.changeVal(m(m({},this.idsObj),{},{val:t}))},getDecimalCount:function(t){var e=t.toString();return e.includes(".")?e.split(".")[1].length:0},formatStepPrecision:function(t,e){var n=Math.pow(10,t-1);return Number((Math.ceil(e*n)/n).toFixed(t))}},render:function(){var t=arguments[0],e=this.itemData,n=e.value_type,o=e.option||{},r=o.step,l=void 0===r?.1:r,c=o.min,h=void 0===c?0:c,m=o.max,v=void 0===m?100:m,f=o.accuracy,_=void 0===f?.1:f;_<this.getDecimalCount(l)&&(l=this.formatStepPrecision(_,l)),0!=_&&0!=l||(l=1);var y=t(d.a,{attrs:{title:this.itemData.title}},[t("el-input",{attrs:{placeholder:"",type:"textarea",resize:"none",value:this.itemData.val},on:{input:this.changeValue}})]),w=t("div",{class:"number-input-box width-height-hundred"},[t("div",{class:"number-input-title"},[this.itemData.title]),t("el-input-number",{attrs:{size:"small",step:l,precision:_,min:h,max:v,value:this.itemData.val},on:{change:this.changeValue}})]);return t("div",{class:this.getClass},[1==n?y:w])}},f=v,_=(n(2352),n(0)),y=Object(_.a)(f,undefined,undefined,!1,null,"b67fda34",null).exports,w=n(38),C=n(209),k=n(45);function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var $={inject:["top"],props:{itemData:{type:Object,default:function(){}}},components:{CollapseComponent:d.a,pickWorkModal:C.a},data:function(){return{uploading:!1}},computed:O(O({},Object(l.c)("user",["isLoggedIn"])),{},{idsObj:function(){var t=this.itemData;return{field:t.field,node_id:t.node_id,node_type:t.node_type}},enableMaskEdit:function(){var t=(this.itemData||{}).option,option=void 0===t?{}:t;return null==option?void 0:option.is_mask_draw}}),mounted:function(){var t=this;this.$EventBus.$on("workflowAppDetailModalConfirm",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})||{},o=n.field,r=void 0===o?"":o,l=n.node_id,c=void 0===l?"":l,d=n.node_type,h=void 0===d?"":d,m=r&&r===t.idsObj.field,v=c&&c===t.idsObj.node_id,f=h&&h===t.idsObj.node_type;m&&v&&f&&t.top.changeVal(O(O({},t.idsObj),{},{val:e}))}))},beforeDestroy:function(){this.$EventBus.$off("workflowAppDetailModalConfirm")},methods:{openGenerateModal:function(){this.enableMaskEdit&&(this.$logEvent("log_actions",{operation:"click_edit_mask",behavior_info:"on_app_detail_page"}),this.$EventBus.$emit("openWorkflowAppDetailModal",this.itemData.val,this.itemData))},openPickWorkModal:function(){this.isLoggedIn?(this.$logEvent("log_actions",{operation:"click_choose_personal_work",behavior_info:"on_app_detail_page"}),this.$refs.pickWorkModal.openModal([])):this.$EventBus.$emit("openLoginDialog")},handlePickImage:function(t){t.type;var e=t.url,n=void 0===e?"":e;t.width,t.height;this.top.changeVal(O(O({},this.idsObj),{},{val:n}))},handleBeforeUpload:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(["image/jpeg","image/png","image/jpg","image/webp"].includes(t.type)){n.next=4;break}return e.$message.error(e.$t("AllowImageFiles")),n.abrupt("return");case 4:if(!(t.size/1024/1024>10)){n.next=14;break}return n.prev=5,n.next=8,Object(k.a)(t,10485760);case 8:t=n.sent,n.next=14;break;case 11:return n.prev=11,n.t0=n.catch(5),n.abrupt("return",!1);case 14:e.handleUploadImage(t);case 15:case"end":return n.stop()}}),n,null,[[5,11]])})))()},handleUploadImage:function(t){var e=this;this.uploading=!0,new w.a({type:20}).startUpload(t,{category:20}).then((function(t){e.top.changeVal(O(O({},e.idsObj),{},{val:t})),e.uploading=!1})).catch((function(t){e.uploading=!1}))},handleDelete:function(){this.top.changeVal(O(O({},this.idsObj),{},{val:""}))}}},D=$,S=(n(2357),Object(_.a)(D,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"image-field"},[e("CollapseComponent",{attrs:{title:t.itemData.title}},[t.itemData.val?e("div",{staticClass:"image-field-display"},[e("img",{staticClass:"img width-height-hundred",class:[t.enableMaskEdit&&"cursor-pointer"],attrs:{src:t.itemData.val,alt:"image"},on:{click:function(e){return e.stopPropagation(),t.openGenerateModal.apply(null,arguments)}}}),t._v(" "),e("i",{staticClass:"iconfont delete-icon icon-shanchu",on:{click:t.handleDelete}}),t._v(" "),t.enableMaskEdit?e("span",{staticClass:"edit-mask-btn",on:{click:function(e){return e.stopPropagation(),t.openGenerateModal.apply(null,arguments)}}},[t._v("Edit Mask")]):t._e()]):e("div",{staticClass:"image-field-upload-box"},[e("el-upload",{attrs:{action:"#","before-upload":t.handleBeforeUpload,"show-file-list":!1,"http-request":function(){}}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.uploading,expression:"uploading"}],staticClass:"uploader"},[e("i",{staticClass:"el-icon-plus"})])]),t._v(" "),e("div",{staticClass:"el-upload pick-item",on:{click:function(e){return e.stopPropagation(),t.openPickWorkModal()}}},[e("div",{staticClass:"upload-item-text"},[t._v(t._s(t.$t("CreativeCenterPopup21")))])]),t._v(" "),e("pick-work-modal",{ref:"pickWorkModal",attrs:{type:"workFlowAppDetail"},on:{confirm:t.handlePickImage}})],1)])],1)}),[],!1,null,"2df03996",null)),I=S.exports,T=(n(16),n(210)),j=n(5);function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var M={inject:["top"],props:{itemData:{type:Object,default:function(){}}},components:{CollapseComponent:d.a,WorkflowStyleModal:T.a},data:function(){return{displayData:{name:"",url:"",version_name:""}}},watch:{itemData:{handler:function(t){var e,n=(t||{}).art_model;n&&(this.displayData.name=null==n?void 0:n.name,this.displayData.url=null==n||null===(e=n.banner)||void 0===e?void 0:e.url,this.displayData.version_name=null==n?void 0:n.version_name)},deep:!0}},computed:{idsObj:function(){var t=this.itemData;return{field:t.field,node_id:t.node_id,node_type:t.node_type}}},methods:{changeUrl:function(t){return Object(j.x)(t,"high")},openModelSelect:function(){this.$refs.workflowStyleModal.openModal({modelType:"Checkpoint"})},handleSelectModel:function(t){var e=t.info||{},n=e.id,o=void 0===n?"":n,r=e.name,l=void 0===r?"":r,c=e.model_ver_no,d=void 0===c?"":c,h=e.version_name,m=void 0===h?"":h,v=e.banner,f=void 0===v?{}:v,_="".concat(o,"@").concat(d);this.displayData={name:l,url:(null==f?void 0:f.url)||"",version_name:m},this.top.changeVal(P(P({},this.idsObj),{},{val:_})),this.$refs.collapse.updateScrollHeight()}}},E=(n(2362),Object(_.a)(M,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"checkpoint-field"},[n("CollapseComponent",{ref:"collapse",attrs:{title:e.itemData.title}},[e.itemData.val?n("div",{staticClass:"checkpoint-field-content"},[n("div",{staticClass:"checkpoint-field-content-left"},[n("div",{staticClass:"version-name flex-center"},[e._v("\n\t\t\t\t\t"+e._s(e.displayData.version_name)+"\n\t\t\t\t")]),e._v(" "),null!==(t=e.displayData)&&void 0!==t&&t.url?n("el-image",{attrs:{fit:"cover",src:e.changeUrl(e.displayData.url)}},[n("template",{slot:"placeholder"},[n("i",{staticClass:"el-icon-loading image-loading"})])],2):n("p",{staticClass:"empty-img flex-center"},[e._v("\n\t\t\t\t\t"+e._s(e.$t("EmptyBannerText"))+"\n\t\t\t\t")]),e._v(" "),n("div",{staticClass:"name overflow-ellipsis",attrs:{title:e.displayData.name}},[e._v("\n\t\t\t\t\t"+e._s(e.displayData.name)+"\n\t\t\t\t")])],1),e._v(" "),n("div",{staticClass:"checkpoint-field-content-right flex-center",on:{click:e.openModelSelect}},[n("i",{staticClass:"iconfont icon-select-model-icon"}),e._v(" "),n("span",{staticClass:"text"},[e._v(e._s(e.$t("switch")))])])]):n("div",{staticClass:"add-icon flex-center",on:{click:e.openModelSelect}},[n("i",{staticClass:"el-icon-plus"})])]),e._v(" "),n("WorkflowStyleModal",{ref:"workflowStyleModal",on:{selectModel:e.handleSelectModel}})],1)}),[],!1,null,"1da1cd84",null).exports);function A(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function N(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?A(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var R={inject:["top"],props:{itemData:{type:Object,default:function(){}}},components:{CollapseComponent:d.a,WorkflowStyleModal:T.a},data:function(){return{displayData:{name:"",url:"",version_name:""}}},watch:{itemData:{handler:function(t){var e,n=(t||{}).art_model;n&&(this.displayData.name=null==n?void 0:n.name,this.displayData.url=null==n||null===(e=n.banner)||void 0===e?void 0:e.url,this.displayData.version_name=null==n?void 0:n.version_name)},deep:!0}},computed:{idsObj:function(){var t=this.itemData;return{field:t.field,node_id:t.node_id,node_type:t.node_type}}},methods:{changeUrl:function(t){return Object(j.x)(t,"high")},openModelSelect:function(){this.$refs.workflowStyleModal.openModal({modelType:"LORA"})},handleSelectModel:function(t){var e=t.info||{},n=e.id,o=void 0===n?"":n,r=e.name,l=void 0===r?"":r,c=e.model_ver_no,d=void 0===c?"":c,h=e.version_name,m=void 0===h?"":h,v=e.banner,f=void 0===v?{}:v,_="".concat(o,"@").concat(d);this.displayData={name:l,url:(null==f?void 0:f.url)||"",version_name:m},this.top.changeVal(N(N({},this.idsObj),{},{val:_})),this.$refs.collapse.updateScrollHeight()}}},B=(n(2363),Object(_.a)(R,(function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"lora-field"},[n("CollapseComponent",{ref:"collapse",attrs:{title:e.itemData.title}},[e.itemData.val?n("div",{staticClass:"lora-field-content"},[n("div",{staticClass:"lora-field-content-left"},[n("div",{staticClass:"version-name flex-center"},[e._v("\n\t\t\t\t\t"+e._s(e.displayData.version_name)+"\n\t\t\t\t")]),e._v(" "),null!==(t=e.displayData)&&void 0!==t&&t.url?n("el-image",{attrs:{fit:"cover",src:e.changeUrl(e.displayData.url)}},[n("template",{slot:"placeholder"},[n("i",{staticClass:"el-icon-loading image-loading"})])],2):n("p",{staticClass:"empty-img flex-center"},[e._v("\n\t\t\t\t\t"+e._s(e.$t("EmptyBannerText"))+"\n\t\t\t\t")]),e._v(" "),n("div",{staticClass:"name overflow-ellipsis",attrs:{title:e.displayData.name}},[e._v("\n\t\t\t\t\t"+e._s(e.displayData.name)+"\n\t\t\t\t")])],1),e._v(" "),n("div",{staticClass:"lora-field-content-right flex-center",on:{click:e.openModelSelect}},[n("i",{staticClass:"iconfont icon-select-model-icon"}),e._v(" "),n("span",{staticClass:"text"},[e._v(e._s(e.$t("switch")))])])]):n("div",{staticClass:"add-icon flex-center",on:{click:e.openModelSelect}},[n("i",{staticClass:"el-icon-plus"})])]),e._v(" "),n("WorkflowStyleModal",{ref:"workflowStyleModal",on:{selectModel:e.handleSelectModel}})],1)}),[],!1,null,"e7926dfc",null).exports);function F(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function U(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?F(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var V={inject:["top"],props:{itemData:{type:Object,default:function(){}}},components:{CollapseComponent:d.a},data:function(){return{}},mounted:function(){},computed:{idsObj:function(){var t=this.itemData;return{field:t.field,node_id:t.node_id,node_type:t.node_type}}},methods:{changeValue:function(t){this.top.changeVal(U(U({},this.idsObj),{},{val:t}))}}},W=(n(2364),Object(_.a)(V,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"slider-field"},[e("CollapseComponent",{attrs:{title:t.itemData.title}},[e("el-slider",{attrs:{"show-input":"","show-input-controls":!1,value:t.itemData.val,min:t.itemData.option.min,max:t.itemData.option.max,step:t.itemData.option.step},on:{input:t.changeValue}})],1)],1)}),[],!1,null,"42c5dc73",null).exports);n(48);function H(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function z(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?H(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var G={inject:["top"],props:{itemData:{type:Object,default:function(){}}},data:function(){return{}},mounted:function(){},computed:{idsObj:function(){var t=this.itemData;return{field:t.field,node_id:t.node_id,node_type:t.node_type}}},methods:{changeValue:function(t){this.top.changeVal(z(z({},this.idsObj),{},{val:t}))}}},J=(n(2365),Object(_.a)(G,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"select-field"},[e("div",{staticClass:"select-field-title"},[t._v(t._s(t.itemData.title))]),t._v(" "),e("el-select",{staticClass:"custom-select-transparent",attrs:{"popper-class":"painting-board-select",value:t.itemData.val,"popper-append-to-body":!0},on:{change:t.changeValue}},t._l(t.itemData.option.values,(function(t){return e("el-option",{key:"key"+t,attrs:{label:t,value:t}})})),1)],1)}),[],!1,null,"56548357",null).exports);function K(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function Y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?K(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Q={inject:["top"],props:{itemData:{type:Object,default:function(){}}},data:function(){return{seedMode:"random",numVal:{random:0,custom:0}}},computed:{idsObj:function(){var t=this.itemData;return{field:t.field,node_id:t.node_id,node_type:t.node_type}},isRandom:function(){return"random"===this.seedMode},seedPlsHd:function(){return this.isRandom?this.$t("RandomSeed"):this.$t("customSeed")},getVal:function(){var t=this.numVal,e=t.random,n=t.custom;return this.isRandom?e:n}},watch:{numVal:{handler:function(){this.top.changeVal(Y(Y({},this.idsObj),{},{val:this.getVal}))},deep:!0,immediate:!0}},methods:{initData:function(){this.numVal.random=this.getRandomSeed(),this.numVal.custom=this.getRandomSeed()},changeSeedMode:function(t){this.seedMode=t,this.isRandom?this.numVal.random=this.getRandomSeed():this.top.changeVal(Y(Y({},this.idsObj),{},{val:this.getVal}))},changeValue:function(t){this.isRandom?this.numVal.random=t:this.numVal.custom=t},getRandomSeed:function(){return Math.floor(4294967294*Math.random())+1}}},X=(n(2366),Object(_.a)(Q,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"seed-field"},[e("div",{staticClass:"seed-field-top"},[e("div",{staticClass:"seed-field-top-title"},[t._v(t._s(t.itemData.title))]),t._v(" "),e("div",{staticClass:"seed-field-top-switch"},[e("button",{staticClass:"switch-btn",class:{active:t.isRandom},on:{click:function(e){return t.changeSeedMode("random")}}},[t._v("\n\t\t\t\t"+t._s(t.$t("Random"))+"\n\t\t\t")]),t._v(" "),e("button",{staticClass:"switch-btn",class:{active:!t.isRandom},on:{click:function(e){return t.changeSeedMode("custom")}}},[t._v("\n\t\t\t\t"+t._s(t.$t("Customization"))+"\n\t\t\t")])])]),t._v(" "),e("div",{staticClass:"seed-field-content flex-center"},[e("el-input-number",{attrs:{placeholder:t.seedPlsHd,precision:0,controls:!1,min:-1,disabled:t.isRandom,value:t.getVal},on:{input:t.changeValue}})],1)])}),[],!1,null,"3fb1b4d4",null).exports),Z=n(359);function tt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function et(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?tt(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var it={name:"CodeViewer",mixins:[n(575).a],inject:["top","handleQuick"],props:{codeViewData:{type:Array,default:function(){return[]}},height:{type:String,default:"100%"},isCreate:{type:Boolean,default:!1}},components:{InputField:y,ImageField:I,CheckpointField:E,LoraField:B,SliderField:W,SelectField:J,SeedField:X,VideoField:Z.a},data:function(){return{percentComplete:"none"}},computed:et(et({},Object(l.c)("user",["isLoggedIn"])),{},{getCodeStyle:function(){return{height:this.height}},getComponentsStyle:function(){return{height:this.isCreate?"calc(100% - 68px)":"100%"}},isShowConsume:function(){var t;return 4==(null===(t=this.top)||void 0===t||null===(t=t.workFlowAppData)||void 0===t||null===(t=t.permission)||void 0===t?void 0:t.source)},getEstimatedCost:function(){var t=this.codeViewData.find((function(t){var e=t.field,n=t.node_type;return"model"==e&&"SeaArtSD3"==n}));return"sd3-turbo"==(null==t?void 0:t.val)?30:45}}),watch:{percentComplete:function(t){this.top.updateProgress(t)}},mounted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.loadCaptcha();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("Google Captcha failed to load or execute",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))()},methods:{fieldMap:function(){var t=this.$createElement;return this.codeViewData.map((function(e){var n=e.type,o=[t(y,{class:"item-component",attrs:{itemData:e}}),t(I,{class:"item-component",attrs:{itemData:e}}),t(E,{class:"item-component",attrs:{itemData:e}}),t(B,{class:"item-component",attrs:{itemData:e}}),t(W,{class:"item-component",attrs:{itemData:e}}),t(J,{class:"item-component",attrs:{itemData:e}}),t(X,{class:"item-component",attrs:{itemData:e},ref:"seedField"}),t(Z.a,{class:"item-component",attrs:{itemData:e}})];return(null==o?void 0:o[n-1])||""}))},handleGenerate:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,l,d,h,m,v,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.updateCaptcha("cmfy_app");case 2:if(t.percentComplete=0,d=(null===(n=t.$route.params)||void 0===n?void 0:n.id)||"",h=!0,m=t.codeViewData.map((function(t){var e=t.field,n=t.node_id,o=t.node_type,r=t.val,l=t.value_type;switch(r||(h=!1),l){case 1:r+="";break;case 2:r=Number(Math.round(r));break;case 3:r=Number(r)}return{field:e,node_id:n,node_type:o,val:r}})),h){e.next=10;break}return t.$message.warning(t.$t("AllValuesRequired")),t.percentComplete="none",e.abrupt("return");case 10:(null===(o=t.$refs)||void 0===o||null===(o=o.seedField)||void 0===o?void 0:o.isRandom)&&(null===(l=t.$refs)||void 0===l||null===(l=l.seedField)||void 0===l||l.changeSeedMode("random")),(v=JSON.parse(JSON.stringify(t.$parent.tabList)))[1].icon="el-icon-loading",t.$parent.tabList=v,f={apply_id:d,inputs:m},t.captchaToken&&(f.g_recaptcha_token=t.captchaToken),t.isLoggedIn||(f.g_mode=1,t.$logEvent("log_actions",{operation:"click_generate",behavior_info:"on_swift_ai_detail_page",behavior_info_sub:"guest_visit"})),Object(c.e)(f).then((function(e){var n=e.data.id;if(n){var o,l=[Object(r.a)({id:n,process:0,components:[],expiration_time:0,deduction_detail:{},create_at:0,creativity:{},status_desc:"waiting",status:1},"creativity",{name:null===(o=t.top)||void 0===o||null===(o=o.workFlowAppData)||void 0===o?void 0:o.name,id:d})];t.$emit("onCreateTask",l)}else t.percentComplete="none"})).catch((function(e){t.percentComplete="none",t.$parent.tabList[1].icon=""}));case 18:case"end":return e.stop()}}),e)})))()},loopGetResult:function(t){var e=this;this.loopInterval=setInterval(Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,l,c,d,h,m,v;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o={task_ids:[t]},e.isLoggedIn||(o.g_mode=1),n.next=5,batchFetchTaskProcess(o);case 5:if(r=n.sent,null!=(l=r.data.items)&&l[0]){n.next=9;break}return n.abrupt("return");case 9:c=l[0],d=c.process,h=c.status_desc,m=c.task_id,v=void 0===m?"":m,e.handleQuick(l[0]),e.percentComplete=d,n.t0=h,n.next="finish"===n.t0?15:"sysCancelDesc"===n.t0?19:"sysTimeoutDesc"===n.t0?23:27;break;case 15:return clearInterval(e.loopInterval),e.percentComplete="none",e.top.changeSelectedId(v),n.abrupt("break",28);case 19:return clearInterval(e.loopInterval),e.$message.warning(e.$t("systemCancel")),e.percentComplete="none",n.abrupt("break",28);case 23:return clearInterval(e.loopInterval),e.$message.warning(e.$t("systemTimeoutCancel")),e.percentComplete="none",n.abrupt("break",28);case 27:return n.abrupt("break",28);case 28:n.next=32;break;case 30:n.prev=30,n.t1=n.catch(0);case 32:case"end":return n.stop()}}),n,null,[[0,30]])}))),3e3)}},render:function(){var t=arguments[0],e=t("el-tooltip",{class:"item",attrs:{effect:"dark",content:this.$t("workFlow31"),placement:"top"}},[t("span",{class:"el-icon-question generate-tips"})]),n=t("div",{class:"estimated-cost"},["(",this.$t("expend"),": ",this.getEstimatedCost," ",this.$t("coin"),")"]),o=t("el-button",{class:"generate-btn flex-center",on:{click:this.handleGenerate}},[t("div",{class:"flex-center"},[t("span",{class:"txt"},[this.$t("Generate")]),!this.isShowConsume&&e]),this.isShowConsume&&n]);return t("div",{class:"code-viewer",style:this.getCodeStyle},[t("div",{class:"items-component width-height-hundred",style:this.getComponentsStyle},[this.fieldMap()]),this.isCreate&&o])}},at=it,nt=(n(2368),Object(_.a)(at,undefined,undefined,!1,null,"2354b186",null));e.a=nt.exports},503:function(t,e,n){"use strict";var o=n(2);n(9),n(7),n(10),n(36),n(14),n(11),n(12),n(8),n(4),n(18),n(6);function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n(16),n(32),n(70),n(19),n(43),n(23),n(49),n(37);var c=n(1),d=n(520),h=n(127),m=n(1913),v=n(35),f=n.n(v),_=n(21);function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C={props:{value:{type:Boolean,default:!1}},computed:w(w({},Object(c.c)("user",["accountData"])),{},{dialogVisible:{get:function(){return this.value},set:function(t){this.$emit("input",t)}},setList:function(){return(f()(this.accountData.tags)||[]).reverse()}}),data:function(){return{delLoading:!1}},methods:w(w({},Object(c.d)("user",["SET_ACCOUNT_DATA"])),{},{onClose:function(){this.$emit("close")},delTags:function(t){var e=this;if(!this.delLoading){this.delLoading=!0;var n={id:t.id,name:t.name};Object(_.jb)({tags:[n]}).then((function(n){if(1e4==n.status.code){var o=f()(e.accountData);o.tags.forEach((function(e,n){e.id==t.id&&o.tags.splice(n,1)})),e.SET_ACCOUNT_DATA(o)}e.delLoading=!1})).catch((function(t){e.delLoading=!1}))}}})},k=(n(2419),n(0)),x=Object(k.a)(C,(function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:t.$t("FavoriteTag"),visible:t.dialogVisible,top:"30vh",width:"508px","custom-class":"SaDialog"},on:{"update:visible":function(e){t.dialogVisible=e},close:t.onClose}},[e("div",{staticClass:"main"},[e("ul",{ref:"list",staticClass:"list"},t._l(t.setList,(function(n,o){return e("li",{key:o},[e("span",[t._v(t._s(t.$t(n.name)))]),t._v(" "),e("i",{staticClass:"el-icon-delete-solid",on:{click:function(e){return t.delTags(n)}}})])})),0)])])}),[],!1,null,"427e60b4",null).exports,O=n(521),$=(n(29),n(40)),D=n(56),S=n(33),I=n(5),T=n(79);function j(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var L={name:"recommendModelList",mixins:[S.a],components:{CollectPopover:D.a},props:{type:{type:String,default:"Checkpoint"},list:{type:Array,default:function(){return[]}},tag:{type:String,default:function(){return""}}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?j(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(c.c)("user",["isLoggedIn","accountSettingsData"])),data:function(){return{replaceImageType:I.x,iconLoad:!1,modelList:[],isReq:!1,itemShow:!1,itemShowId:"",queryParam:{page:2,page_size:7,offset:0,tags:[],order_by:"new",model_type:"-"}}},watch:{list:{handler:function(t){this.modelList=t}}},created:function(){},methods:{goMore:function(t){this.$logEvent("log_actions",{operation:{LORA:" click_recommend_style_change",Checkpoint:"click_recommend_model_change"}[t]}),window.open("/explore?modelType=Checkpoint}&tag=".concat(this.$route.query.id),"_blank")},handleClick:function(t){var e=Object.assign({},t);this.$EventBus.$emit("openGenerate",{action:1,data:{source:e}})},goModel:function(t,e){"IMG"!==t.target.tagName&&"cltpop"!==t.target.className&&"modelName"!==t.target.className||window.open("/models/detail/"+(null==e?void 0:e.id),"_blank")},goUserPage:function(t){var e;window.open("/user/"+(null==t||null===(e=t.author)||void 0===e?void 0:e.id),"_blank")},changeItemShow:function(t){this.itemShow=t.show,this.itemShowId=t.id},setIconLoad:function(){var t=this;this.iconLoad=!0,setTimeout((function(){t.iconLoad=!1}),500)},onChange:function(){this.setIconLoad(),this.getList()},getList:function(){var t=this;this.isReq||(this.isReq=!0,this.modelList=[],this.queryParam.tags=[this.$route.query.id||""],Object(T.i)(this.queryParam).then((function(e){1e4===e.status.code&&(t.queryParam.page++,e.data.has_more||(t.queryParam.page=1),t.modelList=(e.data.items||[]).map((function(t){try{t.banner={},t.banner.url=t.cover||"",t.banner.nsfw=t.nsfw,t.banner.width=t.cover_width,t.banner.height=t.cover_height}catch(t){}return t})),1===t.queryParam.page&&(t.queryParam.offset=e.data.offset))})).finally((function(){t.isReq=!1})))}}},P=L,M=(n(2422),Object(k.a)(P,(function(){var t=this,e=t._self._c;return e("div",{ref:"rmdModelList",staticClass:"rmdModelList"},[e("div",{staticClass:"title"},[e("div",{staticClass:"titleLeft",on:{click:function(e){return t.goMore(t.type)}}},[e("span",[t._v(t._s("Checkpoint"==t.type?t.$t("RmdModel"):t.$t("RmdLora")))]),t._v(" "),e("i",{staticClass:"el-icon-arrow-right"})]),t._v(" "),e("div",{staticClass:"changeit",on:{click:t.onChange}},[e("i",{staticClass:"iconfont icon-changeit",class:{iconLoad:t.iconLoad}}),t._v(" "),e("span",[t._v(t._s(t.$t("changeit")))])])]),t._v(" "),e("div",{staticClass:"list"},t._l(t.modelList,(function(n,o){var r,l,c,d,h,m,v,f;return e("a",{key:o,staticClass:"itme",attrs:{href:"/models/detail/"+(null==n?void 0:n.id)}},[e("div",{on:{click:function(e){return e.preventDefault(),t.goModel(e,n)}}},[e("div",{staticClass:"imgs",class:1===(null==n||null===(r=n.banner)||void 0===r?void 0:r.nsfw)?"bg-nsfw":""},[null!=n&&null!==(l=n.banner)&&void 0!==l&&l.url&&2===(null==n||null===(c=n.banner)||void 0===c?void 0:c.nsfw)?e("img",{directives:[{name:"webp",rawName:"v-webp",value:t.$imgL,expression:"$imgL"}],attrs:{src:null==n||null===(d=n.banner)||void 0===d?void 0:d.url,alt:""}}):e("div",{staticClass:"defTxt"},[t._v(t._s(t.$t("EmptyBannerText")))]),t._v(" "),t.isLoggedIn?e("div",{staticClass:"cltpop",style:{opacity:t.itemShow&&t.itemShowId==n.id?1:0}},[e("CollectPopover",{attrs:{type:"model",folder:n},on:{click:function(t){t.stopPropagation()},showChaneg:t.changeItemShow}})],1):t._e(),t._v(" "),t.isLoggedIn?e("div",{staticClass:"waterfall-hover-try",on:{click:function(e){return e.preventDefault(),t.handleClick(n)}}},[t._v(t._s(t.$t("Try")))]):t._e(),t._v(" "),t.isLoggedIn?e("i",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],class:t.setCollectData(n),on:{click:function(e){return e.preventDefault(),t.setCollect(n,"model")}}}):t._e()]),t._v(" "),e("div",{staticClass:"modelName"},[t._v(t._s(n.name))]),t._v(" "),e("div",{staticClass:"user",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.goUserPage(n)}}},[e("div",{staticClass:"userImg"},[null!=n&&null!==(h=n.author)&&void 0!==h&&h.head?e("img",{directives:[{name:"webp",rawName:"v-webp",value:t.$imgL,expression:"$imgL"}],attrs:{src:null==n||null===(m=n.author)||void 0===m?void 0:m.head,alt:""}}):e("div",{staticClass:"defHead"},[t._v(t._s(null==n||null===(v=n.author)||void 0===v?void 0:v.name[0]))])]),t._v(" "),e("div",{staticClass:"userName"},[t._v(t._s(null==n||null===(f=n.author)||void 0===f?void 0:f.name))])])])])})),0)])}),[],!1,null,"b20e96fc",null).exports),E=n(55),A=n(13),N=n(129),R=n(701);function B(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function F(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?B(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var U=Object(I.p)(),V=U.startTimestamp,W=U.endTimestamp,H=Object(I.r)(),z=H.startTimestamp,G=H.endTimestamp,J=Object(I.o)(),K=J.startTimestamp,Y=J.endTimestamp,Q={components:{TagList:d.a,WaterFallVue:h.a,stickyTab:m.a,myTags:x,SearchInput:O.a,recommendModelList:M,homeList:E.a},filters:{thousandsSeparator:function(t){if("number"!=typeof t)return t;var e=t.toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")},formatNumber:function(t){return Object(I.i)(t)}},mounted:function(){var t,e,n,o=this;this.activeName=(null===(t=this.$route.params)||void 0===t?void 0:t.type)||"artwork",this.getConfit(),this.$logEvent("log_actions",{operation:"enter_tags_detail_page",behavior_info:"on_tags_detail_page",behavior_info_sub:null===(e=this.queryParam)||void 0===e?void 0:e.tag}),this.initList();var r=document.documentElement,l=function(){var t=r.clientWidth;try{o.$refs.tagdetail.style.padding="72px ".concat(t*(100/1920)*.86,"px 0")}catch(t){}};document.addEventListener?window.addEventListener("resize",l,!1):window.attachEvent("onresize",l),this.$once("hook:beforeDestroy",(function(){window.removeEventListener("resize",l)})),this.getTagInfo(null===(n=this.$router.query)||void 0===n?void 0:n.id)},beforeDestroy:function(){console.log("页面销毁++++++++++"),Object(R.a)()},props:{obj:{type:Object,default:function(){return{}}}},data:function(){return{dotReportInfo:{category:"default",view_domain:"Tags",batch_id:""},activeName:this.obj.activeName||"artwork",queryParam:this.obj.queryParam||{},filterShow:!1,fliterLoading:!1,list:this.obj.list||[],nodeList:[],intNodeList:[],isLock:!1,isReq:!1,dialogVisible:!1,addLoading:!1,selectInfo:{ids:[]},isCheck:!1,tagInfoDetail:this.obj.tagInfoDetail||null,tagHoverStatus:!1,collectBtnLoading:!1,reviewType:"artwork",timeName:this.obj.timeName||"All",timeTypeOption:[{name:"All",startTiem:null,endTime:null},{name:"days",startTiem:V,endTime:W},{name:"week",startTiem:z,endTime:G},{name:"months",startTiem:K,endTime:Y}],tagIndex:this.obj.tagIndex||"hot",typeOption:[{name:"Hot",id:"hot",icon:"hot"},{name:"New",id:"new",icon:"new1"}],modelTypes:A.I,baseModels:A.a,modelTypeSelect:[],baseModelSelect:[],listReqFuns:{artwork:T.l,model:T.m,post:T.n,workflow:N.d,swiftapp:N.d,cyberpub:$.squareCharacterList,lora:$.squareLoratemplate,designtmp:$.squarePaletteTemplate,"ai-video":T.c,"ai-audio":T.b},weekHotTab:this.obj.weekHotTab||[],needRotate:this.obj.needRotate||!1,typeArr:[{key:"Graphics",value:"picture"},{key:"Article",value:"article"}]}},computed:F(F(F(F({},Object(c.e)("app",["tagHot","tagNew"])),Object(c.c)("user",["accountData","isLoggedIn","isCompanyAccount"])),Object(c.e)("user",["adminOff"])),{},{lang:function(){return this.$i18n.locale},statTotal:function(){var t,e=(null==this||null===(t=this.tagInfoDetail)||void 0===t?void 0:t.stat)||{};return Object.keys(e).reduce((function(t,n){return t+e[n]}),0)},collectIconClass:function(){return this.tagInfoDetail&&this.tagInfoDetail.is_collect?"icon-edit":"icon-collect"},collectText:function(){return this.tagInfoDetail&&this.tagInfoDetail.is_collect?this.$t("TagEdit"):this.$t("TagCollect")},setTaginfo:function(){return this.tagInfoDetail||{}},renderList:function(){var t;return((null==this||null===(t=this.setTaginfo)||void 0===t?void 0:t.related_tags)||[]).map((function(t){return t.style={},t.style.url=t.cover||"",t.name=t.title||t.id,t}))},setTagShow:function(){var t=this,e=!0;return this.accountData.tags&&this.accountData.tags.length>0&&this.accountData.tags.forEach((function(element){element.id==t.$route.params.tag&&(e=!1)})),e},typeList:function(){var t,e=(null==this||null===(t=this.tagInfoDetail)||void 0===t?void 0:t.stat)||{},n=e.num_of_artwork,o=void 0===n?0:n,r=e.num_of_model,l=void 0===r?0:r,c=e.num_of_post,d=void 0===c?0:c,h=e.num_of_swift_app,m=void 0===h?0:h,v=e.num_of_workflow,f=void 0===v?0:v,_=e.num_of_lora_train,y=void 0===_?0:_,w=e.num_of_design_template,C=e.num_of_character,k=void 0===C?0:C,x=e.num_of_ai_video,O=void 0===x?0:x,$=e.num_of_timbre;return[{name:"Work",value:"artwork",num:o},{name:"Post",value:"post",num:d},{name:"Tavern",value:"cyberpub",num:k},{name:"aiVideName",value:"ai-video",num:O},{name:"AIAudio",value:"ai-audio",num:void 0===$?0:$},{name:"aiapply",value:"swiftapp",num:m},{name:"Model",value:"model",num:l},{name:"LoRATrain",value:"lora",num:y},{name:"designTemplate",value:"designtmp",num:w},{name:"WorkFlow",value:"workflow",num:f}].filter((function(t){return t.num>0}))},checkRun:{get:function(){return 1===this.queryParam.run_available},set:function(t){this.queryParam.run_available=t?1:0}},renderTypeOption:function(){var t=f()(this.typeOption);return["workflow","swiftapp","cyberpub"].includes(this.activeName)&&(t=t.filter((function(t){return"follows"!=t.id&&"recommend"!=t.id}))),t},hideTimeTypeOption:function(){return["recommend","follows"].includes(this.tagIndex)}}),methods:F(F(F({},Object(c.d)("user",["SET_ACCOUNT_DATA"])),Object(c.b)("user",["setAdminOff"])),{},{handleFilter:function(t){var e=this.tagInfoDetail,n=e.name,o=void 0===n?"":n,r=e.id,l=o||(void 0===r?"":r);this.$logEvent("log_actions",{operation:"click_post_filter_button",behavior_info:"on_tab_".concat(l,"_detail_page"),behavior_info_sub:t}),this.queryParam.sub_channel=t,this.intList()},filterReset:function(){this.queryParam.sub_channel="",this.intList()},onFilter:function(t,e){var n=this;this.isReq||(1==e?(this.modelTypeSelect.includes(t)?this.modelTypeSelect.forEach((function(e,o){e==t&&n.modelTypeSelect.splice(o,1)})):this.modelTypeSelect.push(t),this.$logEvent("log_actions",{operation:"click_filter",behavior_info:"on_homepage_model_tab",behavior_info_sub:this.modelTypeSelect||[]})):this.baseModelSelect.includes(t)?this.baseModelSelect.forEach((function(e,o){e==t&&n.baseModelSelect.splice(o,1)})):this.baseModelSelect.push(t),"recommend"==this.tagIndex&&(this.tagIndex="hot"),this.intList())},onWorkfolwFilterReset:function(){this.queryParam.tag="",this.queryParam.nodes_type=[],this.queryParam.run_available=0,this.intList()},getConfit:function(){var t,e=this;["workflow","swiftapp"].includes(this.activeName)&&(this.queryParam.run_available=0,this.fliterLoading||null!==(t=this.nodeList)&&void 0!==t&&t.length||(this.fliterLoading=!0,Object(N.b)().then((function(t){1e4!==!t.status.code&&(e.nodeList=t.data.nodes,e.intNodeList=t.data.nodes)})).finally((function(){e.fliterLoading=!1}))))},remoteMethod:function(t){var e=this;t?(this.fliterLoading=!0,Object(N.e)({keyword:t}).then((function(t){1e4!==!t.status.code&&(e.nodeList=t.data.nodes)})).finally((function(){e.fliterLoading=!1}))):this.nodeList=this.intNodeList},nodeListChange:function(t){this.$logEvent("log_actions",{operation:"click_node_on",behavior_info:"on_comfyui_landing_page",behavior_info_sub:t}),this.intList()},onFilterReset:function(){this.isReq||(this.modelTypeSelect=[],this.baseModelSelect=[],this.intList())},initList:function(){var t=this.list;this.setDefaultTab(),t.length&&(this.list=t.map((function(t){return t.status=1,t})))},setDefaultTab:function(){var t,e,n=this;if(!((null===(t=this.typeList.find((function(t){return t.value===n.activeName})))||void 0===t?void 0:t.num)>0)){this.activeName=(null===(e=this.typeList.find((function(t){return t.num>0})))||void 0===e?void 0:e.value)||"artwork";var o=this.setTabParams();this.timeName=this.weekHotTab.includes(this.activeName)?"week":"All",this.$set(this,"queryParam",o),this.intList()}},setIcon:function(){var t=this,e="homeIcon1";return this.typeOption.forEach((function(n){t.tagIndex==n.id&&(e=n.icon)})),e},handleTimeCommand:function(t){this.timeName=t.name,this.queryParam.time_from=t.startTiem,this.queryParam.time_to=t.endTime,this.$logEvent("log_actions",{operation:"click_".concat(t.name,"_filter"),behavior_info:"on_tags_detail_page"}),this.intList(),"All"!=t.name&&this.$logEvent("log_actions",{operation:" click_time_filter_button",behavior_info:t.name})},handleCommand:function(t){this.tagIndex=t,this.$logEvent("log_actions",{operation:"click_".concat(t,"_filter"),behavior_info:"on_tags_detail_page"}),this.intList()},toggleHoverStatus:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.tagHoverStatus=t},handleCollect:function(){var t,e,n=this;if(this.$logEvent("log_actions",{operation:"click_collect_tags",behavior_info:"on_tags_detail_page",behavior_info_sub:null===(t=this.queryParam)||void 0===t?void 0:t.tag}),this.isLoggedIn){if(!this.collectBtnLoading)if(null!=this&&null!==(e=this.tagInfoDetail)&&void 0!==e&&e.is_collect)this.$router.push(this.localePath("/settings"));else{var o,r={};r.target_id=this.tagInfoDetail.id,r.target_type="tag";var l=null!=this&&null!==(o=this.tagInfoDetail)&&void 0!==o&&o.is_collect?T.p:T.a;this.collectBtnLoading=!0,l(r).then((function(t){var e,o,r=null!=n&&null!==(e=n.tagInfoDetail)&&void 0!==e&&e.is_collect?n.$t("CancelCollectedTips"):n.$t("TagCollectSuccess");[1e4,"10000"].includes(t.status.code)&&(n.$message.success(r),n.$set(n.tagInfoDetail,"is_collect",!(null!=n&&null!==(o=n.tagInfoDetail)&&void 0!==o&&o.is_collect)))})).finally((function(){n.collectBtnLoading=!1}))}}else this.$EventBus.$emit("openLoginDialog")},onPostBnt:function(){this.$logEvent("log_actions",{operation:"click_to_contribute"}),this.$EventBus.$emit("openCreativeCenterModal",{list:[],type:"text",source:"tag"})},backTo:function(){window.history.length>1&&"/"!=this.fromPath?this.$router.back():this.$router.push(this.localePath("/"))},checkType:function(t){var e;this.isReq||this.activeName!==t.value&&(this.activeName=t.value,this.$logEvent("log_actions",{operation:"click_".concat(null===(e=this.queryParam)||void 0===e?void 0:e.tag,"_tags_tab"),behavior_info:"on_tags_detail_page",behavior_info_sub:t.value}),this.getConfit(),this.filterSearch({isTab:!0}),Object(R.b)(t.value,this),this.getList())},changeAdminOff:function(){-1!==this.adminOff&&this.setAdminOff(1===this.adminOff?0:1)},getTagInfo:function(t){var e=this,n={id:t||this.$route.params.tag||"landscape"};Object(T.k)(n).then((function(t){var n;if([1e4,"10000"].includes(null==t||null===(n=t.status)||void 0===n?void 0:n.code)){var o=t.data||{};o.style={},o.style.url=o.cover||"",o.name=o.title||o.id,e.tagInfoDetail=o}})).finally((function(){}))},handleBatchSetTag:function(){},handleGetCheckList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.selectInfo=t},addTgas:function(){var t=this;if(!this.addLoading){this.addLoading=!0;var e={id:this.setTaginfo.id,name:this.setTaginfo.name};Object(_.ib)({tags:[e]}).then((function(e){if(1e4==e.status.code){var n=f()(t.accountData);n.tags.push(t.setTaginfo),t.SET_ACCOUNT_DATA(n)}t.addLoading=!1})).catch((function(e){t.addLoading=!1}))}},changeTags:function(t){this.$logEvent("log_actions",{operation:"click_tags",behavior_info:t,behavior_info_sub:"tag_details"}),this.$router.push(this.localePath(null==t?void 0:t.path))},intList:function(){this.list=[],this.isReq=!1,this.isLock=!1,this.queryParam.page=1,this.queryParam.offset=0,this.getList()},getList:function(t){var e=this;if(!this.isReq&&!this.isLock){this.isReq=!0;var n=this.getReqParams(),o=this.listReqFuns[this.activeName];Object(R.c)(this.activeName,n,this),o(n).then((function(n){if(1e4===n.status.code){if(n.data.has_more?e.isLock=!1:e.isLock=!0,t){var o=(n.data.items||[]).map((function(t){try{t.banner={},t.banner.url=t.cover||"",t.banner.nsfw=t.nsfw,t.banner.width=t.cover_width,t.banner.height=t.cover_height,t.status=1,"model"==e.activeName&&(t.name=t.art_model.name,t.type=t.art_model.type,t.base_model=t.art_model.base_model)}catch(t){}return t}));e.list=e.list.concat(o)}else e.list=(n.data.items||[]).map((function(t){try{t.banner={},t.banner.url=t.cover||"",t.banner.nsfw=t.nsfw,t.banner.width=t.cover_width,t.banner.height=t.cover_height,t.status=1,"model"==e.activeName&&(t.name=t.art_model.name,t.type=t.art_model.type,t.base_model=t.art_model.base_model)}catch(t){}return t}));e.isReq=!1,1===e.queryParam.page&&(e.queryParam.offset=n.data.offset),e.queryParam.page++}})).catch((function(t){e.isReq=!1}))}},setTabParams:function(t){var e=f()(A.u[this.activeName]).params,n=(null==e?void 0:e.order_by)||(this.isLoggedIn?"top":"hot"),o=Object(I.r)(),r=o.startTimestamp,l=o.endTimestamp,c=this.weekHotTab.includes(this.activeName)?r:null,d=this.weekHotTab.includes(this.activeName)?l:null;return F(F({},e),{},{tag:this.$route.params.tag,page:1,page_size:50,order_by:n,time_from:c,time_to:d})},filterSearch:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).isTab;this.isLock=!1,this.isReq=!1,delete this.queryParam.offset;var e=this.setTabParams(t);this.queryParam.page=1,this.$set(this,"queryParam",e),this.list=[]},getReqParams:function(){var t=F(F({},f()(this.queryParam)),{},{order_by:this.tagIndex}),e=this.modelTypeSelect,n=this.baseModelSelect;["model","lora"].includes(this.activeName)?(t.base_models=n,t.model_types=e.map((function(t,e){return"LoRA"==t?"LORA":t}))):"artwork"==this.activeName&&(t.order_by=this.tagIndex);var o={days:[V,W],week:[z,G],months:[K,Y]};return"All"===this.timeName?(delete t.time_from,delete t.time_to):(t.time_from=o[this.timeName][0],t.time_to=o[this.timeName][1]),t},getHref:function(t){var e=this.$route.params.tag,n="artwork"===t.value?"":"/".concat(t.value),path="/tagInfo".concat(n,"/").concat(e);return this.localePath(path)}}),head:function(){var t;if(null===(t=this.tagInfoDetail)||void 0===t||!t.id)return{};var e=this.tagInfoDetail||{},n=e.title,o=e.id,r=e.stat,l=r.num_of_artwork,c=r.num_of_model,d=(e.related_tags||[]).map((function(t){return t.title})),h=this.$route,m=h.name,v=h.params,f=(m=m.split("___")[0]).includes("TagDetail")?(null==v?void 0:v.type)||"artwork":m,_=A.v.find((function(t){return t.name.includes(f)}))||{},title=_.title,desc=_.desc;title=this.$t(title,{name:n});var y=this.$t(desc,{name:n,wNum:l,mNum:c,link:d.toString()});return{title:title,meta:[{hid:"description",name:"description",content:y},{hid:"keywords",name:"keywords",content:n},{hid:"og:title",name:"og:title",content:title},{hid:"og:description",name:"og:description",content:y}],script:[{type:"application/ld+json",json:{"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:[{"@type":"ListItem",position:1,name:this.$t("Home"),item:"https://www.seaart.ai"},{"@type":"ListItem",position:2,name:this.$t("AI_Explore"),item:"https://www.seaart.ai"+"/".concat(o,"?id=").concat(o)}]}}],__dangerouslyDisableSanitizers:["script"]}}},X=Q,Z=(n(2423),Object(k.a)(X,(function(){var t,e,n,o,r=this,c=r._self._c;return c("div",{ref:"tagdetail",staticClass:"tagdetail"},[r.$route.query.isBack?r._e():c("div",{staticClass:"backIcon",on:{click:function(t){return t.stopPropagation(),r.backTo.apply(null,arguments)}}},[c("i",{staticClass:"el-icon-back"})]),r._v(" "),c("el-backtop",{attrs:{bottom:30,right:30}},[c("i",{staticClass:"el-icon-top"})]),r._v(" "),c("div",{staticClass:"head"},[c("div",{staticClass:"head-bg"},[r.setTaginfo.style&&r.setTaginfo.style.url?c("img",{directives:[{name:"webp",rawName:"v-webp",value:r.$imgL,expression:"$imgL"}],attrs:{src:r.setTaginfo.style.url}}):r._e()]),r._v(" "),c("div",{staticClass:"head-info"},[c("div",{staticClass:"user"},[c("div",{staticClass:"flex"},[r.setTaginfo.style&&r.setTaginfo.style.url?c("img",{directives:[{name:"webp",rawName:"v-webp",value:r.$imgL,expression:"$imgL"}],attrs:{src:r.setTaginfo.style.url,alt:r.setTaginfo.name}}):r._e(),r._v(" "),c("div",{staticClass:"name-box"},[c("h1",[r._v(r._s(r.$t(r.setTaginfo.name)))]),r._v(" "),c("div",{staticClass:"work-num-show-box"},[c("div",{staticClass:"work-num-show-box-item"},[c("span",{staticClass:"work-num-show-box-item-num"},[r._v(r._s(r._f("thousandsSeparator")(r.statTotal)))]),r._v(" "),c("span",{staticClass:"work-num-show-box-item-text"},[r._v(r._s(r.$t("RelatedContent")))])])])])]),r._v(" "),c("div",{directives:[{name:"show",rawName:"v-show",value:r.tagInfoDetail,expression:"tagInfoDetail"}],staticClass:"collect-box-2",on:{click:r.handleCollect}},[c("i",{staticClass:"iconfont collect-box-icon",class:r.collectIconClass}),r._v(" "),c("span",{staticClass:"collect-box-text"},[r._v(r._s(r.collectText))])])])])]),r._v(" "),r.renderList&&r.renderList.length>0?c("div",{staticClass:"taglist"},[c("tag-list",{attrs:{active:r.$route.query.id,"use-new-tag":!0,"render-list":r.renderList,clickType:!1},on:{changeTags:r.changeTags}})],1):r._e(),r._v(" "),c("div",{staticClass:"funBar"},[c("div",{staticClass:"funType"},r._l(r.typeList,(function(t,e){return c("a",{key:e,staticClass:"typeItem",class:{typeActivate:r.activeName==t.value},attrs:{"data-num":r._f("formatNumber")(t.num),href:r.getHref(t)},on:{click:function(e){return e.preventDefault(),r.checkType(t)}}},[r._v("\n        "+r._s(r.$t(t.name))+"\n      ")])})),0),r._v(" "),c("div",{staticClass:"Screening"},["post"==r.activeName?c("el-popover",{attrs:{placement:"bottom","popper-class":"waterfull-filter",trigger:"hover"}},[c("div",{staticClass:"filter-content"},[c("div",{staticClass:"title"},[r._v(r._s(r.$t("Type")))]),r._v(" "),c("div",{staticClass:"filter"},r._l(r.typeArr,(function(t){var e,n;return c("div",{key:t.value,staticClass:"item-filter",class:{active:(null===(e=r.queryParam)||void 0===e?void 0:e.sub_channel)==t.value},on:{click:function(e){return r.handleFilter(t.value)}}},[(null===(n=r.queryParam)||void 0===n?void 0:n.sub_channel)==t.value?c("i",{staticClass:"el-icon-check"}):r._e(),r._v("\n              "+r._s(r.$t(t.key))+"\n            ")])})),0),r._v(" "),c("div",{staticClass:"filter-reset",on:{click:r.filterReset}},[r._v("\n            "+r._s(r.$t("resetSelection"))+"\n          ")])]),r._v(" "),c("div",{staticClass:"filter-box",attrs:{slot:"reference"},slot:"reference"},[c("div",[c("i",{staticClass:"iconfont icon-a-filterIcon"}),r._v(" "),c("span",[r._v(r._s(r.$t("Filter")))])]),r._v(" "),c("i",{staticClass:"el-icon-arrow-down"})])]):r._e(),r._v(" "),c("el-popover",{directives:[{name:"show",rawName:"v-show",value:"model"==r.activeName||"lora"==r.activeName,expression:"activeName == 'model' || activeName == 'lora'"}],attrs:{placement:"bottom","popper-class":"homeFilter",trigger:"hover"}},[c("div",{staticClass:"filterCnt"},["model"==r.activeName?c("div",[r.lang.includes("zh")?c("div",{staticClass:"filterTit"},[r._v("\n              "+r._s(r.$t("Model")+r.$t("Type"))+"\n            ")]):c("div",{staticClass:"filterTit"},[r._v(r._s(r.$t("Model")+" "+r.$t("Type")))]),r._v(" "),c("div",{staticClass:"filterList"},r._l(r.modelTypes,(function(t,e){return c("div",{key:e,staticClass:"filterItem",class:{AfilterItem:r.modelTypeSelect.includes(t)},on:{click:function(e){return r.onFilter(t,1)}}},[r.modelTypeSelect.includes(t)?c("i",{staticClass:"el-icon-check"}):r._e(),r._v(" "),c("span",[r._v(r._s("TextualInversion"===t?r.$t("embedding1"):t))])])})),0)]):r._e(),r._v(" "),c("div",{staticClass:"filterTit",staticStyle:{"margin-top":"16px"}},[r._v(r._s(r.$t("BaseModel")))]),r._v(" "),c("div",{staticClass:"filterList"},r._l(r.baseModels,(function(t,e){return c("div",{key:e,staticClass:"filterItem",class:{AfilterItem:r.baseModelSelect.includes(t)},on:{click:function(e){return r.onFilter(t,2)}}},[r.baseModelSelect.includes(t)?c("i",{staticClass:"el-icon-check"}):r._e(),r._v(" "),c("span",[r._v(r._s(t))])])})),0),r._v(" "),c("div",{staticClass:"filterReset graBorder",on:{click:r.onFilterReset}},[r._v("\n            "+r._s(r.$t("resetSelection"))+"\n          ")])]),r._v(" "),c("el-badge",{staticClass:"item",attrs:{slot:"reference",value:(null===(t=r.modelTypeSelect)||void 0===t?void 0:t.length)+(null===(e=r.baseModelSelect)||void 0===e?void 0:e.length),hidden:(null===(n=r.modelTypeSelect)||void 0===n?void 0:n.length)+(null===(o=r.baseModelSelect)||void 0===o?void 0:o.length)==0},slot:"reference"},[c("div",{staticClass:"filterBox"},[c("div",[c("i",{staticClass:"iconfont icon-a-filterIcon"}),r._v(" "),c("span",[r._v(r._s(r.$t("Filter")))])]),r._v(" "),c("i",{staticClass:"el-icon-arrow-down"})])])],1),r._v(" "),c("el-popover",{directives:[{name:"show",rawName:"v-show",value:"workflow"==r.activeName,expression:"activeName == 'workflow'"}],attrs:{placement:"bottom","popper-class":"comfyFilter",trigger:"click"},model:{value:r.filterShow,callback:function(t){r.filterShow=t},expression:"filterShow"}},[c("div",{staticClass:"filterCnt"},[c("el-checkbox",{on:{change:r.intList},model:{value:r.checkRun,callback:function(t){r.checkRun=t},expression:"checkRun"}},[r._v(r._s(r.$t("comfyFilter1")))]),r._v(" "),c("div",{staticClass:"filterTit"},[r._v(r._s(r.$t("comfyFilter3")))]),r._v(" "),c("el-select",{staticClass:"filterSelect",attrs:{"popper-class":"custom-select comfyFilter",filterable:"",remote:"",multiple:"",placeholder:r.$t("Pls_select"),"popper-append-to-body":!1,"remote-method":r.remoteMethod,loading:r.fliterLoading},on:{change:r.nodeListChange},model:{value:r.queryParam.nodes_type,callback:function(t){r.$set(r.queryParam,"nodes_type",t)},expression:"queryParam.nodes_type"}},r._l(r.nodeList,(function(t){return c("el-option",{key:t.value,attrs:{label:t.value,value:t.value}})})),1),r._v(" "),c("div",{staticClass:"filterReset graBorder",on:{click:r.onWorkfolwFilterReset}},[r._v("\n            "+r._s(r.$t("resetSelection"))+"\n          ")])],1),r._v(" "),c("div",{staticClass:"filterBox",attrs:{slot:"reference"},slot:"reference"},[c("div",[c("i",{staticClass:"iconfont icon-a-filterIcon"}),r._v(" "),c("span",[r._v(r._s(r.$t("Filter")))])]),r._v(" "),c("i",{staticClass:"el-icon-arrow-down"})])]),r._v(" "),c("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:!r.hideTimeTypeOption,expression:"!hideTimeTypeOption"}],attrs:{trigger:"hover"},on:{command:r.handleTimeCommand}},[c("div",{staticClass:"el-dropdown-link selectTime"},[c("div",[c("i",{staticClass:"el-icon-time"}),r._v(" "),c("span",[r._v(r._s(r.$t(r.timeName)))])]),r._v(" "),c("i",{staticClass:"el-icon-arrow-down"})]),r._v(" "),c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},r._l(r.timeTypeOption,(function(t,e){return c("el-dropdown-item",{key:e,attrs:{command:t}},[c("div",{staticClass:"el-dropdown-item el-dropdown-item-time"},[c("span",[r._v(r._s(r.$t(t.name)))])])])})),1)],1),r._v(" "),c("el-dropdown",{attrs:{trigger:"hover"},on:{command:r.handleCommand}},[c("div",{staticClass:"el-dropdown-link"},[c("div",[c("i",{staticClass:"iconfont custom-iconfont",class:"icon-".concat(r.setIcon())}),r._v(" "),c("span",[r._v(r._s(r.$t(r.tagIndex.charAt(0).toUpperCase()+r.tagIndex.slice(1))))])]),r._v(" "),c("i",{staticClass:"el-icon-arrow-down"})]),r._v(" "),c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},r._l(r.renderTypeOption,(function(t,e){return c("el-dropdown-item",{key:e,attrs:{command:t.id}},[c("div",{staticClass:"el-dropdown-item"},[c("i",{staticClass:"iconfont custom-iconfont",class:"icon-".concat(t.icon)}),r._v(" "),c("span",[r._v(r._s(r.$t(t.name)))])])])})),1)],1)],1)]),r._v(" "),c("div",{ref:"wraper",staticClass:"wraper"},[c("homeList",{ref:"WaterFallVue",attrs:{list:r.list,container:"wraper",review:"review"===r.activeName,cols:"cyberpub"===r.activeName?5:7,activeName:r.activeName,dotReportInfo:l(l({},r.dotReportInfo),{},{category:r.setTaginfo.id}),needHorizontal:r.needRotate},on:{load:function(t){return r.getList(!0)}}})],1),r._v(" "),c("my-tags",{model:{value:r.dialogVisible,callback:function(t){r.dialogVisible=t},expression:"dialogVisible"}})],1)}),[],!1,null,"e34342c4",null));e.a=Z.exports},504:function(t,e,n){"use strict";n(47),n(19),n(43),n(8),n(10),n(18),n(9),n(7),n(11),n(12),n(4),n(6);var o=n(2),r=(n(1091),n(44),n(589)),l=n.n(r),c=(n(16),n(5)),d={props:{type:{type:String,default:""},isCheck:{type:Boolean,default:!1},item:{type:Object,default:function(){return{}}}},data:function(){return{}},computed:{url:function(){var t,e=((null===(t=this.item)||void 0===t?void 0:t.banner)||{}).url;return Object(c.x)(e,"low")}},methods:{handleEvent:function(t){this.$emit("handle",t,this.item)}}},h=(n(2519),n(0)),m=Object(h.a)(d,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"work-box",class:{"check-box":"CHECK"===t.type,check:t.isCheck},on:{click:function(e){return e.stopPropagation(),t.handleEvent("CHECK")}}},[e("div",{staticClass:"img-box",style:{backgroundImage:"url("+t.url+")"}}),t._v(" "),e("span",{staticClass:"del-btn",on:{click:function(e){return e.stopPropagation(),t.handleEvent("DEL")}}},[e("i",{staticClass:"el-icon-delete-solid"})])])}),[],!1,null,"2edfdc45",null).exports,v=n(40),f=n(1);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var w={components:{WorkBox:m,ElEmpty:l.a},props:["selectIds","modelData"],data:function(){return{params:{page:1,page_size:30,model_no:this.$route.params.id,model_ver_no:"",type:"my",time_to:0},list:[],loading:!1,isEnd:!1}},computed:y(y(y({},Object(f.e)("creation",["generateViewShow"])),Object(f.e)("user",["cdnHost"])),{},{emptyImgUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20230620/c72217d5-e837-483c-9d47-861edb994f70.png")},loadingText:function(){return this.isEnd?this.$t("NoMoreData"):this.loading?this.$t("Loading")+"...":""},isShowLoading:function(){return this.loading||1!==this.params.page&&this.isEnd}}),watch:{generateViewShow:function(t){t||this.refreshList()},modelData:{handler:function(t){this.params.model_ver_no=t.model_ver_no,this.getWorkList()},deep:!0}},mounted:function(){var t;this.params.model_ver_no=null===(t=this.modelData)||void 0===t?void 0:t.model_ver_no,this.addScrollEvent()},methods:{refreshList:function(){this.params.page=1,this.params.time_to=0,this.list=[],this.getWorkList()},getWorkList:function(){var t=this;this.loading=!0,Object(v.artworkList)(this.params).then((function(e){var n=e.data,o=n.items,r=n.has_more;t.list=t.list.concat(o||[]),1===t.params.page&&(t.params.time_to=e.data.time_ms),t.isEnd=!r,t.loading=!1})).catch((function(e){t.loading=!1}))},handleBox:function(t,e){"CHECK"===t&&this.$emit("change",e)},addScrollEvent:function(){var t=this,e=document.querySelector("#editModelForm");e.removeEventListener("scroll",(function(){})),e.addEventListener("scroll",(function(){!(e.scrollHeight-e.scrollTop<=e.clientHeight+250)||t.loading||t.isEnd||(console.log("已经滚动到底部了"),t.params.page++,t.getWorkList())}))}}},C=(n(2520),{components:{WorkBox:m,ModelWork:Object(h.a)(w,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"relation-work"},[e("p",{staticClass:"title flex flex-col"},[e("span",[t._v("\n      "+t._s(t.$t("RelatedWorks"))+"\n      "),e("i",{staticClass:"el-icon-refresh",class:{loading:t.loading},on:{click:t.refreshList}})]),t._v(" "),e("span",{staticClass:"form-item-tips"},[t._v(t._s(t.$t("modelWorkDesc")))])]),t._v(" "),e("div",{staticClass:"work-list"},[t._l(t.list,(function(n,i){return e("work-box",{key:"works_"+i,attrs:{type:"CHECK",item:n,isCheck:t.selectIds.includes(n.id)},on:{handle:t.handleBox}})})),t._v(" "),t.isEnd&&!t.list.length?e("el-empty",{attrs:{description:t.$t("ModelWorkEmptyText"),image:t.emptyImgUrl}}):t._e(),t._v(" "),e("p",{directives:[{name:"show",rawName:"v-show",value:t.isShowLoading,expression:"isShowLoading"}],staticClass:"scroll-loading"},[t._v(t._s(t.loadingText))])],2)])}),[],!1,null,"10b365f7",null).exports},props:["value","modelData"],data:function(){return{}},computed:{selectIds:function(){return this.value.map((function(t){return t.id}))}},methods:{goToGerenate:function(){this.$EventBus.$emit("openGenerate",{action:1,data:{source:Object.assign({},this.modelData,{taskSource:3})}}),this.showMessage()},handleBox:function(t,e){var n=e.id,o=JSON.parse(JSON.stringify(this.value)),r=o.findIndex((function(t){return t.id===n}));-1!==r&&"DEL"===t&&(o.splice(r,1),this.$emit("input",o))},changeSelectList:function(t){var e=t.id,n=JSON.parse(JSON.stringify(this.value)),o=n.findIndex((function(t){return t.id===e}));if(-1===o){if(!(n.length<10))return void this.$message.warning(this.$t("SelectWorkMaxText"));n.push(t)}else n.splice(o,1);this.$emit("input",n)},showMessage:function(){this.$alert(this.$t("ModelGenerateTips"),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),customClass:"custom-confirm",type:"warning",callback:function(t){}})}}}),k=(n(2521),Object(h.a)(C,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"model-work"},[e("div",{staticClass:"work-list"},[e("div",{staticClass:"generate-box",on:{click:t.goToGerenate}},[e("i",{staticClass:"iconfont icon-play"}),t._v("\n        "+t._s(t.$t("GotoGenerate"))+"\n      ")]),t._v(" "),t._l(t.value,(function(n,i){return e("work-box",{key:"work_"+i,attrs:{item:n},on:{handle:t.handleBox}})}))],2),t._v(" "),e("model-work",{attrs:{selectIds:t.selectIds,modelData:t.modelData},on:{change:t.changeSelectList}})],1)}),[],!1,null,"65f472fa",null));e.a=k.exports},519:function(t,e,n){"use strict";n(23),n(37),n(9),n(7),n(11),n(12),n(8),n(6);var o=n(2),r=(n(16),n(10),n(14),n(4),n(127)),l=n(236),c=n(5),d=n(1),h=n(399),m=n(335),v=n(65),f=n(13);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var w={mixins:[h.a],components:{WaterFallVue:r.a},props:{list:{type:Array,default:function(){return[]}}},data:function(){return{replaceImageType:c.x,copyTextToClipboard:c.d,dialogVisible:!1,dataIndex:0,loading:!1,info:{},isI18nToggled:!1,rmdList:[],queryParam:{page:1,page_size:12,style:"",time_to:0},dotReportInfo:{category:"default",view_domain:"studio_style",batch_id:""}}},computed:y(y({},Object(d.c)("user",["isLoggedIn","userInfo","accountSettingsData"])),{},{setI18nPrompt:function(){var t=this.info.meta?this.info.meta.prompt:"",e=this.info.local_prompt;return this.isI18nToggled?e:t}}),watch:{dialogVisible:{handler:function(t){t||(this.info={},this.rmdList=[])}},accountSettingsData:{handler:function(t){this.isI18nToggled=!t.is_off_localization},deep:!0}},mounted:function(){this.isI18nToggled=!this.accountSettingsData.is_off_localization},methods:{jumpToStyleList:function(){var t;if(console.log(this.info,"this.info----"),!["",null,void 0].includes(null===(t=this.list[this.dataIndex])||void 0===t?void 0:t.key)){var e,n="".concat(location.origin,"/studio?style_type=").concat(null===(e=this.list[this.dataIndex])||void 0===e?void 0:e.key);window.open(n,"_blank")}},show:function(t){this.dialogVisible=!0,this.dataIndex=t,this.getDetail()},onTry:function(){if(this.isLoggedIn){this.dialogVisible=!1;var t=Object.assign({},this.info);t.logEventSource=Object(f.E)(this.$route.name),this.$EventBus.$emit("openGenerate",{action:1,data:{source:t}})}else this.$EventBus.$emit("openLoginDialog")},changeData:function(t){"previous"==t&&(0==this.dataIndex?this.dataIndex=this.list.length-1:this.dataIndex=this.dataIndex-1),"next"==t&&(this.dataIndex==this.list.length-1?this.dataIndex=0:this.dataIndex=this.dataIndex+1),this.info={},this.rmdList=[],this.$nextTick((function(){Object(v.a)(document.body,"el-popup-parent--hidden")})),this.getDetail()},getDetail:function(){var t=this;this.loading||(this.loading=!0,Object(l.a)({id:this.list[this.dataIndex].art_id}).then((function(e){1e4===e.status.code&&(t.info=e.data,t.getList())})).finally((function(){t.loading=!1})))},getList:function(){var t,e=this;this.queryParam.style=null===(t=this.info)||void 0===t?void 0:t.style,Object(m.b)(this.queryParam).then((function(t){1e4===t.status.code&&(e.rmdList=t.data.items||[])}))},wordsCopy:function(){var t,e,n=null!==(t=this.info)&&void 0!==t&&t.meta?this.info.meta.prompt:"",o=null===(e=this.info)||void 0===e?void 0:e.local_prompt;this.copyTextToClipboard(this.isI18nToggled?o:n),this.$message.success(this.$t("CopySuccess"))},imgCanUpscale:function(){var t,e;return[null===(t=this.info)||void 0===t||null===(t=t.banner)||void 0===t?void 0:t.width,null===(e=this.info)||void 0===e||null===(e=e.banner)||void 0===e?void 0:e.height].every((function(t){return 2*t<=4096}))},handleQuickOperate:function(t){var e,n,o,r;if(this.isLoggedIn){this.dialogVisible=!1;var l={};switch(l.art_work_no=null!==(e=this.info)&&void 0!==e&&e.art_work_no?null===(n=this.info)||void 0===n?void 0:n.art_work_no:null===(o=this.info)||void 0===o?void 0:o.id,t){case"extra-upscale":this.imgCanUpscale?(l.action=6,this.fastOperateTask(l)):this.$message.warning(this.$t("ImageSizeExceedsError"));break;case"remove-background":l.action=7,l.removeBgUrl=(null===(r=this.info)||void 0===r||null===(r=r.banner)||void 0===r?void 0:r.url)||"",this.fastOperateTask(l)}}else this.$EventBus.$emit("openLoginDialog")}}},C=(n(2390),n(2391),n(0)),component=Object(C.a)(w,(function(){var t,e,n,o,r,l,c,d=this,h=d._self._c;return h("el-dialog",{attrs:{visible:d.dialogVisible,"custom-class":"studioImageInfo",fullscreen:!0,"show-close":!1},on:{"update:visible":function(t){d.dialogVisible=t}}},[h("div",{staticClass:"main"},[h("div",{staticClass:"changeBnt left",on:{click:function(t){return d.changeData("previous")}}},[h("i",{staticClass:"el-icon-arrow-left"})]),d._v(" "),h("div",{staticClass:"changeBnt right",on:{click:function(t){return d.changeData("next")}}},[h("i",{staticClass:"el-icon-arrow-right"})]),d._v(" "),h("div",{staticClass:"changeBnt"}),d._v(" "),h("div",{staticClass:"cnt"},[h("i",{staticClass:"el-icon-close",on:{click:function(t){d.dialogVisible=!1}}}),d._v(" "),h("div",{directives:[{name:"loading",rawName:"v-loading",value:d.loading,expression:"loading"}],staticClass:"cntinfo"},[d.info.id?h("div",{staticClass:"img",class:{"bg-nsfw":1===(null===(t=d.info.banner)||void 0===t?void 0:t.nsfw)}},[h("div",{staticClass:"bntBng"}),d._v(" "),h("div",{staticClass:"bntBox"},[h("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:d.$t("ExtraUpscale"),placement:"top"}},[h("div",{staticClass:"bnts",on:{click:function(t){return d.handleQuickOperate("extra-upscale")}}},[h("i",{staticClass:"iconfont icon-upload-image-icon"})])]),d._v(" "),h("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:d.$t("RemoveBackground"),placement:"top"}},[h("div",{staticClass:"bnts",on:{click:function(t){return d.handleQuickOperate("remove-background")}}},[h("i",{staticClass:"iconfont icon-work-remove-background"})])])],1),d._v(" "),1!==(null===(e=d.info.banner)||void 0===e?void 0:e.nsfw)?h("el-image",{attrs:{src:d.replaceImageType(null===(n=d.info.banner)||void 0===n?void 0:n.url,"low"),fit:"cover","preview-src-list":[null===(o=d.info.banner)||void 0===o?void 0:o.url]}}):d._e()],1):d._e(),d._v(" "),d.info.id?h("div",{staticClass:"infos"},[h("div",{staticClass:"name"},[d._v("\n            "+d._s(d.$t("labStyleType_".concat(null===(r=d.list[d.dataIndex])||void 0===r||null===(r=r.key)||void 0===r?void 0:r.replace(/\s/g,""))))+"\n          ")]),d._v(" "),h("div",{staticClass:"line",staticStyle:{margin:"12px 0 0 0"}}),d._v(" "),h("div",{staticClass:"promptTit"},[d._v(d._s(d.$t("Prompt")))]),d._v(" "),h("div",{staticClass:"promptTxt"},[d._v(d._s(d.setI18nPrompt))]),d._v(" "),h("div",{staticClass:"bnt"},[h("div",{staticClass:"bntItem",on:{click:d.wordsCopy}},[h("i",{staticClass:"iconfont icon-copy"}),d._v(" "),h("span",[d._v(d._s(d.$t("CopyPrompts")))])]),d._v(" "),h("div",{staticClass:"bntItem",on:{click:function(t){d.isI18nToggled=!d.isI18nToggled}}},[h("i",{staticClass:"iconfont icon-i18n_prompt",staticStyle:{color:"#93A2B6","margin-right":"12px"}}),d._v(" "),h("span",[d._v(d._s(d.$t("translate")))])])]),d._v(" "),h("div",{staticClass:"line"}),d._v(" "),h("div",{staticClass:"otherInfo"},[h("div",{staticClass:"otherItem"},[h("div",[d._v(d._s(d.$t("Size")))]),d._v(" "),h("div",[d._v(d._s((null===(l=d.info.banner)||void 0===l?void 0:l.width)+"*"+(null===(c=d.info.banner)||void 0===c?void 0:c.height)))])]),d._v(" "),h("div",{staticClass:"otherItem"},[h("div",[d._v(d._s(d.$t("createModeTitle")))]),d._v(" "),h("div",[d._v(d._s(d.$t("studio")))])])]),d._v(" "),h("div",{staticClass:"tryBox"},[h("div",{staticClass:"try",on:{click:d.onTry}},[d._v(d._s(d.$t("studioTry")))])])]):d._e()]),d._v(" "),h("div",{staticClass:"recommend"},[d.rmdList.length>0?h("div",{staticClass:"tit"},[h("span",[d._v(d._s(d.$t("relatedRecommend")))]),h("span",{staticClass:"view-more",on:{click:function(t){return t.stopPropagation(),d.jumpToStyleList.apply(null,arguments)}}},[d._v(d._s(d.$t("more"))+" "),h("i",{staticClass:"el-icon-arrow-right"})])]):d._e(),d._v(" "),h("div",{ref:"wraperRmdList"},[h("WaterFallVue",{attrs:{type:"artwork",containerForImg:d.$refs.wraperRmdList,list:d.rmdList,dotReportInfo:d.dotReportInfo}})],1)])])])])}),[],!1,null,"53104dbe",null);e.a=component.exports},522:function(t,e,n){"use strict";n(16),n(14);var o=n(15),r=(n(2466),n(44),n(700)),l=n.n(r),c=(n(47),n(43),n(4),n(6),n(64)),d={props:{value:{type:Array,default:function(){return[]}}},components:{SwipeableList:c.a,ElTag:l.a},computed:{imgs:{get:function(){return this.value},set:function(t){this.$emit("input",t)}},allTag:function(){var t=[];return this.value.forEach((function(e){e.tags.forEach((function(e){var n=t.findIndex((function(t){return t.name===e}));-1===n?t.push({name:e,num:1}):t[n].num+=1}))})),t}},watch:{index:{handler:function(t){var e;this.intTag=null===(e=this.imgs[t])||void 0===e?void 0:e.tags}},dialogVisible:{handler:function(t){var e;t&&(this.intTag=null===(e=this.imgs[this.index])||void 0===e?void 0:e.tags)}}},data:function(){return{dialogVisible:!1,index:-1,intTag:[],intTagTxt:"",newTagTxt:"",itemScroll:null,itemScrollLeft:null}},methods:{show:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.index=t,this.dialogVisible=!0,this.getItemScrollLeft()},intTagDelete:function(t){var e=this;this.$confirm(this.$t(this.$t("imgDet7")),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning"}).then((function(){e.intTag.splice(t,1);var n=Object(o.a)(e.value);n[e.index].tags=e.intTag,e.$emit("input",n)})).catch((function(){}))},newTagDelete:function(t){var e=this;this.$confirm(this.$t(this.$t("imgDet7")),this.$t("Tip"),{confirmButtonText:this.$t("Confirm"),cancelButtonText:this.$t("Cancel"),type:"warning"}).then((function(){var n=Object(o.a)(e.value);n.forEach((function(e){e.tags.forEach((function(n,i){n==t&&e.tags.splice(i,1)}))})),e.$emit("input",n)})).catch((function(){}))},tagInputChange:function(){var t=Object(o.a)(this.value);t[this.index].tags.push(this.intTagTxt),this.$emit("input",t),this.intTagTxt=""},newTagInputChange:function(){},addTag:function(t){var e=this,n=Object(o.a)(this.value);n.forEach((function(n){-1==n.tags.indexOf(e.newTagTxt)&&(t?n.tags.unshift(e.newTagTxt):n.tags.push(e.newTagTxt))})),this.$emit("input",n),this.newTagTxt=""},carouselChange:function(t){this.index=t,this.changeScroll()},imgItemChange:function(t){this.$refs.imgCnt.setActiveItem(t),this.changeScroll()},getItemScrollLeft:function(){var t=this;this.$nextTick((function(){t.$refs.listItem&&t.$refs.listItem.forEach((function(e){var n;null!==(n=e.classList)&&void 0!==n&&n.contains("imgActivate")&&(t.itemScrollLeft=e.getBoundingClientRect().left)}))}))},changeScroll:function(){var t=this;this.$nextTick((function(){t.$refs.listItem.forEach((function(e,n){e.classList.contains("imgActivate")&&(t.itemScroll={value:e.getBoundingClientRect().left,index:n})}))}))}}},h=d,m=(n(2467),n(0)),component=Object(m.a)(h,(function(){var t,e,n=this,o=n._self._c;return o("el-dialog",{attrs:{title:n.$t("imgDet1"),visible:n.dialogVisible,width:"1365px",top:"5vh","custom-class":"trainDialog"},on:{"update:visible":function(t){n.dialogVisible=t}}},[n.dialogVisible?o("div",{staticClass:"imgDet"},[o("div",{staticClass:"imgBox",style:{width:(null===(t=n.imgs[n.index])||void 0===t||null===(t=t.tags)||void 0===t?void 0:t.length)>0?"644px":"100%"}},[o("div",{staticClass:"changeBtn leftBtn",on:{click:function(t){return n.$refs.imgCnt.prev()}}},[o("i",{staticClass:"el-icon-arrow-left"})]),n._v(" "),o("div",{staticClass:"changeBtn rightBtn",on:{click:function(t){return n.$refs.imgCnt.next()}}},[o("i",{staticClass:"el-icon-arrow-right"})]),n._v(" "),o("div",{staticClass:"imgInfo"},[o("el-carousel",{ref:"imgCnt",attrs:{autoplay:!1,arrow:"never","initial-index":n.index,"indicator-position":"none"},on:{change:function(t,e){return n.carouselChange(t)}}},n._l(n.imgs,(function(t,e){return o("el-carousel-item",{key:e},[o("img",{attrs:{src:t.url||t.cover,alt:""}})])})),1)],1),n._v(" "),o("div",{staticClass:"imgList"},[o("swipeable-list",{attrs:{scrollLeftnum:n.itemScrollLeft,scrollChange:n.itemScroll,top:"0px",height:"100%",isShowIconBtn:!1}},n._l(n.imgs,(function(t,e){return o("div",{key:e,ref:"listItem",refInFor:!0,staticClass:"imgItem",class:{imgActivate:e==n.index},on:{click:function(t){return n.imgItemChange(e)}}},[o("img",{attrs:{src:t.url||t.cover,alt:""}})])})),0)],1)]),n._v(" "),(null===(e=n.imgs[n.index])||void 0===e||null===(e=e.tags)||void 0===e?void 0:e.length)>0?o("div",{staticClass:"tagBox"},[o("div",{staticClass:"tagTip"},[o("i",{staticClass:"iconfont icon-Union"}),n._v(" "),o("span",[n._v(n._s(n.$t("imgDet5")))])]),n._v(" "),o("div",{staticClass:"tagInput newTagInput",on:{click:function(t){return n.$refs.intTagTxt.focus()}}},[n._l(n.intTag,(function(t,e){return o("el-tag",{key:"tag_"+t+e,attrs:{closable:""},on:{close:function(t){return n.intTagDelete(e)}}},[n._v(n._s(t))])})),n._v(" "),o("el-input",{ref:"intTagTxt",attrs:{type:"text",placeholder:n.$t("pleaseEnte"),resize:"none"},on:{change:n.tagInputChange},model:{value:n.intTagTxt,callback:function(t){n.intTagTxt=t},expression:"intTagTxt"}})],2),n._v(" "),o("div",{staticClass:"tagTip"},[o("i",{staticClass:"iconfont icon-Union"}),n._v(" "),o("span",[n._v(n._s(n.$t("imgDet6")))])]),n._v(" "),o("div",{staticClass:"tagInput newTagInput",on:{click:function(t){return n.$refs.newTagTxt.focus()}}},[n._l(n.allTag,(function(t,e){return o("el-tag",{key:"tag_"+t+e,attrs:{closable:""},on:{close:function(e){return n.newTagDelete(t.name)}}},[n._v(n._s(t.num>1?"".concat(t.name,"(").concat(t.num,")"):"".concat(t.name)))])})),n._v(" "),o("el-input",{ref:"newTagTxt",attrs:{type:"text",placeholder:n.$t("pleaseEnte"),resize:"none"},on:{change:n.newTagInputChange},model:{value:n.newTagTxt,callback:function(t){n.newTagTxt=t},expression:"newTagTxt"}})],2),n._v(" "),o("div",{staticClass:"btnItem"},[o("div",{on:{click:function(t){return n.addTag(!0)}}},[n._v(n._s(n.$t("imgDet3")))]),n._v(" "),o("div",{on:{click:function(t){return n.addTag()}}},[n._v(n._s(n.$t("imgDet4")))])])]):n._e()]):n._e()])}),[],!1,null,"c7f57590",null);e.a=component.exports},523:function(t,e,n){"use strict";n(10),n(28),n(318);var o=n(2);n(9),n(7),n(11),n(12),n(8),n(4),n(6);function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var c={props:{typeIndex:{type:String,default:""},value:{type:Object,default:function(){}},config:{type:Object,default:function(){}},defData:{type:Object,default:function(){}},type:{type:String,default:""},isView:{type:Boolean,default:!1}},watch:{},computed:{maxBatchSize:function(){var t=8;return["sdxl_default","sd35_default"].includes(this.type)&&(t=1),["sd35L_default","sd35M_default"].includes(this.type)&&(t=2),t},datas:{get:function(){return this.value},set:function(t){this.$emit("input",t)}},te_lr_disabled:function(){return this.datas.enable_train_unet||this.isView||"Prodigy"==this.datas.optimizer||["sd35_default"].includes(this.type)},enable_train_unet_disabled:function(){return this.datas.enable_train_text_encoder||this.isView||["sd35_default","flux_default"].includes(this.type)}},data:function(){return{intLearningRate:"",dialogVisible:!1,tabList:["trainParamete","sampleSetting","trainSaveSetting","learnOptimizer","network","labelingSettings","noiseSettings","AdvSet"],tabIndex:0,isOoenScroll:!1,mixed_precision_options:[{value:"no",label:"no"},{value:"fp16",label:"fp16"},{value:"bf16",label:"bf16"}],save_precision_as_options:[{value:"float",label:"float"},{value:"fp16",label:"fp16"},{value:"bf16",label:"bf16"}],learning_rate_options:[{value:1e-6,label:1e-6},{value:1e-5,label:1e-5},{value:5e-5,label:5e-5},{value:1e-4,label:1e-4},{value:2e-4,label:2e-4}],max_token_length_options:[{value:75,label:75},{value:150,label:150},{value:225,label:225},{value:512,label:512}],lr_scheduler_options:[],sampler_options:[],optimizer_options:[]}},created:function(){var t=this;this.isView||(this.config.sampler_name&&this.config.sampler_name.forEach((function(e){t.sampler_options.push({value:e,label:e})})),this.config.lr_schedulers&&this.config.lr_schedulers.forEach((function(e){t.lr_scheduler_options.push({value:e,label:e})})),this.config.optimizers&&this.config.optimizers.forEach((function(e){t.optimizer_options.push({value:e,label:"Prodigy"==e?"Prodigy（".concat(t.$t("newTrainPmt19"),"）"):e})})))},methods:{show:function(){this.dialogVisible=!0},resetArg:function(t){var e=l({},this.value);e[t]=this.defData[t],this.$emit("input",e)},lrChange:function(t){if("down_lr_weight"==t||"up_lr_weight"==t){var e=this.datas[t].split(",");if(12!=e.length)this.$message.warning(this.$t("traindFormatTip")),this.resetArg(t);else{var n=!0;e.forEach((function(t){"-0"==t&&(n=!1),(isNaN(t)||parseFloat(t)>1||parseFloat(t)<0)&&(n=!1)})),n||(this.$message.warning(this.$t("traindFormatTip")),this.resetArg(t))}}else"mid_lr_weight"==t&&(isNaN(this.datas[t])||parseFloat(this.datas[t])>1||parseFloat(this.datas[t])<0)&&this.resetArg(t)},isUnetChange:function(t){var e=l({},this.value);e.te_lr=t?0:this.defData.te_lr,this.$emit("input",e)},isEncoderChange:function(t){var e=l({},this.value);e.unet_lr=t?0:this.defData.unet_lr,this.$emit("input",e)},restUnetLr:function(){var t=l({},this.value);t.unet_lr<1e-6?t.unet_lr=1e-6:t.unet_lr>.001&&(t.unet_lr=.001),t.unet_lr=Number(t.unet_lr),this.$emit("input",t)},restTeLr:function(){var t=l({},this.value);t.te_lr<1e-6?t.te_lr=1e-6:t.te_lr>.001&&(t.te_lr=.001),t.te_lr=Number(t.te_lr),this.$emit("input",t)},scrollToItem:function(t){this.tabIndex=t,this.$refs.listItem[t].scrollIntoView({behavior:"smooth",block:"start"})},isElementInParentViewport:function(t){var e=t.parentElement.getBoundingClientRect(),rect=t.getBoundingClientRect();return rect.top>=e.top&&rect.bottom<=e.bottom},highlightTab:function(){if(this.isOoenScroll){for(var i=0;i<this.tabList.length;i++){var t=this.$refs.listItem[i];this.isElementInParentViewport(t)&&(this.tabIndex=i)}0==this.$refs.scrollContainer.scrollTop&&(this.tabIndex=0)}},resolutionChange:function(){var t=l({},this.value);parseInt(this.datas.resolutionWidth)>1024&&(this.datas.resolutionWidth=1024),parseInt(this.datas.resolutionWidth)<512&&(this.datas.resolutionWidth=512),parseInt(this.datas.resolutionHeight)>1024&&(this.datas.resolutionHeight=1024),parseInt(this.datas.resolutionHeight)<512&&(this.datas.resolutionHeight=512),t.resolutionWidth=parseInt(this.datas.resolutionWidth),t.resolutionHeight=parseInt(this.datas.resolutionHeight),t.text_to_img.width=parseInt(this.datas.resolutionWidth),t.text_to_img.height=parseInt(this.datas.resolutionHeight),this.$emit("input",t)},changeTxtToImgSeed:function(){if(!this.isView){var t=l({},this.value);t.text_to_img.seed=this.getRandomSeed(),this.$emit("input",t)}},changeSeed:function(){if(!this.isView){var t=l({},this.value);t.seed=this.getRandomSeed(),this.$emit("input",t)}},getRandomSeed:function(){return Math.floor(4294967294*Math.random())+1},optimizerChange:function(){var t=l({},this.value);"Prodigy"==this.datas.optimizer?(this.learning_rate_options=[{value:1,label:"1.0（".concat(this.$t("newTrainPmt20"),"）")},{value:1.2,label:1.2},{value:.5,label:.5}],t.learning_rate=1,this.datas.enable_train_unet=!0,this.datas.enable_train_text_encoder=!1,t.te_lr=0,t.unet_lr=this.defData.unet_lr):(this.learning_rate_options=[{value:1e-6,label:1e-6},{value:1e-5,label:1e-5},{value:5e-5,label:5e-5},{value:1e-4,label:1e-4},{value:2e-4,label:2e-4}],t.learning_rate=this.defData.learning_rate,this.datas.enable_train_unet=!1,this.datas.enable_train_text_encoder=!1,t.te_lr=this.defData.te_lr,t.unet_lr=this.defData.unet_lr),this.$emit("input",t)}}},d=(n(2471),n(2472),n(0)),component=Object(d.a)(c,(function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:t.$t("AdvSet"),visible:t.dialogVisible,width:"885px",top:"10vh","custom-class":"trainDialog"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{staticClass:"TarinAdvSet"},[e("div",{staticClass:"tabs"},t._l(t.tabList,(function(n,o){return e("div",{key:o,staticClass:"tabItem",class:{activateIndex:t.tabIndex==o},on:{click:function(e){return t.scrollToItem(o)}}},[t._v(t._s(t.$t(n)))])})),0),t._v(" "),e("div",{ref:"scrollContainer",staticClass:"dataList",on:{scroll:t.highlightTab,mouseover:function(e){t.isOoenScroll=!0},mouseout:function(e){t.isOoenScroll=!1}}},t._l(t.tabList,(function(o,r){return e("div",{key:r,ref:"listItem",refInFor:!0,staticClass:"dataBox"},[e("div",{staticClass:"dataTiT"},[t._v(t._s(t.$t(o)))]),t._v(" "),"trainParamete"==o?e("div",{staticClass:"dataCnt"},[e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Repeat")]),t._v(" "),e("div",[t._v(t._s(t.$t("singleCount")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-slider",{attrs:{disabled:t.isView,"show-input":"","show-input-controls":!1,"show-tooltip":!1,min:1,max:50},model:{value:t.datas.repeat,callback:function(e){t.$set(t.datas,"repeat",e)},expression:"datas.repeat"}})],1)]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Epoch")]),t._v(" "),e("div",[t._v(t._s(t.$t("numberCycles")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-slider",{attrs:{disabled:t.isView,"show-input":"","show-input-controls":!1,"show-tooltip":!1,min:1,max:20},model:{value:t.datas.epoch,callback:function(e){t.$set(t.datas,"epoch",e)},expression:"datas.epoch"}})],1)]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Batch size")]),t._v(" "),e("div",[t._v(t._s(t.$t("batchSize")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-slider",{attrs:{disabled:t.isView||["sdxl_default","flux_default","sd35_default"].includes(t.type),"show-input":"","show-input-controls":!1,"show-tooltip":!1,min:1,max:t.maxBatchSize},model:{value:t.datas.train_batch_size,callback:function(e){t.$set(t.datas,"train_batch_size",e)},expression:"datas.train_batch_size"}})],1)]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Mixed precision")]),t._v(" "),e("div",[t._v(t._s(t.$t("trainingMixedPrecision")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-select",{attrs:{disabled:t.isView||["flux_default","sd35_default"].includes(t.type),"popper-class":"custom-select"},model:{value:t.datas.mixed_precision,callback:function(e){t.$set(t.datas,"mixed_precision",e)},expression:"datas.mixed_precision"}},t._l(t.mixed_precision_options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)])]):t._e(),t._v(" "),"sampleSetting"==o?e("div",{staticClass:"dataCnt"},[e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("resolution")]),t._v(" "),e("div",[t._v(t._s(t.$t("sampleImageResolution")))])]),t._v(" "),t.datas.resolution?e("div",{staticClass:"dataEntry"},[e("div",{staticClass:"resolutionBox"},[e("el-input",{attrs:{disabled:t.isView||"flux_default"===t.type},on:{change:t.resolutionChange},model:{value:t.datas.resolutionWidth,callback:function(e){t.$set(t.datas,"resolutionWidth",e)},expression:"datas.resolutionWidth"}},[e("template",{slot:"prefix"},[t._v("width")])],2),t._v(" "),e("el-input",{attrs:{disabled:t.isView||"flux_default"===t.type},on:{change:t.resolutionChange},model:{value:t.datas.resolutionHeight,callback:function(e){t.$set(t.datas,"resolutionHeight",e)},expression:"datas.resolutionHeight"}},[e("template",{slot:"prefix"},[t._v("height")])],2)],1)]):t._e()]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Seed")]),t._v(" "),e("div",[t._v(t._s(t.$t("RandomSeed")))])]),t._v(" "),t.datas.text_to_img?e("div",{staticClass:"dataEntry"},[e("div",{staticClass:"seedBox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.datas.text_to_img.seed,expression:"datas.text_to_img.seed"}],attrs:{type:"number",disabled:t.isView},domProps:{value:t.datas.text_to_img.seed},on:{change:function(e){t.datas.text_to_img.seed=Number(t.datas.text_to_img.seed)},input:function(e){e.target.composing||t.$set(t.datas.text_to_img,"seed",e.target.value)}}}),t._v(" "),e("div",{on:{click:t.changeTxtToImgSeed}},[e("img",{attrs:{src:n(583),alt:""}})])])]):t._e()]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Sampler")]),t._v(" "),e("div",[t._v(t._s(t.$t("SamplingMethod")))])]),t._v(" "),t.datas.text_to_img?e("div",{staticClass:"dataEntry"},[e("el-select",{attrs:{disabled:t.isView,"popper-class":"custom-select"},model:{value:t.datas.text_to_img.sampler_name,callback:function(e){t.$set(t.datas.text_to_img,"sampler_name",e)},expression:"datas.text_to_img.sampler_name"}},t._l(t.sampler_options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1):t._e()]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Prompts")]),t._v(" "),e("div",[t._v(t._s(t.$t("Prompt")))])]),t._v(" "),t.datas.text_to_img?e("div",{staticClass:"dataEntry"},[e("el-input",{attrs:{disabled:t.isView,type:"textarea",resize:"none"},model:{value:t.datas.text_to_img.prompt,callback:function(e){t.$set(t.datas.text_to_img,"prompt",e)},expression:"datas.text_to_img.prompt"}})],1):t._e()]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Negative Prompts")]),t._v(" "),e("div",[t._v(t._s(t.$t("NegativePrompts")))])]),t._v(" "),t.datas.text_to_img?e("div",{staticClass:"dataEntry"},[e("el-input",{attrs:{disabled:t.isView,type:"textarea",resize:"none"},model:{value:t.datas.text_to_img.negative_prompt,callback:function(e){t.$set(t.datas.text_to_img,"negative_prompt",e)},expression:"datas.text_to_img.negative_prompt"}})],1):t._e()])]):t._e(),t._v(" "),"trainSaveSetting"==o?e("div",{staticClass:"dataCnt"},[e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Save every N epochs")]),t._v(" "),e("div",[t._v(t._s(t.$t("LoRAsaRounds")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-slider",{attrs:{disabled:t.isView,"show-input":"","show-input-controls":!1,"show-tooltip":!1,min:1,max:t.datas.epoch},model:{value:t.datas.save_every_n_epochs,callback:function(e){t.$set(t.datas,"save_every_n_epochs",e)},expression:"datas.save_every_n_epochs"}})],1)]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Save precision")]),t._v(" "),e("div",[t._v(t._s(t.$t("LoRAsaPrecision")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-select",{attrs:{"popper-class":"custom-select",disabled:t.isView||"flux_default"===t.type},model:{value:t.datas.save_precision_as,callback:function(e){t.$set(t.datas,"save_precision_as",e)},expression:"datas.save_precision_as"}},t._l(t.save_precision_as_options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)])]):t._e(),t._v(" "),"learnOptimizer"==o?e("div",{staticClass:"dataCnt"},[e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Learning Rate")]),t._v(" "),e("div",[t._v(t._s(t.$t("learningRate")))]),t._v(" "),e("div",[t._v(t._s(t.$t("trainDesc3")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-select",{attrs:{"popper-class":"custom-select",disabled:t.isView},model:{value:t.datas.learning_rate,callback:function(e){t.$set(t.datas,"learning_rate",e)},expression:"datas.learning_rate"}},t._l(t.learning_rate_options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Unet lr")]),t._v(" "),e("div",[t._v(t._s(t.$t("trainDesc4")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("div",{staticClass:"inputBox",style:{opacity:t.datas.enable_train_text_encoder||t.isView||"Prodigy"==t.datas.optimizer?.2:1}},[e("el-input",{attrs:{type:"number",disabled:t.datas.enable_train_text_encoder||t.isView||"Prodigy"==t.datas.optimizer,resize:"none"},on:{change:t.restUnetLr},model:{value:t.datas.unet_lr,callback:function(e){t.$set(t.datas,"unet_lr",e)},expression:"datas.unet_lr"}})],1)])]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Text encoder lr")]),t._v(" "),e("div",[t._v(t._s(t.$t("trainDesc5")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("div",{staticClass:"inputBox",style:{opacity:t.datas.enable_train_unet||t.isView||"Prodigy"==t.datas.optimizer?.2:1}},[e("el-input",{attrs:{type:"number",disabled:t.te_lr_disabled,resize:"none"},on:{change:t.restTeLr},model:{value:t.datas.te_lr,callback:function(e){t.$set(t.datas,"te_lr",e)},expression:"datas.te_lr"}})],1)])]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Lr warm up")]),t._v(" "),e("div",[t._v(t._s(t.$t("newTrainPmt1")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-slider",{attrs:{disabled:t.isView,"show-input":"","show-input-controls":!1,"show-tooltip":!1},model:{value:t.datas.lr_warmup,callback:function(e){t.$set(t.datas,"lr_warmup",e)},expression:"datas.lr_warmup"}})],1)]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Lr scheduler")]),t._v(" "),e("div",[t._v(t._s(t.$t("learningRateScheduler")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-select",{attrs:{"popper-class":"custom-select",disabled:t.isView},model:{value:t.datas.lr_scheduler,callback:function(e){t.$set(t.datas,"lr_scheduler",e)},expression:"datas.lr_scheduler"}},t._l(t.lr_scheduler_options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Optimizer")]),t._v(" "),e("div",[t._v(t._s(t.$t("Optimizer")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-select",{attrs:{"popper-class":"custom-select",disabled:t.isView},on:{change:function(e){return t.optimizerChange()}},model:{value:t.datas.optimizer,callback:function(e){t.$set(t.datas,"optimizer",e)},expression:"datas.optimizer"}},t._l(t.optimizer_options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Lr scheduler num cycles")]),t._v(" "),e("div",[t._v(t._s(t.$t("newTrainPmt2")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-slider",{attrs:{disabled:t.isView,"show-input":"","show-input-controls":!1,"show-tooltip":!1,min:1,max:5},model:{value:t.datas.lr_scheduler_num_cycles,callback:function(e){t.$set(t.datas,"lr_scheduler_num_cycles",e)},expression:"datas.lr_scheduler_num_cycles"}})],1)]),t._v(" "),t.isView?t._e():e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Train unet only")]),t._v(" "),e("div",[t._v(t._s(t.$t("newTrainPmt3")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-switch",{attrs:{disabled:t.enable_train_unet_disabled},on:{change:t.isUnetChange},model:{value:t.datas.enable_train_unet,callback:function(e){t.$set(t.datas,"enable_train_unet",e)},expression:"datas.enable_train_unet"}})],1)]),t._v(" "),t.isView?t._e():e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Train text encoder only")]),t._v(" "),e("div",[t._v(t._s(t.$t("newTrainPmt4")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-switch",{attrs:{disabled:t.datas.enable_train_unet||t.isView},on:{change:t.isEncoderChange},model:{value:t.datas.enable_train_text_encoder,callback:function(e){t.$set(t.datas,"enable_train_text_encoder",e)},expression:"datas.enable_train_text_encoder"}})],1)]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Min snr gamma")]),t._v(" "),e("div",[t._v(t._s(t.$t("newTrainPmt5")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-slider",{attrs:{disabled:t.isView,"show-input":"","show-input-controls":!1,"show-tooltip":!1,min:0,max:20},model:{value:t.datas.min_snr_gamma,callback:function(e){t.$set(t.datas,"min_snr_gamma",e)},expression:"datas.min_snr_gamma"}})],1)])]):t._e(),t._v(" "),"network"==o?e("div",{staticClass:"dataCnt"},[e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("enable block weights")]),t._v(" "),e("div",[t._v(t._s(t.$t("newTrainPmt6")))]),t._v(" "),e("div",[t._v(t._s(t.$t("newTrainPmtDesc1")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-switch",{attrs:{disabled:t.isView},model:{value:t.datas.enable_block_weights,callback:function(e){t.$set(t.datas,"enable_block_weights",e)},expression:"datas.enable_block_weights"}})],1)]),t._v(" "),t.datas.enable_block_weights?e("div",{staticClass:"lr_box"},[e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("down lr weight")]),t._v(" "),e("div",[t._v(t._s(t.$t("newTrainPmt7")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("div",{staticClass:"inputBox"},[e("el-input",{attrs:{disabled:t.isView,type:"text",resize:"none"},on:{change:function(e){return t.lrChange("down_lr_weight")}},model:{value:t.datas.down_lr_weight,callback:function(e){t.$set(t.datas,"down_lr_weight",e)},expression:"datas.down_lr_weight"}})],1)])]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("mid lr weight")]),t._v(" "),e("div",[t._v(t._s(t.$t("newTrainPmt8")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("div",{staticClass:"inputBox"},[e("el-input",{attrs:{disabled:t.isView,type:"text",resize:"none"},on:{change:function(e){return t.lrChange("mid_lr_weight")}},model:{value:t.datas.mid_lr_weight,callback:function(e){t.$set(t.datas,"mid_lr_weight",e)},expression:"datas.mid_lr_weight"}})],1)])]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("up lr weight")]),t._v(" "),e("div",[t._v(t._s(t.$t("newTrainPmt9")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("div",{staticClass:"inputBox"},[e("el-input",{attrs:{disabled:t.isView,type:"text",resize:"none"},on:{change:function(e){return t.lrChange("up_lr_weight")}},model:{value:t.datas.up_lr_weight,callback:function(e){t.$set(t.datas,"up_lr_weight",e)},expression:"datas.up_lr_weight"}})],1)])]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("block_lr_zero_threshold")]),t._v(" "),e("div",[t._v(t._s(t.$t("newTrainPmt10")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-slider",{attrs:{disabled:t.isView,"show-input":"","show-input-controls":!1,"show-tooltip":!1,step:.1,min:0,max:1},model:{value:t.datas.block_lr_zero_threshold,callback:function(e){t.$set(t.datas,"block_lr_zero_threshold",e)},expression:"datas.block_lr_zero_threshold"}})],1)])]):t._e(),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Network Rank Dim")]),t._v(" "),e("div",[t._v(t._s(t.$t("networkSize")))]),t._v(" "),e("div",[t._v(t._s(t.$t("newTrainPmtDesc2")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-slider",{attrs:{disabled:t.isView,"show-input":"","show-input-controls":!1,"show-tooltip":!1,min:1,max:128},model:{value:t.datas.network_dim,callback:function(e){t.$set(t.datas,"network_dim",e)},expression:"datas.network_dim"}})],1)]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Network Alpha")]),t._v(" "),e("div",[t._v(t._s(t.$t("netWorkAlpha")))]),t._v(" "),e("div",[t._v(t._s(t.$t("newTrainPmtDesc3")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-slider",{attrs:{disabled:t.isView,"show-input":"","show-input-controls":!1,"show-tooltip":!1,min:1,max:["flux_default","sd35_default"].includes(t.type)?128:t.datas.network_dim},model:{value:t.datas.network_alpha,callback:function(e){t.$set(t.datas,"network_alpha",e)},expression:"datas.network_alpha"}})],1)])]):t._e(),t._v(" "),"labelingSettings"==o?e("div",{staticClass:"dataCnt"},[e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Shuffle caption")]),t._v(" "),e("div",[t._v(t._s(t.$t("newTrainPmt11")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-switch",{attrs:{disabled:t.isView},model:{value:t.datas.shuffle_caption,callback:function(e){t.$set(t.datas,"shuffle_caption",e)},expression:"datas.shuffle_caption"}})],1)]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("weighted captions")]),t._v(" "),e("div",[t._v(t._s(t.$t("newTrainPmt12")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-switch",{attrs:{disabled:t.isView},model:{value:t.datas.weighted_captions,callback:function(e){t.$set(t.datas,"weighted_captions",e)},expression:"datas.weighted_captions"}})],1)]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("keep n tokens")]),t._v(" "),e("div",[t._v(t._s(t.$t("newTrainPmt13")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-slider",{attrs:{disabled:t.isView,"show-input":"","show-input-controls":!1,"show-tooltip":!1,min:1,max:225},model:{value:t.datas.keep_tokens,callback:function(e){t.$set(t.datas,"keep_tokens",e)},expression:"datas.keep_tokens"}})],1)]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Max token length")]),t._v(" "),e("div",[t._v(t._s(t.$t("newTrainPmt14")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-select",{attrs:{"popper-class":"custom-select",disabled:t.isView||"flux_default"===t.type},on:{change:function(e){return t.optimizerChange()}},model:{value:t.datas.max_token_length,callback:function(e){t.$set(t.datas,"max_token_length",e)},expression:"datas.max_token_length"}},t._l(t.max_token_length_options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)])]):t._e(),t._v(" "),"noiseSettings"==o?e("div",{staticClass:"dataCnt"},[e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Noise offset（0~1）")]),t._v(" "),e("div",[t._v(t._s(t.$t("newTrainPmt15")))]),t._v(" "),e("div",[t._v(t._s(t.$t("newTrainPmtDesc4")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-slider",{attrs:{disabled:t.isView||"sdxl_default"==t.type,"show-input":"","show-input-controls":!1,"show-tooltip":!1,min:0,max:1,step:.01},model:{value:t.datas.noise_offset,callback:function(e){t.$set(t.datas,"noise_offset",e)},expression:"datas.noise_offset"}})],1)]),t._v(" "),"sdxl_default"!=t.type?e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Multires noise iterations")]),t._v(" "),e("div",[t._v(t._s(t.$t("newTrainPmt16")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-slider",{attrs:{disabled:t.isView,"show-input":"","show-input-controls":!1,"show-tooltip":!1,min:0,max:64},model:{value:t.datas.multires_noise_iterations,callback:function(e){t.$set(t.datas,"multires_noise_iterations",e)},expression:"datas.multires_noise_iterations"}})],1)]):t._e(),t._v(" "),"sdxl_default"!=t.type?e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Multires noise discount")]),t._v(" "),e("div",[t._v(t._s(t.$t("newTrainPmt17")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-slider",{attrs:{disabled:t.isView,"show-input":"","show-input-controls":!1,"show-tooltip":!1,min:0,max:1,step:.01},model:{value:t.datas.multires_noise_discount,callback:function(e){t.$set(t.datas,"multires_noise_discount",e)},expression:"datas.multires_noise_discount"}})],1)]):t._e()]):t._e(),t._v(" "),"AdvSet"==o?e("div",{staticClass:"dataCnt"},[e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("Seed")]),t._v(" "),e("div",[t._v(t._s(t.$t("RandomSeed")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("div",{staticClass:"seedBox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.datas.seed,expression:"datas.seed"}],attrs:{type:"number",disabled:t.isView},domProps:{value:t.datas.seed},on:{change:function(e){t.datas.seed=Number(t.datas.seed)},input:function(e){e.target.composing||t.$set(t.datas,"seed",e.target.value)}}}),t._v(" "),e("div",{on:{click:t.changeSeed}},[e("img",{attrs:{src:n(583),alt:""}})])])])]),t._v(" "),e("div",{staticClass:"dataItem"},[e("div",{staticClass:"dataLabel"},[e("div",[t._v("clip skip")]),t._v(" "),e("div",[t._v(t._s(t.$t("newTrainPmt18")))])]),t._v(" "),e("div",{staticClass:"dataEntry"},[e("el-slider",{attrs:{disabled:t.isView,"show-input":"","show-input-controls":!1,"show-tooltip":!1,min:1,max:2},model:{value:t.datas.clip_skip,callback:function(e){t.$set(t.datas,"clip_skip",e)},expression:"datas.clip_skip"}})],1)])]):t._e()])})),0)])])}),[],!1,null,"9c707eca",null);e.a=component.exports},525:function(t,e,n){"use strict";n(9),n(7),n(11),n(12),n(8),n(6);var o=n(2),r=(n(4),n(105)),l=n(1);function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}var d={props:{modelInfo:{type:Object,default:function(){}}},data:function(){return{downLoadBoxShow:!1,downLoading:!1,isDownLoad:!1,urlData:{}}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(l.c)("user",["isLoggedIn"])),watch:{downLoadBoxShow:{handler:function(t){t||(this.urlData={})}}},methods:{onClose:function(){this.isDownLoad||this.downLoadBoxShow&&(this.downLoadBoxShow=!1)},getDownLoadUrl:function(){var t=this;this.isLoggedIn?1!=this.downLoadBoxShow?this.downLoading||(this.downLoading=!0,Object(r.c)({model_ver_no:this.modelInfo.model_ver_no}).then((function(e){if(1e4===e.status.code)t.urlData=e.data,t.urlData.url||t.urlData.backup?t.downLoadBoxShow=!0:t.$message({message:t.$t("NoDownload"),type:"warning"});else if(70001===e.status.code)t.$message({message:t.$t("downloadLimit"),type:"warning"});else{var n;t.$message({message:null==e||null===(n=e.status)||void 0===n?void 0:n.msg,type:"error"})}})).finally((function(){t.downLoading=!1}))):this.downLoadBoxShow=!1:this.$EventBus.$emit("openLoginDialog")},download:function(t,e){this.$logEvent("log_actions",{operation:"click_download_model_".concat("LORA"==this.modelInfo.type?"lora":"checkpoint"),behavior_info:this.modelInfo.id});var n=document.createElement("a");n.href=t,console.log(n.href),e&&(n.download=e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),this.downLoadBoxShow=!1}}},h=d,m=(n(2507),n(2508),n(0)),component=Object(m.a)(h,(function(){var t=this,e=t._self._c;return e("el-popover",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.onClose,expression:"onClose"}],attrs:{placement:"bottom-start",title:"",trigger:"manual","popper-class":"downPop"},model:{value:t.downLoadBoxShow,callback:function(e){t.downLoadBoxShow=e},expression:"downLoadBoxShow"}},[e("div",{staticClass:"downLoadBox",on:{mouseover:function(e){t.isDownLoad=!0},mouseout:function(e){t.isDownLoad=!1}}},[t.urlData.url?e("div",{staticClass:"item",on:{click:function(e){return t.download(t.urlData.url)}}},[e("span",[t._v(t._s(t.$t("downloadAddress"))+" 1")]),t._v(" "),e("i",{staticClass:"iconfont icon-icon-Download"})]):t._e(),t._v(" "),t.urlData.backup?e("div",{staticClass:"item",staticStyle:{"margin-top":"15px"},on:{click:function(e){return t.download(t.urlData.backup)}}},[e("span",[t._v(t._s(t.$t("downloadAddress"))+" "+t._s(t.urlData.url?2:1))]),t._v(" "),e("i",{staticClass:"iconfont icon-icon-Download"})]):t._e()]),t._v(" "),e("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.downLoading,expression:"downLoading"}],staticClass:"modelDownload",attrs:{slot:"reference"},on:{click:t.getDownLoadUrl},slot:"reference"},[e("i",{staticClass:"iconfont icon-icon-Download"})])],1)}),[],!1,null,"2c8dfd30",null);e.a=component.exports},536:function(t,e,n){"use strict";n(10),n(18),n(47),n(43),n(28),n(4),n(6);var o=n(13),r=n(81),l={name:"tagList",props:{iconBntWidth:{type:Number,default:36},moveLeng:{type:Number,default:400}},data:function(){return{list:[],selectList:[],isShowLeft:!1,isShowRight:!0,savedScrollLeft:0}},mounted:function(){var t=this;this.selectList=[],this.getList(),window.addEventListener("resize",this.setMoveBtnShow),this.$refs.scrollArea.addEventListener("scroll",this.setMoveBtnShow),this.$once("hook:beforeDestroy",(function(){t.$refs.scrollArea.removeEventListener("scroll",t.setMoveBtnShow),window.removeEventListener("resize",t.setMoveBtnShow)}))},beforeDestroy:function(){this.loading=!1},updated:function(){var t=this;this.$nextTick((function(){t.setMoveBtnShow()}))},methods:{getList:function(){var t=this;this.loading=!0,Object(r.a)({show_area:"cyber_bar"}).then((function(e){var n=(null==e?void 0:e.data)||[];n.length&&n.forEach((function(e){e.title=e[o.l[t.$i18n.locale]]})),t.list=n})).finally((function(){t.loading=!1}))},handleSelect:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.loading&&(this.$logEvent("log_actions",{operation:"tavern_on_square",behavior_info:"click_tags",behavior_info_sub:t}),(this.list||[]).some((function(e){return e.id===t.id})))){var e=this.selectList.findIndex((function(e){return e===t.id}));if(-1!==e)this.selectList.splice(e,1);else{if(this.selectList.length>=10)return;this.selectList.push(t.id)}this.$emit("selectList",this.selectList)}},clearSelect:function(){this.selectList=[],this.$emit("selectList",this.selectList)},setMoveBtnShow:function(){var t,e,n=this.$refs.scrollArea||{};n<=(null===(t=this.$refs.tags)||void 0===t?void 0:t.offsetWidth)&&(this.isShowRight=!1),0===n.scrollLeft?this.isShowLeft=!1:this.isShowLeft=!0,Math.ceil(n.scrollLeft)+n.clientWidth>=n.scrollWidth?this.isShowRight=!1:this.isShowRight=!0,this.savedScrollLeft=null===(e=this.$refs.scrollArea)||void 0===e?void 0:e.scrollLeft},tagsMove:function(t){this.$refs.scrollArea.scrollBy({left:t,behavior:"smooth"}),this.setMoveBtnShow()}}},c=l,d=(n(2671),n(0)),component=Object(d.a)(c,(function(){var t=this,e=t._self._c;return e("div",{ref:"tags",staticClass:"c-tavern-tag-list"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowLeft,expression:"isShowLeft"}],staticClass:"swipeab-icon-box swipeab-icon-box-left",style:{width:t.iconBntWidth+"px"}},[e("div",{staticClass:"icon-bnt",style:{width:t.iconBntWidth+"px",height:t.iconBntWidth+"px",marginTop:"-"+t.iconBntWidth/2+"px"},on:{click:function(e){return t.tagsMove("-"+t.moveLeng)}}},[e("i",{staticClass:"el-icon-arrow-left"})])]),t._v(" "),e("div",{ref:"scrollArea",staticClass:"scroll-area"},[e("div",{staticClass:"scroll-area-list"},[e("div",{key:"tavern_tag_",staticClass:"tavern-tag-item",class:[t.selectList.length?"":"tavern-tag-item-active"],on:{click:function(e){return e.stopPropagation(),t.clearSelect.apply(null,arguments)}}},[t._v(t._s(t.$t("tavern3"))+"\n      ")]),t._v(" "),t._l(t.list,(function(n){return e("div",{key:"tavern_tag_".concat(n.id),staticClass:"tavern-tag-item",class:[(t.selectList||[]).includes(n.id)?"tavern-tag-item-active":""],on:{click:function(e){return e.stopPropagation(),t.handleSelect(n)}}},[t._v("\n        "+t._s(n.title||n.id)+"\n      ")])}))],2)]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowRight,expression:"isShowRight"}],staticClass:"swipeab-icon-box swipeab-icon-box-right",style:{width:t.iconBntWidth+"px"}},[e("div",{staticClass:"icon-bnt",style:{width:t.iconBntWidth+"px",height:t.iconBntWidth+"px",marginTop:"-"+t.iconBntWidth/2+"px"},on:{click:function(e){return t.tagsMove(t.moveLeng)}}},[e("i",{staticClass:"el-icon-arrow-right"})])])])}),[],!1,null,"ed24e648",null);e.a=component.exports},537:function(t,e,n){"use strict";n(14),n(9),n(7),n(11),n(12),n(8),n(4),n(6);var o=n(2),r=n(5),l=n(186),c=n(1);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m={name:"roleCardItem",components:{AiChatReport:l.a},props:{isDel:{type:Boolean,default:!1},cardInfo:{type:Object,default:function(){return{}}},showShareBtn:{type:Boolean,default:!0}},computed:h(h({},Object(c.e)("user",["token"])),{},{isLoggedIn:function(){return this.token}}),data:function(){return{formatNumberForeign:r.i,replaceImageType:r.x,vipIconUrl:n(162),defaultImageUrl:"https://image.cdn2.seaart.ai/static/upload/20231207/39b3e881-ae85-415d-b7aa-74182b3b6267.webp"}},methods:{handleClickToDetails:function(){var t;this.$router.push(this.localePath("/cyberPubPage/".concat(null===(t=this.cardInfo)||void 0===t?void 0:t.id)))},otherUser:function(t){var e,n,path="/user/"+encodeURIComponent(t.author.id);(null===(e=this.userInfo)||void 0===e?void 0:e.id)==(null===(n=t.author)||void 0===n?void 0:n.id)&&(path="/personal"),window.open(this.localePath(path),"_blank")},goCreatedSame:function(t){if(t){var e=this.localePath("/cyberPubPage/new-character?id=".concat(t,"&sameStyle=1"));this.isLoggedIn?this.$router.push(e):this.$EventBus.$emit("openLoginDialog",{redirect:e})}},toMall:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$logEvent("log_actions",{operation:"subscription_page_show",behavior_info:null!=t&&t.name?t.name:location.href}),window.open("".concat(location.origin,"/mall"),"_blank")},delCard:function(){this.$emit("delete",this.cardInfo)},goChat:function(){var t;this.$router.push(this.localePath("/aiChat/".concat(null===(t=this.cardInfo)||void 0===t?void 0:t.id)))},queryByTag:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$emit("queryByTag",t.id)},moreActions:function(){if("report"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:""))try{this.$logEvent("log_actions",{operation:"tavern_on_square",behavior_info:"click_report"}),this.$refs.AiChatReport.open()}catch(t){}},handleShare:function(){this.$logEvent("log_actions",{operation:"tavern_on_square",behavior_info:"click_share"});var t=location.origin;Object(r.d)(t+"/cyberPubPage/".concat(this.cardInfo.id)),this.$message.success(this.$t("CopiedURLToClipboard"))}}},v=m,f=(n(2674),n(0)),component=Object(f.a)(v,(function(){var t,e,n,o,r,l,c,d,h,m,v,f,_,y,w,C=this,k=C._self._c;return k("div",{staticClass:"c-role-card-item",on:{click:function(t){return t.stopPropagation(),C.goChat.apply(null,arguments)}}},[k("a",{attrs:{href:C.localePath("/cyberPubPage/".concat(null===(t=C.cardInfo)||void 0===t?void 0:t.id))}}),C._v(" "),k("div",{staticClass:"role-card-item-cover"},[k("div",{staticClass:"role-card-item-cover-image-box"},[k("el-image",{staticClass:"item-cover-img",attrs:{src:null!==(e=C.cardInfo)&&void 0!==e&&null!==(e=e.cover)&&void 0!==e&&e.url?C.replaceImageType(null===(n=C.cardInfo)||void 0===n||null===(n=n.cover)||void 0===n?void 0:n.url,"low"):C.defaultImageUrl,lazy:""}},[k("template",{slot:"error"},[k("img",{staticClass:"item-cover-img",attrs:{src:null===(o=C.cardInfo)||void 0===o||null===(o=o.cover)||void 0===o?void 0:o.url,alt:""}})])],2),C._v(" "),k("img",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{src:C.replaceImageType(null===(r=C.cardInfo)||void 0===r||null===(r=r.cover)||void 0===r?void 0:r.url,"low"),alt:C.cardInfo.name}}),C._v(" "),k("el-popover",{ref:"myPopover",attrs:{placement:"bottom-end","popper-class":"msg-item-more-popover","visible-arrow":!1,width:"120",trigger:"hover"}},[k("div",{staticClass:"pop-btns flex"},[k("button",{on:{click:function(t){return t.stopPropagation(),t.preventDefault(),C.moreActions("report")}}},[k("span",{staticClass:"pop-btns-text"},[C._v(C._s(C.$t("Report")))]),C._v(" "),k("span",{staticClass:"pop-btns-icon"},[k("i",{staticClass:"iconfont icon-task-report-icon"})])])]),C._v(" "),k("div",{staticClass:"item-cover-operate",attrs:{slot:"reference"},slot:"reference"},[k("i",{staticClass:"iconfont icon-more"})])])],1)]),C._v(" "),k("div",{staticClass:"role-card-item-content"},[k("div",{staticClass:"card-info"},[k("div",{staticClass:"role-card-item-content-title"},[1===(null===(l=C.cardInfo)||void 0===l?void 0:l.allow_same)?[k("span",{staticClass:"item-content-title-text item-content-title-text-same",attrs:{title:null===(c=C.cardInfo)||void 0===c?void 0:c.name},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),C.handleClickToDetails.apply(null,arguments)}}},[C._v("\n            "+C._s(null===(d=C.cardInfo)||void 0===d?void 0:d.name)+"\n          ")]),C._v(" "),k("div",{staticClass:"same-style",on:{click:function(t){var e;return t.stopPropagation(),t.preventDefault(),C.goCreatedSame(null===(e=C.cardInfo)||void 0===e?void 0:e.id)}}},[C._v(C._s(C.$t("Remix")))])]:k("span",{staticClass:"item-content-title-text",attrs:{title:null===(h=C.cardInfo)||void 0===h?void 0:h.name},on:{click:function(t){return t.stopPropagation(),C.handleClickToDetails.apply(null,arguments)}}},[C._v("\n          "+C._s(null===(m=C.cardInfo)||void 0===m?void 0:m.name)+"\n        ")])],2),C._v(" "),k("el-tooltip",{attrs:{"popper-class":"custom-tips-popper custom-tips-popper-role",effect:"light",placement:"bottom"}},[k("div",{staticClass:"tooltip-txt",attrs:{slot:"content"},slot:"content"},[C._v(" "+C._s(null===(v=C.cardInfo)||void 0===v?void 0:v.evaluation))]),C._v(" "),k("div",{staticClass:"role-card-item-content-subtitle"},[C._v("\n          "+C._s(null===(f=C.cardInfo)||void 0===f?void 0:f.evaluation)+"\n        ")])])],1),C._v(" "),k("div",{staticClass:"item-info"},[k("div",{staticClass:"item-content-tags"},C._l(C.cardInfo.categories,(function(t){return k("span",{key:t.id,staticClass:"item-content-tags-item",on:{click:function(e){return e.stopPropagation(),C.queryByTag(t)}}},[C._v(C._s(t.name))])})),0),C._v(" "),k("div",{staticClass:"item-content-bottom"},[k("div",{staticClass:"author-name ellipsis",attrs:{title:"by "+(null===(_=C.cardInfo)||void 0===_||null===(_=_.author)||void 0===_?void 0:_.name)},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),C.otherUser(C.cardInfo)}}},[C._v("by "+C._s(null===(y=C.cardInfo)||void 0===y||null===(y=y.author)||void 0===y?void 0:y.name)+"\n        ")]),C._v(" "),k("div",{staticClass:"operate-btn-box"},[k("div",{staticClass:"operate-btn-item"},[k("i",{staticClass:"iconfont icon-comment operate-btn-item-icon"}),C._v(" "),k("span",{staticClass:"operate-btn-item-text"},[C._v(C._s(C.formatNumberForeign((null===(w=C.cardInfo)||void 0===w||null===(w=w.stat)||void 0===w?void 0:w.num_of_token)||0)))])]),C._v(" "),C.showShareBtn?k("div",{staticClass:"operate-btn-item",on:{click:function(t){return t.stopPropagation(),C.handleShare.apply(null,arguments)}}},[k("span",{staticClass:"iconfont icon-icon_share operate-btn-item-icon"}),C._v(" "),k("span",{staticClass:"operate-btn-item-text"},[C._v(C._s(C.$t("Share")))])]):C._e()])])]),C._v(" "),k("ai-chat-report",{ref:"AiChatReport",attrs:{"ai-chat-id":C.cardInfo.id}})],1),C._v(" "),k("i",{directives:[{name:"show",rawName:"v-show",value:C.isDel,expression:"isDel"}],staticClass:"el-icon-close close-btn",on:{click:function(t){return t.stopPropagation(),C.delCard.apply(null,arguments)}}})])}),[],!1,null,"50c5a1e4",null);e.a=component.exports},543:function(t,e,n){"use strict";var o={props:{isDetail:{type:Boolean,default:!1}},data:function(){return{isShow:!1}},mounted:function(){},methods:{handleClick:function(){this.$EventBus.$emit("openGenerate",{action:1,data:""})}}},r=(n(2912),n(0)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"blog-header"},[e("div",{staticClass:"blog-header-top"}),t._v(" "),e("div",{staticClass:"flex"},[e("div",{staticClass:"blog-header-left"},[e("div",{staticClass:"blog-header-left-title"},[e("div",{staticClass:"text-top"},[e("span",{staticClass:"text-top-gradient"},[t._v(t._s(t.$t("SeaArt")))]),t._v(" "),e("span",[t._v(" "+t._s(t.isDetail?t.$t("news_title_2"):t.$t("blog_news")))])]),t._v(" "),e("div",{staticClass:"text-tips"},[t._v("\n          "+t._s(t.isDetail?t.$t("news_intro_2"):t.$t("news_intro_1"))+"\n        ")]),t._v(" "),e("div",{staticClass:"text-btn",on:{click:t.handleClick}},[t._v(t._s(t.$t("news_btn")))])])]),t._v(" "),e("div",{staticClass:"blog-header-video",on:{click:function(e){t.isShow=!0}}},[e("img",{staticClass:"video",attrs:{src:"https://image.cdn2.seaart.ai/static/upload/20240228/bc964c0d-2bbd-42ae-a81c-e8fb8efbc2fd.webp",alt:t.$t("top_image_alt")}}),t._v(" "),t._m(0)])]),t._v(" "),t.isShow?e("div",{staticClass:"dialog"},[e("iframe",{attrs:{width:"784",height:"441",src:"https://www.youtube.com/embed/X64TBs6ZeRU?si=DtxDnLt4aQMk14WS",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowfullscreen:""}}),t._v(" "),e("i",{staticClass:"el-icon-close",on:{click:function(e){t.isShow=!1}}})]):t._e()])}),[function(){var t=this._self._c;return t("div",{staticClass:"blog-header-video-play"},[t("i",{staticClass:"iconfont icon-a-Vector2900"})])}],!1,null,"f1712e16",null);e.a=component.exports},559:function(t,e,n){"use strict";var o=n(2),r=(n(14),n(9),n(7),n(11),n(12),n(8),n(4),n(6),n(3)),l=(n(20),n(10),n(18),n(29),n(1)),c=n(66),d=n(275);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={name:"PaymentCheck",props:{activeMethod:{type:Object,default:function(){return{}}},thirdOrderId:{type:String,default:""}},computed:m(m({},Object(l.e)("user",["userInfo"])),{},{isYahoo:function(){var t;return null===(t=this.userInfo)||void 0===t||null===(t=t.adv_platform)||void 0===t?void 0:t.includes("yahoo")}}),data:function(){return{intervalId:null,loading:!1,defaultOptions:{animationData:d}}},beforeDestroy:function(){this.intervalId&&this.stopPoll()},methods:m(m({},Object(l.b)("payment",["getPaymentInfo"])),{},{pollGetPaymentStatus:function(t){var e=this;this.thirdOrderId&&t&&(this.intervalId=setInterval(Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.getPaymentOnce(t);case 1:case"end":return n.stop()}}),n)}))),3e3))},getPaymentOnce:function(t){var e=arguments,n=this;return Object(r.a)(regeneratorRuntime.mark((function o(){var r,l,data;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(r=e.length>1&&void 0!==e[1]&&e[1],!n.loading){o.next=3;break}return o.abrupt("return");case 3:return n.loading=!0,o.prev=4,o.next=7,Object(c.i)({third_type:t,order_id:n.thirdOrderId});case 7:l=o.sent,n.loading=!1,null!=(data=l.data)&&data.is_paid?(n.paySuccess(),n.$EventBus.$emit("openPaymentStatusDialog2",{data:data}),n.isYahoo,localStorage.setItem("getRewards",JSON.stringify({dueTime:0}))):r&&n.$message.info(n.$t("paymentWaitTxt")),o.next=19;break;case 13:o.prev=13,o.t0=o.catch(4),n.loading=!1,n.stopPoll(),n.$emit("paymentError",{type:t}),console.log("error",o.t0);case 19:case"end":return o.stop()}}),o,null,[[4,13]])})))()},handleCancel:function(){this.loading||this.$emit("back")},paySuccess:function(){var t=this,e=setTimeout((function(){t.getPaymentInfo(),clearTimeout(e)}),1e3);this.$emit("success")},stopPoll:function(){clearInterval(this.intervalId)}})},f=v,_=(n(2551),n(0)),component=Object(_.a)(f,(function(){var t,e,r,l,c,d,h=this,m=h._self._c;return m("div",{staticClass:"wait-payment-content flex-center"},[m("div",{staticClass:"wait-payment"},[h.loading?m("lottie",{staticClass:"loading-anime",attrs:{options:h.defaultOptions,height:110,width:110}}):h._e(),h._v(" "),null!==(t=h.activeMethod)&&void 0!==t&&t.icon?m("div",{staticClass:"wait-icon"},[m("img",{attrs:Object(o.a)({src:n(258)("./".concat(null===(e=h.activeMethod)||void 0===e?void 0:e.icon)),alt:null===(r=h.activeMethod)||void 0===r?void 0:r.icon,loading:"lazy"},"alt","img-cover"),on:{mousedown:function(t){t.preventDefault()},contextmenu:function(t){t.preventDefault()}}})]):h._e(),h._v(" "),m("div",{staticClass:"wait-method"},[h._v(h._s(h.$t("waitMethod",{method:(null===(l=h.activeMethod)||void 0===l?void 0:l.name)||""})))]),h._v(" "),9===(null===(c=h.activeMethod)||void 0===c?void 0:c.type)?[m("div",{staticClass:"wait-title"},[h._v("\n        "+h._s(h.$t("waitPayTxt2",{btn:h.$t("Done")}))+"\n      ")])]:[m("div",{staticClass:"wait-title"},[h._v("\n        "+h._s(h.$t("waitPayPls",{type:h.$t(null===(d=h.activeMethod)||void 0===d?void 0:d.i18n)}))+"\n      ")]),h._v(" "),m("div",{staticClass:"wait-payment-txt"},[h._v("\n        "+h._s(h.$t("waitPayTxt",{btn:h.$t("Done")}))+"\n      ")])],h._v(" "),m("div",{staticClass:"btns flex justify-center"},[m("el-button",{staticClass:"btn-cancel btn",on:{click:h.handleCancel}},[h._v(h._s(h.$t("Cancel")))]),h._v(" "),m("el-button",{staticClass:"btn-done btn",attrs:{type:"primary"},on:{click:function(t){var e;return h.getPaymentOnce(null===(e=h.activeMethod)||void 0===e?void 0:e.type,!0)}}},[h._v(h._s(h.$t("Done")))])],1)],2)])}),[],!1,null,"54bb8474",null);e.a=component.exports},561:function(t,e,n){"use strict";n(9),n(7),n(11),n(12),n(8),n(4),n(6);var o=n(2),r=n(1);function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){Object(o.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var d={name:"BreakInfo",props:{reason:{type:String,default:""}},data:function(){return{rightsArr:["break_rigths_1","break_rigths_2","daily_rights_4","break_rigths_4"]}},mounted:function(){},computed:c(c({},Object(r.e)("user",["cdnHost"])),{},{getStyle:function(){return{background:"url(https://".concat(this.cdnHost,"/static/upload/20240430/881231ed-6783-434d-af90-d40a22d1cb24.webp) no-repeat center center"),backgroundSize:"cover"}},getImgUrl:function(){return"https://".concat(this.cdnHost,"/static/upload/20240430/5b9a424b-99e9-49f0-8a04-a1f56cfadb4b.webp")}}),methods:{toMall:function(){window.open(this.localePath("/mall"),"_blank")}}},h=(n(3182),n(0)),component=Object(h.a)(d,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"break-info",style:t.getStyle},[e("div",{staticClass:"break-info-item words-wrap"},[e("img",{attrs:{src:t.getImgUrl,alt:"vip icon"}}),t._v(" "),e("div",{staticClass:"txt"},[t._v(t._s(t.$t(t.reason)))])]),t._v(" "),e("div",{staticClass:"break-info-rights"},[e("div",{staticClass:"rights-label"},[t._v(t._s(t.$t("MorePrivileges")))]),t._v(" "),t._l(t.rightsArr,(function(n,o){return e("div",{key:"rights_".concat(o),staticClass:"item-rights"},[e("i",{staticClass:"el-icon-check"}),t._v(" "),e("span",[t._v(t._s(t.$t(n)))])])}))],2),t._v(" "),e("div",{staticClass:"break-info-more",on:{click:t.toMall}},[e("span",[t._v(t._s(t.$t("GetStarted")))]),t._v(" "),e("i",{staticClass:"el-icon-arrow-right"})])])}),[],!1,null,"2cb2feb7",null);e.a=component.exports}}]);